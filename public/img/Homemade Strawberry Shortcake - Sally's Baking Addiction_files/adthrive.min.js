window.adthrive.core = {"partners":[{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.96}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"33across","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"pmp","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.34},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_amazon","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_appnexus","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"stickyOutstream","type":"percent","value":0.36},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_gumgum","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.963},{"name":"stickyOutstream","type":"percent","value":0.3},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ix","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.8}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_ogury","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"stickyOutstream","type":"percent","value":0.28}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_openx","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.15},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_pubmatic","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.988},{"name":"stickyOutstream","type":"percent","value":0.39},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_rubicon","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.986},{"name":"stickyOutstream","type":"percent","value":0.34},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_sharethrough","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_spotx","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.976},{"name":"stickyOutstream","type":"percent","value":0.17},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_triplelift","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.86},{"name":"stickyOutstream","type":"percent","value":0.15},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_unruly","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"stickyOutstream","type":"percent","value":0.3},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_verizon","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.1},{"name":"instream","type":"percent","value":0.975}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"a_yieldmo","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.58},{"name":"stickyOutstream","type":"percent","value":0.45},{"name":"instream","type":"percent","value":0.53}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"adform","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"aidem_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"amazonASR","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.91},{"name":"outstream","type":"percent","value":0.55},{"name":"stickyOutstream","type":"percent","value":0.695},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"appnexus","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.1},{"name":"pmp","type":"percent","value":0.1},{"name":"instream","type":"percent","value":0.1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"col_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.1},{"name":"pmp","type":"percent","value":0.1},{"name":"instream","type":"percent","value":0.1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"colossus","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.35}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"concert","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.985}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"conversant","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.983},{"name":"stickyOutstream","type":"percent","value":0.54},{"name":"instream","type":"percent","value":0.998}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"criteo","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.87},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"G-TRUSTX-b827d08da2714822","type":"percent","value":0.97},{"name":"G-JW_PLAYER-cc4da3eff85746e0","type":"percent","value":0.25},{"name":"G-JW_PLAYER-8d9e8049ca4947cf","type":"percent","value":0.25},{"name":"G-JW_PLAYER-15fae286f8a54614","type":"percent","value":0.25},{"name":"G-JW_PLAYER-48b6dc41e71d4585","type":"percent","value":0.25},{"name":"G-JW_PLAYER-3625d1d8189843b9","type":"percent","value":0.25},{"name":"G-JAKALA-ad18dc54f13645f6","type":"percent","value":0.25},{"name":"G-GOODNET-c64f9ad88c37454b","type":"percent","value":0.25},{"name":"G-JW_PLAYER-8f16946ae7db4d0b","type":"percent","value":0.25},{"name":"G-IPONWEB-8eb9cd8d9c074fdb","type":"percent","value":0.25},{"name":"G-GOODNET-1760a8d1849646d4","type":"percent","value":0.25},{"name":"G-JW_PLAYER-1ffec6b669524e6c","type":"percent","value":0.25},{"name":"G-JW_PLAYER-a3eb7128094c4360","type":"percent","value":0.25},{"name":"G-ORACLE-29af695dcd484d86","type":"percent","value":0.25},{"name":"G-JW_PLAYER-acb2ef7c2dc24255","type":"percent","value":0.25},{"name":"G-IPONWEB-4e2af46faa364ea3","type":"percent","value":0.25},{"name":"G-GOODNET-a81896d35fab407f","type":"percent","value":0.25},{"name":"G-JW_PLAYER-5c0fc3ff3b4f4a8b","type":"percent","value":0.25},{"name":"G-JW_PLAYER-3a20f33920ba4e1d","type":"percent","value":0.25},{"name":"G-IPONWEB-b2694d271dbe4183","type":"percent","value":0.25},{"name":"G-GOODNET-376e7a125b6c404f","type":"percent","value":0.25}]},{"name":"stickyOutstream","type":"percent","value":0.7}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"grid","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gridnat","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.95},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"g-trustx-69dcdccd456a4d4a","type":"percent","value":1}]}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gridvid","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"gumgum","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.8},{"name":"instream","type":"percent","value":0.3}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"improve_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.97},{"name":"outstream","type":"percent","value":0.85},{"name":"pmp","type":"percent","value":0.99,"deals":[{"name":"136707122019991","type":"percent","value":0.85},{"name":"136707122019993","type":"percent","value":0.75},{"name":"136708142019991","type":"percent","value":0.89},{"name":"136712112019997","type":"percent","value":0.83},{"name":"136712112019995","type":"percent","value":0.81},{"name":"136707162019999","type":"percent","value":0.88},{"name":"136704252018993","type":"percent","value":0.85},{"name":"136703312017993","type":"percent","value":0.83},{"name":"136703312017997","type":"percent","value":0.84},{"name":"136710072020991","type":"percent","value":0.79},{"name":"136707162019993","type":"percent","value":0.91},{"name":"136703312017991","type":"percent","value":0.88},{"name":"PAD136707102020991","type":"percent","value":0.8},{"name":"136712112019999","type":"percent","value":0.82},{"name":"7002232015","type":"percent","value":0.69},{"name":"136706042019991","type":"percent","value":0.85},{"name":"136712112019993","type":"percent","value":0.9},{"name":"136707152019991","type":"percent","value":0.88},{"name":"136704252018991","type":"percent","value":0.81},{"name":"8209221604","type":"percent","value":0.86},{"name":"136707122019994","type":"percent","value":0.66},{"name":"136708142019992","type":"percent","value":0.65},{"name":"136712112019998","type":"percent","value":0.89},{"name":"136712112019996","type":"percent","value":0.63},{"name":"136704252018994","type":"percent","value":0.89},{"name":"136703312017996","type":"percent","value":0.75},{"name":"136703312017998","type":"percent","value":0.69},{"name":"136710072020992","type":"percent","value":0.74},{"name":"136707162019994","type":"percent","value":0.76},{"name":"136703312017992","type":"percent","value":0.93},{"name":"PAD136707102020992","type":"percent","value":0.8},{"name":"8209221601","type":"percent","value":0.76},{"name":"136706042019992","type":"percent","value":0.69},{"name":"136712112019994","type":"percent","value":0.83},{"name":"136707152019992","type":"percent","value":0.74},{"name":"136704252018992","type":"percent","value":0.65},{"name":"136707122019992","type":"percent","value":0.88},{"name":"136703072017996","type":"percent","value":0.63},{"name":"1367071620199910","type":"percent","value":0.86},{"name":"M1IX203202022021992","type":"flat","value":0.5},{"name":"M1IX203202022021991","type":"flat","value":0.5},{"name":"PAD136701112021991","type":"percent","value":0.9},{"name":"PAD136701112021992","type":"percent","value":1},{"name":"DMD136703032021991","type":"percent","value":0.86},{"name":"DMD136703032021992","type":"percent","value":0.72},{"name":"DMD136702172021991","type":"percent","value":0.88},{"name":"DMD136704082021991","type":"percent","value":0.88},{"name":"DMD136704052021991","type":"percent","value":0.84},{"name":"DMD136704082021992","type":"percent","value":0.8},{"name":"DMD136702172021992","type":"percent","value":0.95},{"name":"DMD136704052021992","type":"percent","value":0.75},{"name":"136705172021991","type":"percent","value":0.83},{"name":"136705172021992","type":"percent","value":0.72},{"name":"136704262021991","type":"percent","value":0.9},{"name":"136704262021992","type":"percent","value":0.69},{"name":"PAD136707312020991","type":"percent","value":0.9},{"name":"136712112019991","type":"percent","value":0.91},{"name":"136706042019995","type":"percent","value":0.83},{"name":"PAD136707312020992","type":"percent","value":0.92},{"name":"136712112019992","type":"percent","value":0.9},{"name":"136706042019996","type":"percent","value":0.83},{"name":"203209212021995","type":"flat","value":1},{"name":"203209212021996","type":"flat","value":1},{"name":"203210122021995","type":"flat","value":1},{"name":"203210122021996","type":"flat","value":1},{"name":"M1IX203212162021995","type":"flat","value":1},{"name":"M1IX203212162021996","type":"flat","value":1},{"name":"9311192021991","type":"percent","value":0.97},{"name":"9311192021992","type":"percent","value":0.97},{"name":"DMD136708052021991","type":"percent","value":0.9},{"name":"DMD136708052021992","type":"percent","value":0.8},{"name":"146002182022991","type":"flat","value":1},{"name":"146002182022992","type":"flat","value":1},{"name":"146002182022993","type":"flat","value":1},{"name":"146002182022994","type":"flat","value":1},{"name":"146002182022995","type":"flat","value":1},{"name":"DMD136708302021992","type":"percent","value":0.71},{"name":"2251041120229923","type":"percent","value":0.97},{"name":"2251041120229922","type":"percent","value":0.97},{"name":"2251041120229921","type":"percent","value":0.97},{"name":"2251041120229920","type":"percent","value":0.97},{"name":"2251041120229919","type":"percent","value":0.97},{"name":"2251041120229918","type":"percent","value":0.97},{"name":"2251041120229917","type":"percent","value":0.97},{"name":"2251041120229916","type":"percent","value":0.97},{"name":"2251041120229915","type":"percent","value":0.97},{"name":"2251041120229914","type":"percent","value":0.97},{"name":"2251041120229913","type":"percent","value":0.97},{"name":"2251041120229912","type":"percent","value":0.97},{"name":"2251041120229911","type":"percent","value":0.97},{"name":"2251041120229910","type":"percent","value":0.97},{"name":"225104112022999","type":"percent","value":0.97},{"name":"225104112022998","type":"percent","value":0.97},{"name":"225104112022997","type":"percent","value":0.97},{"name":"225104112022996","type":"percent","value":0.97},{"name":"225104112022995","type":"percent","value":0.97},{"name":"225104112022994","type":"percent","value":0.97},{"name":"225104112022993","type":"percent","value":0.97},{"name":"225104112022992","type":"percent","value":0.97},{"name":"225104112022991","type":"percent","value":0.97},{"name":"400104282022991","type":"percent","value":0.97},{"name":"335305022022991","type":"flat","value":1},{"name":"335305022022992","type":"flat","value":1},{"name":"905172022991","type":"flat","value":0.5},{"name":"140408052022991","type":"flat","value":1},{"name":"140408052022992","type":"flat","value":1},{"name":"140408052022993","type":"flat","value":1},{"name":"140408052022994","type":"flat","value":1},{"name":"PAD136707202020991","type":"percent","value":0.88},{"name":"PAD136707202020992","type":"percent","value":0.8},{"name":"51210172022991","type":"flat","value":1},{"name":"51210172022992","type":"flat","value":1},{"name":"140410122022991","type":"flat","value":1},{"name":"140410122022992","type":"flat","value":1},{"name":"136710202022991","type":"percent","value":0.83},{"name":"136710202022992","type":"percent","value":0.63},{"name":"51211082022991","type":"flat","value":1},{"name":"270111082022991","type":"flat","value":1.5},{"name":"270111082022992","type":"flat","value":1.5},{"name":"270111082022993","type":"flat","value":1},{"name":"270111082022994","type":"flat","value":1},{"name":"140412152022995","type":"flat","value":1},{"name":"140412152022996","type":"flat","value":1},{"name":"140412152022997","type":"flat","value":1},{"name":"515112212022991","type":"flat","value":1.5},{"name":"515112212022992","type":"flat","value":1.5},{"name":"683401262023991","type":"percent","value":0.97},{"name":"683401262023992","type":"percent","value":0.97},{"name":"1404013123991","type":"flat","value":1},{"name":"1404013123992","type":"flat","value":1},{"name":"1404013123993","type":"flat","value":1},{"name":"1404013123994","type":"flat","value":1},{"name":"140402282023991","type":"flat","value":1},{"name":"121503022023991","type":"flat","value":1.5},{"name":"121503022023992","type":"flat","value":1.5},{"name":"9063003102023991","type":"flat","value":1},{"name":"9063003102023992","type":"flat","value":1},{"name":"9063003102023993","type":"flat","value":1},{"name":"9063003102023994","type":"flat","value":1},{"name":"140403242023991","type":"flat","value":1},{"name":"140403242023992","type":"flat","value":1},{"name":"140403242023993","type":"flat","value":1},{"name":"136701062023994","type":"percent","value":0.69},{"name":"136701062023993","type":"percent","value":0.83},{"name":"136704102023994","type":"percent","value":0.53},{"name":"136704102023993","type":"percent","value":0.86},{"name":"136704102023992","type":"percent","value":0.56},{"name":"136704102023991","type":"percent","value":0.69},{"name":"15105022023993","type":"flat","value":1},{"name":"15105022023994","type":"flat","value":1},{"name":"15105022023995","type":"flat","value":1},{"name":"15105022023996","type":"flat","value":1},{"name":"20706162023991","type":"flat","value":1},{"name":"20706162023992","type":"flat","value":1},{"name":"72206142023991","type":"flat","value":1.5},{"name":"72206142023992","type":"flat","value":1.5},{"name":"23107122023991","type":"flat","value":1},{"name":"23107122023992","type":"flat","value":1},{"name":"23107122023993","type":"flat","value":1},{"name":"23107122023994","type":"flat","value":1},{"name":"23107122023995","type":"flat","value":1},{"name":"23107122023996","type":"flat","value":1},{"name":"23107122023997","type":"flat","value":1},{"name":"23107122023998","type":"flat","value":1},{"name":"23107122023999","type":"flat","value":1},{"name":"231071220239910","type":"flat","value":1},{"name":"231071220239911","type":"flat","value":1},{"name":"231071220239912","type":"flat","value":1},{"name":"231071220239913","type":"flat","value":1},{"name":"231071220239914","type":"flat","value":1},{"name":"231071220239915","type":"flat","value":1},{"name":"231071220239916","type":"flat","value":1},{"name":"231071220239917","type":"flat","value":1},{"name":"231071220239918","type":"flat","value":1},{"name":"231071220239919","type":"flat","value":1},{"name":"231071220239920","type":"flat","value":1},{"name":"231071220239921","type":"flat","value":1},{"name":"231071220239922","type":"flat","value":1},{"name":"303208092023991","type":"flat","value":0.28},{"name":"303208092023992","type":"flat","value":0.28},{"name":"303208092023993","type":"flat","value":0.28},{"name":"303208092023994","type":"flat","value":0.28},{"name":"303208092023995","type":"flat","value":0.28},{"name":"320809082023991","type":"flat","value":1},{"name":"320809082023992","type":"flat","value":1},{"name":"320809082023993","type":"flat","value":1},{"name":"320809082023994","type":"flat","value":1},{"name":"320809082023995","type":"flat","value":1},{"name":"320809082023996","type":"flat","value":1},{"name":"320809082023997","type":"flat","value":1.5},{"name":"320809082023998","type":"flat","value":1.5},{"name":"536509082023991","type":"flat","value":1},{"name":"536509082023992","type":"flat","value":1},{"name":"536509082023993","type":"flat","value":1},{"name":"536509082023994","type":"flat","value":1},{"name":"536509082023995","type":"flat","value":1},{"name":"536509082023996","type":"flat","value":1},{"name":"20709262023991","type":"flat","value":1},{"name":"20709262023992","type":"flat","value":1},{"name":"110010052023991","type":"flat","value":1.97},{"name":"110010052023992","type":"flat","value":1.97},{"name":"152910052023991","type":"flat","value":1},{"name":"152910052023992","type":"flat","value":1},{"name":"515110202023991","type":"flat","value":1.5},{"name":"515110202023992","type":"flat","value":1.5},{"name":"15110132023991","type":"flat","value":1},{"name":"15110132023992","type":"flat","value":1},{"name":"15110172023992","type":"flat","value":1},{"name":"15110172023991","type":"flat","value":1},{"name":"20710262023995","type":"flat","value":1},{"name":"20710262023996","type":"flat","value":1},{"name":"20710262023997","type":"flat","value":1},{"name":"20710262023998","type":"flat","value":1},{"name":"20710262023999","type":"flat","value":1},{"name":"20710232023910","type":"flat","value":1},{"name":"20710262023911","type":"flat","value":1},{"name":"20710262023912","type":"flat","value":1},{"name":"20710262023913","type":"flat","value":1},{"name":"20710262023914","type":"flat","value":1},{"name":"20710262023915","type":"flat","value":1},{"name":"20710262023916","type":"flat","value":1},{"name":"20710262023917","type":"flat","value":1},{"name":"20710262023918","type":"flat","value":1},{"name":"20710262023919","type":"flat","value":1},{"name":"20710262023920","type":"flat","value":1},{"name":"110010262023991","type":"flat","value":1.97},{"name":"110010262023992","type":"flat","value":1.97},{"name":"110010262023993","type":"flat","value":1.47},{"name":"110010272023994","type":"flat","value":1.47},{"name":"110010272023995","type":"flat","value":1.47},{"name":"212210182023991","type":"percent","value":0.9},{"name":"146006052023995","type":"percent","value":0.9},{"name":"146006052023992","type":"percent","value":0.9},{"name":"146006052023991","type":"percent","value":0.9},{"name":"146006052023993","type":"percent","value":0.9},{"name":"483412152023991","type":"flat","value":1},{"name":"483412152023992","type":"flat","value":1},{"name":"9901242024992","type":"flat","value":1.36},{"name":"9901242024993","type":"flat","value":1.36},{"name":"9901242024994","type":"flat","value":1.36},{"name":"193102232024991","type":"flat","value":0.8},{"name":"193102223024992","type":"flat","value":0.8},{"name":"20701262024995","type":"flat","value":1},{"name":"20701262024996","type":"flat","value":1},{"name":"20701262024997","type":"flat","value":1},{"name":"20701262024998","type":"flat","value":1},{"name":"264202292024992","type":"flat","value":1},{"name":"815104172024991","type":"flat","value":1},{"name":"815104172024992","type":"flat","value":1},{"name":"815104172024993","type":"flat","value":1},{"name":"815104172024994","type":"flat","value":1},{"name":"815104172024995","type":"flat","value":1},{"name":"815104172024996","type":"flat","value":1},{"name":"121503272024991","type":"flat","value":1},{"name":"121503272024992","type":"flat","value":1},{"name":"121503272024993","type":"flat","value":1},{"name":"121503272024994","type":"flat","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.5},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ix","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.978},{"name":"outstream","type":"percent","value":0.71},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"kargo","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":0.75},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"krgo_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"nativo","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.91},{"name":"pmp","type":"percent","value":0.935,"deals":[{"name":"OX-caf-ypSBrR","type":"flat","value":1}]},{"name":"stickyOutstream","type":"percent","value":0.25},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"openx","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.9},{"name":"pmp","type":"percent","value":0.9},{"name":"stickyOutstream","type":"percent","value":0.16},{"name":"instream","type":"percent","value":0.24}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"opnx_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.85}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ozone","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.94},{"name":"outstream","type":"percent","value":0.6},{"name":"pmp","type":"percent","value":0.94,"deals":[{"name":"PM-KINC-9618","type":"flat","value":2}]},{"name":"stickyOutstream","type":"percent","value":0.61},{"name":"instream","type":"percent","value":0.92}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubm_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"outstream","type":"percent","value":0.6},{"name":"pmp","type":"percent","value":0.99,"deals":[{"name":"PM-KINC-9618","type":"flat","value":2}]},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"pubmatic","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.01},{"name":"instream","type":"percent","value":0.01}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"resetdigital","enabled":false},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.35}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rtbhouse","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"pmp","type":"percent","value":1,"deals":[{"name":"829398","type":"percent","value":0.95},{"name":"832174","type":"percent","value":0.97},{"name":"832176","type":"percent","value":0.97},{"name":"855828","type":"percent","value":0.97},{"name":"855824","type":"percent","value":0.97},{"name":"855816","type":"percent","value":0.97},{"name":"855814","type":"percent","value":0.97},{"name":"855812","type":"percent","value":0.97},{"name":"855810","type":"percent","value":0.97},{"name":"855808","type":"percent","value":0.97},{"name":"855806","type":"percent","value":0.97},{"name":"855804","type":"percent","value":0.97},{"name":"855802","type":"percent","value":0.97},{"name":"855800","type":"percent","value":0.97},{"name":"855798","type":"percent","value":0.97},{"name":"855796","type":"percent","value":0.97},{"name":"855794","type":"percent","value":0.97},{"name":"855792","type":"percent","value":0.97},{"name":"855790","type":"percent","value":0.97},{"name":"855788","type":"percent","value":0.97},{"name":"855786","type":"percent","value":0.97},{"name":"855784","type":"percent","value":0.97},{"name":"855782","type":"percent","value":0.97},{"name":"855780","type":"percent","value":0.97},{"name":"855778","type":"percent","value":0.97},{"name":"855776","type":"percent","value":0.97},{"name":"859888","type":"percent","value":0.97},{"name":"944042","type":"percent","value":0.97},{"name":"944044","type":"percent","value":0.97},{"name":"1623876","type":"percent","value":0.88},{"name":"1623874","type":"percent","value":0.88},{"name":"1751444","type":"percent","value":0.88},{"name":"1751662","type":"percent","value":0.88},{"name":"1751448","type":"percent","value":0.88},{"name":"1751664","type":"percent","value":0.88},{"name":"1751450","type":"percent","value":0.88},{"name":"1751666","type":"percent","value":0.88},{"name":"1751452","type":"percent","value":0.88},{"name":"1751668","type":"percent","value":0.88},{"name":"1751454","type":"percent","value":0.88},{"name":"1751670","type":"percent","value":0.88},{"name":"1751456","type":"percent","value":0.88},{"name":"1751672","type":"percent","value":0.88},{"name":"1751474","type":"percent","value":0.88},{"name":"1751674","type":"percent","value":0.88},{"name":"1751472","type":"percent","value":0.88},{"name":"1751676","type":"percent","value":0.88},{"name":"1751476","type":"percent","value":0.88},{"name":"1751678","type":"percent","value":0.88},{"name":"1751478","type":"percent","value":0.88},{"name":"1751680","type":"percent","value":0.88},{"name":"1751480","type":"percent","value":0.88},{"name":"1751682","type":"percent","value":0.88},{"name":"1751482","type":"percent","value":0.88},{"name":"1751684","type":"percent","value":0.88},{"name":"1792390","type":"percent","value":0.88},{"name":"1751632","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.88},{"name":"1751634","type":"percent","value":0.88},{"name":"1751688","type":"percent","value":0.88},{"name":"1751636","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.88},{"name":"1751638","type":"percent","value":0.88},{"name":"1751692","type":"percent","value":0.88},{"name":"1751640","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.88},{"name":"1751642","type":"percent","value":0.88},{"name":"1751696","type":"percent","value":0.88},{"name":"1751644","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.88},{"name":"1751646","type":"percent","value":0.88},{"name":"1751700","type":"percent","value":0.88},{"name":"1751648","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751650","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751652","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.88},{"name":"1751654","type":"percent","value":0.88},{"name":"1751710","type":"percent","value":0.88},{"name":"1751656","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.88},{"name":"1751660","type":"percent","value":0.88},{"name":"1751714","type":"percent","value":0.88},{"name":"1751440","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.88},{"name":"1751442","type":"percent","value":0.88},{"name":"1751718","type":"percent","value":0.88},{"name":"1917132","type":"percent","value":0.88},{"name":"1917134","type":"percent","value":0.88},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1950020","type":"percent","value":0.88},{"name":"1950010","type":"percent","value":0.88},{"name":"2003192","type":"percent","value":0.88},{"name":"2003190","type":"percent","value":0.88},{"name":"2003188","type":"percent","value":0.88},{"name":"2003186","type":"percent","value":0.88},{"name":"2032118","type":"percent","value":0.88},{"name":"1921898","type":"percent","value":0.9},{"name":"1921906","type":"percent","value":0.9},{"name":"1791050","type":"percent","value":0.9},{"name":"1791052","type":"percent","value":0.9},{"name":"1791054","type":"percent","value":0.9},{"name":"1130970","type":"percent","value":0.9},{"name":"1130968","type":"percent","value":0.9},{"name":"1130976","type":"percent","value":0.9},{"name":"1130978","type":"percent","value":0.9},{"name":"1883728","type":"percent","value":0.9},{"name":"1921048","type":"percent","value":0.9},{"name":"1883726","type":"percent","value":0.9},{"name":"1883724","type":"percent","value":0.9},{"name":"1917142","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1909612","type":"percent","value":0.9},{"name":"2040506","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2100546","type":"percent","value":0.9},{"name":"2091612","type":"percent","value":0.9},{"name":"2092510","type":"percent","value":0.9},{"name":"2127668","type":"percent","value":0.9},{"name":"2127670","type":"percent","value":0.9},{"name":"2212648","type":"percent","value":0.9},{"name":"2212644","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2256288","type":"percent","value":0.9},{"name":"2256292","type":"percent","value":0.9},{"name":"2331334","type":"percent","value":0.88},{"name":"2339448","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2356286","type":"percent","value":0.9},{"name":"2395892","type":"percent","value":0.9},{"name":"2397458","type":"percent","value":0.9},{"name":"2397466","type":"percent","value":0.9},{"name":"2452690","type":"percent","value":0.88},{"name":"2464274","type":"percent","value":0.88},{"name":"2464278","type":"percent","value":0.88},{"name":"2464280","type":"percent","value":0.88},{"name":"2464282","type":"percent","value":0.88},{"name":"2464284","type":"percent","value":0.88},{"name":"2464286","type":"percent","value":0.88},{"name":"2479038","type":"percent","value":0.88},{"name":"2479456","type":"percent","value":0.88},{"name":"2484526","type":"percent","value":0.9},{"name":"2484530","type":"percent","value":0.9},{"name":"2484532","type":"percent","value":0.9},{"name":"2486688","type":"percent","value":0.9},{"name":"2511840","type":"percent","value":0.88},{"name":"2669970","type":"percent","value":0.88},{"name":"2674258","type":"percent","value":0.88},{"name":"2674260","type":"percent","value":0.88},{"name":"2674262","type":"percent","value":0.88},{"name":"2674264","type":"percent","value":0.88},{"name":"2674268","type":"percent","value":0.88},{"name":"2674270","type":"percent","value":0.88},{"name":"2674272","type":"percent","value":0.88},{"name":"2674276","type":"percent","value":0.88},{"name":"2674278","type":"percent","value":0.88},{"name":"2674280","type":"percent","value":0.88},{"name":"2674282","type":"percent","value":0.88},{"name":"2674284","type":"percent","value":0.88},{"name":"2674286","type":"percent","value":0.88},{"name":"2674288","type":"percent","value":0.88},{"name":"2674290","type":"percent","value":0.88},{"name":"2674292","type":"percent","value":0.88},{"name":"2674296","type":"percent","value":0.88},{"name":"2674298","type":"percent","value":0.88},{"name":"2674300","type":"percent","value":0.88},{"name":"2674302","type":"percent","value":0.88},{"name":"2674304","type":"percent","value":0.88},{"name":"2674306","type":"percent","value":0.88},{"name":"2680696","type":"percent","value":0.88},{"name":"2680698","type":"percent","value":0.88},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2756148","type":"flat","value":0.8},{"name":"2749170","type":"percent","value":0.88},{"name":"2811450","type":"percent","value":0.9},{"name":"2811442","type":"percent","value":0.9},{"name":"2823770","type":"percent","value":0.88},{"name":"2825204","type":"percent","value":0.9},{"name":"2824402","type":"percent","value":0.9},{"name":"2837520","type":"percent","value":0.88},{"name":"2837534","type":"percent","value":0.88}]},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":0.98}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rubi_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.99},{"name":"pmp","type":"percent","value":0.99,"deals":[{"name":"829398","type":"percent","value":0.95},{"name":"832174","type":"percent","value":0.97},{"name":"832176","type":"percent","value":0.97},{"name":"855828","type":"percent","value":0.97},{"name":"855824","type":"percent","value":0.97},{"name":"855816","type":"percent","value":0.97},{"name":"855814","type":"percent","value":0.97},{"name":"855812","type":"percent","value":0.97},{"name":"855810","type":"percent","value":0.97},{"name":"855808","type":"percent","value":0.97},{"name":"855806","type":"percent","value":0.97},{"name":"855804","type":"percent","value":0.97},{"name":"855802","type":"percent","value":0.97},{"name":"855800","type":"percent","value":0.97},{"name":"855798","type":"percent","value":0.97},{"name":"855796","type":"percent","value":0.97},{"name":"855794","type":"percent","value":0.97},{"name":"855792","type":"percent","value":0.97},{"name":"855790","type":"percent","value":0.97},{"name":"855788","type":"percent","value":0.97},{"name":"855786","type":"percent","value":0.97},{"name":"855784","type":"percent","value":0.97},{"name":"855782","type":"percent","value":0.97},{"name":"855780","type":"percent","value":0.97},{"name":"855778","type":"percent","value":0.97},{"name":"855776","type":"percent","value":0.97},{"name":"859888","type":"percent","value":0.97},{"name":"944042","type":"percent","value":0.97},{"name":"944044","type":"percent","value":0.97},{"name":"1623876","type":"percent","value":0.88},{"name":"1623874","type":"percent","value":0.88},{"name":"1751444","type":"percent","value":0.88},{"name":"1751662","type":"percent","value":0.88},{"name":"1751448","type":"percent","value":0.88},{"name":"1751664","type":"percent","value":0.88},{"name":"1751450","type":"percent","value":0.88},{"name":"1751666","type":"percent","value":0.88},{"name":"1751452","type":"percent","value":0.88},{"name":"1751668","type":"percent","value":0.88},{"name":"1751454","type":"percent","value":0.88},{"name":"1751670","type":"percent","value":0.88},{"name":"1751456","type":"percent","value":0.88},{"name":"1751672","type":"percent","value":0.88},{"name":"1751474","type":"percent","value":0.88},{"name":"1751674","type":"percent","value":0.88},{"name":"1751472","type":"percent","value":0.88},{"name":"1751676","type":"percent","value":0.88},{"name":"1751476","type":"percent","value":0.88},{"name":"1751678","type":"percent","value":0.88},{"name":"1751478","type":"percent","value":0.88},{"name":"1751680","type":"percent","value":0.88},{"name":"1751480","type":"percent","value":0.88},{"name":"1751682","type":"percent","value":0.88},{"name":"1751482","type":"percent","value":0.88},{"name":"1751684","type":"percent","value":0.88},{"name":"1792390","type":"percent","value":0.88},{"name":"1751632","type":"percent","value":0.88},{"name":"1751686","type":"percent","value":0.88},{"name":"1751634","type":"percent","value":0.88},{"name":"1751688","type":"percent","value":0.88},{"name":"1751636","type":"percent","value":0.88},{"name":"1751690","type":"percent","value":0.88},{"name":"1751638","type":"percent","value":0.88},{"name":"1751692","type":"percent","value":0.88},{"name":"1751640","type":"percent","value":0.88},{"name":"1751694","type":"percent","value":0.88},{"name":"1751642","type":"percent","value":0.88},{"name":"1751696","type":"percent","value":0.88},{"name":"1751644","type":"percent","value":0.88},{"name":"1751698","type":"percent","value":0.88},{"name":"1751646","type":"percent","value":0.88},{"name":"1751700","type":"percent","value":0.88},{"name":"1751648","type":"percent","value":0.88},{"name":"1751702","type":"percent","value":0.88},{"name":"1751650","type":"percent","value":0.88},{"name":"1751706","type":"percent","value":0.88},{"name":"1751652","type":"percent","value":0.88},{"name":"1751708","type":"percent","value":0.88},{"name":"1751654","type":"percent","value":0.88},{"name":"1751710","type":"percent","value":0.88},{"name":"1751656","type":"percent","value":0.88},{"name":"1751712","type":"percent","value":0.88},{"name":"1751660","type":"percent","value":0.88},{"name":"1751714","type":"percent","value":0.88},{"name":"1751440","type":"percent","value":0.88},{"name":"1751716","type":"percent","value":0.88},{"name":"1751442","type":"percent","value":0.88},{"name":"1751718","type":"percent","value":0.88},{"name":"1917132","type":"percent","value":0.88},{"name":"1917134","type":"percent","value":0.88},{"name":"1917136","type":"percent","value":0.88},{"name":"1917138","type":"percent","value":0.88},{"name":"1950020","type":"percent","value":0.88},{"name":"1950010","type":"percent","value":0.88},{"name":"2003192","type":"percent","value":0.88},{"name":"2003190","type":"percent","value":0.88},{"name":"2003188","type":"percent","value":0.88},{"name":"2003186","type":"percent","value":0.88},{"name":"2032118","type":"percent","value":0.88},{"name":"1921898","type":"percent","value":0.9},{"name":"1921906","type":"percent","value":0.9},{"name":"1791050","type":"percent","value":0.9},{"name":"1791052","type":"percent","value":0.9},{"name":"1791054","type":"percent","value":0.9},{"name":"1130970","type":"percent","value":0.9},{"name":"1130968","type":"percent","value":0.9},{"name":"1130976","type":"percent","value":0.9},{"name":"1130978","type":"percent","value":0.9},{"name":"1883728","type":"percent","value":0.9},{"name":"1921048","type":"percent","value":0.9},{"name":"1883726","type":"percent","value":0.9},{"name":"1883724","type":"percent","value":0.9},{"name":"1917142","type":"percent","value":0.9},{"name":"1915930","type":"percent","value":0.9},{"name":"1917130","type":"percent","value":0.9},{"name":"1915928","type":"percent","value":0.9},{"name":"1917128","type":"percent","value":0.9},{"name":"1915534","type":"percent","value":0.9},{"name":"1917126","type":"percent","value":0.9},{"name":"1915136","type":"percent","value":0.9},{"name":"1917124","type":"percent","value":0.9},{"name":"1915132","type":"percent","value":0.9},{"name":"1917144","type":"percent","value":0.9},{"name":"1916326","type":"percent","value":0.9},{"name":"1917122","type":"percent","value":0.9},{"name":"1914770","type":"percent","value":0.9},{"name":"1917120","type":"percent","value":0.9},{"name":"1913794","type":"percent","value":0.9},{"name":"1917116","type":"percent","value":0.9},{"name":"1910078","type":"percent","value":0.9},{"name":"1916722","type":"percent","value":0.9},{"name":"1909612","type":"percent","value":0.9},{"name":"2040506","type":"percent","value":0.9},{"name":"2076190","type":"percent","value":0.9},{"name":"2100546","type":"percent","value":0.9},{"name":"2091612","type":"percent","value":0.9},{"name":"2092510","type":"percent","value":0.9},{"name":"2127668","type":"percent","value":0.9},{"name":"2127670","type":"percent","value":0.9},{"name":"2212648","type":"percent","value":0.9},{"name":"2212644","type":"percent","value":0.9},{"name":"2256280","type":"percent","value":0.9},{"name":"2256286","type":"percent","value":0.9},{"name":"2256288","type":"percent","value":0.9},{"name":"2256292","type":"percent","value":0.9},{"name":"2331334","type":"percent","value":0.88},{"name":"2339448","type":"percent","value":0.9},{"name":"2394816","type":"percent","value":0.9},{"name":"2394818","type":"percent","value":0.9},{"name":"2356286","type":"percent","value":0.9},{"name":"2395892","type":"percent","value":0.9},{"name":"2397458","type":"percent","value":0.9},{"name":"2397466","type":"percent","value":0.9},{"name":"2452690","type":"percent","value":0.88},{"name":"2464274","type":"percent","value":0.88},{"name":"2464278","type":"percent","value":0.88},{"name":"2464280","type":"percent","value":0.88},{"name":"2464282","type":"percent","value":0.88},{"name":"2464284","type":"percent","value":0.88},{"name":"2464286","type":"percent","value":0.88},{"name":"2479038","type":"percent","value":0.88},{"name":"2479456","type":"percent","value":0.88},{"name":"2484526","type":"percent","value":0.9},{"name":"2484530","type":"percent","value":0.9},{"name":"2484532","type":"percent","value":0.9},{"name":"2486688","type":"percent","value":0.9},{"name":"2511840","type":"percent","value":0.88},{"name":"2669970","type":"percent","value":0.88},{"name":"2674258","type":"percent","value":0.88},{"name":"2674260","type":"percent","value":0.88},{"name":"2674262","type":"percent","value":0.88},{"name":"2674264","type":"percent","value":0.88},{"name":"2674268","type":"percent","value":0.88},{"name":"2674270","type":"percent","value":0.88},{"name":"2674272","type":"percent","value":0.88},{"name":"2674276","type":"percent","value":0.88},{"name":"2674278","type":"percent","value":0.88},{"name":"2674280","type":"percent","value":0.88},{"name":"2674282","type":"percent","value":0.88},{"name":"2674284","type":"percent","value":0.88},{"name":"2674286","type":"percent","value":0.88},{"name":"2674288","type":"percent","value":0.88},{"name":"2674290","type":"percent","value":0.88},{"name":"2674292","type":"percent","value":0.88},{"name":"2674296","type":"percent","value":0.88},{"name":"2674298","type":"percent","value":0.88},{"name":"2674300","type":"percent","value":0.88},{"name":"2674302","type":"percent","value":0.88},{"name":"2674304","type":"percent","value":0.88},{"name":"2674306","type":"percent","value":0.88},{"name":"2680696","type":"percent","value":0.88},{"name":"2680698","type":"percent","value":0.88},{"name":"2734898","type":"percent","value":0.9},{"name":"2734902","type":"percent","value":0.9},{"name":"2734904","type":"percent","value":0.9},{"name":"2734908","type":"percent","value":0.9},{"name":"2734910","type":"percent","value":0.9},{"name":"2734914","type":"percent","value":0.9},{"name":"2734918","type":"percent","value":0.9},{"name":"2734920","type":"percent","value":0.9},{"name":"2734922","type":"percent","value":0.9},{"name":"2734942","type":"percent","value":0.9},{"name":"2734944","type":"percent","value":0.9},{"name":"2734946","type":"percent","value":0.9},{"name":"2734948","type":"percent","value":0.9},{"name":"2734950","type":"percent","value":0.9},{"name":"2734952","type":"percent","value":0.9},{"name":"2734954","type":"percent","value":0.9},{"name":"2734956","type":"percent","value":0.9},{"name":"2734958","type":"percent","value":0.9},{"name":"2734924","type":"percent","value":0.9},{"name":"2734926","type":"percent","value":0.9},{"name":"2734928","type":"percent","value":0.9},{"name":"2734930","type":"percent","value":0.9},{"name":"2734932","type":"percent","value":0.9},{"name":"2734934","type":"percent","value":0.9},{"name":"2734936","type":"percent","value":0.9},{"name":"2734938","type":"percent","value":0.9},{"name":"2734940","type":"percent","value":0.9},{"name":"2734960","type":"percent","value":0.9},{"name":"2734962","type":"percent","value":0.9},{"name":"2734964","type":"percent","value":0.9},{"name":"2734966","type":"percent","value":0.9},{"name":"2734968","type":"percent","value":0.9},{"name":"2734970","type":"percent","value":0.9},{"name":"2734972","type":"percent","value":0.9},{"name":"2734974","type":"percent","value":0.9},{"name":"2734976","type":"percent","value":0.9},{"name":"2756148","type":"flat","value":0.8},{"name":"2749170","type":"percent","value":0.88},{"name":"2811450","type":"percent","value":0.9},{"name":"2811442","type":"percent","value":0.9},{"name":"2823770","type":"percent","value":0.88},{"name":"2825204","type":"percent","value":0.9},{"name":"2824402","type":"percent","value":0.9},{"name":"2837520","type":"percent","value":0.88},{"name":"2837534","type":"percent","value":0.88}]},{"name":"stickyOutstream","type":"percent","value":0.6},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"rubicon","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.7},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"sharethrough","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.98}],"s2s":[],"bidder_name":"teads","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.93},{"name":"outstream","type":"percent","value":0.65},{"name":"stickyOutstream","type":"percent","value":0.55},{"name":"instream","type":"percent","value":0.8}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"tripl_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.988},{"name":"outstream","type":"percent","value":0.65},{"name":"stickyOutstream","type":"percent","value":0.71},{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"triplelift","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.91},{"name":"pmp","type":"percent","value":0.91},{"name":"stickyOutstream","type":"percent","value":0.65},{"name":"instream","type":"percent","value":0.984}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"ttd","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"instream","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"under_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"undertone","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"outstream","type":"percent","value":0.64},{"name":"instream","type":"percent","value":0.38}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"unruly","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.94},{"name":"stickyOutstream","type":"percent","value":0.61},{"name":"instream","type":"percent","value":0.99}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yah_ss","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":0.75},{"name":"stickyOutstream","type":"percent","value":0.54},{"name":"instream","type":"percent","value":0.77}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yahoossp","enabled":true},{"secondary":false,"show":true,"cpm":[{"name":"default","type":"percent","value":1},{"name":"stickyOutstream","type":"percent","value":0.85},{"name":"instream","type":"percent","value":0.956}],"s2s":[{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"display"},{"s2s_value":0,"endpoint_value":null,"endpoint":null,"media_type":"video"}],"bidder_name":"yieldmo","enabled":true}],"liveIntent":[{"bidder":"concert","month":4,"day":30,"multiplier":99.57345351417084,"browser":"Not Chrome"},{"bidder":"pubmatic","month":4,"day":30,"multiplier":98.21925549915888,"browser":"Not Chrome"},{"bidder":"rubi_ss","month":4,"day":30,"multiplier":98.54407912971237,"browser":"Not Chrome"},{"bidder":"rubicon","month":4,"day":30,"multiplier":98.12137331528997,"browser":"Not Chrome"},{"bidder":"criteo","month":4,"day":30,"multiplier":98.3986813638684,"browser":"Not Chrome"},{"bidder":"grid","month":4,"day":30,"multiplier":98.4573670095401,"browser":"Not Chrome"},{"bidder":"tripl_ss","month":4,"day":30,"multiplier":98.7151230831726,"browser":"Not Chrome"},{"bidder":"triplelift","month":4,"day":30,"multiplier":98.96955807270263,"browser":"Not Chrome"},{"bidder":"yah_ss","month":4,"day":30,"multiplier":99.6560242684858,"browser":"Not Chrome"},{"bidder":"pubm_ss","month":4,"day":30,"multiplier":98.25008117791842,"browser":"Not Chrome"},{"bidder":"yieldmo","month":4,"day":30,"multiplier":99.15780296551068,"browser":"Not Chrome"},{"bidder":"ix","month":4,"day":30,"multiplier":98.21026986855675,"browser":"Not Chrome"},{"bidder":"onetag","month":4,"day":30,"multiplier":97.64812628545141,"browser":"Not Chrome"},{"bidder":"trustx","month":4,"day":30,"multiplier":97.27726832697316,"browser":"Chrome"},{"bidder":"pubmatic","month":4,"day":30,"multiplier":99.38344105978452,"browser":"Chrome"},{"bidder":"rtbhouse","month":4,"day":30,"multiplier":99.77275021808825,"browser":"Chrome"},{"bidder":"tripl_ss","month":4,"day":30,"multiplier":99.5965597914787,"browser":"Chrome"},{"bidder":"triplelift","month":4,"day":30,"multiplier":99.6841442008026,"browser":"Chrome"},{"bidder":"yieldmo","month":4,"day":30,"multiplier":99.71123901892388,"browser":"Chrome"},{"bidder":"adform","month":4,"day":30,"multiplier":99.95296002073351,"browser":"Not Chrome"},{"bidder":"ttd","month":4,"day":30,"multiplier":99.96172763027421,"browser":"Chrome"},{"bidder":"under_ss","month":4,"day":30,"multiplier":99.91633930289879,"browser":"Chrome"},{"bidder":"rubi_ss","month":4,"day":30,"multiplier":99.77302629441981,"browser":"Chrome"},{"bidder":"rubicon","month":4,"day":30,"multiplier":99.30455235093373,"browser":"Chrome"},{"bidder":"onetag","month":4,"day":30,"multiplier":99.82561991746049,"browser":"Chrome"},{"bidder":"openx","month":4,"day":30,"multiplier":99.59458855590114,"browser":"Chrome"},{"bidder":"pubm_ss","month":4,"day":30,"multiplier":99.26849482444759,"browser":"Chrome"},{"bidder":"adform","month":4,"day":30,"multiplier":99.46785528880346,"browser":"Chrome"},{"bidder":"ix","month":4,"day":30,"multiplier":99.4756884205057,"browser":"Chrome"},{"bidder":"concert","month":4,"day":30,"multiplier":98.50912984396022,"browser":"Chrome"},{"bidder":"criteo","month":4,"day":30,"multiplier":99.84853590541148,"browser":"Chrome"},{"bidder":"grid","month":4,"day":30,"multiplier":99.50931050639886,"browser":"Chrome"},{"bidder":"gridvid","month":4,"day":30,"multiplier":99.74598570139105,"browser":"Chrome"},{"bidder":"krgo_ss","month":4,"day":30,"multiplier":99.95054265016002,"browser":"Chrome"},{"bidder":"nativo","month":4,"day":30,"multiplier":99.76919447180883,"browser":"Chrome"}],"predictiveAnalysis":[{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubicon","domain":"madewithnestle.ca","mobile":"0","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"madewithnestle.ca","bidder":"openx","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubi_ss","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"thrivent.com","bidder":"rubi_ss","domain":"thrivent.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubicon","domain":"madewithnestle.ca","mobile":"0","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubicon","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"openx","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"rubi_ss","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubi_ss","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"rubicon","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"nestle.fr","bidder":"criteo","domain":"nestle.fr","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"thrivent.com","bidder":"rubi_ss","domain":"thrivent.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"0","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubicon","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"thrivent.com","bidder":"rubicon","domain":"thrivent.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"ix","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"openx","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"0","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"ix","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"thrivent.com","bidder":"rubicon","domain":"thrivent.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"madewithnestle.ca","bidder":"rubi_ss","domain":"madewithnestle.ca","mobile":"0","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"0","adomain":"onehundredmiles.org","bidder":"rubicon","domain":"onehundredmiles.org","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"1.0","chrome":"1","adomain":"nestle.fr","bidder":"criteo","domain":"nestle.fr","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9999588002636783","chrome":"0","adomain":"madewithnestle.ca","bidder":"openx","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9999522786924362","chrome":"0","adomain":"goodnites.com","bidder":"kargo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9999305941143809","chrome":"0","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9999183340138832","chrome":"0","adomain":"goodnites.com","bidder":"kargo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9999124343257443","chrome":"0","adomain":"madewithnestle.ca","bidder":"sharethrough","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9998747651847214","chrome":"0","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9998441153546376","chrome":"0","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.99984","chrome":"0","adomain":"madewithnestle.ca","bidder":"openx","domain":"madewithnestle.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9998387096774194","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9998339146321209","chrome":"1","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9998332777592531","chrome":"1","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9998257536156124","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9998128041931861","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9998091420937112","chrome":"0","adomain":"goodnites.com","bidder":"kargo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9998079139454475","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9997896655682535","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9996734160679295","chrome":"0","adomain":"goodnites.com","bidder":"kargo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9993885661877102","chrome":"1","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.99930301446245","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9992960450531166","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9992849481587415","chrome":"1","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9992292060822647","chrome":"0","adomain":"goodnites.com","bidder":"criteo","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9990927009354567","chrome":"1","adomain":"bexsero.ca","bidder":"gridvid","domain":"bexsero.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.999041895305287","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9989364364364365","chrome":"1","adomain":"bexsero.ca","bidder":"gridvid","domain":"bexsero.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9989197947610046","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9987778796211427","chrome":"1","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9986912176189187","chrome":"1","adomain":"bexsero.ca","bidder":"gridvid","domain":"bexsero.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.998570918185066","chrome":"1","adomain":"lesschwab.com","bidder":"triplelift","domain":"lesschwab.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9985153192063706","chrome":"1","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9984659116545594","chrome":"1","adomain":"bexsero.ca","bidder":"gridvid","domain":"bexsero.ca","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.998332822973019","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9982034758836165","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9981799935364256","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.99812382739212","chrome":"1","adomain":"twitch.tv","bidder":"criteo","domain":"twitch.tv","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9980865354576695","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9979259259259259","chrome":"1","adomain":"twitch.tv","bidder":"criteo","domain":"twitch.tv","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9974860590547582","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9974554707379135","chrome":"1","adomain":"twitch.tv","bidder":"criteo","domain":"twitch.tv","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.997230777925344","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9971872686898594","chrome":"1","adomain":"twitch.tv","bidder":"criteo","domain":"twitch.tv","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.997156916347731","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.997097678142514","chrome":"0","adomain":"geico.com","bidder":"rubi_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9969772303519973","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9968482356971565","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9967983991995998","chrome":"0","adomain":"geico.com","bidder":"rubi_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9966433758049048","chrome":"0","adomain":"geico.com","bidder":"tripl_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9955569174199479","chrome":"0","adomain":"geico.com","bidder":"rubi_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9950995405819295","chrome":"0","adomain":"geico.com","bidder":"rubi_ss","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9950288646568313","chrome":"0","adomain":"gsk.com","bidder":"sharethrough","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.994674454561072","chrome":"0","adomain":"gsk.com","bidder":"sharethrough","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9932428281835494","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9926522614706362","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9925410469823077","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9908471093677034","chrome":"1","adomain":"honda.com","bidder":"kargo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9906326364376866","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9900456919060052","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9892497582617599","chrome":"1","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9890122211010203","chrome":"0","adomain":"goodnites.com","bidder":"gridvid","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9890035906642729","chrome":"0","adomain":"goodnites.com","bidder":"gridvid","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9885042950985347","chrome":"1","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9882370026139994","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9875478147635712","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9872282195529877","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.98702025288128","chrome":"0","adomain":"goodnites.com","bidder":"gridvid","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.987010078387458","chrome":"0","adomain":"goodnites.com","bidder":"gridvid","domain":"goodnites.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9868853262734716","chrome":"0","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9868002544529262","chrome":"0","adomain":"gsk.com","bidder":"sharethrough","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9859673337934207","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.985867529371701","chrome":"0","adomain":"gsk.com","bidder":"sharethrough","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9858146446906242","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9856332032635686","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9851441520835956","chrome":"1","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9842123525329632","chrome":"1","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9834134140722701","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9824641833810889","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9822238681603556","chrome":"1","adomain":"honda.com","bidder":"kargo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9817302119295416","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9803280536610112","chrome":"1","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9801175971388737","chrome":"0","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9796235537903644","chrome":"1","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9778959897009886","chrome":"0","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9766073478760046","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9763126082268762","chrome":"0","adomain":"gsk.com","bidder":"gridvid","domain":"gsk.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9715034965034965","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9693733110281817","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9691821822235066","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.968729470503219","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9676346037507562","chrome":"0","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.966966657742447","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9657692307692308","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9650523560209424","chrome":"1","adomain":"honda.com","bidder":"criteo","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9619511225909001","chrome":"1","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9611201563008792","chrome":"1","adomain":"kohls.com","bidder":"gridvid","domain":"kohls.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9552256710151447","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9551664611590629","chrome":"1","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9520564323290291","chrome":"1","adomain":"geico.com","bidder":"kargo","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9507537688442211","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9466722361459203","chrome":"1","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9464955368932552","chrome":"1","adomain":"geico.com","bidder":"sharethrough","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9461697722567288","chrome":"0","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9373405941959054","chrome":"1","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9373365414792342","chrome":"1","adomain":"geico.com","bidder":"sharethrough","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9330636263332107","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9296165550821668","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9253335298887005","chrome":"1","adomain":"geico.com","bidder":"sharethrough","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9128853984874927","chrome":"1","adomain":"geico.com","bidder":"sharethrough","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.906246253446829","chrome":"0","adomain":"goodnes.com","bidder":"rubicon","domain":"goodnes.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9050914952119086","chrome":"0","adomain":"geico.com","bidder":"triplelift","domain":"geico.com","mobile":"1","report_date":"2024-04-30"},{"error_rate":"0.9008312958435207","chrome":"0","adomain":"honda.com","bidder":"gridvid","domain":"honda.com","mobile":"0","report_date":"2024-04-30"},{"error_rate":"0.9002462380300957","chrome":"0","adomain":"odfl.com","bidder":"triplelift","domain":"odfl.com","mobile":"0","report_date":"2024-04-30"}],"country":"CA","region":"BC","coreExperiments":[{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"cmcmp","key":"ConsentManagerCMP"},{"variants":[{"weight":0,"value":"b"},{"weight":100,"value":"w"},{"weight":0,"value":"g25"}],"type":"weightedChoice","abgroup":"tcmb2","key":"TopCenterMobileBackground"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"rvps","key":"ReducedVideoPlayerSize"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"plfx","key":"PlaylistFix"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"lle","key":"LibLoadedEvent"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"delload","key":"EnableDelayLoading"},{"variants":[{"weight":99.5}],"type":"bernoulliTrial","abgroup":"amzn","key":"Amazon"},{"variants":[{"weight":25,"value":1.5},{"weight":25,"value":2},{"weight":25,"value":3},{"weight":25,"value":4}],"type":"weightedChoice","abgroup":"fto","key":"FloorBootstrap"},{"variants":[{"weight":25,"value":1.5},{"weight":25,"value":2},{"weight":25,"value":3},{"weight":25,"value":4}],"type":"weightedChoice","abgroup":"mto","key":"MarmaladeBootstrap"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"owso","key":"OutstreamWithSOExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"pbm","key":"Playbackmethod"},{"variants":[{"weight":98,"value":30},{"weight":2,"value":15},{"weight":0,"value":10}],"type":"weightedChoice","abgroup":"vmaxdur","key":"VideoDuration"},{"variants":[{"weight":0,"value":"all"},{"weight":100,"value":"adx"},{"weight":0,"value":"off"}],"type":"weightedChoice","abgroup":"inters","key":"Interstitial"},{"variants":[{"weight":0,"value":"all"},{"weight":90,"value":"adx"},{"weight":10,"value":"off"}],"type":"weightedChoice","abgroup":"inters5","key":"InterstitialAlt"},{"variants":[{"weight":20,"value":750},{"weight":20,"value":500},{"weight":20,"value":250},{"weight":20,"value":175},{"weight":20,"value":100}],"type":"weightedChoice","abgroup":"ato","key":"AmazonTimeout"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"magnitedr","key":"Rubicon"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"opnxdr","key":"OpenX"},{"variants":[{"weight":0,"value":"both"},{"weight":98,"value":"client"},{"weight":2,"value":"server"}],"type":"weightedChoice","abgroup":"krgodr","key":"Kargo"},{"variants":[{"weight":0,"value":"both"},{"weight":2,"value":"client"},{"weight":98,"value":"server"}],"type":"weightedChoice","abgroup":"krgodrvid","key":"KargoVideo"},{"variants":[{"weight":99,"value":"none"},{"weight":1,"value":"roxot"}],"type":"weightedChoice","abgroup":"pba","key":"Analytics"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"tripleliftdr","key":"Triplelift"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"yahoodr","key":"YahooSSP"},{"variants":[{"weight":98,"value":"both"},{"weight":1,"value":"client"},{"weight":1,"value":"server"}],"type":"weightedChoice","abgroup":"yahoodr1","key":"YahooSSP1"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"logfltr","key":"LoggerFilter"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rpm","key":"RaptivePlayerMobile"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rpd","key":"RaptivePlayerDesktop"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"fldg","key":"FledgeGPT"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"fldglog","key":"FledgeLogging"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"aed","key":"ContentAdExpansion"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"aed1","key":"AdExpansion"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"essa","key":"EnhancedStickySidebarAds"},{"variants":[{"weight":40,"value":50},{"weight":20,"value":1000},{"weight":20,"value":3000},{"weight":20,"value":5000}],"type":"weightedChoice","abgroup":"deftimer3","key":"DelayLoading"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"wvtls","key":"WebVitals"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"wvtlscls","key":"WebVitals_CLSRefactor"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"loglevel","key":"ImpressionLogLegacy"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"loglevel_1","key":"ImpressionLog1"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"loglev","key":"ImpressionLog"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"sens_off","key":"SensOff"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rtbf","key":"RtbHouseExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sab","key":"BidLimit"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"dgc","key":"DelayGamCall"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"jwb","key":"JwBoost"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"logcls","key":"LayoutShift"},{"variants":[{"weight":60,"value":2},{"weight":10,"value":1.25},{"weight":10,"value":1},{"weight":10,"value":0.75},{"weight":10,"value":0.5}],"type":"weightedChoice","abgroup":"lzcvp","key":"ContentMargin"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"confiant","key":"ConfiantProperty"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"confiant1","key":"ConfiantRefresh"},{"variants":[{"weight":40,"value":5000,"abvalue":"5s"},{"weight":40,"value":10000,"abvalue":"10s"},{"weight":20,"value":15000,"abvalue":"15s"}],"type":"weightedChoice","abgroup":"vast_to","key":"VastTimeout"},{"variants":[{"weight":60,"value":15000,"abvalue":"15s"},{"weight":20,"value":18000,"abvalue":"18s"},{"weight":20,"value":20000,"abvalue":"20s"}],"type":"weightedChoice","abgroup":"vasttoisv","key":"VastTimeoutISV"},{"variants":[{"weight":80,"value":3000,"abvalue":"3s"},{"weight":10,"value":2000,"abvalue":"2s"},{"weight":10,"value":1000,"abvalue":"1s"}],"type":"weightedChoice","abgroup":"vasttoosv","key":"VastTimeoutOSV"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sre","key":"SlotResize"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"addens","key":"AdDensity"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"bmetrics","key":"BrandMetrics"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"rebuildslot","key":"RefreshRebuild"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"nlsentrckr","key":"NielsenTracker"},{"variants":[{"weight":0,"value":4},{"weight":0,"value":5},{"weight":100,"value":6},{"weight":0,"value":7}],"type":"weightedChoice","abgroup":"mxrpog","key":"MaxRequests"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rptv","key":"ComscoreFooterRebrand"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"vadv","key":"AdvancePlaylistExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"cnfep","key":"ConfiantEndpoint"},{"variants":[{"weight":95}],"type":"bernoulliTrial","abgroup":"tpcapi","key":"TopicsAPI"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"crtvmon","key":"CreativeMonitoring"},{"variants":[{"weight":25,"value":"1.00"},{"weight":25,"value":"1.50"},{"weight":25,"value":"2.00"},{"weight":25,"value":"2.50"}],"type":"weightedChoice","abgroup":"faf","key":"FasterAdsFloors"},{"variants":[{"weight":0,"value":"rubi"},{"weight":1,"value":"rapml"},{"weight":0,"value":"cm"},{"weight":0,"value":"fbmag"},{"weight":98,"value":"fbrap"},{"weight":1,"value":"none"}],"type":"weightedChoice","abgroup":"flrml1","key":"Floors"},{"variants":[{"weight":5,"value":"on"},{"weight":95,"value":"off"}],"type":"weightedChoice","abgroup":"pbsflr","key":"PBSFloor"},{"variants":[{"weight":5,"value":"on"},{"weight":95,"value":"off"}],"type":"weightedChoice","abgroup":"pbsflr1","key":"PBSFloor1"},{"variants":[{"weight":19,"value":"1_1"},{"weight":19,"value":"1_2"},{"weight":19,"value":"1_3"},{"weight":19,"value":"1_4"},{"weight":19,"value":"1_5"},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"ttddealflr","key":"TTDDealFloor"},{"variants":[{"weight":100,"value":"both"},{"weight":0,"value":"client"},{"weight":0,"value":"server"}],"type":"weightedChoice","abgroup":"coldr","key":"ColossusExperiment"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"amzn_hold_load","key":"AmazonHoldLoad"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"rmos1","key":"OneVideoStream"},{"variants":[{"weight":0,"value":"sovpcc"},{"weight":0,"value":"sovpct1"},{"weight":100,"value":"sovpct2"}],"type":"weightedChoice","abgroup":"socbe","key":"StickyCloseButton"},{"variants":[{"weight":5,"value":900000,"abvalue":"900"},{"weight":5,"value":600000,"abvalue":"600"},{"weight":5,"value":300000,"abvalue":"300"},{"weight":5,"value":-1,"abvalue":"tdoc"},{"weight":80,"value":0}],"type":"weightedChoice","abgroup":"mgtdtw","key":"TearDownPlayer"},{"variants":[{"weight":40,"value":0.75},{"weight":20,"value":0.25},{"weight":20,"value":0.125},{"weight":20,"value":0}],"type":"weightedChoice","abgroup":"lzbpvp","key":"BelowPostMargin"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"amzn_hold_disp","key":"AmazonHoldDisplay"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"dajto","key":"DisableAjaxTimeout"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"smad300","key":"RemoveLargeSidebar"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rvadv_ab1","key":"AdvancePlaylistRelated"},{"variants":[{"weight":5,"value":6000,"abvalue":"6s"},{"weight":75,"value":4000,"abvalue":"4s"},{"weight":15,"value":2000,"abvalue":"2s"},{"weight":5,"value":0,"abvalue":"0s"}],"type":"weightedChoice","abgroup":"cbt","key":"CloseButtonTimeout"},{"variants":[{"weight":20,"value":10000,"abvalue":"10"},{"weight":60,"value":15000,"abvalue":"15"},{"weight":20,"value":20000,"abvalue":"20"}],"type":"weightedChoice","abgroup":"reqTo","key":"JwRequestTimeout"},{"variants":[{"weight":3}],"type":"bernoulliTrial","abgroup":"addur","key":"LogAdDuration"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"lzhb","key":"LZHB"},{"variants":[{"weight":0,"value":0,"abvalue":"off"},{"weight":0,"value":0.4,"abvalue":"40"},{"weight":0,"value":0.5,"abvalue":"50"},{"weight":100,"value":0.6,"abvalue":"60"},{"weight":0,"value":0.7,"abvalue":"70"}],"type":"weightedChoice","abgroup":"lzflr","key":"LazyLoadFloors"},{"variants":[{"weight":0,"value":0},{"weight":0,"value":1},{"weight":100,"value":2},{"weight":0,"value":3}],"type":"weightedChoice","abgroup":"bpto","key":"BidPoolingTimeoutExperiment"},{"variants":[{"weight":20,"value":"0_0"},{"weight":20,"value":"off"},{"weight":20,"value":"10_10"},{"weight":20,"value":"20_20"},{"weight":20,"value":"30_30"}],"type":"weightedChoice","abgroup":"upro3","key":"UPROExperiment"},{"variants":[{"weight":20,"value":"0_0"},{"weight":20,"value":"02_02"},{"weight":20,"value":"05_05"},{"weight":20,"value":"005_005"},{"weight":20,"value":"off"}],"type":"weightedChoice","abgroup":"upro2","key":"UPROExperiment2"},{"variants":[{"weight":99.5,"value":"ix"},{"weight":96,"value":"mn"},{"weight":99,"value":"ox"},{"weight":95,"value":"pu"},{"weight":90,"value":"un"},{"weight":90,"value":"ma"},{"weight":90,"value":"sh"},{"weight":90,"value":"st"},{"weight":99,"value":"sb"},{"weight":75,"value":"sv"},{"weight":99,"value":"tl"},{"weight":0,"value":"yh"},{"weight":99,"value":"mg"},{"weight":99,"value":"xr"},{"weight":75,"value":"ot"},{"weight":100,"value":"ax"},{"weight":100,"value":"ch"},{"weight":100,"value":"cr"},{"weight":100,"value":"gg"},{"weight":100,"value":"kg"},{"weight":100,"value":"td"},{"weight":90,"value":"ym"}],"type":"multivalueBernoulliTrial","abgroup":"doba","key":"DisplayOpenBidderExperiment"},{"variants":[{"weight":100,"value":"ax"},{"weight":95,"value":"ix"},{"weight":90,"value":"mn"},{"weight":95,"value":"ox"},{"weight":95,"value":"pu"},{"weight":95,"value":"un"},{"weight":95,"value":"ma"},{"weight":100,"value":"sx"},{"weight":90,"value":"tl"},{"weight":99,"value":"yh"},{"weight":90,"value":"sh"},{"weight":55,"value":"ym"},{"weight":99,"value":"mg"},{"weight":99,"value":"xr"},{"weight":95,"value":"gg"},{"weight":75,"value":"ot"},{"weight":75,"value":"sv"}],"type":"multivalueBernoulliTrial","abgroup":"voba","key":"VideoOpenBidderExperiment"},{"variants":[{"weight":100,"value":2},{"weight":0,"value":3},{"weight":0,"value":0}],"type":"weightedChoice","abgroup":"osp","key":"OutstreamPlacementExperiment"},{"variants":[{"weight":25,"value":0.8},{"weight":25,"value":1},{"weight":25,"value":1.2},{"weight":25,"value":1.4}],"type":"weightedChoice","abgroup":"flrmltp","key":"SingleFloorMultiplier"},{"variants":[{"weight":80}],"type":"bernoulliTrial","abgroup":"optd","key":"OptimalDisplayBidders"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"mgncrbn","key":"MagniteCarbon"},{"variants":[{"weight":80}],"type":"bernoulliTrial","abgroup":"optv","key":"OptimalVideoBidders"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"adlifecyc","key":"LogAdLifeCycle"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"fan","key":"FooterAnchorAd"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"nosvp","key":"OutstreamRendererExperiment"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sppe50","key":"StickyPlayerPosition"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sospp","key":"StickyOutstreamOnStickyPlayerPages"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"dlsops","key":"StickyOutstreamPlayerSizeExperiment"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"sidp","key":"SharedIdPlugin"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"dofre","key":"DisplayBackupRenderer"},{"variants":[{"weight":100,"value":"tlo"}],"type":"weightedChoice","abgroup":"sicb","key":"StickyInstreamCloseButton"},{"variants":[{"weight":0,"value":"strict"},{"weight":100,"value":"relaxed"},{"weight":0,"value":"off"}],"type":"weightedChoice","abgroup":"dco","key":"DemandChain"},{"variants":[{"weight":25,"value":100},{"weight":50,"value":200,"abvalue":"off"},{"weight":25,"value":300}],"type":"weightedChoice","abgroup":"s2sbuff","key":"S2SBuffer"},{"variants":[{"weight":85,"value":0},{"weight":5,"value":1},{"weight":5,"value":500},{"weight":5,"value":1000}],"type":"weightedChoice","abgroup":"adt","key":"AuctionDelay"},{"variants":[{"weight":5,"value":1},{"weight":5,"value":250},{"weight":85,"value":500},{"weight":5,"value":750}],"type":"weightedChoice","abgroup":"adt2","key":"AuctionDelay_2"},{"variants":[{"weight":85,"value":0},{"weight":5,"value":1},{"weight":5,"value":500},{"weight":5,"value":1000}],"type":"weightedChoice","abgroup":"adt_alt","key":"AltAuctionDelay"},{"variants":[{"weight":25,"value":"on5"},{"weight":25,"value":"on7"},{"weight":25,"value":"on10"},{"weight":25,"value":"off"}],"type":"weightedChoice","abgroup":"tckscroll","key":"TrackScrollExperiment"},{"variants":[{"weight":10,"value":1},{"weight":30,"value":1.3},{"weight":30,"value":1.1},{"weight":30,"value":1.2}],"type":"weightedChoice","abgroup":"refflr2","key":"FloorsRefresh"},{"variants":[{"weight":97,"value":1},{"weight":1,"value":1.1},{"weight":1,"value":1.2},{"weight":1,"value":1.3}],"type":"weightedChoice","abgroup":"refvidflr","key":"FloorsInstreamRefresh"},{"variants":[{"weight":20,"value":0.1},{"weight":20,"value":0.2},{"weight":20,"value":0.3},{"weight":10,"value":0.4},{"weight":10,"value":0.5},{"weight":10,"value":0.6},{"weight":10,"value":0}],"type":"weightedChoice","abgroup":"sesflrso","key":"SessionFloorStickyOutstreamPercentileExperiment"},{"variants":[{"weight":80,"value":0},{"weight":5,"value":1.1},{"weight":5,"value":1.2},{"weight":5,"value":1.3},{"weight":5,"value":1.4}],"type":"weightedChoice","abgroup":"refsoflr","key":"FloorsStickyOutstreamRefresh"},{"variants":[{"weight":33,"value":0},{"weight":33,"value":1},{"weight":34,"value":1.5}],"type":"weightedChoice","abgroup":"socon","key":"SuppressOutreamSlowConnection"},{"variants":[{"weight":0,"value":10000},{"weight":0,"value":15000},{"weight":0,"value":20000},{"weight":100,"value":25000},{"weight":0,"value":30000}],"type":"weightedChoice","abgroup":"cmpto","key":"CMPTimeout"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"upl","key":"UserPageDataLogging"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"rmosnv1","key":"OneVideoStreamNoVideo"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"aos","key":"AdditionalOutstreamUnitsExperiment"},{"variants":[{"weight":10}],"type":"bernoulliTrial","abgroup":"datapriv","key":"UserPageDataPrivacyLogging"},{"variants":[{"weight":25,"value":500},{"weight":25,"value":1000},{"weight":25,"value":1500},{"weight":25,"value":2000}],"type":"weightedChoice","abgroup":"faite","key":"FasterAdsInitialTimeoutExperiment"},{"variants":[{"weight":10,"value":2000},{"weight":15,"value":2100},{"weight":50,"value":2200},{"weight":15,"value":2300},{"weight":10,"value":2400}],"type":"weightedChoice","abgroup":"ito_df","key":"InitialTimeoutDesktopFastExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_ds","key":"InitialTimeoutDesktopSlowExperiment"},{"variants":[{"weight":10,"value":2400},{"weight":15,"value":2500},{"weight":50,"value":2600},{"weight":15,"value":2700},{"weight":10,"value":2800}],"type":"weightedChoice","abgroup":"ito_dn","key":"InitialTimeoutDesktopUnknownExperiment"},{"variants":[{"weight":10,"value":2400},{"weight":15,"value":2500},{"weight":50,"value":2600},{"weight":15,"value":2700},{"weight":10,"value":2800}],"type":"weightedChoice","abgroup":"ito_mf","key":"InitialTimeoutMobileFastExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_ms","key":"InitialTimeoutMobileSlowExperiment"},{"variants":[{"weight":10,"value":2600},{"weight":15,"value":2700},{"weight":50,"value":2800},{"weight":15,"value":2900},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"ito_mn","key":"InitialTimeoutMobileUnknownExperiment"},{"variants":[{"weight":10,"value":"on"},{"weight":80,"value":"off"},{"weight":10,"value":"vpr"}],"type":"weightedChoice","abgroup":"iroe","key":"InstreamRerequestOnError"},{"variants":[{"weight":10,"value":"on"},{"weight":80,"value":"off"},{"weight":0,"value":"vpr"},{"weight":10,"value":"dbc"}],"type":"weightedChoice","abgroup":"iroe2","key":"InstreamRerequestOnError_2"},{"variants":[{"weight":10,"value":"id5Id"},{"weight":1,"value":"identityLink"},{"weight":1,"value":"pairId"},{"weight":1,"value":"unifiedId"},{"weight":1,"value":"unifiedId2"},{"weight":1,"value":"sharedId"},{"weight":5,"value":"criteo"},{"weight":5,"value":"connectId"},{"weight":5,"value":"fabrickId"},{"weight":95,"value":"FTrackId"},{"weight":5,"value":"33acrossId"},{"weight":1,"value":"liveIntentId"},{"weight":5,"value":"lotamePanoramaId"},{"weight":25,"value":"merkleId"},{"weight":5,"value":"merkuryId"}],"type":"multivalueBernoulliTrial","abgroup":"idho","key":"IDHO"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"idguid2","key":"IdGraphUid2"},{"variants":[{"weight":70}],"type":"bernoulliTrial","abgroup":"idglr","key":"IdGraphLiveRamp"},{"variants":[{"weight":0.5,"value":"ix_ebda"},{"weight":4,"value":"medianet_ebda"},{"weight":10,"value":"openx_ebda"},{"weight":1,"value":"pubmatic_ebda"},{"weight":10,"value":"rhythmone_ebda"},{"weight":6,"value":"rubicon_ebda"},{"weight":10,"value":"sharethrough_ebda"},{"weight":1,"value":"smart_ebda"},{"weight":1,"value":"sonobi_ebda"},{"weight":15,"value":"sovrn_ebda"},{"weight":1,"value":"triplelift_ebda"},{"weight":0,"value":"verizon_ebda"},{"weight":10,"value":"yieldmo_ebda"},{"weight":1,"value":"mediagrid_ebda"},{"weight":1,"value":"xandr_ebda"},{"weight":1,"value":"onetag_ebda"}],"type":"holdout","abgroup":"ebho","key":"EBHO"},{"variants":[{"weight":5,"value":"ix_ebda"},{"weight":10,"value":"medianet_ebda"},{"weight":20,"value":"openx_ebda"},{"weight":5,"value":"pubmatic_ebda"},{"weight":5,"value":"rhythmone_ebda"},{"weight":5,"value":"rubicon_ebda"},{"weight":0,"value":"spotx_ebda"},{"weight":1,"value":"triplelift_ebda"},{"weight":1,"value":"verizon_ebda"},{"weight":10,"value":"sharethrough_ebda"},{"weight":20,"value":"yieldmo_ebda"},{"weight":5,"value":"xandr_ebda"}],"type":"holdout","abgroup":"vebho","key":"VEBHO"},{"variants":[{"weight":1,"value":"aidem"},{"weight":10,"value":"appnexus"},{"weight":25,"value":"colossus"},{"weight":1,"value":"conversant"},{"weight":1,"value":"criteo"},{"weight":20,"value":"gridvid"},{"weight":50,"value":"gumgum"},{"weight":10,"value":"improvedigital"},{"weight":0.5,"value":"ix"},{"weight":1,"value":"openx"},{"weight":1,"value":"pubmatic"},{"weight":100,"value":"resetdigital"},{"weight":15,"value":"roundel"},{"weight":1,"value":"rubicon"},{"weight":1,"value":"sharethrough"},{"weight":1,"value":"triplelift"},{"weight":1,"value":"ttd"},{"weight":1,"value":"unruly"},{"weight":1,"value":"undertone"},{"weight":75,"value":"yahoossp"},{"weight":1,"value":"kargo"},{"weight":100,"value":"33across"},{"weight":10,"value":"onetag"},{"weight":95,"value":"adform"}],"type":"multivalueBernoulliTrial","abgroup":"vbho","key":"VBHO"},{"variants":[{"weight":25,"value":"33across"},{"weight":1,"value":"aidem"},{"weight":1,"value":"appnexus"},{"weight":20,"value":"colossus"},{"weight":10,"value":"conversant"},{"weight":5,"value":"concert"},{"weight":1,"value":"criteo"},{"weight":0.5,"value":"grid"},{"weight":5,"value":"gumgum"},{"weight":1,"value":"kargo"},{"weight":15,"value":"improvedigital"},{"weight":0.5,"value":"ix"},{"weight":1,"value":"nativo"},{"weight":1,"value":"openx"},{"weight":10,"value":"ozone"},{"weight":1,"value":"pubmatic"},{"weight":100,"value":"resetdigital"},{"weight":10,"value":"roundel"},{"weight":15,"value":"rtbhouse"},{"weight":1,"value":"rubicon"},{"weight":50,"value":"sharethrough"},{"weight":1,"value":"teads"},{"weight":0.5,"value":"triplelift"},{"weight":1,"value":"ttd"},{"weight":20,"value":"undertone"},{"weight":1,"value":"unruly"},{"weight":10,"value":"verizon"},{"weight":75,"value":"yahoossp"},{"weight":1,"value":"yieldmo"},{"weight":95,"value":"adform"}],"type":"multivalueBernoulliTrial","abgroup":"hbho","key":"HBHO"},{"variants":[{"weight":50,"value":"animatedFooter"},{"weight":50,"value":"expandableFooter"},{"weight":50,"value":"miniscroller"},{"weight":50,"value":"interscroller"}],"type":"multivalueBernoulliTrial","abgroup":"athmb","key":"AdTypeHoldout"},{"variants":[{"weight":0,"value":"33across"},{"weight":0,"value":"appnexus"},{"weight":0,"value":"colossus"},{"weight":0,"value":"conversant"},{"weight":0,"value":"concert"},{"weight":0,"value":"criteo"},{"weight":0,"value":"grid"},{"weight":0,"value":"gridvid"},{"weight":0,"value":"gumgum"},{"weight":0,"value":"kargo"},{"weight":0,"value":"improvedigital"},{"weight":0,"value":"ix"},{"weight":0,"value":"nativo"},{"weight":0,"value":"openx"},{"weight":0,"value":"pubmatic"},{"weight":0,"value":"resetdigital"},{"weight":0,"value":"roundel"},{"weight":0,"value":"rtbhouse"},{"weight":0,"value":"rubicon"},{"weight":0,"value":"sharethrough"},{"weight":0,"value":"teads"},{"weight":0,"value":"triplelift"},{"weight":0,"value":"ttd"},{"weight":0,"value":"undertone"},{"weight":0,"value":"unruly"},{"weight":0,"value":"verizon"},{"weight":0,"value":"yahoossp"},{"weight":0,"value":"yieldmo"},{"weight":0,"value":"onetag"}],"type":"multivalueBernoulliTrial","abgroup":"allbho","key":"AllBidderHO"},{"variants":[{"weight":25,"value":"amzn"},{"weight":25,"value":"gumgum"},{"weight":25,"value":"kargo"},{"weight":25,"value":"sharethrough"},{"weight":25,"value":"teads"},{"weight":25,"value":"triplelift"},{"weight":25,"value":"undertone"},{"weight":25,"value":"yieldmo"}],"type":"multivalueBernoulliTrial","abgroup":"sfbho","key":"SFBHO"},{"variants":[{"weight":100,"value":"33across"},{"weight":5,"value":"appnexus"},{"weight":100,"value":"conversant"},{"weight":99,"value":"grid"},{"weight":2,"value":"gumgum"},{"weight":100,"value":"improve_ss"},{"weight":1,"value":"openx"},{"weight":100,"value":"pubm_ss"},{"weight":100,"value":"resetdigital"},{"weight":100,"value":"under_ss"},{"weight":100,"value":"unruly"},{"weight":100,"value":"yieldmo"},{"weight":100,"value":"adform"},{"weight":100,"value":"aidem_ss"},{"weight":100,"value":"gridnat"}],"type":"multivalueBernoulliTrial","abgroup":"pbs2s","key":"S2S2"},{"variants":[{"weight":70,"value":1},{"weight":10,"value":2},{"weight":10,"value":3},{"weight":10,"value":4}],"type":"weightedChoice","abgroup":"usynctrig","key":"UserSyncTrigger"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":5},{"weight":25,"value":10},{"weight":25,"value":25}],"type":"weightedChoice","abgroup":"csync_lim","key":"UserSyncLimit"},{"variants":[{"weight":75}],"type":"bernoulliTrial","abgroup":"testCf","key":"TestCloudfrontInvalidation"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rog_2","key":"Optable"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"roghem_2","key":"UseOptableHem"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rogcu","key":"Uid2TokenCleanup"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"spa","key":"SinglePageAppSupport"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"logger","key":"DisableLogger"},{"variants":[{"weight":99}],"type":"bernoulliTrial","abgroup":"s2sparam","key":"OrtbEnrich"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"jtte","key":"JumpToTracker"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"csp","key":"ContentSpecificPlaylists"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"spa_636bb77b4a063e2c3e3686fb","key":"SinglePageAppSupport_636bb77b4a063e2c3e3686fb"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"spa_62a8f1d2540a6e420ab16977","key":"SinglePageAppSupport_62a8f1d2540a6e420ab16977"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_660a2f0855c0e65b7013b0a2a","key":"StickyOutstreamTopCenter_660a2f0855c0e65b7013b0a2a"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_56d7646348ac34b603d08cdd","key":"StickyOutstreamTopCenter_56d7646348ac34b603d08cdd"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_52e41fac28963d1e058a107e","key":"StickyOutstreamTopCenter_52e41fac28963d1e058a107e"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_553542257a55b2e06135e447","key":"StickyOutstreamTopCenter_553542257a55b2e06135e447"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_53237591208f222c05b9a652","key":"StickyOutstreamTopCenter_53237591208f222c05b9a652"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_530961e8208f222c05b9a319","key":"StickyOutstreamTopCenter_530961e8208f222c05b9a319"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_60a7fa14d53602489a3692c6","key":"StickyOutstreamTopCenter_60a7fa14d53602489a3692c6"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_52e41fac28963d1e058a1132","key":"StickyOutstreamTopCenter_52e41fac28963d1e058a1132"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_58c18d1bf051050f829e3c0b","key":"StickyOutstreamTopCenter_58c18d1bf051050f829e3c0b"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5667530f4856897050e3754f","key":"StickyOutstreamTopCenter_5667530f4856897050e3754f"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_55bccc97303edab84afd77e2","key":"StickyOutstreamTopCenter_55bccc97303edab84afd77e2"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5e7dea4b319b6675881fa756","key":"StickyOutstreamTopCenter_5e7dea4b319b6675881fa756"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_54bdb2d6358b65853f5fe5c4","key":"StickyOutstreamTopCenter_54bdb2d6358b65853f5fe5c4"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5ebac21ff67e7555ae952e51","key":"StickyOutstreamTopCenter_5ebac21ff67e7555ae952e51"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_60241fb76f0af53ee0150fba","key":"StickyOutstreamTopCenter_60241fb76f0af53ee0150fba"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5af420ecfab03c25e571fc36","key":"StickyOutstreamTopCenter_5af420ecfab03c25e571fc36"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5e42febb231faa5bc174c1e9","key":"StickyOutstreamTopCenter_5e42febb231faa5bc174c1e9"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_62f26eb8e4a64b3ce9532c7b","key":"StickyOutstreamTopCenter_62f26eb8e4a64b3ce9532c7b"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5ade026821520f50ab7dc946","key":"StickyOutstreamTopCenter_5ade026821520f50ab7dc946"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"sotc_5be1d613604fb775e8699c25","key":"StickyOutstreamTopCenter_5be1d613604fb775e8699c25"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"scatcve","key":"StickyContainerAdsTopCenterVideoDependency"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"ssau","key":"SlickstreamAdUnits"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"ssff","key":"StickySidebarFeatureFlag"},{"variants":[{"weight":80,"value":"20sc"},{"weight":10,"value":"20s"},{"weight":10,"value":"off"}],"type":"weightedChoice","abgroup":"multirefauc","key":"MultistagePrebidAuction"},{"variants":[{"weight":85,"value":"20s"},{"weight":5,"value":"20sf1"},{"weight":5,"value":"20sf2"},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"multirefaucd","key":"MultistagePrebidAuctionDisplay"},{"variants":[{"weight":50,"value":1},{"weight":50,"value":0}],"type":"weightedChoice","abgroup":"multis2s","key":"MultistageServer"},{"variants":[{"weight":2,"value":"10s1"},{"weight":2,"value":"10s2"},{"weight":96,"value":"off"}],"type":"weightedChoice","abgroup":"multirefaucv","key":"MultistagePrebidAuctionV"},{"variants":[{"weight":1,"value":"none"},{"weight":99,"value":"8.30.0"}],"type":"weightedChoice","abgroup":"jwpv","key":"JWPVersionExperiment"},{"variants":[{"weight":70,"value":10000},{"weight":7,"value":15000},{"weight":7,"value":20000},{"weight":10,"value":25000},{"weight":3,"value":1000},{"weight":3,"value":2000}],"type":"weightedChoice","abgroup":"ainv","key":"AdInViewExperiment"},{"variants":[{"weight":100,"value":1000}],"type":"weightedChoice","abgroup":"ainv2","key":"AdInViewExperiment_2"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"dovh","key":"DetectOverlappingHeader"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"vcsu","key":"VideoCollapseScrollUp"},{"variants":[{"weight":0,"value":"off"},{"weight":100,"value":"1"},{"weight":0,"value":"2"}],"type":"weightedChoice","abgroup":"cosuftc","key":"VideoCollapseScrollUpTopCenter"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"sotcDA","key":"StickyOutstreamTopCenterDA"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"intcfg","key":"InterstitialConfig"},{"variants":[{"weight":33,"value":0},{"weight":33,"value":1},{"weight":34,"value":1.5}],"type":"weightedChoice","abgroup":"csld","key":"ConnectionSpeedLazyLoad"},{"variants":[{"weight":99,"value":"Continuing without bids"},{"weight":99,"value":"xhr timeout after"}],"type":"multivalueBernoulliTrial","abgroup":"dsle","key":"DialDownLogsExperiment"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"esc","key":"EnableSensitiveCategories"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"plin","key":"PlayInline"},{"variants":[{"weight":90}],"type":"bernoulliTrial","abgroup":"iplin","key":"IOSPlayInline"},{"variants":[{"weight":25,"value":"sm"},{"weight":25,"value":"md"},{"weight":25,"value":"lg"},{"weight":25,"value":"con"}],"type":"weightedChoice","abgroup":"lzset","key":"LazyLoadSettingsExperiment"},{"variants":[{"weight":80,"value":0},{"weight":5,"value":5},{"weight":5,"value":10},{"weight":5,"value":25},{"weight":5,"value":50}],"type":"weightedChoice","abgroup":"ilfe","key":"InstreamLowerFloorsExperiment"},{"variants":[{"weight":96,"value":0.9},{"weight":1,"value":0.85},{"weight":1,"value":0.8},{"weight":1,"value":0.75},{"weight":1,"value":0}],"type":"weightedChoice","abgroup":"vpred_1","key":"PredictiveAnalysis"},{"variants":[{"weight":55,"value":{"protocols":[1,2,3,4,5,6,7,8],"value":"all","scope":"all"}},{"weight":15,"value":{"protocols":[2,3,5,6,7,8],"value":"nv1","scope":"all"}},{"weight":15,"value":{"protocols":[1,2,3,5,6,7,8],"value":"allr","scope":"limited"}},{"weight":15,"value":{"protocols":[2,3,5,6,7,8],"value":"nv1r","scope":"limited"}}],"type":"weightedChoice","abgroup":"proto","key":"Protocols"},{"variants":[{"weight":30,"value":"off"},{"weight":50,"value":"7.30"},{"weight":10,"value":"5.10"},{"weight":5,"value":"3.00"},{"weight":5,"value":"1.40"}],"type":"weightedChoice","abgroup":"dcsll_ss2","key":"DCSLLSiteSpecific"},{"variants":[{"weight":5}],"type":"bernoulliTrial","abgroup":"soblp","key":"StickyOutstreamBottomLeftExperiment"},{"variants":[{"weight":97}],"type":"bernoulliTrial","abgroup":"oxli","key":"OpenXLiveIntent"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"tlli","key":"TripleLiftLiveIntent"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"pale","key":"ParallaxAdLogError"},{"variants":[{"weight":10,"value":1800},{"weight":10,"value":2100},{"weight":10,"value":2400},{"weight":60,"value":2700},{"weight":10,"value":3000}],"type":"weightedChoice","abgroup":"dssmh","key":"DynamicSidebarSlotsMinHeight"},{"variants":[{"weight":16,"value":5},{"weight":16,"value":10},{"weight":17,"value":15},{"weight":17,"value":18},{"weight":17,"value":22},{"weight":17,"value":25}],"type":"weightedChoice","abgroup":"dssc2","key":"DynamicSidebarSlotsCap"},{"variants":[{"weight":1,"value":"ats"},{"weight":1,"value":"conf"},{"weight":1,"value":"hawk"},{"weight":1,"value":"tgtaff"},{"weight":1,"value":"amz"},{"weight":95,"value":"none"}],"type":"weightedChoice","abgroup":"3pho","key":"TKHO"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":1},{"weight":25,"value":5},{"weight":25,"value":15}],"type":"weightedChoice","abgroup":"ettl","key":"EventHistoryTTL"},{"variants":[{"weight":1}],"type":"bernoulliTrial","abgroup":"aml","key":"AuctionMetricsLogger"},{"variants":[{"weight":0,"value":"control"},{"weight":100,"value":"topLeft"},{"weight":0,"value":"topLeftAboveAd"}],"type":"weightedChoice","abgroup":"fcp","key":"FooterCloseButtonLocation"},{"variants":[{"weight":25}],"type":"bernoulliTrial","abgroup":"rpbs","key":"RaptivePrebidServerExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"rpbsp","key":"RaptivePrebidServerProxyExperiment"},{"variants":[{"weight":0,"value":"east"},{"weight":25,"value":"west"},{"weight":75,"value":"mag"}],"type":"weightedChoice","abgroup":"rrpbs","key":"RaptiveRegionalPrebidServerExperiment"},{"variants":[{"weight":0,"value":"off"},{"weight":100,"value":"20s"}],"type":"weightedChoice","abgroup":"multiserverauc","key":"RaptivePBSMultistageAuctionExperiment"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":2},{"weight":20,"value":4},{"weight":20,"value":6},{"weight":20,"value":8}],"type":"weightedChoice","abgroup":"rpbsdr","key":"RaptivePBSDoubleRequestExperiment"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"rmp","key":"RubiconMultiformatParamExperiment"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"rmpu","key":"RubiconMultiformatParamExperimentUpdate"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"intl","key":"InterstitialLink"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"mrbf","key":"MidrollBugFixExperiment"},{"variants":[{"weight":25,"value":30},{"weight":25,"value":40},{"weight":25,"value":50},{"weight":25,"value":60}],"type":"weightedChoice","abgroup":"ttle","key":"EventHistoryTTLExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"prm","key":"PageRefreshMonitorExperiment"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":60},{"weight":25,"value":150},{"weight":25,"value":300}],"type":"weightedChoice","abgroup":"ttlmbc","key":"MinBidCacheTTLExperiment"},{"variants":[{"weight":25,"value":0},{"weight":25,"value":1000},{"weight":25,"value":2500},{"weight":25,"value":5000}],"type":"weightedChoice","abgroup":"lito","key":"LiveIntentTimeOutExperiment"},{"variants":[{"weight":100,"value":100}],"type":"weightedChoice","abgroup":"lat","key":"LazyLoadThreshold"},{"variants":[{"weight":100,"value":"ix"},{"weight":100,"value":"ttd"}],"type":"multivalueBernoulliTrial","abgroup":"prbi","key":"PriorityBiddersExperiment"},{"variants":[{"weight":100,"value":"ss"},{"weight":100,"value":"td"},{"weight":100,"value":"auth"},{"weight":100,"value":"authbr"},{"weight":100,"value":"nl"},{"weight":100,"value":"url"},{"weight":100,"value":"urlh"},{"weight":100,"value":"api"},{"weight":100,"value":"grwm"},{"weight":100,"value":"cki"},{"weight":100,"value":"l"},{"weight":100,"value":"o"},{"weight":100,"value":"c"},{"weight":100,"value":"l_i"}],"type":"multivalueBernoulliTrial","abgroup":"hemsa","key":"hemSourceAllowlist"},{"variants":[{"weight":99.25,"value":"yieldmo"},{"weight":99.44,"value":"unruly"},{"weight":96.86,"value":"trustx"},{"weight":99.19,"value":"triplelift"},{"weight":99.31,"value":"tripl_ss"},{"weight":99.67,"value":"sharethrough"},{"weight":98.8,"value":"rubicon"},{"weight":99.59,"value":"rubi_ss"},{"weight":99.07,"value":"pubmatic"},{"weight":99.6,"value":"pubm_ss"},{"weight":99.2,"value":"openx"},{"weight":99.74,"value":"onetag"},{"weight":99.98,"value":"nativo"},{"weight":99.3,"value":"krgo_ss"},{"weight":99.2,"value":"kargo"},{"weight":98.84,"value":"ix"},{"weight":99.93,"value":"improve_ss"},{"weight":99.9,"value":"gridvid"},{"weight":99.72,"value":"grid"}],"type":"multivalueBernoulliTrial","abgroup":"licfa_3_31","key":"LiveIntentChromeFeeAdjustment"},{"variants":[{"weight":98.8,"value":"yieldmo"},{"weight":98.87,"value":"unruly"},{"weight":98.3,"value":"triplelift"},{"weight":97.75,"value":"tripl_ss"},{"weight":97.83,"value":"rubicon"},{"weight":98.07,"value":"rubi_ss"},{"weight":96.86,"value":"rtbhouse"},{"weight":97.86,"value":"pubmatic"},{"weight":98,"value":"pubm_ss"},{"weight":98.43,"value":"onetag"},{"weight":99.62,"value":"krgo_ss"},{"weight":97.81,"value":"ix"},{"weight":99.57,"value":"gridvid"},{"weight":99.74,"value":"grid"},{"weight":99.15,"value":"adform"}],"type":"multivalueBernoulliTrial","abgroup":"lincfa_3_31","key":"LiveIntentNonChromeFeeAdjustment"},{"variants":[{"weight":1,"value":"11"},{"weight":25,"value":"1911"},{"weight":1,"value":"21"},{"weight":72,"value":"169"},{"weight":1,"value":"43"}],"type":"weightedChoice","abgroup":"ntvrat","key":"NativeRatio"},{"variants":[{"weight":90,"value":"ec3"},{"weight":5,"value":"arl"},{"weight":5,"value":"off"}],"type":"weightedChoice","abgroup":"ixnt","key":"IxNativeExperiment"},{"variants":[{"weight":10,"value":2000},{"weight":40,"value":1000},{"weight":40,"value":1250},{"weight":10,"value":1500}],"type":"weightedChoice","abgroup":"s2sto","key":"S2STimeOutExperiment"},{"variants":[{"weight":100}],"type":"bernoulliTrial","abgroup":"inp","key":"INPExperiment"},{"variants":[{"weight":85,"value":1500},{"weight":5,"value":2000},{"weight":5,"value":3000},{"weight":5,"value":4000}],"type":"weightedChoice","abgroup":"s2store","key":"S2SRefreshTimeout"},{"variants":[{"weight":50}],"type":"bernoulliTrial","abgroup":"opli","key":"OpenPathLiveIntent"},{"variants":[{"weight":20,"value":"rec"},{"weight":20,"value":"old"},{"weight":20,"value":"fr30"},{"weight":20,"value":"fr60"},{"weight":20,"value":"fr90"}],"type":"weightedChoice","abgroup":"td_hsl","key":"TrueDataHemSelectionLogic"},{"variants":[{"weight":0}],"type":"bernoulliTrial","abgroup":"ssptrm","key":"SspTakeRateMonitor"},{"variants":[{"weight":20,"value":1},{"weight":20,"value":2},{"weight":20,"value":3},{"weight":20,"value":4},{"weight":20,"value":5}],"type":"weightedChoice","abgroup":"ttlb","key":"TTLBuffer"},{"variants":[{"weight":20,"value":20},{"weight":20,"value":23},{"weight":20,"value":25},{"weight":20,"value":28},{"weight":20,"value":30}],"type":"weightedChoice","abgroup":"ntvtl","key":"NativeTitleLength"},{"variants":[{"weight":20,"value":0},{"weight":5,"value":75},{"weight":20,"value":100},{"weight":20,"value":120},{"weight":35,"value":140}],"type":"weightedChoice","abgroup":"ntvdl","key":"NativeDescriptionLength"},{"variants":[{"weight":20,"value":0},{"weight":20,"value":5},{"weight":20,"value":10},{"weight":20,"value":15},{"weight":20,"value":20}],"type":"weightedChoice","abgroup":"nbho","key":"NoBidHoldouts"},{"variants":[{"weight":25,"value":5},{"weight":25,"value":10},{"weight":25,"value":15},{"weight":25,"value":20}],"type":"weightedChoice","abgroup":"nbl","key":"NoBidLimit"},{"variants":[{"weight":4,"value":"11_1"},{"weight":4,"value":"11_2"},{"weight":4,"value":"11_3"},{"weight":4,"value":"11_4"},{"weight":4,"value":"11_5"},{"weight":4,"value":"1911_1"},{"weight":4,"value":"1911_2"},{"weight":4,"value":"1911_3"},{"weight":4,"value":"1911_4"},{"weight":4,"value":"1911_5"},{"weight":4,"value":"21_1"},{"weight":4,"value":"21_2"},{"weight":4,"value":"21_3"},{"weight":4,"value":"21_4"},{"weight":4,"value":"21_5"},{"weight":4,"value":"169_1"},{"weight":4,"value":"169_2"},{"weight":4,"value":"169_3"},{"weight":4,"value":"169_4"},{"weight":4,"value":"169_5"},{"weight":4,"value":"43_1"},{"weight":4,"value":"43_2"},{"weight":4,"value":"43_3"},{"weight":4,"value":"43_4"},{"weight":4,"value":"43_5"}],"type":"weightedChoice","abgroup":"ntvrat2","key":"NativeContentRatio"},{"variants":[{"weight":20,"value":300},{"weight":20,"value":400},{"weight":20,"value":500},{"weight":20,"value":600},{"weight":20,"value":700}],"type":"weightedChoice","abgroup":"ftmg","key":"FetchMargin"},{"variants":[{"weight":7,"value":"2_1"},{"weight":7,"value":"2_2"},{"weight":7,"value":"2_3"},{"weight":7,"value":"2_4"},{"weight":7,"value":"2_5"},{"weight":7,"value":"3_1"},{"weight":7,"value":"3_2"},{"weight":7,"value":"3_3"},{"weight":7,"value":"4_1"},{"weight":7,"value":"4_2"},{"weight":7,"value":"4_3"},{"weight":7,"value":"5_1"},{"weight":7,"value":"5_2"},{"weight":7,"value":"5_3"},{"weight":2,"value":"off"}],"type":"weightedChoice","abgroup":"mmsa","key":"MultiMultistagePrebidAuctionDisplay"}]};

    'use strict';window.adthrive.branch=window.adthrive.branch||"HEAD b198782";window.adthrive.bucket=window.adthrive.bucket||"flex";window.adthrive.gdpr="false";window.adthrive.deployment=window.adthrive.deployment||"X";
var adthrive=function(){function xr(a,b,c,d){a.reverse().forEach(e=>{d=e(b,c,d)||d});return d}function yr(a,b){a.reverse().forEach(c=>{(c=c(b))&&(b=c)});return b}function Bn(a,b){return Sd.get(a)&&Sd.get(a).get(b)}function Td(a,b,c){if(void 0===b)throw new TypeError;return(b=Bn(b,c))&&b.get(a)}function Cn(a,b,c,d){if(d&&!["string","symbol"].includes(typeof d))throw new TypeError;var e;(e=Bn(c,d))||(e=Sd.get(c)||new Map,Sd.set(c,e),c=e.get(d)||new Map,e.set(d,c),e=c);e.set(a,b)}function sg(a,b,c){return Td(a,
b,c)?Td(a,b,c):Object.getPrototypeOf(b)?sg(a,Object.getPrototypeOf(b),c):void 0}function tg(a,b){function c(){this.constructor=a}ug(a,b);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function zr(a,b,c,d){function e(f){return f instanceof c?f:new c(function(g){g(f)})}return new (c||(c=Promise))(function(f,g){function h(n){try{m(d.next(n))}catch(p){g(p)}}function k(n){try{m(d["throw"](n))}catch(p){g(p)}}function m(n){n.done?f(n.value):e(n.value).then(h,k)}m((d=d.apply(a,b||[])).next())})}
function Ar(a,b){function c(m){return function(n){return d([m,n])}}function d(m){if(f)throw new TypeError("Generator is already executing.");for(;e;)try{if(f=1,g&&(h=m[0]&2?g["return"]:m[0]?g["throw"]||((h=g["return"])&&h.call(g),0):g.next)&&!(h=h.call(g,m[1])).done)return h;if(g=0,h)m=[m[0]&2,h.value];switch(m[0]){case 0:case 1:h=m;break;case 4:return e.label++,{value:m[1],done:!1};case 5:e.label++;g=m[1];m=[0];continue;case 7:m=e.ops.pop();e.trys.pop();continue;default:if(!(h=e.trys,h=0<h.length&&
h[h.length-1])&&(6===m[0]||2===m[0])){e=0;continue}if(3===m[0]&&(!h||m[1]>h[0]&&m[1]<h[3]))e.label=m[1];else if(6===m[0]&&e.label<h[1])e.label=h[1],h=m;else if(h&&e.label<h[2])e.label=h[2],e.ops.push(m);else{h[2]&&e.ops.pop();e.trys.pop();continue}}m=b.call(a,e)}catch(n){m=[6,n],g=0}finally{f=h=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}var e={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},f,g,h,k;return k={next:c(0),"throw":c(1),"return":c(2)},"function"===
typeof Symbol&&(k[Symbol.iterator]=function(){return this}),k}function Ud(a){var b="function"===typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"===typeof a.length)return{next:function(){a&&d>=a.length&&(a=void 0);return{value:a&&a[d++],done:!a}}};throw new TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.");}function Vd(a,b){var c="function"===typeof Symbol&&a[Symbol.iterator];if(!c)return a;a=c.call(a);var d,e=[];try{for(;(void 0===b||0<b--)&&
!(d=a.next()).done;)e.push(d.value)}catch(g){var f={error:g}}finally{try{d&&!d.done&&(c=a["return"])&&c.call(a)}finally{if(f)throw f.error;}}return e}function ac(){for(var a=[],b=0;b<arguments.length;b++)a=a.concat(Vd(arguments[b]));return a}function Br(a){var b=Reflect.getMetadata("design:paramtypes",a)||[],c=Reflect.getOwnMetadata("injectionTokens",a)||{};Object.keys(c).forEach(function(d){b[+d]=c[d]});return b}function fa(a,b){return function(c,d,e){d=Reflect.getOwnMetadata("injectionTokens",c)||
{};d[e]=b?{token:a,transform:b.transformToken,transformArgs:b.args||[]}:a;Reflect.defineMetadata("injectionTokens",d,c)}}function sc(a){return"string"===typeof a||"symbol"===typeof a}function Dn(a){return"object"===typeof a&&"token"in a&&"transform"in a}function Cr(a,b,c){void 0===c&&(c="    ");return ac([a],b.message.split("\n").map(function(d){return c+d})).join("\n")}function H(){return function(a){En.set(a,Br(a))}}function y(){return function(a){H()(a);S.registerSingleton(a)}}function q(a,b,c,
d){var e=arguments.length,f=3>e?b:null===d?d=Object.getOwnPropertyDescriptor(b,c):d,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(a,b,c,d);else for(var h=a.length-1;0<=h;h--)if(g=a[h])f=(3>e?g(f):3<e?g(b,c,f):g(b,c))||f;return 3<e&&f&&Object.defineProperty(b,c,f),f}function ha(a,b){return function(c,d){b(c,d,a)}}function t(a,b){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(a,b)}function mb(a){var b=typeof a;return null!=
a&&("object"==b||"function"==b)}function Xc(a){if(null==a)return void 0===a?"[object Undefined]":"[object Null]";if(Fn&&Fn in Object(a)){var b=Dr.call(a,Yc),c=a[Yc];try{a[Yc]=void 0;var d=!0}catch(f){}var e=Er.call(a);d&&(b?a[Yc]=c:delete a[Yc]);a=e}else a=Fr.call(a);return a}function tc(a){return null!=a&&"object"==typeof a}function Gn(a){if("number"==typeof a)return a;var b=a;if("symbol"==typeof b||tc(b)&&"[object Symbol]"==Xc(b))return Hn;mb(a)&&(a="function"==typeof a.valueOf?a.valueOf():a,a=
mb(a)?a+"":a);if("string"!=typeof a)return 0===a?a:+a;if(a){b=a.slice;for(var c=a.length;c--&&Gr.test(a.charAt(c)););a=b.call(a,0,c+1).replace(Hr,"")}return(b=Ir.test(a))||Jr.test(a)?Kr(a.slice(2),b?2:8):Lr.test(a)?Hn:+a}function In(a,b,c){function d(C){var I=k,F=m;k=m=void 0;w=C;return n=a.apply(F,I)}function e(C){var I=C-r;C-=w;return void 0===r||I>=b||0>I||x&&C>=E}function f(){var C=Hb.Date.now();if(e(C))return g(C);var I=setTimeout;var F=C-w;C=b-(C-r);F=x?Mr(C,E-F):C;p=I(f,F)}function g(C){p=
void 0;if(B&&k)return d(C);k=m=void 0;return n}function h(){var C=Hb.Date.now(),I=e(C);k=arguments;m=this;r=C;if(I){if(void 0===p)return w=C=r,p=setTimeout(f,b),z?d(C):n;if(x)return clearTimeout(p),p=setTimeout(f,b),d(r)}void 0===p&&(p=setTimeout(f,b));return n}var k,m,n,p,r,w=0,z=!1,x=!1,B=!0;if("function"!=typeof a)throw new TypeError("Expected a function");b=Gn(b)||0;if(mb(c)){z=!!c.leading;var E=(x="maxWait"in c)?Nr(Gn(c.maxWait)||0,b):E;B="trailing"in c?!!c.trailing:B}h.cancel=function(){void 0!==
p&&clearTimeout(p);w=0;k=r=m=p=void 0};h.flush=function(){return void 0===p?n:g(Hb.Date.now())};return h}function Zc(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new TypeError("Expected a function");mb(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e);return In(a,b,{leading:d,maxWait:b,trailing:e})}function Wd(a,b){return a===b||a!==a&&b!==b}function Xd(a,b){for(var c=a.length;c--;)if(Wd(a[c][0],b))return c;return-1}function zb(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<
c;){var d=a[b];this.set(d[0],d[1])}}function vg(a){if(!mb(a))return!1;a=Xc(a);return"[object Function]"==a||"[object GeneratorFunction]"==a||"[object AsyncFunction]"==a||"[object Proxy]"==a}function wg(a,b){a=null==a?void 0:a[b];if(!mb(a)||Jn&&Jn in a)var c=!1;else{b=vg(a)?Or:Pr;var d=b.test;b:if(null!=a){try{c=Qr.call(a);break b}catch(e){}c=a+""}else c="";c=d.call(b,c)}return c?a:void 0}function bc(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Yd(a,
b){a=a.__data__;var c=typeof b;return("string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==b:null===b)?a["string"==typeof b?"string":"hash"]:a.map}function uc(a){var b=-1,c=null==a?0:a.length;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function vc(a){this.size=(this.__data__=new zb(a)).size}function xg(a,b,c){"__proto__"==b&&Zd?Zd(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}):a[b]=c}function yg(a,b,c){(void 0===c||Wd(a[b],c))&&(void 0!==c||b in a)||xg(a,b,c)}function Kn(a){var b=
a&&a.constructor;return a===("function"==typeof b&&b.prototype||Rr)}function Ln(a){return tc(a)&&"[object Arguments]"==Xc(a)}function Mn(a){return"number"==typeof a&&-1<a&&0==a%1&&9007199254740991>=a}function zg(a){return null!=a&&Mn(a.length)&&!vg(a)}function Sr(){return!1}function Tr(a){return tc(a)&&Mn(a.length)&&!!sa[Xc(a)]}function Ur(a){return function(b){return a(b)}}function Ag(a,b){if(("constructor"!==b||"function"!==typeof a[b])&&"__proto__"!=b)return a[b]}function Nn(a,b){var c=typeof a;
b=null==b?9007199254740991:b;return!!b&&("number"==c||"symbol"!=c&&Vr.test(a))&&-1<a&&0==a%1&&a<b}function On(a){if(zg(a)){var b=Bg(a),c=!b&&Cg(a),d=!b&&!c&&Pn(a),e=!b&&!c&&!d&&Qn(a);if(b=b||c||d||e){c=a.length;for(var f=String,g=-1,h=Array(c);++g<c;)h[g]=f(g);c=h}else c=[];f=c.length;for(var k in a)b&&("length"==k||d&&("offset"==k||"parent"==k)||e&&("buffer"==k||"byteLength"==k||"byteOffset"==k)||Nn(k,f))||c.push(k);a=c}else if(mb(a)){k=Kn(a);e=[];for(d in a)("constructor"!=d||!k&&Wr.call(a,d))&&
e.push(d);a=e}else{k=[];if(null!=a)for(e in Object(a))k.push(e);a=k}return a}function Rn(a,b,c,d,e){a!==b&&Xr(b,function(f,g){e||(e=new vc);if(mb(f)){f=e;var h=Ag(a,g),k=Ag(b,g),m=f.get(k);if(m)yg(a,g,m);else{var n=d?d(h,k,g+"",a,b,f):void 0;if(m=void 0===n){var p=Bg(k),r=!p&&Pn(k),w=!p&&!r&&Qn(k);n=k;if(p||r||w)if(Bg(h))n=h;else if(tc(h)&&zg(h))for(n=void 0,p=-1,r=h.length,n||(n=Array(r));++p<r;)n[p]=h[p];else r?(m=!1,n=k.slice()):w?(m=!1,h=k.buffer,n=new h.constructor(h.byteLength),(new Sn(n)).set(new Sn(h)),
n=new k.constructor(n,k.byteOffset,k.length)):n=[];else if(tc(k)&&"[object Object]"==Xc(k)?(p=Tn(k),null===p?p=!0:(p=Yr.call(p,"constructor")&&p.constructor,p="function"==typeof p&&p instanceof p&&Un.call(p)==Zr)):p=!1,p||Cg(k))if(n=h,Cg(h)){n=On(h);p=void 0;r=!p;p||(p={});w=-1;for(var z=n.length;++w<z;){var x=n[w],B=void 0;void 0===B&&(B=h[x]);if(r)xg(p,x,B);else{var E=p,C=E[x];$r.call(E,x)&&Wd(C,B)&&(void 0!==B||x in E)||xg(E,x,B)}}n=p}else{if(!mb(h)||vg(h))n="function"!=typeof k.constructor||Kn(k)?
{}:as(Tn(k))}else m=!1}m&&(f.set(k,n),Rn(n,k,c,d,f),f["delete"](k));yg(a,g,n)}}else k=d?d(Ag(a,g),f,g+"",a,b,e):void 0,void 0===k&&(k=f),yg(a,g,k)},On)}function Vn(a){return a}function bs(a,b,c){switch(c.length){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function cs(a,b,c){b=Wn(void 0===b?a.length-1:b,0);return function(){for(var d=arguments,e=-1,f=Wn(d.length-b,0),g=Array(f);++e<f;)g[e]=d[b+e];
e=-1;for(f=Array(b+1);++e<b;)f[e]=d[e];f[b]=c(g);return bs(a,this,f)}}function ds(a){return function(){return a}}function es(a,b){return fs(cs(a,b,Vn),a+"")}function Ab(a,b){void 0===b&&(b={});b=b.insertAt;if(a&&"undefined"!==typeof document){var c=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";"top"===b?c.firstChild?c.insertBefore(d,c.firstChild):c.appendChild(d):c.appendChild(d);d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a))}}
function Xn(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}));c.push.apply(c,d)}return c}function Xa(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?Xn(Object(c),!0).forEach(function(d){var e=c[d];a:if("object"===typeof d&&null!==d){var f=d[Symbol.toPrimitive];if(void 0!==f){d=f.call(d,"string");if("object"!==typeof d)break a;throw new TypeError("@@toPrimitive must return a primitive value.");
}d=String(d)}d="symbol"===typeof d?d:String(d);d in a?Object.defineProperty(a,d,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[d]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):Xn(Object(c)).forEach(function(d){Object.defineProperty(a,d,Object.getOwnPropertyDescriptor(c,d))})}return a}function Ga(){Ga=Object.assign?Object.assign.bind():function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,
d)&&(a[d]=c[d])}return a};return Ga.apply(this,arguments)}function gs(a,...b){b.forEach(function(c){var d=$c;var e=a[c]?a[c].bind(a):(e=self.console[c])?e.bind(self.console,`[${c}] >`):cc;d[c]=e})}function Dg(a){return Uint8Array.from(atob(a),b=>b.charCodeAt(0))}function hs(a){let b=function(c,d,e){const f=c[d];c[d]=c[e];c[e]=f};b(a,0,3);b(a,1,2);b(a,4,5);b(a,6,7)}function Yn(a){return Uint8Array.from(unescape(encodeURIComponent(a)),b=>b.charCodeAt(0))}function Zn(a){switch(a){case Ya.FAIRPLAY:return wa.FAIRPLAY;
case Ya.PLAYREADY:return wa.PLAYREADY;case Ya.WIDEVINE:return wa.WIDEVINE;case Ya.CLEARKEY:return wa.CLEARKEY}}function $n(a){switch(a){case wa.FAIRPLAY:return Ya.FAIRPLAY;case wa.PLAYREADY:return Ya.PLAYREADY;case wa.WIDEVINE:return Ya.WIDEVINE;case wa.CLEARKEY:return Ya.CLEARKEY}}function Eg(a){let {drmSystems:b,widevineLicenseUrl:c}=a;a=b?[wa.FAIRPLAY,wa.WIDEVINE,wa.PLAYREADY,wa.CLEARKEY].filter(d=>!!b[d]):[];!a[wa.WIDEVINE]&&c&&a.push(wa.WIDEVINE);return a}function is(a,b,c,d){switch(a){case wa.FAIRPLAY:a=
["cenc","sinf"];break;case wa.WIDEVINE:case wa.PLAYREADY:a=["cenc"];break;case wa.CLEARKEY:a=["cenc","keyids"];break;default:throw Error(`Unknown key-system: ${a}`);}return js(a,b,c,d)}function js(a,b,c,d){return[{initDataTypes:a,persistentState:d.persistentState||"not-allowed",distinctiveIdentifier:d.distinctiveIdentifier||"not-allowed",sessionTypes:d.sessionTypes||[d.sessionType||"temporary"],audioCapabilities:b.map(e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:d.audioRobustness||"",encryptionScheme:d.audioEncryptionScheme||
null})),videoCapabilities:c.map(e=>({contentType:`video/mp4; codecs="${e}"`,robustness:d.videoRobustness||"",encryptionScheme:d.videoEncryptionScheme||null}))}]}function dc(a,b,c){return Uint8Array.prototype.slice?a.slice(b,c):new Uint8Array(Array.prototype.slice.call(a,b,c))}function La(a){return String.fromCharCode.apply(null,a)}function ao(a,b){a=a[b]<<8|a[b+1];return 0>a?65536+a:a}function da(a,b){a=a[b]<<24|a[b+1]<<16|a[b+2]<<8|a[b+3];return 0>a?4294967296+a:a}function Fg(a,b,c){a[b]=c>>24;a[b+
1]=c>>16&255;a[b+2]=c>>8&255;a[b+3]=c&255}function ka(a,b){let c=[];if(!b.length)return c;let d=a.byteLength;for(var e=0;e<d;){var f=da(a,e);let g=La(a.subarray(e+4,e+8));f=1<f?e+f:d;g===b[0]&&(1===b.length?c.push(a.subarray(e+8,f)):(e=ka(a.subarray(e+8,f),b.slice(1)),e.length&&ks.apply(c,e)));e=f}return c}function ls(a){let b=[],c=a[0];var d=8;let e=da(a,d);d+=4;d=(0===c?d+8:d+16)+2;let f=a.length+0,g=ao(a,d);d+=2;for(let k=0;k<g;k++){var h=da(a,d);d+=4;let m=h&2147483647;if(1===(h&2147483648)>>>
31)return D.warn("SIDX has hierarchical references (not supported)"),null;h=da(a,d);d+=4;b.push({referenceSize:m,subsegmentDuration:h,info:{duration:h/e,start:f,end:f+m-1}});f+=m;d+=4}return{earliestPresentationTime:0,timescale:e,version:c,referencesCount:g,references:b}}function bo(a){let b=[],c=ka(a,["moov","trak"]);for(let h=0;h<c.length;h++){var d=c[h],e=ka(d,["tkhd"])[0];if(e){var f=e[0];f=0===f?12:20;e=da(e,f);var g=ka(d,["mdia","mdhd"])[0];if(g&&(f=g[0],f=0===f?12:20,f=da(g,f),g=ka(d,["mdia",
"hdlr"])[0])&&(g=La(g.subarray(8,12)),g={soun:oa.AUDIO,vide:oa.VIDEO}[g])){d=ka(d,["mdia","minf","stbl","stsd"])[0];let k;d&&(k=La(d.subarray(12,16)));b[e]={timescale:f,type:g};b[g]={timescale:f,id:e,codec:k}}}}ka(a,["moov","mvex","trex"]).forEach(h=>{var k=da(h,4);if(k=b[k])k.default={duration:da(h,12),flags:da(h,20)}});return b}function ms(a,b){if(!a||!b)return a;let c=b.keyId;c&&b.isCommonEncryption&&ka(a,["moov","trak"]).forEach(d=>{d=ka(d,["mdia","minf","stbl","stsd"])[0].subarray(8);let e=ka(d,
["enca"]),f=0<e.length;f||(e=ka(d,["encv"]));e.forEach(g=>{g=f?g.subarray(28):g.subarray(78);ka(g,["sinf"]).forEach(h=>{if(h=co(h)){let k=h.subarray(8,24);k.some(m=>0!==m)||(D.log(`[eme] Patching keyId in 'enc${f?"a":"v"}>sinf>>tenc' box: ${qb.hexDump(k)} -> ${qb.hexDump(c)}`),h.set(c,8))}})})});return a}function co(a){var b=ka(a,["schm"])[0];if(b&&(b=La(b.subarray(4,8)),"cbcs"===b||"cenc"===b))return ka(a,["schi","tenc"])[0];D.error("[eme] missing 'schm' box");return null}function ns(a,b){return ka(b,
["moof","traf"]).reduce((c,d)=>{let e=ka(d,["tfdt"])[0],f=e[0];d=ka(d,["tfhd"]).reduce((g,h)=>{h=da(h,4);if(h=a[h]){let k=da(e,4);if(1===f){if(k===$d)return D.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),g;k*=$d+1;k+=da(e,8)}h=k/(h.timescale||9E4);if(isFinite(h)&&(null===g||h<g))return h}return g},null);return null!==d&&isFinite(d)&&(null===c||d<c)?d:c},null)}function os(a,b){var c=0,d=0,e=0;let f=ka(a,["moof","traf"]);for(let p=0;p<f.length;p++){var g=
f[p],h=ka(g,["tfhd"])[0],k=da(h,4);if(k=b[k]){var m=k.default,n=da(h,0)|(null==m?NaN:m.flags);m=null==m?void 0:m.duration;n&8&&(m=n&2?da(h,12):da(h,8));h=k.timescale||9E4;g=ka(g,["trun"]);for(n=0;n<g.length;n++)c=ps(g[n]),!c&&m&&(c=da(g[n],4),c*=m),k.type===oa.VIDEO?d+=c/h:k.type===oa.AUDIO&&(e+=c/h)}}if(0===d&&0===e){b=0;a=ka(a,["sidx"]);for(d=0;d<a.length;d++)e=ls(a[d]),null!=e&&e.references&&(b+=e.references.reduce((p,r)=>p+r.info.duration||0,0));return b}return d?d:e}function ps(a){let b=da(a,
0),c=8;b&1&&(c+=4);b&4&&(c+=4);let d=0,e=da(a,4);for(let f=0;f<e;f++){if(b&256){let g=da(a,c);d+=g;c+=4}b&512&&(c+=4);b&1024&&(c+=4);b&2048&&(c+=4)}return d}function qs(a,b,c){ka(b,["moof","traf"]).forEach(d=>{ka(d,["tfhd"]).forEach(e=>{e=da(e,4);if(e=a[e]){var f=e.timescale||9E4;ka(d,["tfdt"]).forEach(g=>{var h=g[0];let k=da(g,4);0===h?(k-=c*f,k=Math.max(k,0),Fg(g,4,k)):(k*=Math.pow(2,32),k+=da(g,8),k-=c*f,k=Math.max(k,0),h=Math.floor(k%($d+1)),Fg(g,4,Math.floor(k/($d+1))),Fg(g,8,h))})}})})}function ec(a,
b){let c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return c}function eo(a,b){let c=[],d=b.samples,e=b.timescale,f=b.id,g=!1;ka(d,["moof"]).map(h=>{let k=h.byteOffset-8;ka(h,["traf"]).map(m=>{let n=ka(m,["tfdt"]).map(p=>{const r=p[0];let w=da(p,4);1===r&&(w*=Math.pow(2,32),w+=da(p,8));return w/e})[0];void 0!==n&&(a=n);return ka(m,["tfhd"]).map(p=>{let r=da(p,4),w=da(p,0)&16777215,z=0,x=0!==(w&16),B=0,E=0!==(w&32),C=8;r===f&&(0!==(w&1)&&(C+=8),0!==(w&2)&&(C+=4),0!==(w&8)&&(z=da(p,
C),C+=4),x&&(B=da(p,C),C+=4),E&&(C+=4),"video"===b.type&&(g=rs(b.codec)),ka(m,["trun"]).map(I=>{let F=I[0];var O=da(I,0)&16777215,R=0!==(O&1),J=0,aa=0!==(O&4);let qa=0!==(O&256),za=0!==(O&512),Ea=0!==(O&1024);O=0!==(O&2048);let Ib=0,Jb=da(I,4),Ba=8;R&&(J=da(I,Ba),Ba+=4);aa&&(Ba+=4);aa=J+k;for(let Kb=0;Kb<Jb;Kb++){qa?(R=da(I,Ba),Ba+=4):R=z;za?(J=da(I,Ba),Ba+=4):J=B;Ea&&(Ba+=4);O&&(Ib=0===F?da(I,Ba):I[Ba]<<24|I[Ba+1]<<16|I[Ba+2]<<8|I[Ba+3],Ba+=4);if(b.type===oa.VIDEO){let db=0;for(;db<J;){let fc=da(d,
aa);aa+=4;var Sa=d[aa];g?(Sa=Sa>>1&63,Sa=39===Sa||40===Sa):Sa=6===(Sa&31);Sa&&(Sa=d.subarray(aa,aa+fc),fo(Sa,g?2:1,a+Ib/e,c));aa+=fc;db+=fc+4}}a+=R/e}}))})})});return c}function rs(a){if(!a)return!1;let b=a.indexOf(".");a=0>b?a:a.substring(0,b);return"hvc1"===a||"hev1"===a||"dvh1"===a||"dvhe"===a}function fo(a,b,c,d){a=go(a);b=0+b;let e;let f=!1;for(var g;b<a.length;){e=0;do{if(b>=a.length)break;g=a[b++];e+=g}while(255===g);var h=0;do{if(b>=a.length)break;g=a[b++];h+=g}while(255===g);g=a.length-b;
if(!f&&4===e&&b<a.length){if(f=!0,181===a[b++]&&(g=ao(a,b),b+=2,49===g&&(g=da(a,b),b+=4,1195456820===g&&(g=a[b++],3===g)))){h=a[b++];var k=31&h,m=64&h;k=m?2+3*k:0;let n=new Uint8Array(k);if(m)for(n[0]=h,h=1;h<k;h++)n[h]=a[b++];d.push({type:g,payloadType:e,pts:c,bytes:n})}}else if(5===e&&h<g){if(f=!0,16<h){g=[];for(m=0;16>m;m++)k=a[b++].toString(16),g.push(1==k.length?"0"+k:k),3!==m&&5!==m&&7!==m&&9!==m||g.push("-");h-=16;m=new Uint8Array(h);for(k=0;k<h;k++)m[k]=a[b++];d.push({payloadType:e,pts:c,
uuid:g.join(""),userData:rb(m),userDataBytes:m})}}else if(h<g)b+=h;else if(h>g)break}}function go(a){var b=a.byteLength;let c=[],d=1;for(;d<b-2;)0===a[d]&&0===a[d+1]&&3===a[d+2]?(c.push(d+2),d+=2):d++;if(0===c.length)return a;b-=c.length;let e=new Uint8Array(b),f=0;for(d=0;d<b;f++,d++)f===c[0]&&(f++,c.shift()),e[d]=a[f];return e}function ss(a){if(!(a instanceof ArrayBuffer)||32>a.byteLength)return null;let b={version:0,systemId:"",kids:null,data:null};var c=new DataView(a),d=c.getUint32(0);if(a.byteLength!==
d&&44<d||1886614376!==c.getUint32(4))return null;b.version=c.getUint32(8)>>>24;if(1<b.version)return null;b.systemId=qb.hexDump(new Uint8Array(a,12,16));c=c.getUint32(28);if(0===b.version){if(d-32<c)return null;b.data=new Uint8Array(a,32,c)}else if(1===b.version)for(b.kids=[],d=0;d<c;d++)b.kids.push(new Uint8Array(a,32+16*d,16));return b}function Za(a,b,c){if(null!==a.variableList||a.hasVariableRefs)for(let d=c.length;d--;){let e=c[d],f=b[e];f&&(b[e]=Gg(a,f))}}function Gg(a,b){if(null!==a.variableList||
a.hasVariableRefs){let c=a.variableList;return b.replace(Hg,d=>{let e=d.substring(2,d.length-1),f=null==c?void 0:c[e];return void 0===f?(a.playlistParsingError||(a.playlistParsingError=Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${e}"`)),d):f})}return b}function ho(a,b,c){let d=a.variableList;d||(a.variableList=d={});let e,f;if("QUERYPARAM"in b){e=b.QUERYPARAM;try{let g=(new self.URL(c)).searchParams;if(g.has(e))f=g.get(e);else throw Error(`"${e}" does not match any query parameter in URI: "${c}"`);
}catch(g){a.playlistParsingError||(a.playlistParsingError=Error(`EXT-X-DEFINE QUERYPARAM: ${g.message}`))}}else e=b.NAME,f=b.VALUE;e in d?a.playlistParsingError||(a.playlistParsingError=Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${e}"`)):d[e]=f||""}function ae(){if("undefined"!==typeof self)return self.MediaSource||self.WebKitMediaSource}function Ig(a,b){var c;return null!=(c=null==io?void 0:io.isTypeSupported(`${b||"video"}/mp4;codecs="${a}"`))?c:!1}function jo(a,b,c){var d,e;a=new Aa(a);
Za(c,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);c=null!=(d=a.METHOD)?d:"";let f=a.URI;d=a.hexadecimalInteger("IV");let g=a.KEYFORMATVERSIONS,h=null!=(e=a.KEYFORMAT)?e:"identity";f&&a.IV&&!d&&D.error(`Invalid IV: ${a.IV}`);b=f?sb.resolve(f,b):"";e=(g?g:"1").split("/").map(Number).filter(Number.isFinite);return new be(c,b,h,e,d)}function ko(a){a=(new Aa(a)).decimalFloatingPoint("TIME-OFFSET");return Y(a)?a:null}function ts(a,b){["video","audio","text"].forEach(c=>{let d=a.filter(e=>{let f=
us[c];return!!f&&!0===f[e.slice(0,4)]});if(d.length){let e=d.filter(f=>0===f.lastIndexOf("avc1",0)||0===f.lastIndexOf("mp4a",0));b[`${c}Codec`]=0<e.length?e[0]:d[0];a=a.filter(f=>-1===d.indexOf(f))}});b.unknownCodecs=a}function lo(a,b,c){(b=b[c])&&(a[c]=b)}function mo(a,b){a.rawProgramDateTime?a.programDateTime=Date.parse(a.rawProgramDateTime):null!=b&&b.programDateTime&&(a.programDateTime=b.endProgramDateTime);Y(a.programDateTime)||(a.programDateTime=null,a.rawProgramDateTime=null)}function no(a,
b,c,d){a.relurl=b.URI;b.BYTERANGE&&a.setByteRange(b.BYTERANGE);a.level=c;a.sn="initSegment";d&&(a.levelkeys=d);a.initSegment=null}function oo(a,b,c){a.levelkeys=b;({encryptedFragments:c}=c);c.length&&c[c.length-1].levelkeys===b||!Object.keys(b).some(d=>b[d].isCommonEncryption)||c.push(a)}function po(a){({type:a}=a);switch(a){case la.AUDIO_TRACK:return ba.AUDIO;case la.SUBTITLE_TRACK:return ba.SUBTITLE;default:return ba.MAIN}}function Jg(a,b){a=a.url;if(void 0===a||0===a.indexOf("data:"))a=b.url;return a}
function qo(a,b){let c;try{c=new Event("addtrack")}catch(d){c=document.createEvent("Event"),c.initEvent("addtrack",!1,!1)}c.track=a;b.dispatchEvent(c)}function ro(a,b){let c=a.mode;"disabled"===c&&(a.mode="hidden");if(a.cues&&!a.cues.getCueById(b.id))try{if(a.addCue(b),!a.cues.getCueById(b.id))throw Error(`addCue is failed for: ${b}`);}catch(d){D.debug(`[texttrack-utils]: ${d}`);try{let e=new self.TextTrackCue(b.startTime,b.endTime,b.text);e.id=b.id;a.addCue(e)}catch(e){D.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===
c&&(a.mode=c)}function wc(a){let b=a.mode;"disabled"===b&&(a.mode="hidden");if(a.cues)for(let c=a.cues.length;c--;)a.removeCue(a.cues[c]);"disabled"===b&&(a.mode=b)}function Kg(a,b,c,d){let e=a.mode;"disabled"===e&&(a.mode="hidden");if(a.cues&&0<a.cues.length){a:{var f=a.cues;let h=[];var g=vs(f,b);if(-1<g)for(let k=g,m=f.length;k<m;k++)if(g=f[k],g.startTime>=b&&g.endTime<=c)h.push(g);else if(g.startTime>c){b=h;break a}b=h}for(c=0;c<b.length;c++)d&&!d(b[c])||a.removeCue(b[c])}"disabled"===e&&(a.mode=
e)}function vs(a,b){if(b<a[0].startTime)return 0;let c=a.length-1;if(b>a[c].endTime)return-1;let d=0,e=c;for(;d<=e;){let f=Math.floor((e+d)/2);if(b<a[f].startTime)e=f-1;else if(b>a[f].startTime&&d<c)d=f+1;else return f}return a[d].startTime-b<b-a[e].startTime?d:e}function Lg(){if("undefined"!==typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function Mg(a,b){return a.getTime()/1E3-b}function Ng(a,b){var c=b.startPTS;Y(c)?(b.sn>a.sn?c-=a.start:(c=a.start-c,a=b),a.duration!==c&&
(a.duration=c)):b.start=b.sn>a.sn?a.cc===b.cc&&a.minEndPTS?a.start+(a.minEndPTS-a.start):a.start+a.duration:Math.max(a.start-b.duration,0)}function so(a,b,c,d,e,f){0>=d-c&&(D.warn("Fragment should have a positive duration",b),d=c+b.duration,f=e+b.duration);var g=c;let h=d;var k=b.startPTS;let m=b.endPTS;Y(k)&&(g=Math.abs(k-c),Y(b.deltaPTS)?b.deltaPTS=Math.max(g,b.deltaPTS):b.deltaPTS=g,g=Math.max(c,k),c=Math.min(c,k),e=Math.min(e,b.startDTS),h=Math.min(d,m),d=Math.max(d,m),f=Math.max(f,b.endDTS));
k=c-b.start;0!==b.start&&(b.start=c);b.duration=d-b.start;b.startPTS=c;b.maxStartPTS=g;b.startDTS=e;b.endPTS=d;b.minEndPTS=h;b.endDTS=f;c=b.sn;if(!a||c<a.startSN||c>a.endSN)return 0;c-=a.startSN;d=a.fragments;d[c]=b;for(b=c;0<b;b--)Ng(d[b],d[b-1]);for(b=c;b<d.length-1;b++)Ng(d[b],d[b+1]);a.fragmentHint&&Ng(d[d.length-1],a.fragmentHint);a.PTSKnown=a.alignedSliding=!0;return k}function ws(a,b){let c=null;var d=a.fragments;for(var e=d.length-1;0<=e;e--){let h=d[e].initSegment;if(h){c=h;break}}a.fragmentHint&&
delete a.fragmentHint.endPTS;let f=0,g;xs(a,b,(h,k)=>{h.relurl&&(f=h.cc-k.cc);Y(h.startPTS)&&Y(h.endPTS)&&(k.start=k.startPTS=h.startPTS,k.startDTS=h.startDTS,k.maxStartPTS=h.maxStartPTS,k.endPTS=h.endPTS,k.endDTS=h.endDTS,k.minEndPTS=h.minEndPTS,k.duration=h.endPTS-h.startPTS,k.duration&&(g=k),b.PTSKnown=b.alignedSliding=!0);k.elementaryStreams=h.elementaryStreams;k.loader=h.loader;k.stats=h.stats;k.urlId=h.urlId;h.initSegment&&(c=k.initSegment=h.initSegment)});c&&(b.fragmentHint?b.fragments.concat(b.fragmentHint):
b.fragments).forEach(h=>{var k;h.initSegment&&h.initSegment.relurl!==(null==(k=c)?void 0:k.relurl)||(h.initSegment=c)});if(b.skippedSegments)if(b.deltaUpdateFailed=b.fragments.some(h=>!h),b.deltaUpdateFailed){D.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(d=b.skippedSegments;d--;)b.fragments.shift();b.startSN=b.fragments[0].sn;b.startCC=b.fragments[0].cc}else b.canSkipDateRanges&&(b.dateRanges=ys(a.dateRanges,b.dateRanges,b.recentlyRemovedDateranges));d=
b.fragments;if(f)for(D.warn("discontinuity sliding from playlist, take drift into account"),e=0;e<d.length;e++)d[e].cc+=f;b.skippedSegments&&(b.startCC=b.fragments[0].cc);zs(a.partList,b.partList,(h,k)=>{k.elementaryStreams=h.elementaryStreams;k.stats=h.stats});g?so(b,g,g.startPTS,g.endPTS,g.startDTS,g.endDTS):to(a,b);d.length&&(b.totalduration=b.edge-d[0].start);b.driftStartTime=a.driftStartTime;b.driftStart=a.driftStart;d=b.advancedDateTime;b.advanced&&d?(a=b.edge,b.driftStart||(b.driftStartTime=
d,b.driftStart=a),b.driftEndTime=d,b.driftEnd=a):(b.driftEndTime=a.driftEndTime,b.driftEnd=a.driftEnd,b.advancedDateTime=a.advancedDateTime)}function ys(a,b,c){let d=Ga({},a);c&&c.forEach(e=>{delete d[e]});Object.keys(b).forEach(e=>{let f=new uo(b[e].attr,d[e]);f.isValid?d[e]=f:D.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(b[e].attr)}"`)});return d}function zs(a,b,c){if(a&&b){let d=0;for(let e=0,f=a.length;e<=f;e++){let g=a[e],h=b[e+d];g&&h&&g.index===h.index&&g.fragment.sn===
h.fragment.sn?c(g,h):d--}}}function xs(a,b,c){let d=b.skippedSegments;var e=Math.max(a.startSN,b.startSN)-b.startSN;let f=(a.fragmentHint?1:0)+(d?b.endSN:Math.min(a.endSN,b.endSN))-b.startSN,g=b.startSN-a.startSN,h=b.fragmentHint?b.fragments.concat(b.fragmentHint):b.fragments;for(a=a.fragmentHint?a.fragments.concat(a.fragmentHint):a.fragments;e<=f;e++){let k=a[g+e],m=h[e];d&&!m&&e<d&&(m=b.fragments[e]=k);k&&m&&c(k,m)}}function to(a,b){let c=b.startSN+b.skippedSegments-a.startSN;a=a.fragments;0>c||
c>=a.length||Og(b,a[c].start)}function Og(a,b){if(b){let c=a.fragments;for(let d=a.skippedSegments;d<c.length;d++)c[d].start+=b;a.fragmentHint&&(a.fragmentHint.start+=b)}}function As(a,b=Infinity){let c=1E3*a.targetduration;a.updated?(a=a.fragments,a.length&&4*c>b&&(b=1E3*a[a.length-1].duration,b<c&&(c=b))):c/=2;return Math.round(c)}function vo(a,b,c){var d;return null!=a&&a.details?wo(null==(d=a.details)?void 0:d.partList,b,c):null}function wo(a,b,c){if(a)for(let d=a.length;d--;){let e=a[d];if(e.index===
c&&e.fragment.sn===b)return e}return null}function ce(a){switch(a.details){case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_TIMEOUT:case K.LEVEL_LOAD_TIMEOUT:case K.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function xo(a,b){b=ce(b);return a.default[`${b?"timeout":"error"}Retry`]}function Pg(a,b){return Math.min(("linear"===a.backoff?1:Math.pow(2,b))*a.retryDelayMs,a.maxRetryDelayMs)}function yo(a){return Xa(Xa({},a),{errorRetry:null,timeoutRetry:null})}function de(a,b,c,d){return!!a&&b<a.maxNumRetry&&(0===
d&&!1===navigator.onLine||!!d&&(400>d||499<d)||!!c)}function ad(a,b,c=0,d=0){let e=null;a?e=b[a.sn-b[0].sn+1]||null:0===c&&0===b[0].start&&(e=b[0]);if(e&&0===Qg(c,d,e))return e;b=zo.search(b,Qg.bind(null,c,d));return!b||b===a&&e?e:b}function Qg(a=0,b=0,c){if(c.start<=a&&c.start+c.duration>a)return 0;b=Math.min(b,c.duration+(c.deltaPTS?c.deltaPTS:0));return c.start+c.duration-b<=a?1:c.start-b>a&&c.start?-1:0}function Bs(a,b){return zo.search(a,c=>c.cc<b?1:c.cc>b?-1:0)}function Cs(a,b,c){if(3E5<performance.now()-
a.lastErrorPerfMs)return!0;let d=a.details;if(b.details===K.FRAG_GAP&&d&&b.frag){let e=ad(null,d.fragments,b.frag.start);if(e&&!e.gap)return!0}return c&&a.errors.length<c.errors.length&&(a=a.errors[a.errors.length-1],d&&a.frag&&b.frag&&Math.abs(a.frag.start-b.frag.start)>3*d.targetduration)?!0:!1}function ee(a,b,c){c&&("audio"===b?(a.audioGroupIds||(a.audioGroupIds=[]),a.audioGroupIds[a.url.length-1]=c):"text"===b&&(a.textGroupIds||(a.textGroupIds=[]),a.textGroupIds[a.url.length-1]=c))}function Ao(a){let b=
{};a.forEach(c=>{let d=c.groupId||"";c.id=b[d]=b[d]||0;b[d]++})}function fe(a){var b,c,d;return a.buffered&&(a.body.gap||(null==(b=a.range.video)?void 0:b.partial)||(null==(c=a.range.audio)?void 0:c.partial)||(null==(d=a.range.audiovideo)?void 0:d.partial))}function xc(a){return`${a.type}_${a.level}_${a.urlId}_${a.sn}`}function Bo(a,b=null){var c=b||a;b={frag:a,part:b,responseType:"arraybuffer",url:c.url,headers:{},rangeStart:0,rangeEnd:0};let d=c.byteRangeStartOffset;c=c.byteRangeEndOffset;if(Y(d)&&
Y(c)){var e;let f=d,g=c;"initSegment"===a.sn&&"AES-128"===(null==(e=a.decryptdata)?void 0:e.method)&&(a=c-d,a%16&&(g=c+(16-a%16)),0!==d&&(b.resetIV=!0,f=d-16));b.rangeStart=f;b.rangeEnd=g}return b}function Co(a,b){let c={type:Z.MEDIA_ERROR,details:K.FRAG_GAP,fatal:!1,frag:a,error:Error(`GAP ${a.gap?"tag":"attribute"} found`),networkDetails:null};b&&(c.part=b);(b?b:a).stats.aborted=!0;return new Bb(c)}function ge(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Do(a,b){let c=null;for(let d=
0,e=a.length;d<e;d++){let f=a[d];if(f&&f.cc===b){c=f;break}}return c}function Eo(a,b){a&&(b=a.start+b,a.start=a.startPTS=b,a.endPTS=b+a.duration)}function Rg(a,b){let c=b.fragments;for(let d=0,e=c.length;d<e;d++)Eo(c[d],a);b.fragmentHint&&Eo(b.fragmentHint,a);b.alignedSliding=!0}function Fo(a,b){if(a.hasProgramDateTime&&b.hasProgramDateTime){var c=a.fragments;b=b.fragments;if(c.length&&b.length){b=b[Math.round(b.length/2)-1];c=Do(c,b.cc)||c[Math.round(c.length/2)-1];var d=b.programDateTime,e=c.programDateTime;
null!==d&&null!==e&&Rg((e-d)/1E3-(c.start-b.start),a)}}}function Ds(){var a;let b=self.SourceBuffer||self.WebKitSourceBuffer;return"function"===typeof(null==b?void 0:null==(a=b.prototype)?void 0:a.changeType)}function Es(){var a=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"});a=self.URL.createObjectURL(a);return{worker:new self.Worker(a),objectURL:a}}function Fs(a){a=(new self.URL(a,
self.location.href)).href;return{worker:new self.Worker(a),scriptURL:a}}function tb(a="",b=9E4){return{type:a,id:-1,pid:-1,inputTimeScale:b,sequenceNumber:-1,samples:[],dropped:0}}function bd(a,b){return 255===a[b]&&240===(a[b+1]&246)}function Sg(a,b){return(a[b+3]&3)<<11|a[b+4]<<3|(a[b+5]&224)>>>5}function Gs(a,b){if(b+1<a.length&&bd(a,b)){let c=a[b+1]&1?7:9;if(b+c>=a.length)return!1;let d=Sg(a,b);if(d<=c)return!1;b+=d;return b===a.length||b+1<a.length&&bd(a,b)}return!1}function Go(a,b,c,d,e){if(!a.samplerate){{let g;
var f=navigator.userAgent.toLowerCase();let h=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350];g=((c[d+2]&192)>>>6)+1;let k=(c[d+2]&60)>>>2;if(k>h.length-1)b.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${k}`}),e=void 0;else{b=(c[d+2]&1)<<2;b|=(c[d+3]&192)>>>6;D.log(`manifest codec:${e}, ADTS type:${g}, samplingIndex:${k}`);if(/firefox/i.test(f))6<=k?(g=5,c=Array(4),f=k-3):(g=2,c=Array(2),f=k);else if(-1!==f.indexOf("android"))g=
2,c=Array(2),f=k;else if(g=5,c=Array(4),e&&(-1!==e.indexOf("mp4a.40.29")||-1!==e.indexOf("mp4a.40.5"))||!e&&6<=k)f=k-3;else{if(e&&-1!==e.indexOf("mp4a.40.2")&&(6<=k&&1===b||/vivaldi/i.test(f))||!e&&1===b)g=2,c=Array(2);f=k}c[0]=g<<3;c[0]|=(k&14)>>1;c[1]|=(k&1)<<7;c[1]|=b<<3;5===g&&(c[1]|=(f&14)>>1,c[2]=(f&1)<<7,c[2]|=8,c[3]=0);e={config:c,samplerate:h[k],channelCount:b,codec:"mp4a.40."+g,manifestCodec:e}}}e&&(a.config=e.config,a.samplerate=e.samplerate,a.channelCount=e.channelCount,a.codec=e.codec,
a.manifestCodec=e.manifestCodec,D.log(`parsed codec:${a.codec}, rate:${e.samplerate}, channels:${e.channelCount}`))}}function Ho(a,b,c,d,e){d+=9216E4/a.samplerate*e;a:{e=b[c+1]&1?7:9;if(c+e<=b.length){var f=Sg(b,c)-e;if(0<f){e={headerLength:e,frameLength:f};break a}}e=void 0}if(e){let {frameLength:g,headerLength:h}=e;f=h+g;let k=Math.max(0,c+f-b.length);k?(e=new Uint8Array(f-h),e.set(b.subarray(c+h,b.length),0)):e=b.subarray(c+h,c+f);b={unit:e,pts:d};k||a.samples.push(b);return{sample:b,length:f,
missing:k}}a=b.length-c;e=new Uint8Array(a);e.set(b.subarray(c,b.length),0);return{sample:{unit:e,pts:d},length:a,missing:-1}}function Io(a,b,c,d,e){if(!(c+24>b.length)){var f=Jo(b,c);if(f&&c+f.frameLength<=b.length)return d+=9E4*f.samplesPerFrame/f.sampleRate*e,b={unit:b.subarray(c,c+f.frameLength),pts:d,dts:d},a.config=[],a.channelCount=f.channelCount,a.samplerate=f.sampleRate,a.samples.push(b),{sample:b,length:f.frameLength,missing:0}}}function Jo(a,b){var c=a[b+1]>>3&3;let d=a[b+1]>>1&3;var e=
a[b+2]>>4&15,f=a[b+2]>>2&3;if(1!==c&&0!==e&&15!==e&&3!==f){let k=a[b+3]>>6;e=1E3*Hs[14*(3===c?3-d:3===d?3:4)+e-1];f=Is[3*(3===c?0:2===c?1:2)+f];let m=3===k?1:2;var g=Js[c][d],h=Ks[d];c=8*g*h;g=Math.floor(g*e/f+(a[b+2]>>1&1))*h;null===he&&(he=(h=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?parseInt(h[1]):0);he&&87>=he&&2===d&&224E3<=e&&0===k&&(a[b+3]|=128);return{sampleRate:f,channelCount:m,frameLength:g,samplesPerFrame:c}}}function ie(a,b){return 255===a[b]&&224===(a[b+1]&224)&&0!==(a[b+1]&
6)}function je(a,b,c,d){return{key:a,frame:!1,pts:b,dts:c,units:[],debug:d,length:0}}function yc(a){let b=0;let c;let d,e,f=a.data;if(!a||0===a.size)return null;for(;19>f[0].length&&1<f.length;){var g=new Uint8Array(f[0].length+f[1].length);g.set(f[0]);g.set(f[1],f[0].length);f[0]=g;f.splice(1,1)}g=f[0];if(1===(g[0]<<16)+(g[1]<<8)+g[2]){if((c=(g[4]<<8)+g[5])&&c>a.size-6)return null;var h=g[7];h&192&&(d=536870912*(g[9]&14)+4194304*(g[10]&255)+16384*(g[11]&254)+128*(g[12]&255)+(g[13]&254)/2,h&64?(e=
536870912*(g[14]&14)+4194304*(g[15]&255)+16384*(g[16]&254)+128*(g[17]&255)+(g[18]&254)/2,54E5<d-e&&(D.warn(`${Math.round((d-e)/9E4)}s delta between PTS and DTS, align them`),d=e)):e=d);h=g[8];let k=h+9;if(a.size<=k)return null;a.size-=k;a=new Uint8Array(a.size);for(let m=0,n=f.length;m<n;m++){g=f[m];let p=g.byteLength;if(k)if(k>p){k-=p;continue}else g=g.subarray(k),p-=k,k=0;a.set(g,b);b+=p}c&&(c-=h+3);return{data:a,pts:d,dts:e,len:c}}return null}function cd(a,b){if(a.units.length&&a.frame){if(void 0===
a.pts){var c=b.samples;let d=c.length;if(d)c=c[d-1],a.pts=c.pts,a.dts=c.dts;else{b.dropped++;return}}b.samples.push(a)}a.debug.length&&D.log(a.pts+"/"+a.dts+":"+a.debug)}function Tg(a,b,c=1,d=!1){a=a*b*c;return d?Math.round(a):a}function Ls(a,b,c=1,d=!1){return Tg(a,b,1/c,d)}function dd(a,b=!1){return Tg(a,1E3,1/9E4,b)}function Ms(a,b=1){return Tg(a,9E4,1/b)}function eb(a,b){let c;if(null===b)return a;for(c=b<a?-8589934592:8589934592;4294967296<Math.abs(a-b);)a+=c;return a}function Ko(a,b,c,d){let e=
a.samples.length;if(e){var f=a.inputTimeScale;for(let g=0;g<e;g++){let h=a.samples[g];h.pts=eb(h.pts-c.baseTime*f/c.timescale,b*f)/f;h.dts=eb(h.dts-d.baseTime*f/d.timescale,b*f)/f}b=a.samples;a.samples=[];return{samples:b}}}function Lo(a,b,c){let d=a.samples.length;if(d){var e=a.inputTimeScale;for(let f=0;f<d;f++){let g=a.samples[f];g.pts=eb(g.pts-c.baseTime*e/c.timescale,b*e)/e}a.samples.sort((f,g)=>f.pts-g.pts);b=a.samples;a.samples=[];return{samples:b}}}function Mo(a,b){return(a=null==a?void 0:
a.codec)&&4<a.length?a:"hvc1"===a||"hev1"===a?"hvc1.1.6.L120.90":"av01"===a?"av01.0.04M.08":"avc1"===a||b===oa.VIDEO?"avc1.42e01e":"mp4a.40.5"}function Ns(a,b){let c=null;0<a.byteLength&&null!=b&&null!=b.key&&null!==b.iv&&null!=b.method&&(c=b);return c}function ke(a){return"then"in a&&a.then instanceof Function}function No(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(!Os(a[c].attrs,b[c].attrs))return!1;return!0}function Os(a,b){let c=a["STABLE-RENDITION-ID"];return c?c===b["STABLE-RENDITION-ID"]:
!"LANGUAGE NAME CHARACTERISTICS AUTOSELECT DEFAULT FORCED".split(" ").some(d=>a[d]!==b[d])}function Ug(a){let b=[];for(let c=0;c<a.length;c++){let d=a[c];"subtitles"!==d.kind&&"captions"!==d.kind||!d.label||b.push(a[c])}return b}function Oo(a){return(a=a.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/))?59<parseFloat(a[2])?3600*(a[2]|0)+60*(a[3]|0)+parseFloat(a[4]||0):3600*(a[1]|0)+60*(a[2]|0)+(a[3]|0)+parseFloat(a[4]||0):null}function Po(a,b,c,d){a=d?a.split(d):[a];for(let e in a)"string"===typeof a[e]&&
(d=a[e].split(c),2===d.length&&b(d[0],d[1]))}function Ps(a,b,c){function d(){let g=Oo(a);if(null===g)throw Error("Malformed timestamp: "+f);a=a.replace(/^[^\sa-zA-Z-]+/,"");return g}function e(){a=a.replace(/^\s+/,"")}let f=a;e();b.startTime=d();e();if("--\x3e"!==a.slice(0,3))throw Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+f);a=a.slice(3);e();b.endTime=d();e();(function(g,h){let k=new Qs;Po(g,function(m,n){switch(m){case "region":for(let p=c.length-1;0<=p;p--)if(c[p].id===
n){k.set(m,c[p].region);break}break;case "vertical":k.alt(m,n,["rl","lr"]);break;case "line":n=n.split(",");k.integer(m,n[0]);k.percent(m,n[0])&&k.set("snapToLines",!1);k.alt(m,n[0],["auto"]);2===n.length&&k.alt("lineAlign",n[1],["start",le,"end"]);break;case "position":n=n.split(",");k.percent(m,n[0]);2===n.length&&k.alt("positionAlign",n[1],["start",le,"end","line-left","line-right","auto"]);break;case "size":k.percent(m,n);break;case "align":k.alt(m,n,["start",le,"end","left","right"])}},/:/,/\s/);
h.region=k.get("region",null);h.vertical=k.get("vertical","");g=k.get("line","auto");"auto"===g&&-1===Vg.line&&(g=-1);h.line=g;h.lineAlign=k.get("lineAlign","start");h.snapToLines=k.get("snapToLines",!0);h.size=k.get("size",100);h.align=k.get("align",le);g=k.get("position","auto");"auto"===g&&50===Vg.position&&(g="start"===h.align||"left"===h.align?0:"end"===h.align||"right"===h.align?100:50);h.position=g})(a,b)}function Wg(a,b,c){return Xg(a.toString())+Xg(b.toString())+Xg(c)}function Rs(a,b,c,d,
e,f,g){let h=new Ss;a=rb(new Uint8Array(a)).trim().replace(Ts,"\n").split("\n");let k=[],m=b?Ms(b.baseTime,b.timescale):0,n="00:00.000",p=0,r=0,w,z=!0;h.oncue=function(x){var B=c[d],E=c.ccOffset,C=(p-m)/9E4;if(null!=B&&B.new)if(void 0!==r)E=c.ccOffset=B.start;else{{B=c[d];let F=c[B.prevCC];if(!F||!F.new&&B.new)c.ccOffset=c.presentationOffset=B.start,B.new=!1;else{for(;null!=(I=F)&&I.new;){var I;c.ccOffset+=B.start-F.start;B.new=!1;B=F;F=c[B.prevCC]}c.presentationOffset=C}}}if(C){if(!b){w=Error("Missing initPTS for VTT MPEGTS");
return}E=C-c.presentationOffset}C=x.endTime-x.startTime;E=eb(9E4*(x.startTime+E-r),9E4*e)/9E4;x.startTime=Math.max(E,0);x.endTime=Math.max(E+C,0);E=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(E));x.id||(x.id=Wg(x.startTime,x.endTime,E));0<x.endTime&&k.push(x)};h.onparsingerror=function(x){w=x};h.onflush=function(){w?g(w):f(k)};a.forEach(x=>{if(z){if(Yg(x,"X-TIMESTAMP-MAP=")){z=!1;x.slice(16).split(",").forEach(B=>{Yg(B,"LOCAL:")?n=B.slice(6):Yg(B,"MPEGTS:")&&(p=parseInt(B.slice(7)))});
try{r=Us(n)/1E3}catch(B){w=B}return}""===x&&(z=!1)}h.parse(x+"\n")});h.flush()}function Qo(a,b,c,d){a=ka(new Uint8Array(a),["mdat"]);if(0===a.length)d(Error("Could not parse IMSC1 mdat"));else{a=a.map(f=>rb(f));var e=Ls(b.baseTime,1,b.timescale);try{a.forEach(f=>c(Vs(f,e)))}catch(f){d(f)}}}function Vs(a,b){let c=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("tt")[0];if(!c)throw Error("Invalid ttml");let d={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},e=Object.keys(d).reduce((k,
m)=>{k[m]=c.getAttribute(`ttp:${m}`)||d[m];return k},{}),f="preserve"!==c.getAttribute("xml:space"),g=Ro(Zg(c,"styling","style")),h=Ro(Zg(c,"layout","region"));a=Zg(c,"body","[begin]");return[].map.call(a,k=>{var m=So(k,f);if(!m||!k.hasAttribute("begin"))return null;var n=$g(k.getAttribute("begin"),e),p=$g(k.getAttribute("dur"),e);let r=$g(k.getAttribute("end"),e);if(null===n)throw To(k);if(null===r){if(null===p)throw To(k);r=n+p}m=new ah(n-b,r-b,m);m.id=Wg(m.startTime,m.endTime,m.text);n=h[k.getAttribute("region")];
k=g[k.getAttribute("style")];k=Ws(n,k,g);({textAlign:n}=k);if(n){if(p=Xs[n])m.lineAlign=p;m.align=n}Ga(m,k);return m}).filter(k=>null!==k)}function Zg(a,b,c){return(a=a.getElementsByTagName(b)[0])?[].slice.call(a.querySelectorAll(c)):[]}function Ro(a){return a.reduce((b,c)=>{let d=c.getAttribute("xml:id");d&&(b[d]=c);return b},{})}function So(a,b){return[].slice.call(a.childNodes).reduce((c,d,e)=>{var f;return"br"===d.nodeName&&e?c+"\n":null!=(f=d.childNodes)&&f.length?So(d,b):b?c+d.textContent.trim().replace(/\s+/g,
" "):c+d.textContent},"")}function Ws(a,b,c){let d=null,e=null!=a&&a.hasAttribute("style")?a.getAttribute("style"):null;e&&c.hasOwnProperty(e)&&(d=c[e]);return"displayAlign textAlign color backgroundColor fontSize fontFamily".split(" ").reduce((f,g)=>{let h=bh(b,"http://www.w3.org/ns/ttml#styling",g)||bh(a,"http://www.w3.org/ns/ttml#styling",g)||bh(d,"http://www.w3.org/ns/ttml#styling",g);h&&(f[g]=h);return f},{})}function bh(a,b,c){return a?a.hasAttributeNS(b,c)?a.getAttributeNS(b,c):null:null}function To(a){return Error(`Could not parse ttml timestamp ${a}`)}
function $g(a,b){if(!a)return null;let c=Oo(a);null===c&&(Uo.test(a)?(a=Uo.exec(a),c=3600*(a[1]|0)+60*(a[2]|0)+(a[3]|0)+((a[4]|0)+(a[5]|0)/b.subFrameRate)/b.frameRate):Vo.test(a)&&(c=Ys(a,b)));return c}function Ys(a,b){a=Vo.exec(a);let c=Number(a[1]);switch(a[2]){case "h":return 3600*c;case "m":return 60*c;case "ms":return 1E3*c;case "f":return c/b.frameRate;case "t":return c/b.tickRate}return c}function Wo(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}function Xo(a,b,c,d){a&&
Object.keys(b).forEach(e=>{let f=a.filter(g=>g.groupId===e).map(g=>{const h=Ga({},g);h.details=void 0;h.attrs=new Aa(h.attrs);h.url=h.attrs.URI=Yo(g.url,g.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",c);h.groupId=h.attrs["GROUP-ID"]=b[e];h.attrs["PATHWAY-ID"]=d;return h});a.push(...f)})}function Yo(a,b,c,d){let {HOST:e,PARAMS:f,[c]:g}=d,h;b&&(h=null==g?void 0:g[b])&&(a=h);let k=new self.URL(a);e&&!h&&(k.host=e);f&&Object.keys(f).sort().forEach(m=>{m&&k.searchParams.set(m,f[m])});return k.href}
function Zs(a,b){b={method:"GET",mode:"cors",credentials:"same-origin",signal:b,headers:new self.Headers(Ga({},a.headers))};a.rangeEnd&&b.headers.set("Range","bytes="+a.rangeStart+"-"+String(a.rangeEnd-1));return b}function $s(a){var b=a.get("Content-Range");if(b&&(b=(b=at.exec(b))?parseInt(b[2])-parseInt(b[1])+1:void 0,Y(b)))return b;if(a=a.get("Content-Length"))return parseInt(a)}function bt(a,b){return new self.Request(a.url,b)}function ct(a,b){if((b.liveSyncDurationCount||b.liveMaxLatencyDurationCount)&&
(b.liveSyncDuration||b.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==b.liveMaxLatencyDurationCount&&(void 0===b.liveSyncDurationCount||b.liveMaxLatencyDurationCount<=b.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==b.liveMaxLatencyDuration&&(void 0===b.liveSyncDuration||
b.liveMaxLatencyDuration<=b.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let c=ch(a),d=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];["manifest","level","frag"].forEach(e=>{let f=`${"level"===e?"playlist":e}LoadPolicy`,g=void 0===b[f],h=[];d.forEach(k=>{var m=`${e}Loading${k}`;let n=b[m];if(void 0!==n&&g)switch(h.push(m),m=c[f].default,b[f]={default:m},k){case "TimeOut":m.maxLoadTimeMs=n;m.maxTimeToFirstByteMs=n;break;
case "MaxRetry":m.errorRetry.maxNumRetry=n;m.timeoutRetry.maxNumRetry=n;break;case "RetryDelay":m.errorRetry.retryDelayMs=n;m.timeoutRetry.retryDelayMs=n;break;case "MaxRetryTimeout":m.errorRetry.maxRetryDelayMs=n,m.timeoutRetry.maxRetryDelayMs=n}});h.length&&D.warn(`hls.js config: "${h.join('", "')}" setting(s) are deprecated, use "${f}": ${JSON.stringify(b[f])}`)});return Xa(Xa({},c),b)}function ch(a){return a&&"object"===typeof a?Array.isArray(a)?a.map(ch):Object.keys(a).reduce((b,c)=>{b[c]=ch(a[c]);
return b},{}):a}window.adthrive.buildDate="2024-05-01";let Sd=new WeakMap;Object.assign(Reflect,{decorate:function(a,b,c,d){if(!Array.isArray(a)||0===a.length)throw new TypeError;if(void 0!==c)return xr(a,b,c,d);if("function"===typeof b)return yr(a,b)},defineMetadata:function(a,b,c,d){Cn(a,b,c,d)},getMetadata:function(a,b,c){return sg(a,b,c)},getOwnMetadata:function(a,b,c){return Td(a,b,c)},hasMetadata:function(a,b,c){return!!sg(a,b,c)},hasOwnMetadata:function(a,b,c){return!!Td(a,b,c)},metadata:function(a,
b){return function(c,d){Cn(a,b,c,d)}}});var dh;(function(a){a[a.Transient=0]="Transient";a[a.Singleton=1]="Singleton";a[a.ResolutionScoped=2]="ResolutionScoped";a[a.ContainerScoped=3]="ContainerScoped"})(dh||(dh={}));var $a=dh,ug=function(a,b){ug=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,d){c.__proto__=d}||function(c,d){for(var e in d)d.hasOwnProperty(e)&&(c[e]=d[e])};return ug(a,b)},Zo=function(){function a(b){this.wrap=b;this.reflectMethods="get getPrototypeOf setPrototypeOf getOwnPropertyDescriptor defineProperty has set deleteProperty apply construct ownKeys".split(" ")}
a.prototype.createProxy=function(b){var c=this,d=!1,e;return new Proxy({},this.createHandler(function(){d||(e=b(c.wrap()),d=!0);return e}))};a.prototype.createHandler=function(b){var c={};this.reflectMethods.forEach(function(d){c[d]=function(){for(var e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];e[0]=b();return Reflect[d].apply(void 0,ac(e))}});return c};return a}(),eh=function(){function a(){this._registryMap=new Map}a.prototype.entries=function(){return this._registryMap.entries()};a.prototype.getAll=
function(b){this.ensure(b);return this._registryMap.get(b)};a.prototype.get=function(b){this.ensure(b);b=this._registryMap.get(b);return b[b.length-1]||null};a.prototype.set=function(b,c){this.ensure(b);this._registryMap.get(b).push(c)};a.prototype.setAll=function(b,c){this._registryMap.set(b,c)};a.prototype.has=function(b){this.ensure(b);return 0<this._registryMap.get(b).length};a.prototype.clear=function(){this._registryMap.clear()};a.prototype.ensure=function(b){this._registryMap.has(b)||this._registryMap.set(b,
[])};return a}(),dt=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}tg(b,a);return b}(eh),$o=function(){return function(){this.scopedResolutions=new Map}}(),et=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}tg(b,a);return b}(eh),ft=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}tg(b,a);return b}(eh),gt=function(){return function(){this.preResolution=new et;this.postResolution=new ft}}(),En=new Map,S=new (function(){function a(b){this.parent=
b;this._registry=new dt;this.interceptors=new gt;this.disposed=!1;this.disposables=new Set}a.prototype.register=function(b,c,d){void 0===d&&(d={lifecycle:$a.Transient});this.ensureNotDisposed();c=c.useClass||void 0!=c.useValue||c.useToken||c.useFactory?c:{useClass:c};if(c.useToken)for(var e=[b],f=c;null!=f;){f=f.useToken;if(e.includes(f))throw Error("Token registration cycle detected! "+ac(e,[f]).join(" -> "));e.push(f);f=(f=this._registry.get(f))&&f.provider.useToken?f.provider:null}if(d.lifecycle===
$a.Singleton||d.lifecycle==$a.ContainerScoped||d.lifecycle==$a.ResolutionScoped)if(void 0!=c.useValue||c.useFactory)throw Error('Cannot use lifecycle "'+$a[d.lifecycle]+'" with ValueProviders or FactoryProviders');this._registry.set(b,{provider:c,options:d});return this};a.prototype.registerType=function(b,c){this.ensureNotDisposed();return sc(c)?this.register(b,{useToken:c}):this.register(b,{useClass:c})};a.prototype.registerInstance=function(b,c){this.ensureNotDisposed();return this.register(b,
{useValue:c})};a.prototype.registerSingleton=function(b,c){this.ensureNotDisposed();if(sc(b)){if(sc(c))return this.register(b,{useToken:c},{lifecycle:$a.Singleton});if(c)return this.register(b,{useClass:c},{lifecycle:$a.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token');}var d=b;c&&!sc(c)&&(d=c);return this.register(b,{useClass:d},{lifecycle:$a.Singleton})};a.prototype.resolve=function(b,c){void 0===c&&(c=new $o);this.ensureNotDisposed();var d=this.getRegistration(b);
if(!d&&sc(b))throw Error('Attempted to resolve unregistered dependency token: "'+b.toString()+'"');this.executePreResolutionInterceptor(b,"Single");if(d)return c=this.resolveRegistration(d,c),this.executePostResolutionInterceptor(b,c,"Single"),c;if("function"===typeof b||b instanceof Zo)return c=this.construct(b,c),this.executePostResolutionInterceptor(b,c,"Single"),c;throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.");
};a.prototype.executePreResolutionInterceptor=function(b,c){var d;if(this.interceptors.preResolution.has(b)){var e=[];try{for(var f=Ud(this.interceptors.preResolution.getAll(b)),g=f.next();!g.done;g=f.next()){var h=g.value;"Once"!=h.options.frequency&&e.push(h);h.callback(b,c)}}catch(m){var k={error:m}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(k)throw k.error;}}this.interceptors.preResolution.setAll(b,e)}};a.prototype.executePostResolutionInterceptor=function(b,c,d){var e;if(this.interceptors.postResolution.has(b)){var f=
[];try{for(var g=Ud(this.interceptors.postResolution.getAll(b)),h=g.next();!h.done;h=g.next()){var k=h.value;"Once"!=k.options.frequency&&f.push(k);k.callback(b,c,d)}}catch(n){var m={error:n}}finally{try{h&&!h.done&&(e=g.return)&&e.call(g)}finally{if(m)throw m.error;}}this.interceptors.postResolution.setAll(b,f)}};a.prototype.resolveRegistration=function(b,c){this.ensureNotDisposed();if(b.options.lifecycle===$a.ResolutionScoped&&c.scopedResolutions.has(b))return c.scopedResolutions.get(b);var d=b.options.lifecycle===
$a.ContainerScoped;d=b.options.lifecycle===$a.Singleton||d;d=void 0!=b.provider.useValue?b.provider.useValue:b.provider.useToken?d?b.instance||(b.instance=this.resolve(b.provider.useToken,c)):this.resolve(b.provider.useToken,c):b.provider.useClass?d?b.instance||(b.instance=this.construct(b.provider.useClass,c)):this.construct(b.provider.useClass,c):b.provider.useFactory?b.provider.useFactory(this):this.construct(b.provider,c);b.options.lifecycle===$a.ResolutionScoped&&c.scopedResolutions.set(b,d);
return d};a.prototype.resolveAll=function(b,c){var d=this;void 0===c&&(c=new $o);this.ensureNotDisposed();var e=this.getAllRegistrations(b);if(!e&&sc(b))throw Error('Attempted to resolve unregistered dependency token: "'+b.toString()+'"');this.executePreResolutionInterceptor(b,"All");if(e)return e=e.map(function(f){return d.resolveRegistration(f,c)}),this.executePostResolutionInterceptor(b,e,"All"),e;e=[this.construct(b,c)];this.executePostResolutionInterceptor(b,e,"All");return e};a.prototype.isRegistered=
function(b,c){void 0===c&&(c=!1);this.ensureNotDisposed();return this._registry.has(b)||c&&(this.parent||!1)&&this.parent.isRegistered(b,!0)};a.prototype.reset=function(){this.ensureNotDisposed();this._registry.clear();this.interceptors.preResolution.clear();this.interceptors.postResolution.clear()};a.prototype.clearInstances=function(){var b;this.ensureNotDisposed();try{for(var c=Ud(this._registry.entries()),d=c.next();!d.done;d=c.next()){var e=Vd(d.value,2);this._registry.setAll(e[0],e[1].filter(function(g){return void 0==
g.provider.useValue}).map(function(g){g.instance=void 0;return g}))}}catch(g){var f={error:g}}finally{try{d&&!d.done&&(b=c.return)&&b.call(c)}finally{if(f)throw f.error;}}};a.prototype.createChildContainer=function(){var b;this.ensureNotDisposed();var c=new a(this);try{for(var d=Ud(this._registry.entries()),e=d.next();!e.done;e=d.next()){var f=Vd(e.value,2),g=f[0],h=f[1];h.some(function(m){return m.options.lifecycle===$a.ContainerScoped})&&c._registry.setAll(g,h.map(function(m){return m.options.lifecycle===
$a.ContainerScoped?{provider:m.provider,options:m.options}:m}))}}catch(m){var k={error:m}}finally{try{e&&!e.done&&(b=d.return)&&b.call(d)}finally{if(k)throw k.error;}}return c};a.prototype.beforeResolution=function(b,c,d){void 0===d&&(d={frequency:"Always"});this.interceptors.preResolution.set(b,{callback:c,options:d})};a.prototype.afterResolution=function(b,c,d){void 0===d&&(d={frequency:"Always"});this.interceptors.postResolution.set(b,{callback:c,options:d})};a.prototype.dispose=function(){return zr(this,
void 0,void 0,function(){var b;return Ar(this,function(c){switch(c.label){case 0:return this.disposed=!0,b=[],this.disposables.forEach(function(d){(d=d.dispose())&&b.push(d)}),[4,Promise.all(b)];case 1:return c.sent(),[2]}})})};a.prototype.getRegistration=function(b){return this.isRegistered(b)?this._registry.get(b):this.parent?this.parent.getRegistration(b):null};a.prototype.getAllRegistrations=function(b){return this.isRegistered(b)?this._registry.getAll(b):this.parent?this.parent.getAllRegistrations(b):
null};a.prototype.construct=function(b,c){var d=this;if(b instanceof Zo)return b.createProxy(function(f){return d.resolve(f,c)});var e=function(){var f=En.get(b);if(!f||0===f.length){if(0===b.length)return new b;throw Error('TypeInfo not known for "'+b.name+'"');}f=f.map(d.resolveParams(c,b));return new (b.bind.apply(b,ac([void 0],f)))}();"function"!==typeof e.dispose||0<e.dispose.length||this.disposables.add(e);return e};a.prototype.resolveParams=function(b,c){var d=this;return function(e,f){var g,
h,k;try{return"object"===typeof e&&"token"in e&&"multiple"in e?Dn(e)?e.multiple?(g=d.resolve(e.transform)).transform.apply(g,ac([d.resolveAll(e.token)],e.transformArgs)):(h=d.resolve(e.transform)).transform.apply(h,ac([d.resolve(e.token,b)],e.transformArgs)):e.multiple?d.resolveAll(e.token):d.resolve(e.token,b):Dn(e)?(k=d.resolve(e.transform,b)).transform.apply(k,ac([d.resolve(e.token,b)],e.transformArgs)):d.resolve(e,b)}catch(m){throw e=Error,g=m,h=Vd(c.toString().match(/constructor\(([\w, ]+)\)/)||
[],2)[1],h=void 0===h?null:h,f=null===h?"at position #"+f:'"'+h.split(",")[f].trim()+'" at position #'+f,f=Cr("Cannot inject the dependency "+f+' of "'+c.name+'" constructor. Reason:',g),new e(f);}}};a.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container");};return a}());if("undefined"===typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");
"function"===typeof SuppressedError?SuppressedError:function(a,b,c){c=Error(c);return c.name="SuppressedError",c.error=a,c.suppressed=b,c};class ap{}let me=class extends ap{constructor(){super(...arguments);this.name="StorageHandler";this.disable=!1;this.gdprPurposes=[1];this._storageHandlerQueue=[];this._shouldQueue=!1;this.removeLocalStorageValue=(a,b=!0)=>{window.localStorage.removeItem(`${b?"adthrive_":""}${a.toLowerCase()}`)};this.getLocalStorageValue=(a,b=!0,c=!0,d,e)=>{let f=b?"adthrive_":
"";if(this.disable)return null;c=c?a.toLowerCase():a;try{let g=window.localStorage.getItem(`${f}${c}`);if(g){let h=JSON.parse(g),k=void 0!==d&&Date.now()-h.created>=d;if(h&&!k)return e&&this.setLocalStorageValue(a,h.value,b),h.value}}catch(g){return window.localStorage.getItem(`${f}${c}`)}return null};this.setLocalStorageValue=(a,b,c=!0)=>{try{c=c?"adthrive_":"";let d={value:b,created:Date.now()};if(this._gdpr&&this._shouldQueue){let e={key:`${c}${a.toLowerCase()}`,value:d};this._storageHandlerQueue.push(e)}else window.localStorage.setItem(`${c}${a.toLowerCase()}`,
JSON.stringify(d))}catch(d){}};this.isValidABGroupLocalStorageValue=a=>void 0!==a&&null!==a&&!("number"===typeof a&&isNaN(a));this.getOrSetLocalStorageValue=(a,b)=>{let {key:c,timeout:d,lowercase:e=!0,rolling:f=!0,cb:g,adthriveKey:h}=a;a=this.getLocalStorageValue(c,h,e,d,f);if(null!==a)return a;b=b();this.setLocalStorageValue(c,b,h);g&&g(b);return b};this.getOrSetABGroupLocalStorageValue=(a,b,c,d=!0,e)=>{c=this.getLocalStorageValue("abgroup",!0,!0,c,d);if(null!==c&&(d=c[a],this.isValidABGroupLocalStorageValue(d)))return d;
b=b();this.setLocalStorageValue("abgroup",{...c,[a]:b});e&&e();return b}}init(a){this._shouldQueue=this._gdpr="true"===a.gdpr}clearQueue(a){a&&(this._shouldQueue=!1,this._storageHandlerQueue.forEach(b=>{if("adthrive_abgroup"===b.key){let c=Object.keys(b.value.value)[0],d=b.value.value[c];this.getOrSetABGroupLocalStorageValue(c,()=>d)}else window.localStorage.setItem(b.key,JSON.stringify(b.value))}));this._storageHandlerQueue=[]}setSessionFpv(){this.setLocalStorageValue("session_fpv",null===this.getLocalStorageValue("session_fpv")?
!0:!1)}};me=q([y()],me);let U=new me,fh=class{constructor(){this.emitters=new Set}};fh=q([y()],fh);let gh=S.resolve(fh).emitters;class L{constructor(){this._listeners=new Set;this._emitted=0;this._onces=[]}on(a){this._listeners.add(a);return()=>{this.off(a)}}off(a){this._listeners.delete(a)}once(a,b=!0){let c=this.on((...d)=>{c();a(...d)});b&&(this._onces.push(()=>this.once(a,!1)),this._trackStatefulEmitter())}legacyOnce(){return new Promise(a=>{let b=this.on((...c)=>{b();return a(...c)})})}_trackStatefulEmitter(){gh.add(this)}async legacyEmit(a){return Promise.all([...this._listeners].map(b=>
b(a))).then(b=>{this._emitted++;return b})}emit(a){[...this._listeners].forEach(b=>b(a));this._emitted++;this._trackStatefulEmitter()}clear(){this._listeners.clear()}resetEmitted(){this._emitted=0}resetOnces(){this._onces.forEach(a=>a())}get count(){return this._listeners.size}get emitted(){return this._emitted}get onces(){return this._onces}}class ab extends L{constructor(){super(...arguments);this._pastEvents=[]}on(a,b){this._listeners.add(a);(null===b||void 0===b?0:b.handleEventsAlreadyEmitted)&&
this._pastEvents.forEach(a);return()=>{this.off(a)}}async legacyEmit(a){this._pastEvents.push(a);return Promise.all([...this._listeners].map(b=>b(a))).then(b=>{this._emitted++;return b})}emit(a){this._pastEvents.push(a);[...this._listeners].forEach(b=>b(a));this._emitted++;this._trackStatefulEmitter()}_trackStatefulEmitter(){gh.add(this)}}let Ma=class{};Ma=q([y()],Ma);let ed=class extends Ma{constructor(){super(...arguments);this.dialDownLogs=new L;this.newContextDataEncodingSize=new L}};ed=q([y()],
ed);let ne=class extends ap{constructor(){super();this.name="Logger";this.gdprPurposes=[7];this._shouldQueue=this.disable=!1;this._data={abgroup:{key:"adslogger-err"},pubab:{key:"adslogger-err"},sess:"adslogger-err",pvk:"adslogger-err",hbho:["adslogger-err"],vbho:["adslogger-err"],spa:!1};this.sending=new L;this.logQueue=[];this.suppressedEventLogNames=new Map([["SlotRenderEnded","adImpression"],["VideoUtils","getPlacementElement"],["PrebidAuctionManager","_logAuctionDebug"],["PrebidAuctionManager",
"init"]]);this.maxCloudFrontUrlSize=8192;this.loggerEventBus=S.resolve(ed)}init(a){this.logFilter=a.loggerFilters||[];this.siteId=a.siteAds.siteId;this.siteName=a.siteAds.siteName;this.bucket=a.bucket;this.branch=a.branch;this.deployment=a.deployment;this.debug=a.debug;this._shouldQueue=this._gdpr="true"===a.gdpr;this._setLoggerExperiments()}_setLoggerExperiments(){this.loggerEventBus.dialDownLogs.on(({result:a,choices:b})=>{this._dialDownLogsExperimentResult=a;this._dialDownLogsExperimentChoices=
b})}_isDialedDownLog(a){let b=this._dialDownLogsExperimentResult||[];return a.some(c=>"string"===typeof c&&b.some(d=>-1<c.toLowerCase().indexOf(d.toLowerCase())))}_dialedDownChoice(a){var b;return null===(b=this._dialDownLogsExperimentChoices)||void 0===b?void 0:b.filter(({choice:c})=>"string"===typeof c&&a.some(d=>"string"===typeof d&&-1<d.toLowerCase().indexOf(c.toLowerCase()))).map(({weight:c})=>c)}log(a,b,...c){this.call(console.log,a,b,...c)}info(a,b,...c){this.call(console.info,a,b,...c)}warn(a,
b,...c){this.call(console.warn,a,b,...c)}_getLogToCheck(a){let b=a&&a[1]&&a[1].arguments&&a[1].arguments[0];return b?[b]:a}error(a,b,...c){this.shouldLog(a,b)&&this.call(console.error,a,b,...c);var d=this._getLogToCheck(c);this._isDialedDownLog(d)||((d=this._dialedDownChoice(d))&&d.length&&c.push(`Sampled at ${100-d[0]} percent`),this.makeRequest("send","error",a,b,...c).catch(e=>{this.shouldLog(a,b)&&console.error(e)}))}shouldLog(a,b){return!!this.debug&&!this.suppressedEventLogNames.has(a)&&this.suppressedEventLogNames.get(a)!==
b}event(a,b,...c){this.shouldLog(a,b)&&this.call(console.log,a,b,...c);this.makeRequest("send","event",a,b,...c).catch(d=>{console.error(d)})}fetchEvent(a,b,...c){this.debug&&this.call(console.log,a,b,...c);this.makeRequest("fetch","event",a,b,...c).catch(d=>{console.error(d)})}call(a,b,c,...d){let e=this.logFilter;if(!(e&&e.length&&e.includes(b))){b=[`%c${b}::${c} `];c=["color: #999; font-weight: bold;"];0<d.length&&"string"===typeof d[0]&&b.push(d.shift());c.push(...d);try{Function.prototype.apply.call(a,
console,[b.join(""),...c])}catch(f){console.error(f)}}}buildRequestUrl(a,b,c,d){a=`https://logger.adthrive.com/${a}`;b=[`${b}::${c} `];0<d.length&&"string"===typeof d[0]&&b.push(d.shift());d=d.map(e=>{e&&e.error&&(e=e.error);e instanceof Error&&(e={name:e.name,message:e.message,stack:e.stack});return e});this._data&&d.push(this._data);d=[`siteId=${encodeURIComponent(this.siteId||"")}`,`siteName=${encodeURIComponent(this.siteName||"")}`,`bucket=${encodeURIComponent(this.bucket||"")}`,`branch=${encodeURIComponent(this.branch||
"")}`,`deployment=${encodeURIComponent(this.deployment||"")}`,`message=${encodeURIComponent(b.join("").trim())}`,`pageurl=${encodeURIComponent(window.location.origin+window.location.pathname)}`,`body=${encodeURIComponent(JSON.stringify(d))}`];return`${a}?${d.join("&")}`}clearQueue(a){a&&(this._shouldQueue=!1,this.logQueue.forEach(b=>{"send"===b.action&&this.sendRequest(b.type,b.className,b.methodName,...b.args).catch(()=>{});"fetch"===b.action&&this.fetchRequest(b.type,b.className,b.methodName,...b.args).catch(()=>
{})}));this.logQueue=[]}async makeRequest(a,b,c,d,...e){return this.disable?Promise.resolve(!1):this._gdpr&&this._shouldQueue?(this.logQueue.push({action:a,type:b,className:c,methodName:d,args:e}),Promise.resolve(!0)):"send"===a?this.sendRequest(b,c,d,...e):this.fetchRequest(b,c,d,...e)}async sendRequest(a,b,c,...d){this.sending.emit();let e=this.buildRequestUrl(a,b,c,d);return e.length>this.maxCloudFrontUrlSize?this.sendRequest(a,b,c,"Payload too large. Logger cannot send").catch(f=>{console.error(f)}):
new Promise((f,g)=>{let h=new XMLHttpRequest;h.open("get",e);let k="logger"===b&&"sendRequest"===c;h.addEventListener("load",()=>200!==h.status?(k||this.error("logger","sendRequest",...d,{className:b,methodName:c}),g(Error(`Logger send request failed ${h.status}`))):f(h.responseText));h.addEventListener("error",()=>{k||this.error("logger","sendRequest",...d,{className:b,methodName:c});return g(Error("Logger send request failed"))});h.send()})}async fetchRequest(a,b,c,...d){this.sending.emit();a=this.buildRequestUrl(a,
b,c,d);return fetch(a,{method:"GET",keepalive:!0,referrerPolicy:"no-referrer-when-downgrade"})}get data(){return this._data}set data(a){this._data=a;this.loggerEventBus.newContextDataEncodingSize.emit(encodeURIComponent(JSON.stringify(this._data)).length)}};ne=q([H(),t("design:paramtypes",[])],ne);let A=new ne;class ht{constructor(a){this._wait=a;this._timeouts=new Map}async limit(a){return new Promise(b=>{this._timeouts.has(a)&&window.clearTimeout(this._timeouts.get(a));let c=window.setTimeout(()=>
{b()},this._wait);this._timeouts.set(a,c)})}}let hh=class extends ne{};hh=q([H()],hh);let gc=new hh,hc={percent:1,flat:0},ih=hc.flat,jh=hc.percent,it=[.1,5,20,100],jt=new Map([[.1,100],[5,20],[20,10],[100,2]]),oe=(a,b,c)=>{var d,e,f,g,h,k;const m=+(null!==(d=null===a||void 0===a?void 0:a.percent)&&void 0!==d?d:jh);a=+(null!==(e=null===a||void 0===a?void 0:a.flat)&&void 0!==e?e:ih);e=+(null!==(f=null===b||void 0===b?void 0:b.percent)&&void 0!==f?f:jh);b=+(null!==(g=null===b||void 0===b?void 0:b.flat)&&
void 0!==g?g:ih);c&&(g=+(null!==(h=c.percent)&&void 0!==h?h:jh),c=+(null!==(k=c.flat)&&void 0!==k?k:ih),e*=g,b+=c);return{percent:e*m,flat:b+a}},bp=(a,b,c)=>{const {percent:d,flat:e}=oe(a,b);return c*d-e},cp=(a,b)=>{var c,d,e,f;return{percent:Number(null!==(c=a.percent)&&void 0!==c?c:1)*Number(null!==(d=b.percent)&&void 0!==d?d:1),flat:Number(null!==(e=a.flat)&&void 0!==e?e:0)+Number(null!==(f=b.flat)&&void 0!==f?f:0)}},pe=(a,b,c,d=!0)=>{var e=c&&c.mediaType||"default";d&&(c.dealId&&"prebid"===b?
e="pmp":(d=c&&c.adUnitCode||"",e=a.video.instreamAdUnits.has(d),d=d.includes("Video_StickyOutstream"),c=!e&&!d&&("vastUrl"in c||"vastXml"in c),e=e?"instream":d?"stickyOutstream":c?"outstream":"default"));return(c=a.partners.getBidderConfig(b))?c.cpmMap.get(a.partners.getBidderConfig(b).cpmMap.has(e)?e:"default"):hc},kh=(a,b,c,d=!0)=>{var e,f,g=c&&c.mediaType||"default";if(d){d=c&&c.adUnitCode||"";g=a.video.instreamAdUnits.has(d);d=d.includes("Video_StickyOutstream");const h=(null===(e=null===c||void 0===
c?void 0:c.meta)||void 0===e?void 0:e.isInBannerVideo)||!g&&!d&&("vastUrl"in c||"vastXml"in c);g=g?"instream":d?"stickyOutstream":h?"outstream":"default"}b=b?b:c.bidderCode;if(null===(f=null===c||void 0===c?void 0:c.meta)||void 0===f?0:f.isInBannerVideo)g="outstream";return(c=a.partners.getBidderConfig(b))?c.cpmMap.get(a.partners.getBidderConfig(b).cpmMap.has(g)?g:"default"):hc},lh=(a,b,c,d)=>{var e,f,g,h;const k=!d.isAmazon,m=k?null===d||void 0===d?void 0:d.dealId:d.amzndeal_sp,n=null===(g=a.partners.getBidderConfig(c).cpmMap)||
void 0===g?void 0:g.get("pmp");g=null===(h=null===n||void 0===n?void 0:n.deals)||void 0===h?void 0:h[m];const {isPrebid:p,dealId:r,pmpConfig:w,dealConfig:z}={isPrebid:k,dealId:m,pmpConfig:n,dealConfig:g};h=null!==(e=pe(a,"default",d,p))&&void 0!==e?e:{};e=null!==(f=pe(a,"prebid",d,p))&&void 0!==f?f:{};f=cp(h,e);if(r&&w)if(z){const {percent:x,flat:B}=oe(f,w,z);b=b*x-B}else b=bp(f,w,b);else a=kh(a,c,d,p),b=bp(f,a,b);return Math.max(b,0)},kt=(a,b,c,d=!1)=>{var e;a=null!==(e=pe(a,"default",c,!0))&&void 0!==
e?e:{};e=cp(a,{});return Math.max(d?(b+e.flat)/e.percent:b*e.percent-e.flat,0)},dp=(a,b,c,d,e=!1)=>{var f,g,h=null!==(f=kh(a,"default",c,!0))&&void 0!==f?f:{};f=null!==(g=pe(a,"prebid",c,!0))&&void 0!==g?g:{};g=kh(a,b,c);h=oe(h,g,{});const {percent:k,flat:m}=oe(h,f);b=a.prebid.s2s.bidders.includes(b);h=e?(d+m)/k:d*k-m;a=kt(a,d,c,e);return b?a:h},qe=a=>{var b=it.find(c=>a<=c)||100;b=jt.get(b);return(Math.floor(a*b)/b).toFixed(2)},re=(a,b,c,d,e)=>{var f;b={...b};b.mediaType=e;b.isAmazon=!0;b.amzndeal_sp=
(null===b||void 0===b?void 0:b.amzndeal_sp)||(null===(f=b.targeting)||void 0===f?void 0:f.amzndeal_sp);a=lh(a,d,c,b);return Math.max(a,0)},mh=navigator.vendor,Ca=navigator.userAgent,ic=(a,b)=>/Chrom/.test(a||Ca)&&/Google/.test(b||mh)&&!/Edge\/|Edg\//.test(a||Ca)&&!/Opera|OPR/.test(a||Ca),nh=(a,b)=>/Safari/.test(a||Ca)&&/Apple Computer/.test(b||mh)&&!/Edge\/|Edg\//.test(a||Ca)&&!/Opera|OPR/.test(a||Ca),ep=(a,b)=>ic(a,b)?"Chrome":nh(a,b)?"Safari":/Edge\/|Edg\//.test(a||Ca)?"Edge":/Firefox/.test(a||
Ca)?"Firefox":/Opera|OPR/.test(a||Ca)?"Opera":/Trident|MSIE/.test(a||Ca)?"IE":"Others",fp=(a,b)=>{b=ep(a||Ca,b||mh);if("Chrome"===b){a=a||Ca;b=a.indexOf("Chrom");if(-1!==b){b+=7;var c=a.indexOf(" ",b);a=a.substring(b,c)}else a=null;return a}if("Safari"===b)return a=a||Ca,b=a.indexOf("Version/"),-1!==b?(b+=8,c=a.indexOf(" ",b),a=a.substring(b,c)):(b=a.indexOf("Safari/"),-1!==b?(b+=7,c=a.indexOf(" ",b),a=a.substring(b,c)):a=null),a;if("Firefox"===b)return a=a||Ca,b=a.indexOf("Firefox/"),-1!==b?(b+=
8,c=a.indexOf(" ",b),-1===c&&(c=a.length),a=a.substring(b,c)):a=null,a;if("Edge"===b)return a=a||Ca,b=a.indexOf("Edg/"),-1!==b?(b+=4,c=a.indexOf(" ",b),-1===c&&(c=a.length),a=a.substring(b,c)):a=null,a;if("IE"===b)return a=a||Ca,b=a.indexOf("MSIE "),-1!==b?(b+=5,c=a.indexOf(";",b),-1===c&&(c=a.length),a=a.substring(b,c)):a=void 0,a;if("Opera"===b)return a=a||Ca,b=a.indexOf("OPR/"),-1!==b?(b+=4,c=a.indexOf(" ",b),a=a.substring(b,c)):a="Unknown",a},gp=(a=window.document)=>!!a.browsingTopics&&!!a.featurePolicy&&
a.featurePolicy.allowsFeature("browsing-topics"),lt=(a=window.document,b=window.navigator)=>!!b.joinAdInterestGroup&&!!a.featurePolicy&&a.featurePolicy.allowsFeature("join-ad-interest-group")&&a.featurePolicy.allowsFeature("run-ad-auction"),hp={"control_1.1":"disabled","control_1.2":"disabled","control_1.3":"disabled","control_1.4":"disabled",label_only_2:"experiment",label_only_3:"experiment",label_only_4:"enabled",label_only_5:"enabled",control_2:"disabled","treatment_1.1":"enabled","treatment_1.2":"enabled",
"treatment_1.3":"enabled",none:"experiment"},mt=a=>{const b=Object.keys(hp).find(c=>a===c||a.startsWith(c));return hp[null!==b&&void 0!==b?b:"none"]},se=(a,b=0,c=!1,d=74)=>{if(a.parentElement&&b!==d){var e=getComputedStyle(a.parentElement).overflow;if("hidden"===e||"auto"===e)a.parentElement.style.overflow="visible",c||(c=!0,A.event("util","checkForOverflow","parent element with overflow detected"));se(a.parentElement,++b,c,d)}},zc=()=>{const a=document.querySelector(".adthrive-footer");let b=52;
a&&"none"===a.style.display?b=102:a&&(b=Math.max(a.getBoundingClientRect().height,b));return b},Na=a=>{for(const b of document.cookie.split(";")){const [c,...d]=b.split("=");if(c.trim()===a)return d.join("=").trim()}return""},ip=a=>(a=Na(a))&&JSON.parse(a)||[],jp=a=>{Na(a)&&(document.cookie=`${a+"="}; SameSite=None; Secure; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC`)},ub=(a,b,c,d,e)=>{const f=document.createElement(a);b&&f.setAttribute("id",b);c&&(f.className=c);d&&(f.innerHTML=d);e&&(f.href=
e,"a"===a&&f.addEventListener("click",g=>{g.preventDefault()}));return f},Q=(a,b)=>null==a||a!==a?b:a,kp=a=>new Promise(b=>{setTimeout(b,a)}),te=(a,b)=>{const c=window.innerWidth;return c>=b?"desktop":c>=a?"tablet":"phone"},oh=()=>new Promise(a=>{if("interactive"===document.readyState||"complete"===document.readyState)return a();document.addEventListener("DOMContentLoaded",()=>a())}),ue=(a,b)=>!a.disableAds.locations.has(b.location)&&!a.disableAds.all,nt=a=>0===a.length||!a.split(",").some(b=>null!==
document.querySelector(b)),lp=a=>{let b=a.clientWidth;getComputedStyle&&(a=getComputedStyle(a,null),b-=parseFloat(a.paddingLeft||"0")+parseFloat(a.paddingRight||"0"));return b},ve=a=>{const b=a.offsetHeight,c=a.offsetWidth;var d=a.getBoundingClientRect();const e=document.body,f=document.documentElement;a=Math.round(d.top+(window.pageYOffset||f.scrollTop||e.scrollTop)-(f.clientTop||e.clientTop||0));d=Math.round(d.left+(window.pageXOffset||f.scrollLeft||e.scrollLeft)-(f.clientLeft||e.clientLeft||0));
return{top:a,left:d,bottom:a+b,right:d+c,width:c,height:b}},mp=(a,b=50)=>{a=a.getBoundingClientRect();return(a.bottom-(window.innerHeight||document.documentElement.clientHeight))/a.height*100>=b},np=(a,b=50)=>{a=a.getBoundingClientRect();return(0-a.top)/a.height*100>=b},op=a=>(a=a.match(/([a-zA-Z0-9._!#$%+^&*()[\]<>-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi))?a[0]:"",jc=(a=window.location.search)=>{const b=0===a.indexOf("?")?1:0;return a.slice(b).split("&").reduce((c,d)=>{const [e,f]=d.split("=");c.set(e,
f);return c},new Map)},ph=a=>a.split("&").reduce((b,c)=>{const [d,e]=c&&c.split("=");d&&e&&(b[d]=e);return b},{}),ot=a=>Object.keys(a).map(b=>`${b}=${encodeURIComponent(a[b])}`).join("&"),pp=a=>{let b={};const c=jc().get(a);if(c)try{const d=decodeURIComponent(c);b=JSON.parse(d);A.event("ExperimentOverridesUtil","getExperimentOverrides",a,b)}catch(d){}return b},Lb=(a,b,c)=>c.indexOf(a)===b,pt=(a,b)=>a.reduce((c,d)=>{const e=[];c.forEach(f=>{d.forEach(g=>{e.push(f+b+g)})});return e}).sort((c,d)=>c.split("*").length-
d.split("*").length),Ta=(a=navigator.userAgent)=>/Windows NT|Macintosh/i.test(a),Mb=(a=navigator.userAgent)=>/iP(hone|od|ad)/i.test(a),qt=(a=navigator.userAgent)=>a.includes("android")||a.includes("Android"),rt=(a,b=navigator.userAgent)=>(new RegExp(`OS ${a}`,"i")).test(b),we=(a,b=navigator.userAgent)=>Mb(b)&&rt(a.toString(),b),qp=(a=navigator.userAgent)=>nh(a)&&Ta(a),st=new Map([["Facebook",{ios:"com.facebook.Facebook",android:"com.facebook.katana"}],["Pinterest",{ios:"pinterest",android:"com.pinterest"}],
["Instagram",{ios:"com.burbn.instagram",android:"com.instagram.android"}]]),rp=(a,b)=>{const c=window.navigator.userAgent.includes("FBAN")||window.navigator.userAgent.includes("FBAV")?"Facebook":window.navigator.userAgent.includes("Instagram")?"Instagram":window.navigator.userAgent.includes("[Pinterest/iOS]")||window.navigator.userAgent.includes("[Pinterest/Android]")?"Pinterest":"";var d=st.get(c);if(d)return(d=Mb()?d.ios:qt()?d.android:"")?{bundle:d,name:c,domain:a,content:b.content}:void 0},ca=
()=>{const a=navigator.userAgent,b=/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari|CrOS/i.test(a);return/Mobi|iP(hone|od)|Opera Mini/i.test(a)&&!b},sp=a=>ca()&&"Content"===a.location&&1===a.refreshCount?60:80,qh=a=>0<a.refreshCount?sp(a):a.viewability?Math.min(10*Math.floor(100*a.viewability/10),80):0,Ac=a=>a.id?`id:${a.id}`:a.classList&&a.classList.value?`class:${a.classList.value.split(" ").join(".")}`:`node:${a.nodeName.toLowerCase()}`,rh=a=>new Promise((b,c)=>{fetch(a).then(d=>
{d.json().then(e=>b(e)).catch(()=>c(!1))}).catch(()=>c(!1))}),tt=(a=document)=>(a===document?document.body:a).getBoundingClientRect().top,ut=a=>a.includes(",")?a.split(","):[a],vt=(a=document)=>{a=a.querySelectorAll("article");return 0===a.length?null:(a=Array.from(a).reduce((b,c)=>c.offsetHeight>b.offsetHeight?c:b))&&a.offsetHeight>1.5*window.innerHeight?a:null},wt=(a,b,c=document)=>{const d=vt(c),e=d?[d]:[],f=[];a.forEach(h=>{const k=Array.from(c.querySelectorAll(h.elementSelector)).slice(0,h.skip);
ut(h.elementSelector).forEach(m=>{m=c.querySelectorAll(m);for(let n=0;n<m.length;n++){const p=m[n];if(b.map.some(({el:w})=>w.isEqualNode(p)))continue;const r=p&&p.parentElement;r&&r!==document.body?e.push(r):e.push(p);-1===k.indexOf(p)&&f.push({dynamicAd:h,element:p})}})});const g=tt(c);a=f.sort((h,k)=>h.element.getBoundingClientRect().top-g-(k.element.getBoundingClientRect().top-g));return[e,a]},tp=(a,b,c=document)=>{const [d,e]=wt(a,b,c);if(0===d.length)throw Error("No Main Content Elements Found");
return[Array.from(d).reduce((f,g)=>g.offsetHeight>f.offsetHeight?g:f)||document.body,e]},sh=(a,b="div #comments, section .comments")=>(b=a.querySelector(b))?a.offsetHeight-b.offsetHeight:a.offsetHeight,th=a=>{const b=a.split("."),c=b.length;2<c&&(a=b[c-2]+"."+b[c-1],2!==b[c-2].length&&3!==b[c-2].length||2!==b[c-1].length||(a=b[c-3]+"."+a));return a},xe=a=>{a:{if(document.referrer&&document.referrer.length){var b=document.referrer;var c=document.createElement("a");c.href=b;b=c.hostname;c=th(b);const d=
th(window.location.hostname);if(c!==d)break a}b=void 0}return Q(b,a)},xt=(a,b)=>{const c=document.getElementsByTagName("script")[0];c&&c.parentNode&&!b?c.parentNode.insertBefore(a,c):document.body.appendChild(a)},nb=(a,b=!1,c=!1,d=!1)=>new Promise((e,f)=>{const g=document.createElement("script");g.addEventListener("error",()=>f(Error(`Failed to import script ${a}`)));g.addEventListener("load",()=>e(g));g.type="text/javascript";g.src=a;g.defer=c;g.async=d;xt(g,b)}),up=(a,b,c)=>{const d=document.createElement("link");
d.rel=b;d.href=a;c&&c.length&&c.forEach(e=>{d.setAttribute(e.name,e.value)});document.head.appendChild(d)},vp="Refresh PD Source Browser Topic MCMP Sens".split(" "),fd=(a,b,c=!1)=>{b.addToQueue(()=>{const d=b.getConfig("ix")||{firstPartyData:{}},e={...d.firstPartyData,...a},f={};vp.forEach(g=>{g in e&&(f[g]=e[g])});for(const g in e)vp.includes(g)||(f[g]=e[g]);d.firstPartyData=f;c&&delete d.firstPartyData.Refresh;b.setConfig({ix:d})})},yt=(a,b)=>{b.addToQueue(()=>{const c=b.getConfig("ix")||{};c.largeFormatSizes=
a;b.setConfig({ix:c})})},wp=a=>{const b={google:"google",facebook:"facebook",instagram:"instagram",pinterest:"pinterest"};return a.split(".").filter(c=>b[c])[0]||"other"},xp=[50,60,70,80],yp=({event:a,ignoreOtherCompanyIds:b=!1})=>{var c=new Set([-1,0,1,199612376,2143809321]);const d=new Set([4455444655,4460609902,4463579729,4464180925,4466143841,4550726766,4623743690,4623743882,4634020290,4642901988,4697115760,4801442281,4802163255,4805985973,4807636548,4867316569]);c=!a.campaignId||c.has(a.campaignId);
a=!a.companyIds||a.companyIds&&!a.companyIds.some(e=>d.has(e));return b?c:c&&a},zt=()=>{var a=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);var b=Math.max(document.documentElement.clientHeight||0,window.innerHeight||0);if(5E3<a||5E3<b)return"vpv"},At=()=>{var a=document.createElement("canvas");const b=(a=a.getContext&&a.getContext("webgl"))&&a.getExtension&&a.getExtension("WEBGL_debug_renderer_info");if(b&&b.UNMASKED_RENDERER_WEBGL&&"Google SwiftShader"===(a&&a.getParameter(b.UNMASKED_RENDERER_WEBGL)))return"wglv"},
zp=()=>{var a=zt();var b=navigator&&navigator.webdriver?"wdv":void 0;var c=navigator&&navigator.userAgent&&/python|apis|googleweblight|spider|crawler|curl|wget|ia_archiver|insights|baidu|bot|monitor|scraper|A6-Indexer|addthis|admantx|agentslug|alexa|anderspink|apache-httpclient|apachebench|apis-google|appengine-google|ask jeeves|asynchttpclient|awe.sm|baidu|barkrowler|biglotron|bingpreview|brandverify|bubing|butterfly|buzztalk|cf-uc|check_http|cloudflare|cmradar\/0.1|coldfusion|comodo ssl checker|convera|copypants|crowsnest|curl|dap\/nethttp|daumoa|developers.google.com\/\+\/web\/snippet\/|digitalpersona fingerprint software|drupact|duckduck|elb-healthchecker|embedly|eoaagent|europarchive|eventmachine httpclient|evrinid|exaleadcloudview|ezooms|ez publish|facebookexternalhit|feedburner|feedfetcher-google|findlink|findthatfile|flipboardproxy|garlik|genieo|getprismatic.com|ghost|gigablast|go http package|google( page speed insights| web preview|google-site-verification|-structured-data-testing-tool|-structureddatatestingtool)|hatena|headless|heritrix|htmlparser|http(_request2|client|s|unit)|httrack|hubspot|ichiro|icoreservice|idmarch|in(agist|sieve|stapaper)|ips-agent|jack|jakarta commons|java|jetslide|jobseeker|js-kit|kimengi|knows.is|kraken|laconica|libwww|lighthouse|linode|lipperhey|longurl|ltx71|lwp-trivial|mappydata|mastodon|mediapartners-google|megaindex.ru|metauri|mfe_expand|mixnode|mon(tastic|tools)|moreover|mrchrome|nberta|net(craft|researchserver|state|vibes)|newrelicpinger|newspaper|newsme|ning|nmap|nutch|online-domain-tools|paessler|page(peek|sinventory|thing)|panopta|peerindex|phantomjs|pingdom|plukkie|proximic|pu_in|publiclibraryarchive.org|python-(httplib2|requests|urllib)|quanti|queryseeker|quicklook|qwanti|re-animator|readability|rebelmouse|relateiq|riddler|rssmicro|ruby|scrapy|seo-audit|seodiver|seokicks|shopwiki|shortlinktranslate|siege|sistrix|site24x7|siteexplorer|skypeuripreview|slack|slurp|socialrank|sogou|spinn3r|squider|statuscake|stripe|summify|teeraid|teoma|test certificate info|tineye|traackr|tweetedtimes|twikle|twitjobsearch|twitmunin|twurly|typhoeus|unwindfetch|uptim(e|ia)|uptm.io|vagabondo|vb project|vigil|vkshare|wappalyzer|watchsumo|webceo|webdatascout|webmon|webscout|wesee|wget|whatsapp|whatweb|wikido|wordpress|wormly|wotbox|xenu link sleuth|xing-contenttabreceiver|yandex|yanga|yeti|yff35|yourls|zelist.ro|zibb|^Mozilla\/5\.0$|Viv\/2/i.test(window.navigator.userAgent)?
"uav":void 0;var d=navigator&&16<navigator.hardwareConcurrency?"hwv":void 0;a=[a,b,c,d,At()].filter(e=>!!e);return a.length?a:void 0},ye={EMAIL:"e:",IP4:"i4:"},Bc=a=>a?a.includes("g_td"):!1,gd=a=>!!(a.offsetWidth||a.offsetHeight||a.getClientRects().length);var hd;(function(a){a.amznbid="amznbid";a.amzniid="amzniid";a.amznp="amznp";a.amznsz="amznsz"})(hd||(hd={}));var l;(function(a){a.ThirtyThreeAcross="33across";a.Adform="adform";a.AidemServer="aidem_ss";a.AppNexus="appnexus";a.AmazonTAM="amazon";
a.AmazonUAM="AmazonUAM";a.Colossus="colossus";a.ColossusServer="col_ss";a.Conversant="conversant";a.Concert="concert";a.Criteo="criteo";a.GumGum="gumgum";a.ImproveDigital="improvedigital";a.ImproveDigitalServer="improve_ss";a.IndexExchange="ix";a.Kargo="kargo";a.KargoServer="krgo_ss";a.MediaGrid="grid";a.MediaGridVideo="gridvid";a.Nativo="nativo";a.OpenX="openx";a.Ogury="ogury";a.OpenXServer="opnx_ss";a.Ozone="ozone";a.Pubmatic="pubmatic";a.PubmaticServer="pubm_ss";a.ResetDigital="resetdigital";a.Roundel=
"roundel";a.Rtbhouse="rtbhouse";a.Rubicon="rubicon";a.RubiconServer="rubi_ss";a.Sharethrough="sharethrough";a.Teads="teads";a.Triplelift="triplelift";a.TripleliftServer="tripl_ss";a.TTD="ttd";a.Undertone="undertone";a.UndertoneServer="under_ss";a.Unruly="unruly";a.YahooSSP="yahoossp";a.YahooSSPServer="yah_ss";a.Verizon="verizon";a.Yieldmo="yieldmo"})(l||(l={}));var Oa;(function(a){a.Prebid="prebid";a.GAM="gam";a.Amazon="amazon";a.Marmalade="marmalade";a.Floors="floors";a.CMP="cmp";a.Optable="optable"})(Oa||
(Oa={}));var id;(function(a){a.cm="cm";a.fbrap="fbrap";a.rapml="rapml"})(id||(id={}));var na;(function(a){a.lazy="lazy";a.raptive="raptive";a.refresh="refresh";a.session="session";a.crossDomain="crossdomain";a.highSequence="highsequence";a.lazyBidPool="lazyBidPool"})(na||(na={}));var uh;(function(a){a.lazy="l";a.raptive="rapml";a.refresh="r";a.session="s";a.crossdomain="c";a.highsequence="hs";a.lazyBidPool="lbp"})(uh||(uh={}));var Da;(function(a){a.Version="Version";a.SharingNotice="SharingNotice";
a.SaleOptOutNotice="SaleOptOutNotice";a.SharingOptOutNotice="SharingOptOutNotice";a.TargetedAdvertisingOptOutNotice="TargetedAdvertisingOptOutNotice";a.SensitiveDataProcessingOptOutNotice="SensitiveDataProcessingOptOutNotice";a.SensitiveDataLimitUseNotice="SensitiveDataLimitUseNotice";a.SaleOptOut="SaleOptOut";a.SharingOptOut="SharingOptOut";a.TargetedAdvertisingOptOut="TargetedAdvertisingOptOut";a.SensitiveDataProcessing="SensitiveDataProcessing";a.KnownChildSensitiveDataConsents="KnownChildSensitiveDataConsents";
a.PersonalDataConsents="PersonalDataConsents";a.MspaCoveredTransaction="MspaCoveredTransaction";a.MspaOptOutOptionMode="MspaOptOutOptionMode";a.MspaServiceProviderMode="MspaServiceProviderMode";a.SubSectionType="SubsectionType";a.Gpc="Gpc"})(Da||(Da={}));var Nb;(function(a){a[a.NA=0]="NA";a[a.OptedOut=1]="OptedOut";a[a.OptedIn=2]="OptedIn"})(Nb||(Nb={}));var bb;(function(a){a.AdDensity="addensity";a.AdLayout="adlayout";a.FooterCloseButton="footerclose";a.Interstitial="interstitial";a.RemoveVideoTitleWrapper=
"removevideotitlewrapper";a.StickyOutstream="stickyoutstream";a.StickyOutstreamOnStickyPlayer="sospp";a.VideoAdvancePlaylistRelatedPlayer="videoadvanceplaylistrp";a.MobileStickyPlayerPosition="mspp"})(bb||(bb={}));var jd;(function(a){a.Desktop="desktop";a.Mobile="mobile"})(jd||(jd={}));var M;(function(a){a.Video_Collapse_Autoplay_SoundOff="Video_Collapse_Autoplay_SoundOff";a.Video_Individual_Autoplay_SOff="Video_Individual_Autoplay_SOff";a.Video_Coll_SOff_Smartphone="Video_Coll_SOff_Smartphone";a.Video_In_Post_ClicktoPlay_SoundOn=
"Video_In-Post_ClicktoPlay_SoundOn"})(M||(M={}));var Ap;(Ap||(Ap={})).None="none";var P;(function(a){a.Default="default";a.AZ_Animals="5daf495ed42c8605cfc74b0b";a.Natashas_Kitchen="55bccc97303edab84afd77e2";a.RecipeTin_Eats="55cb7e3b4bc841bd0c4ea577";a.Sallys_Baking_Recipes="566aefa94856897050ee7303";a.Spend_With_Pennies="541917f5a90318f9194874cf"})(P||(P={}));var Ja=[640,360],Ka=[400,225];let Bt=(a,b)=>{const c=a.adDensityEnabled;a=a.adDensityLayout.pageOverrides.find(d=>!!document.querySelector(d.pageSelector)&&
(d[b].onePerViewport||"number"===typeof d[b].adDensity));return c?!a:!0},ze=(a,b)=>{if(1>=a.length)return 0;a.sort((f,g)=>f-g);if(0>=b)return a[0];if(1<=b)return a[a.length-1];b*=a.length+1;const c=Math.floor(b)-1,d=c+1,e=Number((b%1).toFixed(1));return 1>b?a[0]:d>=a.length?a[c]:a[c]+e*(a[d]-a[c])},Ct=(a,b)=>{window.addEventListener("message",c=>{try{const {origin:d,source:e}=c,f=JSON.parse(c.data),g=f&&f.message===b.message;d&&d.match(a)&&g&&e.postMessage(JSON.stringify(b),d)}catch(d){}})},Dt=(a,
b=33)=>Object.keys(a).reduce((c,d)=>{const e=a[d].map(f=>parseInt(f,b)/1E5);return{...c,[d]:[...e]}},{}),Ae=(a,b=33)=>Object.keys(a).reduce((c,d)=>{const e=a[d].map(f=>Math.floor(1E5*f).toString(b));return{...c,[d]:e}},{}),Bp=()=>new Promise(a=>{if("complete"===document.readyState)return a();window.addEventListener("load",()=>a())}),Be=(a,b)=>{a.length>=b&&a.splice(Math.floor(Math.random()*a.length),1)},vh=(a,b)=>{if("Intl"in window){const c=Intl.DateTimeFormat().resolvedOptions().timeZone;return a.some(d=>
c===d)}return b.some(c=>{const d=(new Date).getTimezoneOffset();var e=(new Date).getTimezoneOffset();var f=new Date((new Date).getFullYear(),0,1);const g=new Date((new Date).getFullYear(),6,1);f=Math.max(f.getTimezoneOffset(),g.getTimezoneOffset());return d===(e<f?c-60:c)})},kc=a=>void 0!==a,Cb=(a,b)=>!!(a&&"object"===typeof a&&b in a),wh=a=>{const b=window.location.href;return a.some(c=>(new RegExp(c,"i")).test(b))},Cp=a=>{try{return{valid:!0,elements:document.querySelectorAll(a)}}catch(b){return{valid:!1,
...b}}},Cc=a=>""===a?{valid:!0}:Cp(a),Et=a=>{const b=a.reduce((c,d)=>d.weight?d.weight+c:c,0);return 0<a.length&&a.every(c=>{const d=c.value;c=c.weight;return!(void 0===d||null===d||"number"===typeof d&&isNaN(d)||!c)})&&100===b},Ft=["siteId","siteName","adOptions","breakpoints","adUnits"],Dp=(a,b=Ft)=>{if(!a)return!1;for(let c=0;c<b.length;c++)if(!a[b[c]])return!1;return!0};class Gt{constructor(){this._timeOrigin=0}resetTimeOrigin(){this._timeOrigin=window.performance.now()}now(){try{return Math.round(window.performance.now()-
this._timeOrigin)}catch(a){return 0}}}window.adthrive.windowPerformance=window.adthrive.windowPerformance||new Gt;let kd=window.adthrive.windowPerformance,ra=kd.now.bind(kd),Ep=(a,b,c,d,e,f)=>{a=Math.round(f-e);b=[];e=[];b.push("(",c.map(()=>"%o").join(", "),")");e.push(...c);void 0!==d&&(b.push(" => %o"),e.push(d));b.push(` %c(${a}ms)`);e.push("color: #999;")},Fp=(a,b,c)=>{const d=void 0!==c.get?c.get:c.value;return function(...e){try{const f=ra(),g=d.apply(this,e);if(g instanceof Promise)return g.then(k=>
{const m=ra();Ep(a,b,e,k,f,m);return Promise.resolve(k)}).catch(k=>{k.logged||(A.error(a,b,k),k.logged=!0);throw k;});const h=ra();Ep(a,b,e,g,f,h);return g}catch(f){throw f.logged||(A.error(a,b,f),f.logged=!0),f;}}},v=(a,b=!1)=>c=>{const d=Object.getOwnPropertyNames(c.prototype).filter(e=>b||0!==e.indexOf("_")).map(e=>[e,Object.getOwnPropertyDescriptor(c.prototype,e)]);for(const [e,f]of d)void 0!==f&&"function"===typeof f.value?c.prototype[e]=Fp(a,e,f):void 0!==f&&void 0!==f.get&&"function"===typeof f.get&&
Object.defineProperty(c.prototype,e,{...f,get:Fp(a,e,f)})},Ht=a=>{let b=5381,c=a.length;for(;c;)b=33*b^a.charCodeAt(--c);return b>>>0},ea=()=>(a,b,c)=>{const d=c.value;d&&(c.value=function(...e){var f=Array.isArray(this._choices)?Ht(JSON.stringify(this._choices)).toString(16):null,g=this._expConfigABGroup?this._expConfigABGroup:this.abgroup;g=g?g.toLowerCase():this.key?this.key.toLowerCase():"";f=f?`${g}_${f}`:g;f=this.localStoragePrefix?`${this.localStoragePrefix}-${f}`:f;g=U.getLocalStorageValue("branch");
!1===(g&&g.enabled)&&U.removeLocalStorageValue(f);return U.getOrSetABGroupLocalStorageValue(f,()=>d.apply(this,e),864E5)})},Gp=Math.pow(2,48)-1,It=(a,b)=>{if(isNaN(a))throw Error(`${a} must be a number`);if(a>Gp)throw a=Error(`cannot encode time greater than ${Gp}`),a.source="ulid",a;let c,d="";for(;0<b;b--)c=a%32,d="0123456789ABCDEFGHJKMNPQRSTVWXYZ".charAt(c)+d,a=(a-c)/32;return d},Jt=(a,b)=>{let c="";for(;0<a;a--){let d=Math.floor(32*b());32===d&&(d=31);c="0123456789ABCDEFGHJKMNPQRSTVWXYZ".charAt(d)+
c}return c},Dc=()=>It(Date.now(),10)+Jt(16,()=>{if(window.crypto){var a=new Uint8Array(1);crypto.getRandomValues(a);a=a[0]/255}else a=Math.random();return a}),Ce=a=>new Promise(b=>setTimeout(b,a)),xh=async({condition:a,delay:b=500,maxAttempts:c=10,executedAttempts:d=0})=>{if(!a()){if(d>=c)throw Error("Max waitFor attempts reached without resolution");await Ce(b);return await xh({condition:a,delay:b,maxAttempts:c,executedAttempts:d+1})}},yh=class{getBidWithBsidForSlot(a,b){let c=a.filter(d=>d.meta&&
d.meta.dchain);b=new RegExp(`${b.location}_${b.sequence}(?!\d)`,"i");for(let d=a.length-1;0<=d;d--){let {adUnitCode:e,meta:f}=a[d];if(b.test(e)&&this.getLastBsid(f))return c[d]}}getLastBsid(a={}){({dchain:a}=a);a=a&&a.nodes||[];for(let b=a.length-1;0<=b;b--)if(a[b].bsid)return a[b].bsid}};yh=q([v("DemandChain"),H()],yh);class ia{addAdUnits(a){this.addToQueue(()=>{window.pbjs.addAdUnits(a)})}getPrebidAdUnits(){return window.pbjs&&window.pbjs.adUnits}addToQueue(a){window.pbjs.que.push(a)}enableAnalytics(a){this.addToQueue(()=>
{window.pbjs.enableAnalytics(a)})}isPrebidLoaded(){return window.pbjs&&window.pbjs.libLoaded}getVersion(){return window.pbjs&&window.pbjs.version||"nl"}markWinningBidAsUsed(a){this.addToQueue(()=>{window.pbjs.markWinningBidAsUsed(a)})}offEvent(a,b){this.addToQueue(()=>{window.pbjs.offEvent(a,b)})}onEvent(a,b){this.addToQueue(()=>{window.pbjs.onEvent(a,b)})}refreshUserIds(a,b){this.addToQueue(()=>{window.pbjs.refreshUserIds(a,b)})}requestBids(a){this.addToQueue(()=>{window.pbjs.requestBids(a)})}setAliasBidder(a,
b,c){this.addToQueue(()=>{c?window.pbjs.aliasBidder(a,b,c):window.pbjs.aliasBidder(a,b)})}setBidderConfig(a,b=!1){this.addToQueue(()=>{window.pbjs.setBidderConfig(a,b)})}setBidderSettings(a){this.addToQueue(()=>{window.pbjs.bidderSettings=a})}setBidsReceivedFilter(a){this.addToQueue(()=>{window.pbjs.setBidsReceivedFilter(a)})}setConfig(a){this.addToQueue(()=>{window.pbjs.setConfig(a)})}setTargetingForGPTAsync(a,b=null,c="",d,e,f){this.addToQueue(()=>{window.pbjs.setTargetingForGPTAsync(a,b,c,d,e,
f)})}triggerUserSyncs(){this.addToQueue(()=>{window.pbjs.triggerUserSyncs()})}registerSignalSources(){this.addToQueue(()=>{window.pbjs.registerSignalSources()})}clearTargetingForSharedBidPool(a){this.addToQueue(()=>{window.pbjs.clearTargetingForSharedBidPool(a)})}clearAllAuctions(){this.addToQueue(()=>{window.pbjs.clearAllAuctions()})}waitForQueue(){return new Promise(a=>{this.isPrebidLoaded()||a(!1);window.pbjs.que.push(()=>{a(!0)})})}getBidResponsesForAdUnitCode(a){return window.pbjs.getBidResponsesForAdUnitCode(a)}getUserIdsAsEids(){return window.pbjs.getUserIdsAsEids()}getUserIdsAsEidBySource(a){return window.pbjs.getUserIdsAsEidBySource(a)}getBidResponsesForBidPoolId(a){return pbjs.getBidResponsesForBidPoolId(a)}getAdserverTargetingForAdUnitCode(a,
b){return window.pbjs.getAdserverTargetingForAdUnitCode(a,b)}getAllPrebidWinningBids(){return window.pbjs.getAllPrebidWinningBids()}getConfig(a,b){return b?window.pbjs.getConfig(a,b):window.pbjs.getConfig(a)}getHighestCpmBids(a){return window.pbjs.getHighestCpmBids(a)}getHighestCpmBidsForPoolId(a){return window.pbjs.getHighestCpmBidsForPoolId(a)}getUserIds(){return window.pbjs.getUserIds()}getUserIdsAsync(){return new Promise(a=>{this.isPrebidLoaded()||a(!1);window.pbjs.getUserIdsAsync().then(b=>
a(b)).catch(()=>{})})}removeAdUnit(a){return window.pbjs.removeAdUnit(a)}removeAllAdUnits(){var a;let b=[...(null!==(a=pbjs.adUnits)&&void 0!==a?a:[])];window.pbjs.adUnits=[];return b}}let cb=class extends Ma{constructor(){super(...arguments);this.addSlots=new L;this.requestingBids=new L;this.preRequestBids=new L;this.refreshingBids=new L;this.beforeGoogleAdManagerRefreshSlots=new L;this.addPrebidSlotTargeting=new L;this.displaySlot=new L;this.amazonBidResponseReceived=new L}};cb=q([y()],cb);class T{get enabled(){return!0}}
let De=class{constructor(a){this.prefix="AdThrive";this.networkCode="18190176";this._gamMCMEnabled=Q(a.siteAds.adOptions.gamMCMEnabled,!1);this._gamMCMChildNetworkCode=Q(a.siteAds.adOptions.gamMCMChildNetworkCode,"");this.account=this._gamMCMEnabled&&""!==this._gamMCMChildNetworkCode?`${this.networkCode},${this._gamMCMChildNetworkCode}`:this.networkCode;let b=new Set(["service","bidding","dynamicVersion"]);this.targeting=a.siteAds.targeting.length&&a.siteAds.targeting.filter(({key:c})=>!b.has(c)).map(({key:c,
value:d})=>{"boolean"===typeof d&&(d=String(d));return{key:c,value:d}})||[]}};De=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],De);let zh=class{constructor(){this.adthriveExperimentOverrides=pp("at_features")}hasValidOverride(a,b){return a in this.adthriveExperimentOverrides?this.isValidExperimentOverride(b,this.adthriveExperimentOverrides[a]):!1}useOverride(a){return this.adthriveExperimentOverrides[a]}isValidExperimentOverride(a,b){if(0===a.length)return!1;let c=Array.isArray(a[0])?
"array":typeof a[0];if("array"===c){if(!Array.isArray(b)||b.some(d=>!a.includes(d))&&b.map(d=>"["+JSON.stringify(d)+"]").some(d=>!a.map(e=>JSON.stringify(e)).includes(d))&&!a.map(d=>JSON.stringify(d)).includes(JSON.stringify(b)))return!1}else if("object"===c){if(!a.map(d=>JSON.stringify(d)).includes(JSON.stringify(b)))return!1}else if(!a.includes(b))return!1;return!0}};zh=q([y(),t("design:paramtypes",[])],zh);class fb{constructor(){this.shouldUseCoreExperimentsConfig=!0;let a=this.run.bind(this);
this.run=()=>{var b;let c=S.resolve(zh),d=null===(b=this._choices)||void 0===b?void 0:b.map(e=>e.choice);b=this._expConfigABGroup?this._expConfigABGroup:this.abgroup?this.abgroup:this.key;return d&&c.hasValidOverride(b,d)?c.useOverride(b):a()}}}class Hp{}class Ha extends Hp{constructor(a){super();this._probability=a}get(){if(0>this._probability||1<this._probability)throw Error(`Invalid probability: ${this._probability}`);return Math.random()<this._probability}}class Ec extends Hp{constructor(a=[],
b){super();this._choices=a;this._default=b}static fromArray(a,b){return new Ec(a.map(([c,d])=>({choice:c,weight:d})),b)}addChoice(a,b){this._choices.push({choice:a,weight:b})}get(){let a=100*Math.random(),b=0;for(let {choice:c,weight:d}of this._choices)if(b+=d,b>=a)return c;return this._default}get totalWeight(){return this._choices.reduce((a,{weight:b})=>a+b,0)}}let Ee=class extends Ma{constructor(){super(...arguments);this.libraryLoadFailed=new ab}};Ee=q([y()],Ee);let ld=class extends Ma{constructor(){super();
this.topicsReceived=new ab}};ld=q([y(),t("design:paramtypes",[])],ld);let md=class extends Ma{constructor(){super(...arguments);this.act25consentCaptured=new ab}};md=q([y()],md);let nd=class extends Ma{constructor(){super(...arguments);this.footerElementAdded=new ab;this.comscoreInitialized=new ab}};nd=q([y()],nd);let Db=class extends Ma{constructor(){super(...arguments);this.dataCaptured=new ab;this.dataSentFromIframe=new L;this.iframeReady=new ab;this.optableResolved=new ab}};Db=q([y()],Db);let Ah=
class extends Ma{constructor(){super(...arguments);this.iframeReady=new ab}};Ah=q([y()],Ah);let Bh=class extends Ma{constructor(){super(...arguments);this.ttdServerTokenGenerated=new L}};Bh=q([y()],Bh);let ob=class extends Ma{constructor(){super();this.marmaladeResponseLoaded=new ab;this.recencyFrequencyDataSet=new ab;this.resetMarmaladeData=new L}};ob=q([y(),t("design:paramtypes",[])],ob);let Pa=class extends Ma{constructor(){super(...arguments);this.routeChanged=new L;this.resetCompleted=new L}};
Pa=q([y()],Pa);let Fe=class extends Ma{constructor(){super(...arguments);this.targetingReady=new L}};Fe=q([y()],Fe);let Ua=class extends Ma{constructor(){super(...arguments);this.videoPlayerAdded=new L;this.preRequestVideoBids=new L;this.requestingVideoBids=new L;this.addAPStagSlotBidResponse=new L;this.topCenterVideoClosed=new L;this.topCenterVideoCollapsed=new L;this.topCenterVideoUnCollapsed=new L;this.amazonVideoBidResponseReceived=new L}};Ua=q([y()],Ua);let Ge=class extends Ma{constructor(){super(...arguments);
this.realizedAdDensityCompReady=new L;this.metricsRequested=new L}};Ge=q([y()],Ge);class Fc{constructor(){this._siteExperimentEventBus=S.resolve(Fe);this._isTargeted=!1}get result(){this._isTargeted||(this._siteExperimentEventBus.targetingReady.emit(),this._isTargeted=!0);return this._result}get enabled(){return void 0!==this.experimentConfig}_isValidResult(a,b=()=>!0){return b()&&U.isValidABGroupLocalStorageValue(a)}}class Ch extends Fc{constructor(){super(...arguments);this._resultValidator=()=>
!0}_isValidResult(a){return super._isValidResult(a,()=>this._resultValidator(a)||"control"===a)}run(){if(!this.experimentConfig||!this._mappedChoices||0===this._mappedChoices.length)return A.error("WeightedChoiceSiteExperiment","run","No experiment config found"),"control";let a=(new Ec(this._mappedChoices)).get();if(this._isValidResult(a))return a;A.error("WeightedChoiceSiteExperiment","run","Invalid result from experiment choices. Defaulting to control.",a);return"control"}}class Dh{constructor(a){var b,
c;this.siteExperiments=[];this._device=ca()?"mobile":"desktop";this.siteExperiments=null!==(c=null===(b=null===a||void 0===a?void 0:a.siteExperiments)||void 0===b?void 0:b.filter(d=>{var e=d.key;var f=this._device;if(d){var g=!!d.enabled,h=null==d.dateStart||Date.now()>=d.dateStart,k=null==d.dateEnd||Date.now()<=d.dateEnd,m=null===d.selector||""!==d.selector&&!!document.querySelector(d.selector),n="mobile"===d.platform&&"mobile"===f;f="desktop"===d.platform&&"desktop"===f;n=null===d.platform||"all"===
d.platform||n||f;(f="bernoulliTrial"===d.experimentType?1===d.variants.length:Et(d.variants))||A.error("SiteTest","validateSiteExperiment","experiment presented invalid choices for key:",d.key,d.variants);d=g&&h&&k&&m&&n&&f}else d=!1;a:switch(e){case bb.AdDensity:var p=Bt(a,this._device);break a;case bb.StickyOutstream:var r,w;p=(e=null===(w=null===(r=null===(p=a.videoPlayers)||void 0===p?void 0:p.partners)||void 0===r?void 0:r.stickyOutstream)||void 0===w?void 0:w.blockedPageSelectors)?!document.querySelector(e):
!0;break a;case bb.Interstitial:p=(p=a.adOptions.interstitialBlockedPageSelectors)?!document.querySelector(p):!0;break a;default:p=!0}return d&&p}))&&void 0!==c?c:[]}getSiteExperimentByKey(a){let b=this.siteExperiments.filter(e=>e.key.toLowerCase()===a.toLowerCase())[0],c=pp("at_site_features"),d=typeof((null===b||void 0===b?0:b.variants[1])?null===b||void 0===b?void 0:b.variants[1].value:null===b||void 0===b?void 0:b.variants[0].value)===typeof c[a];b&&c[a]&&d&&(b.variants=[{displayName:"test",value:c[a],
weight:100,id:0}]);return b}}let vb=class extends Dh{constructor(a){var b;super(a.siteAds);this._players=null===(b=a.siteAds.videoPlayers)||void 0===b?void 0:b.players}getVideoPlaylistByType(a){var b,c;return null!==(c=null===(b=this._players)||void 0===b?void 0:b.filter(d=>d.type===a))&&void 0!==c?c:[]}};vb=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],vb);let Eh=class extends fb{constructor(a){super();this.key="SensOff";this.abgroup="SensOffExperiment";this._choices=[];this._sensCategories=
Q(a.siteAds.adOptions.sensitiveCategories,[]);this._choices=this._sensCategories.map(b=>({choice:[b]}));this._result=this.run()}get result(){return this._result}run(){return this._sensCategories.filter(()=>(new Ha(.01)).get())}};Eh=q([v("SensOffExperiment"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],Eh);let He=class{constructor(a,b){this._sensOffExperiment=b;this.enableCategoriesNetworkWide=["drg","conl"];this.disableCategoriesNetworkWide=["dlu"];this.id=a.siteAds.siteId;this.name=
a.siteAds.siteName;this.verticals=a.siteAds.adOptions.verticals;this.sensitiveCategories=Q(a.siteAds.adOptions.sensitiveCategories,[]).filter(c=>!this.enableCategoriesNetworkWide.includes(c)&&!this.disableCategoriesNetworkWide.includes(c));this.sensCategoriesOff=this._sensOffExperiment.result;this.filteredSensitiveCategories=this.sensitiveCategories.filter(c=>-1===this.sensCategoriesOff.indexOf(c));this.breakpoints=a.siteAds.breakpoints;this.style=a.style;this.spa=Q(a.siteAds.adOptions.spa,!1)}};
He=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Eh])],He);let Ia=class{constructor(){this._map=new Map;this.setAbGroup=!jc().has("at_features")}set(a,b){this.setAbGroup&&this._map.set(a,b)}get(a){return this._map.get(a)}get groups(){let a=[];for(let [b,c]of this._map)Array.isArray(c)?c.forEach(d=>{a.push(`${b}:${d}`)}):a.push(`${b}:${c}`);return a}get groupsAsObject(){let a={};for(let b of this._map.keys()){let c=this._map.get(b);c&&(a[b]=c)}return a}};Ia=q([y(),t("design:paramtypes",
[])],Ia);let pb=class extends Ia{};pb=q([y()],pb);let Kt=a=>{let b=0;a.forEach(c=>{c.weight&&(b+=c.weight)});return 0<a.length&&a.every(c=>!(!c.hasOwnProperty("value")||!c.hasOwnProperty("weight")))&&100===b},Lt=a=>0<a.length&&a.every(b=>!(!b.hasOwnProperty("value")||!b.hasOwnProperty("weight"))),Ob=class{constructor(a){this._validExperiments=this._getValidExperiments(a).map(b=>({...b,_expConfigABGroup:b.abgroup}));this.coreExperiments=this._validExperiments.map(({variants:b,abgroup:c,key:d})=>({variants:b,
abgroup:c,key:d}))}getCoreExperimentButMutateWeights(a){let b=this._validExperiments.find(({key:c})=>c===a);"bernoulliTrial"===(null===b||void 0===b?void 0:b.type)&&(b.variants[0].weight/=100);return b}getCoreExperiment(a){return this._validExperiments.find(({key:b})=>b===a)}getWeightedChoiceVariants(a){return(a=this.getCoreExperimentButMutateWeights(a))&&"weightedChoice"===a.type?a.variants.map(b=>({choice:b.value,weight:b.weight,...(b.abvalue?{abvalue:b.abvalue}:{})})):null}getMultivalueBernoulliVariants(a){return(a=
this.getCoreExperimentButMutateWeights(a))&&"multivalueBernoulliTrial"===a.type?a.variants.map(b=>({choice:b.value,weight:b.weight})):null}_getValidExperiments(a=[]){return a.filter(({type:b,variants:c,key:d})=>"weightedChoice"===b?this._isValidWeightedChoice(c,d):"bernoulliTrial"===b?this._isValidBernoulliTrial(c,d):"multivalueBernoulliTrial"===b?this._isValidMultivalueBernoulliTrial(c,d):!1)}_isValidWeightedChoice(a,b){(a=Kt(a))||this._invalidExperiment(b);return a}_isValidBernoulliTrial(a,b){(a=
1===a.length)||this._invalidExperiment(b);return a}_isValidMultivalueBernoulliTrial(a,b){(a=Lt(a))||this._invalidExperiment(b);return a}_invalidExperiment(a){A.error("CoreExperimentConfig","_invalidExperiment","Experiment Validation failed for key: ",a)}};Ob=q([y(),ha(0,fa("CoreExperimentValues")),t("design:paramtypes",[Array])],Ob);let od=class extends fb{get _choices(){return null}get key(){if(!this._key)throw Error("You need to set \"this._key\" in the init method for this experiment. The code should look something like this:\n\n  protected init() {\n    this._key = 'my_key';\n  }");
return this._key}constructor(a,b){var c;super();this.abgroupClass=a;this._coreExperimentConfig=b;this._autorun=this._setAbGroup=!0;this.init();this.isEnabled()&&(this._expConfigABGroup=null===(c=this._coreExperimentConfig.getCoreExperiment(this.key))||void 0===c?void 0:c.abgroup,this._autorun&&this._runAndSetABGroup())}_runAndSetABGroup(){var a=this._choices;if(a){this._result=this.run();var b=a.filter(({choice:c})=>c===this._result)[0];a=b&&b.abvalue||this._result;this._setAbGroup&&void 0!==a&&(b=
this.getResultWeight(a,b&&b.weight||-1),100!==b&&this.setABGroup(a,void 0,b))}return this._result}getResultWeight(a,b=-1){let c=this._experiment;if(!c)return-1;if("bernoulliTrial"===c.type)return b=c.variants[0].weight,a?b:100-b;if("multivalueBernoulliTrial"===c.type){let d=new Map;c.variants.forEach(e=>{d.set(e.value,e.weight)});return d}return b}setABGroup(a,b,c){let d=this._coreExperimentConfig.getCoreExperiment(this.key);d&&(Array.isArray(a)?(a=a.filter(e=>"number"===typeof c?100!==c:c&&100!==
c.get(e)).map(e=>`${e}@${"number"===typeof c?c:c&&c.get(e)||0}`),this.abgroupClass.set(b||d.abgroup,a)):this.abgroupClass.set(b||d.abgroup,`${a}@${c}`))}init(){throw Error("You need to set \"this._key\" in the init method for this experiment. The code should look something like this:\n\n  protected init() {\n    this._key = 'my_key';\n  }");}get result(){!1===this._autorun&&void 0===this._result&&void 0===this.abgroupClass.get(this.key)&&(this._result=this._runAndSetABGroup());return this._result}isEnabled(){return this.shouldUseCoreExperimentsConfig?
!!(this._experiment=this._coreExperimentConfig.getCoreExperiment(this.key)):!0}};od=q([ha(0,fa(Ia)),ha(1,fa(Ob)),t("design:paramtypes",[Ia,Ob])],od);class Eb extends od{constructor(){super(...arguments);this._default=["none"]}get _choices(){return this._coreExperimentConfig.getMultivalueBernoulliVariants(this.key)}run(){var a=this._choices;a&&(a=a.filter(b=>(new Ha(b.weight/100)).get()).map(b=>b.choice),a.length&&(this._result=a));return this._result||this._default}get choices(){return this._choices}}
let Fh=class extends Eb{init(){this._setAbGroup=!0;this._key="S2S2"}};Fh=q([v("S2SExperiment"),y()],Fh);class X extends od{get _choices(){return this._coreExperimentConfig.getWeightedChoiceVariants(this.key)}run(){if(this._choices)return(new Ec(this._choices)).get()}}let Gh=class extends X{init(){this._key="AuctionDelay_2"}get result(){return this._result}};Gh=q([v("AuctionDelayExperiment"),y()],Gh);class W extends od{get _choices(){return[{choice:!0,weight:-1},{choice:!1,weight:-1}]}run(){let a=
this._coreExperimentConfig.getCoreExperiment(this.key);if(a)return(new Ha(a.variants[0].weight/100)).get()}setABGroup(a,b){let c=this._coreExperimentConfig.getCoreExperiment(this.key);if(c){let d=c.variants[0].weight;100!==d&&this.abgroupClass.set(b||c.abgroup,a?`on@${d}`:`off@${100-d}`)}}get result(){var a;if(void 0===this._default)throw Error("You need to set \"this._default\" in the init method for this experiment. The code should look something like this:\n  protected init() {\n    this._key = 'my_key';\n    this._default = false;\n  }");
!1===this._autorun&&void 0===this._result&&void 0===this.abgroupClass.get(this.key)&&(this._result=this._runAndSetABGroup());return null!==(a=this._result)&&void 0!==a?a:this._default}}let Hh=class extends W{init(){this._key="OrtbEnrich";this._default=!1}};Hh=q([v("OrtbEnrichExperiment"),y()],Hh);let pd=class extends X{init(){this._key="ColossusExperiment"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],pd.prototype,"run",null);
pd=q([v("ColossusExperiment"),y()],pd);let qd=class extends X{init(){this._key="Kargo"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],qd.prototype,"run",null);qd=q([v("KargoExperiment"),y()],qd);let rd=class extends X{init(){this._key="OpenX"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],rd.prototype,"run",null);rd=q([v("OpenXExperiment"),y()],rd);let sd=class extends X{init(){this._key=
"Rubicon"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],sd.prototype,"run",null);sd=q([v("RubiconExperiment"),y()],sd);let td=class extends X{init(){this._key="Triplelift"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],td.prototype,"run",null);td=q([v("TripleLiftExperiment"),y()],td);let ud=class extends X{init(){this._key="YahooSSP1"}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],ud.prototype,"run",null);ud=q([v("YahooSSPExperiment"),y()],ud);let Ie=class extends X{init(){this._key="MultistagePrebidAuctionDisplay"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Ie.prototype,"run",null);Ie=q([v("MultistagePrebidAuctionExperiment"),y()],Ie);let Je=new Map([[l.Adform,{enabled:!0,nameFromAdmin:"adform"}],[l.AmazonUAM,
{enabled:!0,nameFromAdmin:"amazonUAM"}],[l.AppNexus,{enabled:!0,nameFromAdmin:"appNexus"}],[l.Colossus,{enabled:!0}],[l.Concert,{enabled:!1}],[l.Conversant,{enabled:!0}],[l.Criteo,{enabled:!0}],[l.GumGum,{enabled:!0}],[l.ImproveDigital,{enabled:!0}],[l.IndexExchange,{enabled:!0,nameFromAdmin:"indexExchange"}],[l.Kargo,{enabled:!0}],[l.MediaGrid,{enabled:!0,nameFromAdmin:"mediaGrid"}],[l.MediaGridVideo,{enabled:!0,nameFromAdmin:"mediaGrid"}],[l.Nativo,{enabled:!0}],[l.OpenX,{enabled:!0}],[l.Ozone,
{enabled:!1}],[l.Pubmatic,{enabled:!0,nameFromAdmin:"pubMatic"}],[l.ResetDigital,{enabled:!0}],[l.Rtbhouse,{enabled:!0}],[l.Rubicon,{enabled:!0}],[l.Roundel,{enabled:!0}],[l.Sharethrough,{enabled:!0}],[l.Teads,{enabled:!0}],[l.ThirtyThreeAcross,{enabled:!0,nameFromAdmin:"thirtyThreeAcross"}],[l.Triplelift,{enabled:!0,nameFromAdmin:"tripleLift"}],[l.TTD,{enabled:!0,nameFromAdmin:"theTradeDesk"}],[l.Undertone,{enabled:!0}],[l.UndertoneServer,{enabled:!0}],[l.Unruly,{enabled:!0}],[l.Verizon,{enabled:!0}],
[l.YahooSSP,{enabled:!0}],[l.Yieldmo,{enabled:!0}]]),Mt=new Map([[l.Adform,!0],[l.AmazonUAM,!0],[l.AppNexus,!1],[l.Colossus,!0],[l.Concert,!1],[l.Conversant,!1],[l.Criteo,!0],[l.GumGum,!0],[l.ImproveDigital,!0],[l.IndexExchange,!1],[l.Kargo,!0],[l.MediaGrid,!0],[l.MediaGridVideo,!0],[l.Nativo,!0],[l.OpenX,!1],[l.Ozone,!1],[l.Pubmatic,!0],[l.ResetDigital,!0],[l.Rtbhouse,!0],[l.Rubicon,!0],[l.Roundel,!0],[l.Sharethrough,!0],[l.Teads,!0],[l.ThirtyThreeAcross,!0],[l.Triplelift,!0],[l.TTD,!0],[l.Undertone,
!0],[l.Unruly,!0],[l.Verizon,!0],[l.YahooSSP,!0],[l.Yieldmo,!0]]),Nt=new Map([["AmazonUAM",!0],[l.Adform,!0],[l.AppNexus,!0],[l.Colossus,!0],[l.Criteo,!0],[l.GumGum,!0],[l.ImproveDigital,!0],[l.IndexExchange,!0],[l.Kargo,!0],[l.MediaGridVideo,!0],[l.OpenX,!0],[l.Pubmatic,!0],[l.ResetDigital,!0],[l.Rubicon,!0],[l.Sharethrough,!0],[l.ThirtyThreeAcross,!0],[l.Triplelift,!0],[l.TTD,!0],[l.Unruly,!0],[l.UndertoneServer,!0],[l.YahooSSP,!0]]),Ot=[{choice:l.ThirtyThreeAcross,weight:.0033},{choice:l.AppNexus,
weight:.0033},{choice:l.ColossusServer,weight:.0033},{choice:l.Colossus,weight:.0033},{choice:l.Concert,weight:3.3E-4},{choice:l.Conversant,weight:3.3E-4},{choice:l.GumGum,weight:3.3E-4},{choice:l.ImproveDigitalServer,weight:.0033},{choice:l.IndexExchange,weight:.0033},{choice:l.Kargo,weight:3.3E-4},{choice:l.KargoServer,weight:0},{choice:l.MediaGrid,weight:.0033},{choice:l.Nativo,weight:3.3E-4},{choice:l.OpenX,weight:.0033},{choice:l.OpenXServer,weight:.0033},{choice:l.Ozone,weight:.0033},{choice:l.Pubmatic,
weight:.0033},{choice:l.PubmaticServer,weight:.0033},{choice:l.Rtbhouse,weight:3.3E-4},{choice:l.Rubicon,weight:.0033},{choice:l.RubiconServer,weight:.0033},{choice:l.Roundel,weight:0},{choice:l.Sharethrough,weight:3.3E-4},{choice:l.Triplelift,weight:.00158},{choice:l.TripleliftServer,weight:.00236},{choice:l.TTD,weight:.0033},{choice:l.Undertone,weight:3.3E-4},{choice:l.Unruly,weight:.0033},{choice:l.Verizon,weight:.0033},{choice:l.YahooSSP,weight:.0033},{choice:l.YahooSSPServer,weight:.0033},{choice:l.Yieldmo,
weight:.0033},{choice:l.AidemServer,weight:.0033}],Ke=class{constructor(a){var b,c;this._biddersCoreConfig=new Map;this._globalPriceAdjustments=new Map([["default",{flat:.0147}],["instream",{flat:.1747}]]);this._prebidPriceAdjustments=new Map([["default",{flat:0}],["instream",{flat:0}],["pmp",{flat:0}]]);this._bidderPriceAdjustments={ix:new Map([["pmp",{flat:.05}]])};this._configTypes=["default","instream","outstream","stickyOutstream","pmp"];let d=a.siteAds.videoPlayers&&a.siteAds.videoPlayers.partners,
e=a.siteAds.video&&a.siteAds.video.partners;this._adOptions=a.siteAds.adOptions;this._videoPartners=d||e||{};if(null===(c=null===(b=a.core)||void 0===b?void 0:b.partners)||void 0===c?0:c.length){let f=this._isCPMConfigLegacy(a.core.partners);this._enableConfiantPriceAdjustments();a.core.liveIntent&&this._enableLiveIntentPriceAdjustments(a.core.liveIntent);a.core.partners.forEach(g=>{g.bidder_name&&this._createCPMMap(g,f)});this._biddersCoreConfig.set("default",{bidder_name:"default",enabled:!0,cpmMap:this._globalPriceAdjustments});
this._biddersCoreConfig.set("prebid",{bidder_name:"prebid",enabled:!0,cpmMap:this._prebidPriceAdjustments})}this.display=this._getDisplayBidders();this.video=this._getVideoBidders()}getBidderConfig(a,b=!0){b={bidder_name:a,enabled:b,cpmMap:new Map};return Q(this._biddersCoreConfig.get(a),b)}get bidderPriceAdjustments(){return this._bidderPriceAdjustments}_enableConfiantPriceAdjustments(){this._setBidderPriceAdjustments(Ot,["default","outstream","stickyOutstream"],"flat")}_setBidderPriceAdjustments(a,
b,c){a&&b.forEach(d=>{a.forEach(e=>this._setBidderPriceAdjustmentMap(e,d,c))})}_enableLiveIntentPriceAdjustments(a){a=this._getMostRecentLiveIntentConfigs(a).filter(b=>ic()?"Chrome"===b.browser:"Not Chrome"===b.browser).map(b=>({choice:b.bidder,weight:b.multiplier/100}));this._setBidderPriceAdjustments(a,this._configTypes,"percent")}_getMostRecentLiveIntentConfigs(a){let b=a;if(0<b.length&&b[0].hasOwnProperty("month")&&b[0].hasOwnProperty("day")){let c=a.reduce((d,e)=>{e.month>d.month?(d.month=e.month,
e.day>d.day&&(d.day=e.day)):e.month===d.month&&e.day>=d.day&&(d.day=e.day);return d},{month:0,day:0});b=b.filter(d=>d.month===c.month&&d.day===c.day)}return b}_setBidderPriceAdjustmentMap(a,b,c){var d,e;if(a){var {choice:f,weight:g}=a,h=this._bidderPriceAdjustments[a.choice];if(h){let k=h.get(b);k?(a=null!==(d=k.percent)&&void 0!==d?d:1,d=Number(null!==(e=k.flat)&&void 0!==e?e:0),h.set(b,{percent:"percent"===c?Number(g)*a:a,flat:"flat"===c?Number(g)+d:d})):h.set(b,{[c]:a.weight})}else this._bidderPriceAdjustments[f]=
new Map([[b,{[c]:a.weight}]])}}_displayPartnerEnabled(a){var b,c,d,e=(null===(b=Je.get(a))||void 0===b?void 0:b.nameFromAdmin)||a;b=e?Q(this._adOptions[e],Mt.get(a)):void 0;e=Q(null===(c=this._biddersCoreConfig.get(a))||void 0===c?void 0:c.enabled,null===(d=Je.get(a))||void 0===d?void 0:d.enabled);return a===l.AmazonUAM?b:!!b&&!!e}_videoPartnerEnabled(a){var b,c,d;let e=(null===(b=Je.get(a))||void 0===b?void 0:b.nameFromAdmin)||a;b=Q(this._videoPartners[e],Nt.get(a));a=Q(null===(c=this._biddersCoreConfig.get(a))||
void 0===c?void 0:c.enabled,null===(d=Je.get(a))||void 0===d?void 0:d.enabled);return!!b&&!!a}_createCPMMap(a,b){let c=Q(a.enabled,!0),d;if(b){d=new Map;let e=[];this._configTypes.forEach(f=>{var g,h=a.cpm.find(k=>k.name===f);h?e.push(h):(h=null===(g=a.cpm.find(k=>"default"===k.name))||void 0===g?void 0:g.value,e.push({name:f,type:"percent",value:h?h:hc.percent}))});e.forEach(f=>{d.set(f.name,this._convertToCPMPriceAdjustments(f,a.bidder_name))})}else d=a.cpm;this._biddersCoreConfig.set(a.bidder_name,
{bidder_name:a.bidder_name,enabled:c,cpmMap:d})}_isCPMConfigLegacy(a){var b;return(a=null===(b=null===a||void 0===a?void 0:a[0])||void 0===b?void 0:b.cpm)&&Array.isArray(a)}_convertToCPMPriceAdjustments(a,b){return"pmp"===a.name?this._convertToCMPPriceAdjustmentPMP(a,b):this._convertToCMPPriceAdjustment(a,b)}_convertToCMPPriceAdjustmentPMP(a,b){let c=this._convertToCMPPriceAdjustment(a,b);a.deals&&(c.deals={},a.deals.forEach(d=>{c.deals[d.name]=this._convertToCMPPriceAdjustment(d,b,!1)}));return c}_convertToCMPPriceAdjustment(a,
b,c=!0){let d={};b=this._getBidderPriceAdjustment(b,a.name,c);c=1;let e=0;"percent"===a.type?c*=a.value:"flat"===a.type&&(e+=a.value);d.percent=c*b.percent;d.flat=e+Number(b.flat);return d}_getBidderPriceAdjustment(a,b,c=!0){if(!c)return{...hc};c=this._bidderPriceAdjustments;a=c[a]&&c[a].get(c[a].has(b)?b:"default")||{};return{...hc,...a}}_getDisplayBidders(){return new Map([[l.Adform,this._displayPartnerEnabled(l.Adform)],[l.AppNexus,this._displayPartnerEnabled(l.AppNexus)],[l.Concert,this._displayPartnerEnabled(l.Concert)],
[l.Colossus,this._displayPartnerEnabled(l.Colossus)],[l.Conversant,this._displayPartnerEnabled(l.Conversant)],[l.Criteo,this._displayPartnerEnabled(l.Criteo)],[l.ImproveDigital,this._displayPartnerEnabled(l.ImproveDigital)],[l.IndexExchange,this._displayPartnerEnabled(l.IndexExchange)],[l.GumGum,this._displayPartnerEnabled(l.GumGum)],[l.Kargo,this._displayPartnerEnabled(l.Kargo)],[l.MediaGrid,this._displayPartnerEnabled(l.MediaGrid)],[l.MediaGridVideo,this._displayPartnerEnabled(l.MediaGridVideo)],
[l.Nativo,this._displayPartnerEnabled(l.Nativo)],[l.OpenX,this._displayPartnerEnabled(l.OpenX)],[l.Ozone,this._displayPartnerEnabled(l.Ozone)],[l.Pubmatic,this._displayPartnerEnabled(l.Pubmatic)],[l.ResetDigital,this._displayPartnerEnabled(l.ResetDigital)],[l.Rtbhouse,this._displayPartnerEnabled(l.Rtbhouse)],[l.Rubicon,this._displayPartnerEnabled(l.Rubicon)],[l.Roundel,this._displayPartnerEnabled(l.Roundel)],[l.Sharethrough,this._displayPartnerEnabled(l.Sharethrough)],[l.Teads,this._displayPartnerEnabled(l.Teads)],
[l.ThirtyThreeAcross,this._displayPartnerEnabled(l.ThirtyThreeAcross)],[l.Triplelift,this._displayPartnerEnabled(l.Triplelift)],[l.TTD,this._displayPartnerEnabled(l.TTD)],[l.Undertone,this._displayPartnerEnabled(l.Undertone)],[l.Unruly,this._displayPartnerEnabled(l.Unruly)],[l.Verizon,this._displayPartnerEnabled(l.Verizon)],[l.YahooSSP,this._displayPartnerEnabled(l.YahooSSP)],[l.Yieldmo,this._displayPartnerEnabled(l.Yieldmo)],[l.AmazonUAM,this._displayPartnerEnabled(l.AmazonUAM)]])}_getVideoBidders(){return new Map([[l.Adform,
this._videoPartnerEnabled(l.Adform)],[l.AmazonUAM,this._videoPartnerEnabled(l.AmazonUAM)],[l.AppNexus,this._videoPartnerEnabled(l.AppNexus)],[l.Colossus,this._videoPartnerEnabled(l.Colossus)],[l.Criteo,this._videoPartnerEnabled(l.Criteo)],[l.GumGum,this._videoPartnerEnabled(l.GumGum)],[l.ImproveDigital,this._videoPartnerEnabled(l.ImproveDigital)],[l.IndexExchange,this._videoPartnerEnabled(l.IndexExchange)],[l.Kargo,this._videoPartnerEnabled(l.Kargo)],[l.MediaGridVideo,this._videoPartnerEnabled(l.MediaGridVideo)],
[l.OpenX,this._videoPartnerEnabled(l.OpenX)],[l.Pubmatic,this._videoPartnerEnabled(l.Pubmatic)],[l.ResetDigital,this._videoPartnerEnabled(l.ResetDigital)],[l.Rubicon,this._videoPartnerEnabled(l.Rubicon)],[l.Sharethrough,this._videoPartnerEnabled(l.Sharethrough)],[l.ThirtyThreeAcross,this._videoPartnerEnabled(l.ThirtyThreeAcross)],[l.Triplelift,this._videoPartnerEnabled(l.Triplelift)],[l.TTD,this._videoPartnerEnabled(l.TTD)],[l.Unruly,this._videoPartnerEnabled(l.Unruly)],[l.UndertoneServer,this._videoPartnerEnabled(l.Undertone)],
[l.YahooSSP,this._videoPartnerEnabled(l.YahooSSP)],[l.Yieldmo,this._videoPartnerEnabled(l.Yieldmo)]])}};Ke=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],Ke);let Ih=class extends X{init(){this._key="MultistageServer"}run(){return super.run()}};Ih=q([v("MultistageServerExperiment"),y()],Ih);let Pt=new Map([["20sf1","ttd appnexus verizon rtbhouse teads kargo roundel gridvid col_ss rubi_ss tripl_ss pubm_ss yah_ss improve_ss krgo_ss opnx_ss under_ss".split(" ")],["20sf2","ozone under_ss 33across nativo triplelift grid undertone opnx_ss yieldmo col_ss unruly yah_ss pubm_ss krgo_ss improve_ss tripl_ss rubi_ss".split(" ")],
["20scf","appnexus teads kargo pubmatic ix ttd rubicon pubm_ss yieldmo yahoossp yah_ss colossus undertone unruly opnx_ss krgo_ss".split(" ")]]),Gc=class extends X{init(){this._key="MultistagePrebidAuctionV"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Gc.prototype,"run",null);Gc=q([v("MultistagePrebidAuctionVideoExperiment"),y()],Gc);let Jh=class{constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z){var x,B;this._gam=f;this._site=g;this._partners=
w;this.bidPoolSlots=["Below_Post","Content","Sidebar","Recipe"];this.deals=[];this.firstVideoAuctionBidders=new Set;this.secondVideoAuctionBidders=new Set;this.auctionMapping=new Map;this.targetingKeys="ADOMAIN AD_ID BIDDER CACHE_ID CACHE_HOST DEAL FORMAT PRICE_BUCKET SIZE SOURCE UUID INTERSTITIAL DSP CRID".split(" ");this.advertiserId=413678576;this.refreshStickyOutstreamAuctionCount=this.refreshAuctionCount=1;this.rubiconS2SBidders=[l.YahooSSPServer,l.RubiconServer];this.sendAllBidsTargetingKeys=
this.targetingKeys.filter(C=>!["ADOMAIN","BIDDER","INTERSTITIAL","DSP","CRID"].includes(C));this._s2sBidders=[];this._isIOS=Mb();this.s2s=this._setupS2SBidders(a,h,k,m,n,p,r);this.interstitialAdUnitCode=`gpt_unit_/${this._gam.account}/AdThrive_Interstitial_1/${this._site.id}_0`;this.ortbEnrich=c.result;a=Object.values(l);let E=[l.AmazonTAM,l.AmazonUAM];a=a.filter(C=>!this.s2s.bidders.includes(C)&&!E.includes(C));c=d.result||"off";f=d.result||"off";this.multistageActive="off"!==c;this.multistageStickyOutstreamActive=
"off"!==f;z=null!==(x=z.result)&&void 0!==x?x:0;this._determineBidderLabel(c,z,a);this._determineVideoBidderLabel(e);this.auctionDelay=null!==(B=b.result)&&void 0!==B?B:0;this._setRefreshAuctionCount(d);this.experimentRefreshInterval=3E4-5E3*this.refreshAuctionCount}_setRefreshAuctionCount(a){a.result&&"off"!==a.result&&(this.refreshAuctionCount=2)}_setupS2SBidders(a,b,c,d,e,f,g){this._addToS2SBidders(l.ColossusServer,b&&b.result);this._addToS2SBidders(l.KargoServer,c&&c.result);this._addToS2SBidders(l.OpenXServer,
d&&d.result);this._addToS2SBidders(l.RubiconServer,e&&e.result);this._addToS2SBidders(l.TripleliftServer,f&&f.result);this._addToS2SBidders(l.YahooSSPServer,g&&g.result);a=a.result||[];b=a.indexOf(l.GumGum);this._isIOS&&-1<b&&a.splice(b,1);a=[...a,...this._s2sBidders];let h=new Map([[l.ColossusServer,l.Colossus],[l.ImproveDigitalServer,l.ImproveDigital],[l.KargoServer,l.Kargo],[l.OpenXServer,l.OpenX],[l.PubmaticServer,l.Pubmatic],[l.RubiconServer,l.Rubicon],[l.TripleliftServer,l.Triplelift],[l.YahooSSPServer,
l.YahooSSP],[l.UndertoneServer,l.Undertone]]);return{bidders:a.filter(k=>this._partners.display.get(k)||this._partners.video.get(k)||h.has(k)&&(this._partners.display.get(h.get(k))||this._partners.video.get(h.get(k))))}}_determineBidderLabel(a,b,c){if("off"!==a){var d="20sc"===a||"20s"===a,e=this.s2s.bidders,f=Object.values(l),g=[l.AmazonTAM,l.AmazonUAM];f=f.filter(k=>!e.includes(k)&&!g.includes(k));var h={};d?(b="20sc"===a?Math.ceil(c.length/2):0,h[1]=e.concat(this._shuffleArray(c).slice(0,b))):
(a=Pt.get(a),h[1]=this._evaluateMulistageServerBidders(b,e,a)||[...e,...c]);h[2]=this._getLastAuctionBidders(h[1]||[],[...e,...f]);for(let k in h)this._addBidderLabelToAuctionMap(h[k],Number(k))}}_evaluateMulistageServerBidders(a,b,c){c&&1===a?c=c.concat(b).filter(Lb):c&&2===a&&(c=c.filter(d=>!b.includes(d)));return c}_getLastAuctionBidders(a,b){return b.filter(c=>!a.includes(c))}_addBidderLabelToAuctionMap(a,b){a.forEach(c=>{this.auctionMapping.set(c,`auction-${b}`)})}_determineVideoBidderLabel(a){var b=
Object.values(l);let c=[l.AmazonTAM,l.AmazonUAM];b=b.filter(e=>!this.s2s.bidders.includes(e)&&!c.includes(e));var {result:d}=a;this.refreshStickyOutstreamAuctionCount="off"!==d?2:1;({bidders:a}=this.s2s);"10s1"!==d||this._isIOS?"10s2"!==d||this._isIOS?this.secondVideoAuctionBidders=this.firstVideoAuctionBidders=new Set([...a,...b]):(this.firstVideoAuctionBidders=new Set(a),this.secondVideoAuctionBidders=new Set(b)):(b=this._shuffleArray(b),d=Math.ceil(b.length/2),this.firstVideoAuctionBidders=new Set([...a,
...b.slice(0,d)]),this.secondVideoAuctionBidders=new Set(b.slice(d)))}_shuffleArray(a){a=[...a];for(let b=a.length-1;0<b;b--){let c=Math.floor(Math.random()*(b+1));[a[b],a[c]]=[a[c],a[b]]}return a}_addToS2SBidders(a,b){"both"!==b&&"server"!==b||this._s2sBidders.push(a)}getVideoBidderLabel(a){let b=this.firstVideoAuctionBidders.has(a);a=this.secondVideoAuctionBidders.has(a);return b&&!a||!b&&a?b?["auction-1"]:["auction-2"]:[]}getBidderLabel(a){return[this.auctionMapping.get(a)||`auction-${this.refreshAuctionCount}`]}};
Jh=q([y(),t("design:paramtypes",[Fh,Gh,Hh,Ie,Gc,De,He,pd,qd,rd,sd,td,ud,Ke,Ih])],Jh);let Kh=["Sidebar_3","Sidebar_4","Sidebar_5","Native_Recipe"];class Ip{constructor(a,b,c,d,e,f=!1,g=8,h,k=[],m=!0,n=!1){this.location=a;this.sequence=b;this.sizes=c;this.element=d;this.sticky=e;this.lazy=f;this.auctionPriority=g;this.stickyOverlapSelector=h;this.special=k;this.enabledForAuction=m;this.infinite=n;this.closed=this.isRefreshing=this.refreshPaused=!1;this.slotFullyRenderedDuration=this.viewableDuration=
0;this.outOfViewGPT=this.outOfViewIO=!0;this.displayed=this.alwaysInView=!1;this.viewability=this.refreshCount=0;this.highlyViewable=!1;this.hvp=0;this.servedPrebidBidResponse=void 0;this.lazyDisabled=!1;this.transactionId="";this.nativeEnabled=this.multiformat=!1;"Video_StickyOutstream"===this.location&&(this.noAdRefreshCount=this.stickyOutstreamErrorCount=0,this.stickyOutstreamErrorLogged=!1)}get id(){return this.element.id}get isSticky(){return this.sticky}get hasHighViewability(){return this.sticky||
"Recipe"===this.location}setHighlyViewable(a){a=this.viewability>=Number(a&&a.hvThreshold);this.highlyViewable=this.lazy||a}setBidPoolId(a){this.location.includes("Sidebar")?this.generateSidebarBidPoolId(a):this.generateContentBidPoolId(a)}generateSidebarBidPoolId(a){var b=this.lazy;let c=`${this.location}_${this.sequence}`;this.sequence&&!Kh.includes(c)&&(b=b?b?"_Lazy":"":"_Nonlazy",2>=this.sizes.length||!a.includes(this.location)||!b||(this.bidPoolId=`${this.location}_BPID${b}`))}generateContentBidPoolId(a){var b=
this.lazy;let c=this.location.toLowerCase().includes("content"),d=this.sequence;b=c&&d&&4<=d&&!b?"_Nonlazy":c&&b?"_Lazy":"";!a.includes(this.location)||c&&!b||(this.bidPoolId=`${this.location}_BPID${b}`)}setPassiveBidPoolId(){let a=this.lazy,b=this.location;var c=`${b}_${this.sequence}`;let d=b.includes("Content");c=b.includes("Sidebar")&&!Kh.includes(c);a||!d&&!c||(this.passiveBidPoolId=`${b}_BPID_Lazy`)}isHighlyViewable(){return this.highlyViewable||this.lazy||0<this.refreshCount}get isAboveTheFold(){return 1E3<
this.element.getBoundingClientRect().top+window.pageYOffset}hasSize([a,b]){return this.sizes.some(([c,d])=>a===c&&b===d)}get name(){return[this.location,this.sequence].filter(kc).join("_")}get placementMapName(){return"Content"===this.location&&this.sequence&&9<this.sequence?"Content_9":this.name.includes("Below_Post")?"Below_Post":"Sidebar"===this.location&&this.sequence&&9<this.sequence?"Sidebar_9":"Recipe"===this.location&&this.sequence&&5<this.sequence?"Recipe_2":this.name}pushToQueue(a){let b=
window.googletag;b&&b.cmd&&b.cmd.push(a)}setViewability(a){let b=a.adViewability.length&&void 0!==a.adViewability[0].home&&void 0!==a.adViewability[0].depth&&void 0!==a.adViewability[0].lazy,c="/"===window.location.pathname?"1":"0",d=U.getLocalStorageValue("session_fpv"),e=!0===d||null===d?"1":"0";a.adViewability.filter(f=>f.speed===a.speed&&window.innerWidth>=f.width[0]&&(!f.width[1]||window.innerWidth<=f.width[1])&&(!b||f.home===c&&f.depth===e&&this.lazy===f.lazy)).forEach(f=>{Object.keys(f.adUnits).forEach(g=>
{g===this.name?this.viewability=f.adUnits[g]:"Content"===this.location&&9<this.sequence?this.viewability=f.adUnits.Content:"Below_Post"===this.location&&1<this.sequence&&(this.viewability=f.adUnits.Below_Post)})})}clearTargeting(a){this.googleTagSlot?this.googleTagSlot.clearTargeting(a):A.error("Slot","setTargeting","Attempted to clear targeting before slot was defined",a)}setTargeting(a){this.pushToQueue(()=>{if(this.googleTagSlot){let b=Array.isArray(a)?a:[a];for(let c of b)this.googleTagSlot.setTargeting(c.key,
c.value)}else A.error("Slot","setTargeting","Attempted to set targeting before slot was defined",a)})}setSlotTargetingFlag(a,b,c=!1){let d=()=>{if(this.googleTagSlot){const e=this.googleTagSlot.getTargeting("flag_slot").filter(f=>{[f]=f.split(":");return!c||f!==a});this.googleTagSlot.setTargeting("flag_slot",[...e,...b.map(f=>`${a}:${f}`)])}};b&&0<b.length&&this.pushToQueue(()=>d())}clearSlotTargetingFlag(a){let b=()=>{if(this.googleTagSlot){const c=this.googleTagSlot.getTargeting("flag_slot").filter(d=>
{[d]=d.split(":");return!a.includes(d)});this.googleTagSlot.setTargeting("flag_slot",[...c])}};this.pushToQueue(()=>b())}getTargeting(a){if(this.googleTagSlot)return this.googleTagSlot.getTargeting(a);A.error("Slot","getTargeting","Attempted to get targeting before slot was defined",a);return[]}setTransactionId(a){this.transactionId=a}getTargetingMap(){if(this.googleTagSlot){let a=this.googleTagSlot;return a.getTargetingKeys().reduce((b,c)=>{b[c]=a.getTargeting(c);return b},{})}A.error("Slot","getTargetingMap",
"Attempted to get targeting before slot was defined");return{}}setSlotAppBids(a,b){a=a.filter(c=>c.adUnitCode===b).map(c=>c.adId);a.length&&(this.slotAppBids=a)}getSlotAppBids(){return this.slotAppBids}addRequestTypeSlotFlag(){var a;if((null===(a=null===this||void 0===this?void 0:this.getSlotAppBids())||void 0===a?0:a.length)&&(null===this||void 0===this?0:this.googleTagSlot)){let b=this.getSlotAppBids();this.googleTagSlot.getTargeting("hb_adid").some(c=>null===b||void 0===b?void 0:b.includes(c))&&
this.setSlotTargetingFlag("reqtype",["app"],!0)}}}let Qa=class{constructor(){this.added=new L;this.bidServed=new L;this._slots=new Map}add(a){let b=sessionStorage.getItem("adthrive_footer_closed");a=this.castArray(a);b&&(a=a.filter(c=>"Footer"!==c.location));for(let c of a)if(!this._slots.has(c.id)){this._slots.set(c.id,c);try{this.added.emit(c)}catch(d){A.error("Slots","add",d)}}return a}remove(a){a=this.castArray(a);for(let b of a)this._slots.has(b.id)&&(b.closed=!0,this._slots.delete(b.id))}get(a){return a?
this._slots.get(a):[...this._slots.values()]}castArray(a){return"string"===typeof a?(a=this.get(a),void 0!==a?[a]:[]):Array.isArray(a)?a:[a]}};Qa=q([v("Slots"),y()],Qa);let vd=class{constructor(a,b){this._slots=a;this._slotEventBus=b;this.slotIntersectionObservers=new Map;this.unobservedSlotIntersectionObservers=new Map}observe(a,b){a=this.getIntersectionObserver(a);this.slotIntersectionObservers.set(b,a);this.unobservedSlotIntersectionObservers.set(b,a);a.observe(b.element)}unobserve(a){let b=this.unobservedSlotIntersectionObservers.get(a);
b&&(b.unobserve(a.element),this.unobservedSlotIntersectionObservers.delete(a))}unobserveAll(a=!0){this.unobservedSlotIntersectionObservers.forEach((b,c)=>{this.unobserve(c);a&&this._slotEventBus.displaySlot.emit(c)})}getIntersectionObserver(a){return new IntersectionObserver(b=>{for(const c of b)this.processEntry(c)},{rootMargin:`${a/100*window.innerHeight}px 0px`,threshold:[0]})}processEntry(a){let b=this._slots.get(a.target.id);b&&0<a.intersectionRatio&&this.unobservedSlotIntersectionObservers.has(b)&&
(this._slotEventBus.displaySlot.emit(b),this.unobserve(b))}};vd=q([v("IntersectionObserverManager"),y(),t("design:paramtypes",[Qa,cb])],vd);let Lh=class extends X{init(){this._key="DCSLLSiteSpecific"}};Lh=q([v("DCSLLSiteSpecificExperiment"),y()],Lh);class Jp{constructor(){this._featureRollouts={}}get siteFeatureRollouts(){return this._featureRollouts}isRolloutEnabled(a){return this._featureRollouts&&this._featureRollouts[a]?this._featureRollouts[a].enabled:!1}}let wd=class extends Jp{constructor(a){super();
this._featureRollouts=a.siteAds.featureRollouts||{}}};wd=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],wd);let Mh=class{constructor(a,b){this._consentEventBus=b;this._storageKey="act25-consent";this._storageTimeout=33696E6;this._required="CA"===a.core.country&&vh(["America/Toronto","America/Blanc-Sablon","America/Montreal","America/Nipigon"],[300,240])&&this._isFrenchLanguage();this._consented=U.getLocalStorageValue(this._storageKey,!0,!1,this._storageTimeout);this._required&&this._setupListeners()}get required(){return this._required}get consented(){return this._consented}set consented(a){this._consented=
a}_setupListeners(){this._consentEventBus.act25consentCaptured.on(a=>{this._consented=a})}_isFrenchLanguage(){var a,b;let c=null!==(a=navigator.language&&navigator.language.toLowerCase())&&void 0!==a?a:"";a=null!==(b=navigator.languages&&navigator.languages.map(d=>d.toLowerCase()))&&void 0!==b?b:[];return"fr"===c||c.includes("fr-")||(null===a||void 0===a?void 0:a.some(d=>"fr"===d||d.includes("fr-")))}};Mh=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,md])],Mh);let Le=class extends X{init(){this._key=
"InterstitialAlt"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Le.prototype,"run",null);Le=q([v("InterstitialExperiment"),y()],Le);let Kp=()=>{try{const a=window.localStorage.getItem("__lsv__"),b=a?JSON.parse(decodeURIComponent(a)):[];return 2500<=window.innerWidth?{isError:!1,canDisplay:!1}:b.length?{isError:!1,canDisplay:36E5<Date.now()-b[0]}:{isError:!1,canDisplay:!0}}catch(a){return{isError:!0,canDisplay:!1,message:a.message}}},
Me=class extends Fc{constructor(a,b){super();this._siteExperiments=a;this._pubabgroup=b;this._choices=[];this._result=!1;this.key=bb.Interstitial;let {isError:c,canDisplay:d,message:e}=Kp();c&&A.error("InterstitialSiteExperiment","constructor",{message:e});this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);this.enabled&&this.experimentConfig&&d&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){return(new Ha(this._choices[0].weight/
100)).get()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;this._pubabgroup.set(a,this._result?"on":"off")}else A.error("InterstitialSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config")}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Me.prototype,"run",null);Me=q([y(),t("design:paramtypes",[vb,pb])],Me);let Ne=
class extends Fc{constructor(a,b){super();this._siteExperiments=a;this._pubabgroup=b;this._choices=[];this._result=!1;this.key=bb.FooterCloseButton;this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){return(new Ha(this._choices[0].weight/100)).get()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;
this._pubabgroup.set(a,this._result?"on":"off")}else A.error("RemoveFooterCloseButtonSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config")}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Ne.prototype,"run",null);Ne=q([y(),t("design:paramtypes",[vb,pb])],Ne);let xd=class{constructor(a,b,c){var d,e,f,g,h,k,m;this._interstitialSiteExperiment=b;this._removeFooterCloseButtonSiteExperiment=c;this.footerCloseButtonMigrated=
!1;let {allowSmallerAdSizes:n,footerCloseButton:p,footerCloseButtonMobile:r,footerCloseButtonDesktop:w,footerSelector:z,infiniteScroll:x,infiniteScrollOptions:B,infiniteScrollRefresh:E,isAutoOptimized:C,pmp:I,targetaff:F,stickyContainerConfig:O,sidebarConfig:R,siteAttributes:J,dynamicContentSlotLazyLoading:aa,desktopInterstitial:qa,mobileInterstitial:za}=a.siteAds.adOptions;this.allowSmallerAdSizes=Q(n,!0);void 0!==r&&void 0!==w&&(this.footerCloseButtonMigrated=!0);b=this._isGamInterstitialNetworkExperimentEnabled(a);
this.interstitial={gam:this._interstitialSiteExperiment.enabled?this._interstitialSiteExperiment.result:b,prebid:!1};this._removeFooterCloseButtonSiteExperiment.enabled?this.footerCloseButtonDesktop=this.footerCloseButtonMobile=this.footerCloseButton=b=!this._removeFooterCloseButtonSiteExperiment.result:(this.footerCloseButton=Q(p,!0),this.footerCloseButtonMobile=Q(r,!0),this.footerCloseButtonDesktop=Q(w,!0));this.footerSelector=Q(z,"");this.pmp=Q(I,!0);this.infiniteScroll=Q(x,!1);this.infiniteScrollOptions=
Q(B,{});this.infiniteScrollRefresh=Q(E,!0);this.isAutoOptimized=Q(C,!1);this.targetAff=Q(F,!1);this.spa=Q(a.siteAds.adOptions.spa,!1);this.stickyContentEnabled=null===(d=null===O||void 0===O?void 0:O.content)||void 0===d?void 0:d.enabled;this.stickyContentHeight=null===(e=null===O||void 0===O?void 0:O.content)||void 0===e?void 0:e.minHeight;this.stickyRecipeHeight=ca()?null===(f=null===O||void 0===O?void 0:O.recipeMobile)||void 0===f?void 0:f.minHeight:null===(g=null===O||void 0===O?void 0:O.recipeDesktop)||
void 0===g?void 0:g.minHeight;this.stickyHeaderSelectors=null===O||void 0===O?void 0:O.stickyHeaderSelectors;this.stickyBlockedSelectors=null===O||void 0===O?void 0:O.blockedSelectors;this.dynamicStickySidebarEnabled=null===(h=null===R||void 0===R?void 0:R.dynamicStickySidebar)||void 0===h?void 0:h.enabled;this.dynamicStickySidebarHeight=null===(k=null===R||void 0===R?void 0:R.dynamicStickySidebar)||void 0===k?void 0:k.minHeight;this.dynamicStickySidebarBlockedSelectors=null===(m=null===R||void 0===
R?void 0:R.dynamicStickySidebar)||void 0===m?void 0:m.blockedSelectors;this.dynamicStickySidebarHeaderSelectors=ca()?null===J||void 0===J?void 0:J.mobileHeaderSelectors:null===J||void 0===J?void 0:J.desktopHeaderSelectors;this.dynamicContentSlotLazyLoading=Q(aa,!1);this.desktopInterstitial=Q(qa,!1);this.mobileInterstitial=Q(za,!1)}_isGamInterstitialNetworkExperimentEnabled(a){let {isError:b,canDisplay:c,message:d}=Kp();var e=ca()&&Q(a.siteAds.adOptions.mobileInterstitial,!1);a=!ca()&&Q(a.siteAds.adOptions.desktopInterstitial,
!1);b&&A.error("InterstitialExperiment","canDisplayInterstitial",{message:d});return c&&(e||a)?(e=S.resolve(Le))&&e.result&&"off"!==e.result?!0:!1:!1}};xd=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Me,Ne])],xd);let Nh=class{constructor(a){a=a.siteAds.adTypes||{};this.animatedFooter=Q(a.animatedFooter,!0);this.expandableFooter=Q(a.expandableFooter,!0);this.inRecipeRecommendationDesktop=Q(a.inRecipeRecommendationDesktop,!0);this.inRecipeRecommendationMobile=Q(a.inRecipeRecommendationMobile,
!0);this.interscroller=ca()?Q(a.interscroller,!0):!1;this.largeFormatsDesktop=Q(a.largeFormatsDesktop,!0);this.largeFormatsMobile=Q(a.largeFormatsMobile,!0);this.miniscroller=ca()?Q(a.miniscroller,!0):!1;this.nativeDesktopContent=Q(a.nativeDesktopContent,!0);this.nativeDesktopRecipe=Q(a.nativeDesktopRecipe,!0);this.nativeDesktopSidebar=Q(a.nativeDesktopSidebar,!0);this.nativeDesktopHeader=Q(a.nativeDesktopHeader,!0);this.nativeDesktopBelowPost=Q(a.nativeDesktopBelowPost,!0);this.nativeMobileContent=
Q(a.nativeMobileContent,!0);this.nativeMobileRecipe=Q(a.nativeMobileRecipe,!0);this.nativeMobileHeader=Q(a.nativeMobileHeader,!0);this.nativeMobileBelowPost=Q(a.nativeMobileBelowPost,!0);this.outstreamDesktop=Q(a.outstreamDesktop,!0);this.outstreamMobile=Q(a.outstreamMobile,!0);this.sponsorTileDesktop=Q(a.sponsorTileDesktop,!1);this.sponsorTileMobile=Q(a.sponsorTileMobile,!1)}has(a){return this[a]&&!0===this[a]}get enabled(){return Object.keys(this).filter(a=>!0===this[a])}get enabledMinified(){let a=
{outstreamDesktop:{min:"od",val:this.outstreamDesktop},outstreamMobile:{min:"om",val:this.outstreamMobile}};return this.enabled.filter(b=>Object.keys(a).includes(b)&&a[b].val).map(b=>a[b].min)}get outstreamEnabled(){return ca()?!0===this.outstreamMobile:!0===this.outstreamDesktop}};Nh=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],Nh);let Oe=class extends W{init(){this._key="Optable";this._autorun=this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",
[]),t("design:returntype",Object)],Oe.prototype,"run",null);Oe=q([v("OptableExperiment"),y()],Oe);let Lp=a=>{const b=document.getElementsByTagName("meta");return!!Array.from(b).filter(c=>c.name===a&&"true"===c.content).length},yd=()=>Lp("child-directed-treatment"),Pe=()=>Lp("health-directed-treatment"),Qe=class extends fb{constructor(a,b,c){super();this._result=!0;this.key="Amazon";this._choices=[{choice:!0},{choice:!1}];this.weight=.995;a=a.deliveryFeatures;c=c.getCoreExperimentButMutateWeights(this.key);
a&&a.includes("amazonLoad")||!c||(this._expConfigABGroup=c.abgroup,this.weight=c.variants[0].weight,this._result=this.run(),b.set(c.abgroup,this._result?"on":"off"))}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Qe.prototype,"run",null);Qe=q([v("AmazonExperiment"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Ia,Ob])],Qe);let Oh=class extends W{init(){this._key="WebVitals";
this._default=!1}};Oh=q([v("WebVitalsExperiment"),y()],Oh);let Fa=class{constructor(a,b,c){this.optableLoblawEnabled=this.optableEnabled=!1;this.bootstrapResult=new Map;this.bootstrapLoaders={};this.ccpaOptIn="1YNY";this.ccpaOptOut="1YYY";this.ccpaConsentChange=new L;this.usPrivacyRegions="US CA TW ID SG JP AU NZ MX".split(" ");let d=a&&a.core&&a.core.country;this.webVitalsEnabled=ic()?S.resolve(Oh).result:!1;this.ccpaRequired=d?this.usPrivacyRegions.includes(d):!1;this.initializeCcpaPrivacyString();
this.ccpaEnabled=(this.ccpaUserOptedOut=this.ccpaPrivacyString===this.ccpaOptOut)&&this.ccpaRequired;this.gptLibFailed=!1;this.liveRamp=Q(a.siteAds.adOptions.liveRamp,!0);this.liveRampId=Q(a.siteAds.adOptions.liveRampId,"7f035220-1751-4684-bb7f-a1c0d45657df");36!==this.liveRampId.length&&(this.liveRampId="7f035220-1751-4684-bb7f-a1c0d45657df");if("FR"===d||"DE"===d)this.liveRampId="34233849-5500-4e44-8601-5006ae8d13fe";var e=Mb()?"/s2s":"";this._baseUrl=a.baseUrl;this._targetPath=`${a.targetPath}${e}`||
`/es2018${e}`;e=a.deliveryFeatures;this.isAmazonPreloaded=!(!e||!e.includes("amazonLoad"));this.isGPTPreloaded=!(!e||!e.includes("gptLoad"));this.isPrebidPreloaded=!(!e||!e.includes("prebidLoad"));this.isOptablePreloaded=!(!e||!e.includes("optableLoad"));this.amazonEnabled=b.result||this.isAmazonPreloaded;if("US"===d||"CA"===d)this.optableEnabled=(c.result||this.isOptablePreloaded)&&void 0===a.invalidTraffic,this.optableLoblawEnabled="CA"===d&&this.optableEnabled;this.isGDPR="true"===a.gdpr}get baseUrl(){return this._baseUrl}get targetPath(){return this._targetPath}checkIsFirstPageview(){let a=
0;try{let b=U.getLocalStorageValue("fpv");b&&(a=Date.now()-Date.parse(b));if(!b||864E5<a)return!0}catch(b){}return!1}initializeCcpaPrivacyString(){this.ccpaPrivacyString=Na("usprivacy");yd()&&this.ccpaRequired?this.ccpaPrivacyString=this.ccpaOptOut:Pe()&&this.ccpaRequired&&vh(["America/Los_Angeles"],[480])?this.ccpaPrivacyString=this.ccpaOptOut:!this.ccpaPrivacyString&&this.ccpaRequired&&(this.ccpaPrivacyString=this.ccpaOptIn)}};Fa=q([v("BootstrapConfig"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",
[Object,Qe,Oe])],Fa);let Ph=class{constructor(a,b){this._bootstrapConfig=b;this.type=Oa.Amazon;this.wait=!1;this._url="https://c.amazon-adsystem.com/aax2/apstag.js";this._link="https://c.amazon-adsystem.com";this._amazonUAM=a.siteAds.adOptions.amazonUAM}async load(){if(this._bootstrapConfig.amazonEnabled&&this._amazonUAM){this._init();if(this._bootstrapConfig.isAmazonPreloaded)return Promise.resolve(!0);this._addAmazonLinks();return this._addApstag()}return Promise.resolve(!1)}_addApstag(){return nb(this._url)}_addAmazonLinks(){let a=
this._link;up(a,"dns-prefetch");up(a,"preconnect",[{name:"crossorigin",value:""}])}_init(){window.apstag||(window.apstag={init(){window.apstag._Q.push(["i",arguments])},fetchBids(){window.apstag._Q.push(["f",arguments])},setDisplayBids(){},targetingKeys(){return[]},dpa(){window.apstag._Q.push(["di",arguments])},rpa(){window.apstag._Q.push(["ri",arguments])},upa(){window.apstag._Q.push(["ui",arguments])},_Q:[]})}};Ph=q([v("AmazonBootstrap"),H(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Fa])],
Ph);let Qh=class extends W{init(){this._key="UseOptableHem";this._autorun=this._default=!1}run(){return super.run()}};Qh=q([v("UseOptableHemExperiment"),y()],Qh);let Pb=class{constructor(a){var b;this._useOptableHemExperiment=a;this.enabled=!1;this.useOptableHem=null!==(b=this._useOptableHemExperiment.result)&&void 0!==b?b:!1;this.loblawEnabled=!1}};Pb=q([y(),t("design:paramtypes",[Qh])],Pb);var Hc;(function(a){a.GetPiiData="adthrive_GetPiiData";a.SetPiiData="adthrive_SetPiiData";a.DeletePiiData=
"adthrive_DeletePiiData";a.SendPiiData="adthrive_SendPiiData"})(Hc||(Hc={}));let Re=class{constructor(a,b){this._bootstrapConfig=a;this._piiEventBus=b;this._host="adthriveDevelopmentMode"in window?"https://localhost:8080":"https://ads.adthrive.com";this._frame=document.createElement("iframe");this._frameSrc=`${this._bootstrapConfig.baseUrl.replace("/gdpr","")}/html/i.html`;this.enabled&&this._addIframeToPage().then(()=>{this._piiEventBus.iframeReady.emit();this._setupEventListeners()}).catch(c=>{A.error("PiiIframeManager",
"constructor","Failed to initialize identity iframe",c)})}get enabled(){return!this._bootstrapConfig.ccpaUserOptedOut}deleteData(){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({action:Hc.DeletePiiData},this._host)}catch(a){A.error("PiiIframeManager","deleteIdentity","Failed to delete identity data",a)}}setData(a){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({action:Hc.SetPiiData,piiData:a},this._host)}catch(b){A.error("PiiIframeManager","setIdentity",
"Failed to set identity data",b)}}getData(){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({action:Hc.GetPiiData},this._host)}catch(a){A.error("PiiIframeManager","getIdentity","Failed to get identity data",a)}}_addIframeToPage(){return new Promise(a=>{this._frame.src=this._frameSrc;this._frame.id="adthrive-pii";this._frame.style.display="none";this._frame.onload=()=>{a()};document.body.appendChild(this._frame)})}_setupEventListeners(){this._piiEventBus.dataCaptured.on(a=>{let {sha1Hash:b,
sha256Hash:c,source:d}=a;(c||b||d)&&this.setData({sha1Hash:b,sha256Hash:c,source:d})},{handleEventsAlreadyEmitted:!0});this._bootstrapConfig.ccpaConsentChange.on(a=>{a===this._bootstrapConfig.ccpaOptOut&&this.deleteData()});this._frame.contentWindow&&window.addEventListener("message",this._handleMessageEvent.bind(this))}_handleMessageEvent(a){let b=a.data.piiData;a.origin===this._host&&a.data.action===Hc.SendPiiData&&this._piiEventBus.dataSentFromIframe.emit(b||null)}};Re=q([v("PiiIframeManager"),
y(),t("design:paramtypes",[Fa,Db])],Re);let Rh=class extends Eb{init(){this._key="hemSourceAllowlist"}setABGroup(a,b){(a=this._coreExperimentConfig.getCoreExperiment(this.key))&&this.abgroupClass.set(a.abgroup,"on")}};Rh=q([v("HemSourceAllowlistExperiment"),y()],Rh);let zd=class{constructor(a){var b;this.default=!1;this.allowedSources=null!==(b=a.result)&&void 0!==b?b:[]}_getMatchedHemSource(a){var b=a.match(/^l_i$/);if(b)return b[0];if((b=a.match(/^(ss)_.*/))||(b=a.match(/(?:g_)(.*?)(?:_c|_s)/))&&
b[1])return b[1];if((a=a.match(/(.*?)(?:_c|_s)/))&&a[1])return a[1]}checkSource(a){var b;if(!a)return this.default;a=null!==(b=this._getMatchedHemSource(this._removeIdentityIframePrefix(a)))&&void 0!==b?b:"";return this.allowedSources.includes(a)?!0:this.default}_removeIdentityIframePrefix(a){let b=a.match(/^l_i-(.*)/);return b&&b[1]?b[1]:a}};zd=q([y(),t("design:paramtypes",[Rh])],zd);let Ic=class{constructor(a,b,c,d){this._piiEventBus=a;this._piiIframeManager=b;this._optableConfig=c;this._hemSourceAllowlist=
d;this._elements=[];this._growMeOnPage=this._emailProviderOnPage=this._keydownListenerAdded=!1;this._growMeSelector='[id^="grow-me-inline-subscribe-cta-root-"]';this._growMeFormSelector='[class^="SubscribeCtaWidget___StyledDiv6-"]';this.piiManagerReady=new L;this.emailCaptured=new ab;this._emailProviders=[{divSelector:'div[id$="-optin"]'},{divSelector:'div[class^="cb-form-group"]'},{divSelector:"div.sumo-form-wrapper.listbuilder-popup"},{divSelector:this._growMeSelector}];this._emailCheckTimeout=
1500;this._eventMap=new Map([["mousemove",window],["scroll",window],["mouseleave",document],["om.Campaign.startShow",document]]);this._boundCallEventHandler=this.callCheckEmailProviders.bind(this);this._boundProcessEventHandler=this.processInputChange.bind(this);this.addEmailProviderListeners();this._addElementListeners();this._addKeydownEventListener()}captureEmail(a,b,c){b=this.checkSources(b);this.emailCaptured.emit({pii:{email:a,source:`${b}_c`}})}checkSources(a){a="slickstream"===a?"ss":a;let b=
"url urlh c nl ss l_s l_i api grwm g_td".split(" ");return a&&(b.includes(a)||(null===a||void 0===a?0:a.startsWith("ss_")))?a:"o"}_processHash(a,b){return a&&"string"===typeof a&&a.match(/value/i)?this._retrieveBitHashString(a,b):a||""}collectEmailFromStorage(){this.piiManagerReady.once(()=>{let [a,b]=this._getStoredHashInfo(),c=this._getStoredSource(b);a?this._processStoredHash(a,c):this._collectFromIframe()})}_getStoredHashInfo(){var a=Na("adt_ei");a=a?JSON.parse(a):null;let b=U.getLocalStorageValue("adt_ei",
!1),c=null,d=!1;a?(c=a,d=!0):b&&(c="string"===typeof b?{sha256Hash:b,sha1Hash:""}:b);return[c,d]}_getStoredSource(a=!1){var b=Na("adt_emsrc");b=(b?JSON.parse(b):null)||U.getLocalStorageValue("adt_emsrc",!1)||"o_s";return b.includes("l_i")?this._retrieveIframeSourceString(b):b.includes("g_")?(a=b.includes("_c"),"g_td"===b?`${b}${"_c"}`:a?b.replace("_c","_s"):b):this._determineSource(b,a)}_determineSource(a,b){let c="url"===a||"urlh"===a,d=a.endsWith("_c");a=a&&a.match(/value/i)?this._retrieveSourceString(a):
a;return c?`${a}_c`:d?a.replace(/_c$/,"_s"):b?"cki_s":a}_processStoredHash(a,b){var c=[{key:"sha256Hash",length:64},{key:"sha1Hash",length:40}];for(let d of c)c=a[d.key],c.length&&(a[d.key]=this._processHash(c,d.length));a&&b&&(a.sha256Hash||a.sha1Hash)&&this.emailCaptured.emit({pii:{sha256Hash:a.sha256Hash,sha1Hash:a.sha1Hash,source:b}})}_collectFromIframe(){this._piiEventBus.dataSentFromIframe.once(a=>{a&&(a.source&&!a.source.includes("l_i-")&&(a.source=`${"l_i-"}${a.source}`),this.emailCaptured.emit({pii:a}))});
this._piiEventBus.iframeReady.on(()=>this._piiIframeManager.getData(),{handleEventsAlreadyEmitted:!0})}_retrieveBitHashString(a,b){return(a=a.match(`\\w{${b}}`))?a[0]:""}_retrieveSourceString(a){return(a=a.match(/[a-z]{1,4}_[a-z]{1}/))?a[0]:"o_s"}_retrieveIframeSourceString(a){return(a=a.match(/^(l_i)-(.*)/))&&3===a.length?a[0].replace(/_c$/,"_s"):"l_i"}addEmailProviderListeners(){this._eventMap.forEach((a,b)=>{a.addEventListener(b,this._boundCallEventHandler)})}removeEmailProviderListeners(){this._eventMap.forEach((a,
b)=>{a.removeEventListener(b,this._boundCallEventHandler)})}callCheckEmailProviders(a){("mouseleave"!==a.type||0>=a.clientY)&&setTimeout(()=>{this._emailProviderOnPage||this.emailProviderHandler()},this._emailCheckTimeout)}emailProviderHandler(){for(let a of this._emailProviders)if(document.querySelectorAll(a.divSelector).length){a.divSelector.includes("grow-me")&&(this._growMeOnPage=!0);this.removeEmailProviderListeners();this._emailProviderOnPage=!0;this._addElementListeners();break}}setElements(){var a,
b;this._elements=Array.prototype.slice.call(document.querySelectorAll("input[type=text], input[type=email], input[name=email]"));if(this._growMeOnPage){var [c]=Array.from(document.querySelectorAll(this._growMeSelector));c=null!==(b=Array.prototype.slice.call(null===(a=null===c||void 0===c?void 0:c.shadowRoot)||void 0===a?void 0:a.querySelectorAll("input[type=text], input[type=email], input[name=email]")))&&void 0!==b?b:[];this._elements=[...this._elements,...c]}}_addKeydownEventListener(){document.addEventListener("keydown",
a=>this._keydownEventListener(a))}_keydownEventListener(a){"keydown"!==a.type||"@"!=a.key||this._keydownListenerAdded||(this._keydownListenerAdded=!0,this._addElementListeners())}_addElementListeners(){this.setElements();for(let a of this._elements)a.addEventListener("blur",this._boundProcessEventHandler),a.addEventListener("change",this._boundProcessEventHandler)}removeElementListeners(){for(let a of this._elements)a.removeEventListener("blur",this._boundProcessEventHandler),a.removeEventListener("change",
this._boundProcessEventHandler)}sourceOrigin(a){let b=void 0;if(a.form){var {id:c}=a.form;"string"===typeof c&&(c.includes("comment")?b="c":c.includes("subscribe")?b="nl":this._growMeOnPage&&a.form.querySelectorAll(this._growMeFormSelector)&&(b="grwm"));return b}}processInputChange(a){var b=a.target;if(a=op(b.value.toLowerCase().replace(/\s/g,"")))b=this.sourceOrigin(b),this.captureEmail(a,b,"_processInputChange"),this.removeElementListeners()}};Ic=q([v("EmailCaptureHandler"),y(),t("design:paramtypes",
[Db,Re,Pb,zd])],Ic);class Mp{async load(a){var b,c,d,e;a=`s-${a}`;(null===(b=window.optable)||void 0===b?0:b.instance)&&(null===(c=window.optable)||void 0===c?0:c.auth)&&(null===(d=window.optable)||void 0===d?void 0:d.site)===a&&(null===(e=window.optable.auth)||void 0===e?void 0:e.site)===a||(window.optable=window.optable||{cmd:[]},window.optable.site=a,window.optable.auth=window.optable.auth||{cmd:[]},window.optable.auth.site=a,await nb("https://raptive.solutions.cdn.optable.co/public-assets/raptive-sdk.js"))}addToQueue(a){var b,
c;(null===(b=window.optable)||void 0===b?0:b.instance)&&(null===(c=window.optable)||void 0===c?0:c.auth)?a():(window.optable=window.optable||{},window.optable.cmd=window.optable.cmd||[],window.optable.cmd.push(a))}async resolveRaptiveClusters(a){return new Promise((b,c)=>{this.addToQueue(()=>{var d,e;if(null===(e=null===(d=window.optable)||void 0===d?void 0:d.auth)||void 0===e||!e.resolve)return this._logAndReject("resolveRaptiveClusters","Optable SDK 'auth.resolve' method not available after loading SDK",
c);window.optable.auth.resolve(a).then(b).catch(c)})})}async resolveThirdPartyClusters(a){return new Promise((b,c)=>{this.addToQueue(()=>{var d,e;if(null===(e=null===(d=window.optable)||void 0===d?void 0:d.instance)||void 0===e||!e.resolve)return this._logAndReject("resolveThirdPartyClusters","Optable SDK 'instance.resolve' method not available after loading SDK",c);window.optable.instance.resolve(a).then(b).catch(c)})})}async identify(a,b,c){return new Promise((d,e)=>{let f=ye[a];if(!f)return this._logAndReject("identify",
`Invalid identifier type: ${a}`,e);this.addToQueue(()=>{var g,h,k,m,n,p;if(null===(h=null===(g=window.optable)||void 0===g?void 0:g.auth)||void 0===h||!h.identify)return this._logAndReject("identify","Optable SDK 'identify' method not available after loading SDK",e);g=[`${f}${b}`];if(c){if(null===(m=null===(k=window.optable)||void 0===k?void 0:k.SDK)||void 0===m||!m.cid)return this._logAndReject("identify","Optable SDK 'cid' method not available after loading SDK",e);g.push(window.optable.SDK.cid(c))}null===
(p=null===(n=window.optable)||void 0===n?void 0:n.auth)||void 0===p?void 0:p.identify(...g).then(d).catch(e)})})}async profile(a,b,c){return new Promise((d,e)=>{let f=ye[a];if(!f)return this._logAndReject("profile",`Invalid identifier type: ${a}`,e);this.addToQueue(()=>{var g,h,k,m;if(null===(h=null===(g=window.optable)||void 0===g?void 0:g.auth)||void 0===h||!h.profile)return this._logAndReject("profile","Optable SDK 'auth.profile' method not available after loading SDK",e);null===(m=null===(k=window.optable)||
void 0===k?void 0:k.auth)||void 0===m?void 0:m.profile(`${f}${b}`,c).then(d).catch(e)})})}async targeting(){return new Promise((a,b)=>{this.addToQueue(()=>{var c,d;if(null===(d=null===(c=window.optable)||void 0===c?void 0:c.auth)||void 0===d||!d.targeting)return this._logAndReject("targeting","Optable SDK 'auth.targeting' method not available after loading SDK",b);window.optable.auth.targeting().then(a).catch(b)})})}installGPTSecureSignals(){return new Promise(a=>{this.addToQueue(()=>{window.googletag=
window.googletag||{cmd:[]};let b=window.googletag;b.cmd.push(()=>{b.secureSignalProviders||(b.secureSignalProviders=[]);b.secureSignalProviders.push({id:"loblawmedia.ca",collectorFunction:()=>{var c,d,e;return null!==(d=null===(c=window.optable)||void 0===c?void 0:c.auth)&&void 0!==d&&d.lmpidFromCache?Promise.resolve(null===(e=window.optable.auth)||void 0===e?void 0:e.lmpidFromCache()):Promise.resolve(void 0)}})});a()})})}_logAndReject(a,b,c){c(Error(b))}}let Sh=class extends X{init(){this._key="TrueDataHemSelectionLogic"}};
Sh=q([v("TrueDataHemSelectionLogicExperiment"),y()],Sh);let Th=class{constructor(a,b,c,d,e,f){this._adthrive=a;this._bootstrapConfig=b;this._optableConfig=c;this._emailCaptureHandler=d;this._piiEventBus=e;this._optableSdkWrapper=f;this.type=Oa.Optable;this.wait=!1;this.hem="";this._optableClusterMatchLimit=4;this._optableTimingData={};this._firstPageView=this._bootstrapConfig.checkIsFirstPageview();this._optableConfig.enabled=this._bootstrapConfig.optableEnabled;this._optableConfig.loblawEnabled=
this._bootstrapConfig.optableLoblawEnabled}async load(){try{this._optableTimingData.bootstrapStarted=ra(),this._bootstrapConfig.optableEnabled&&(await this._initOptableSDK(),await this._start(),this._optableTimingData.bootstrapFinished=ra(),this._shouldLogTimingData()&&A.event("OptableBootstrap","load","Optable timing data",this._optableTimingData))}catch(a){A.error("OptableBootstrap","load","Failed to bootstrap Optable SDK",a)}}_shouldLogTimingData(){return.95<=Math.random()}async _initOptableSDK(){var a;
this._bootstrapConfig.isOptablePreloaded||(null===(a=window.optable)||void 0===a?0:a.site)||(await this._optableSdkWrapper.load(this._adthrive.siteAds.siteId),this._bootstrapConfig.optableLoblawEnabled&&(this._optableSdkWrapper.installGPTSecureSignals(),this._optableSdkWrapper.targeting()))}async _start(){var a;if(null!==(a=window.optable)&&void 0!==a&&a.instance){a=U.getLocalStorageValue("adt_ei",!1);var b=U.getLocalStorageValue("adt_emsrc",!1),c=!(null===a||void 0===a||!a.sha256Hash);b=null===b||
void 0===b?void 0:b.includes("td");c&&b||(c&&!b?await this._handleResolvingOptable({shouldStoreNewHem:!1,storedHem:null===a||void 0===a?void 0:a.sha256Hash}):!c&&this._firstPageView&&await this._handleResolvingOptable({shouldStoreNewHem:!0}))}}async _handleResolvingOptable(a){var b,c,d,e;let {shouldStoreNewHem:f,storedHem:g}=a;this._optableTimingData.resolveStarted=ra();a=await this._optableSdkWrapper.resolveThirdPartyClusters();this._optableTimingData.resolveFinished=ra();this._bootstrapConfig.optableLoblawEnabled&&
a.lmpid&&localStorage.setItem("__lmpid",a.lmpid);var h="rec";g&&(h=null!==(b=S.resolve(Sh).result)&&void 0!==b?b:"rec");b=this._sortClusters(a.clusters,h);let k=b.map(m=>this._getHemsFromCluster(m));a=0<k.length?k[0]:[];h={clusterCount:b.length,hemCount:a.length,traits:(null===(c=b[0])||void 0===c?void 0:c.traits)||[],accuracyResult:{status:"no-stored-hem"}};g&&(c=k.filter(m=>m.some(n=>n.includes(g))),0<c.length?(c=k.indexOf(c[0]),h.accuracyResult={status:"hem-found",matchingClusterIndex:c},h.traits=
(null===(d=b[c])||void 0===d?void 0:d.traits)||[]):h.accuracyResult={status:"no-stored-hem"},A.event("OptableBootstrap","_handleResolvingOptable",h));this._piiEventBus.optableResolved.emit(h);a.length&&f&&b.length&&!(b.length>this._optableClusterMatchLimit)&&a.length&&(d=a[Math.floor(Math.random()*a.length)],c=ye.EMAIL.length,d=null!==(e=null===d||void 0===d?void 0:d.substring(c))&&void 0!==e?e:null)&&(this.hem=d,this._emailCaptureHandler.emailCaptured.emit({pii:{sha256Hash:d,source:"g_td_c"}}))}_sortClusters(a,
b){switch(b){case "fr30":return this._sortClustersByFrequency(a,"frequency30d");case "fr60":return this._sortClustersByFrequency(a,"frequency60d");case "fr90":return this._sortClustersByFrequency(a,"frequency90d");case "old":return this._sortClustersByRecency(a,"oldest");default:return this._sortClustersByRecency(a,"newest")}}_sortClustersByFrequency(a,b){return a.sort((c,d)=>{var e,f,g,h;c=Number(null!==(f=null===(e=c.traits.find(k=>k.key===b))||void 0===e?void 0:e.value)&&void 0!==f?f:"0");return Number(null!==
(h=null===(g=d.traits.find(k=>k.key===b))||void 0===g?void 0:g.value)&&void 0!==h?h:"0")-c})}_sortClustersByRecency(a,b){return a.sort((c,d)=>{var e,f,g,h;c=Number(null!==(f=null===(e=c.traits.find(k=>"last_seen"===k.key))||void 0===e?void 0:e.value)&&void 0!==f?f:"0");d=Number(null!==(h=null===(g=d.traits.find(k=>"last_seen"===k.key))||void 0===g?void 0:g.value)&&void 0!==h?h:"0");return"newest"===b?d-c:c-d})}_getHemsFromCluster(a){var b;return null!==(b=null===a||void 0===a?void 0:a.ids.filter(c=>
c.startsWith(ye.EMAIL)))&&void 0!==b?b:[]}};Th=q([v("OptableBootstrap"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Fa,Pb,Ic,Db,Mp])],Th);let Uh=class{constructor({isGPTPreloaded:a}){this._url="https://securepubads.g.doubleclick.net/tag/js/gpt.js";this._isGPTPreloaded=a}async load(){if(this._isGPTPreloaded)return Promise.resolve(!0);this.init();return nb(this._url)}init(){window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[]}};Uh=q([v("GAMBootstrap"),H(),t("design:paramtypes",
[Fa])],Uh);let Vh=class extends X{init(){this._key="MarmaladeBootstrap"}run(){return super.run()}};Vh=q([v("MarmaladeBootstrapTimeoutExperiment"),y()],Vh);let Wh=class{constructor(a,b){this._eventBus=a;this._timeoutExp=b;this._marmaladeFinishedTimeout=this._timeoutExp.result?1E3*this._timeoutExp.result:3E3}setMarmaladeFinishedTimeout(a){this._marmaladeFinishedTimeout=a}async get(){if(window.adthrive.marmalade){var a=await window.adthrive.marmalade;this._emitMarmaladeResponse(a);return a}a=(new Promise(c=>
{window.adthrive.marmaladeFinished=d=>{clearTimeout(this._timeoutId);c(d);return d}})).then(c=>{this._emitMarmaladeResponse(c);return c});let b=new Promise(c=>{this._timeoutId=window.setTimeout(()=>{const d=window.adthrive.marmalade||{};this._emitMarmaladeResponse(d);c(d)},this._marmaladeFinishedTimeout)});return Promise.race([a,b])}_emitMarmaladeResponse(a){a&&0<Object.keys(a).length&&this._eventBus.marmaladeResponseLoaded.emit(a)}};Wh=q([v("MarmaladeBootstrap"),H(),t("design:paramtypes",[ob,Vh])],
Wh);let Xh=class{constructor({baseUrl:a,targetPath:b,isPrebidPreloaded:c}){this.type=Oa.Prebid;this.wait=!1;this._url=`${a}/vendor/prebid${b}/prebid.min.js`;this._isPrebidPreloaded=c}async load(){this.init();return this._isPrebidPreloaded?"preloaded":await nb(this._url)}init(){window.pbjs=window.pbjs||{};window.pbjs.que=window.pbjs.que||[]}};Xh=q([v("PrebidBootstrap"),H(),t("design:paramtypes",[Fa])],Xh);let Se=class extends X{init(){this._key="Floors"}run(){return super.run()}};q([ea(),t("design:type",
Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Se.prototype,"run",null);Se=q([v("FloorsExperiment"),y()],Se);let Qb=class{constructor(a,b){this._floorsExperiment=a;this.abGroup=b;this._result={raptive:!1,legacy:!1,fbrap:!1,cm:!1,percentile:{lazy:0}};this.run()}get result(){return this._result}_enableRaptiveFloors(){this._result.raptive=!0}_enableLegacyFloors(){this._result.legacy=!0}_getFloorsExperimentResults(){let a=this._floorsExperiment.result,b=a===id.cm,c=a===id.fbrap;return{cm:b,
fbrap:c,rapML:a===id.rapml,enableLegacy:c||b}}_setExpResults({cm:a,fbrap:b}){let c=this._result;a&&(c.cm=a);b&&(c.fbrap=b)}run(){let a=this._getFloorsExperimentResults(),{enableLegacy:b,fbrap:c,rapML:d}=a;this._setExpResults(a);(d||c)&&this._enableRaptiveFloors();b&&this._enableLegacyFloors()}};Qb=q([v("FloorsExperimentHandler"),y(),t("design:paramtypes",[Se,Ia])],Qb);let Ad=class{constructor(a){this._enabledFloorsExperiments=a;this.floorsDataReady=new L;this.floorsTypeExcludes=new Set([na.raptive]);
this.amazonSlotCpm=new Map;this._activeFloorsTypes=[];this._cmFPVPriority=[na.refresh,na.lazyBidPool,na.lazy,na.session];this._cmNonFPVPriority=[na.refresh,na.lazyBidPool,na.session,na.lazy];this._customFieldsMap=new Map([["hvp",b=>(b=b.ortb2Imp.ext.data.hvp)?`${b}`:"*"],["hour",()=>"*"],["*",()=>"*"]]);this._customSchemaFields={};this._floorsPriorityData=new Map;this._schemaFieldOrder=new Map([["adUnitCode",1]]);this._standardSchemaFields=new Set(["size","mediaType","gptSlot","domain","adUnitCode"]);
this._modelTimestamp=0;this._fpv=!0===U.getLocalStorageValue("session_fpv")||null===U.getLocalStorageValue("session_fpv")}savePriorityFloorData(a,b){this._floorsPriorityData.set(b,a)}get floorsData(){return this._floorsData}set floorsData(a){this._floorsData=a}get floorsExperiment(){return this._enabledFloorsExperiments.result}get activeFloorsData(){return this._floorsPriorityData}get cmPriority(){return this._fpv?this._cmFPVPriority:this._cmNonFPVPriority}get activeFloorsTypes(){return this._activeFloorsTypes}addActiveFloorsType(a){return this._activeFloorsTypes.push(a)}get customSchemaFields(){return this._customSchemaFields}getSchemaFieldOrder(a){return this._schemaFieldOrder.get(a)}get raptiveMLRefreshFloors(){return this._raptiveMLRefreshFloors}set raptiveMLRefreshFloors(a){this._raptiveMLRefreshFloors=
a}get modelTimestamp(){return this._modelTimestamp}set modelTimestamp(a){this._modelTimestamp=a}setAdditionalSchemaFields(a){for(let b of a)if(this._schemaFieldOrder.set(b,a.indexOf(b)||0),!this._standardSchemaFields.has(b)){let c=this._customFieldsMap.get(b)||this._customFieldsMap.get("*");this._customSchemaFields[b]=c}}};Ad=q([y(),t("design:paramtypes",[Qb])],Ad);let Yh=class extends X{init(){this._key="FloorBootstrap"}run(){return super.run()}};Yh=q([v("FloorsBootstrapTimeoutExperiment"),y()],
Yh);let Zh=class{constructor(a,b,c){this._floorsConfig=b;this._timeoutExp=c;this._isRaptive=!1;this._floorsFinishedTimeout=this._timeoutExp.result?1E3*this._timeoutExp.result:3E3;this._isRaptive=(a.deliveryFeatures||[]).includes("raptiveFloors")&&this._floorsConfig.floorsExperiment.raptive}_resolveFloorsData(a){return Promise.resolve(a).then(b=>{var c;if(b&&Object.keys(b).length){let d=b.floors?b.floors:b;b=b.refreshFloors;this._floorsConfig.floorsData=d;this._floorsConfig.raptiveMLRefreshFloors=
b;this._floorsConfig.modelTimestamp=null!==(c=d.modelTimestamp)&&void 0!==c?c:0;this._floorsConfig.floorsDataReady.emit();return d}return{}})}async get(){if(!this._isRaptive)return Promise.resolve({});var a=window.adthrive.raptiveFloors;if(a)return this._resolveFloorsData(a);a=new Promise(c=>{window.adthrive.raptiveFloorsFinished=c});let b=new Promise(c=>{setTimeout(()=>{c({})},this._floorsFinishedTimeout)});return Promise.race([a,b]).then(()=>this._resolveFloorsData(window.adthrive.raptiveFloors))}};
Zh=q([v("FloorsBootstrap"),H(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Ad,Yh])],Zh);let $h=class{constructor(a,b){var c,d;this._bootstrapConfig=a;this._marmaladeEventBus=b;this._host=null!==(c=window.adthriveDevelopmentHost)&&void 0!==c?c:"https://ads.adthrive.com";this._baseUrl=null!==(d=window.adthriveDevelopmentBaseUrl)&&void 0!==d?d:this._bootstrapConfig.baseUrl;this._frame=document.createElement("iframe")}async start(){this._bootstrapConfig.ccpaEnabled||(await this.addIframeToPage(),
this._marmaladeEventBus.marmaladeResponseLoaded.on(a=>{a=a.recencyFrequency;Array.isArray(a)&&a.length&&this.setMcmpData(a)},{handleEventsAlreadyEmitted:!0}),this._bootstrapConfig.ccpaConsentChange.on(a=>{a===this._bootstrapConfig.ccpaOptOut&&this.deleteMcmpData()}))}get recencyFrequencyIframeLocation(){return`${this._baseUrl}/html/rnf.html`}addIframeToPage(){let a,b=new Promise(c=>{a=c});this._frame.onload=()=>{a()};try{this._frame.src=this.recencyFrequencyIframeLocation,this._frame.id="adthrive-mcmp",
this._frame.style.display="none",document.body.appendChild(this._frame)}catch(c){A.error("RecencyAndFrequencyIFrameManager","addIframeToPage","Failed to append rnf iframe to document",c)}return b}deleteMcmpData(){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({message:"deleteMcmpData"},this._host)}catch(a){A.error("RecencyAndFrequencyIFrameManager","deleteMcmpData","Failed to delete mcmp data",a)}}setMcmpData(a){try{this._frame.contentWindow&&(window.addEventListener("message",
b=>{let c=b.data;b.origin===this._host&&"mcmpDataResponse"===c.message&&this._marmaladeEventBus.recencyFrequencyDataSet.emit(c.mcmpData)}),this._frame.contentWindow.postMessage({message:"setMcmpData",mcmpData:a},this._host))}catch(b){A.error("RecencyAndFrequencyIFrameManager","setMcmpData","Failed to set mcmp data",b)}}};$h=q([v("RecencyAndFrequencyIFrameManager"),y(),t("design:paramtypes",[Fa,ob])],$h);let ai=class{constructor(a,b,c,d,e,f,g,h){this._bootstrapConfig=a;this._bootstrapEventBus=b;this._amazon=
c;this._optable=d;this._gam=e;this._marmalade=f;this._prebid=g;this._floors=h;S.resolve($h).start().catch(k=>{A.error("Bootstrap","constructor","Failed to start RecencyAndFrequencyIFrameManager",k)})}async run(){let a=this._run(()=>this._floors.get(),Oa.Floors),b;this.loadNonBlockingLibraries();let c=this._run(()=>this._gam.load(),Oa.GAM,{required:!0}).catch(e=>this.gamFallback(e&&e.result,b)),d=b=this._run(()=>this._marmalade.get(),Oa.Marmalade);return Promise.all([c,d,a,oh()]).then(([e,f,g])=>({gam:e,
marmalade:f,floors:g}))}get ccpaOptOut(){return this._bootstrapConfig.ccpaUserOptedOut}loadNonBlockingLibraries(){[this._prebid,this._amazon,this._optable].forEach(a=>{this._run(()=>this._bootstrapConfig.bootstrapLoaders[a.type]=a.load().catch(b=>{this._bootstrapEventBus.libraryLoadFailed.emit({bootstrapType:a.type});throw Error(b);}),a.type,{wait:a.wait}).catch(()=>!1)})}gamFallback(a,b){this._bootstrapConfig.gptLibFailed=!0;this._bootstrapConfig.webVitalsEnabled||(this._bootstrapConfig.webVitalsEnabled=
!0);return b.then(c=>Promise.reject({message:a,marmalade:c}))}_run(a,b,{required:c=!1,wait:d=!0}={}){let e=ra(),f=g=>{const h=ra();g={result:g,started:e,finished:h,duration:h-e};this._bootstrapConfig.bootstrapResult.set(b,g);return g};a=a().then(f,g=>{A.error("Bootstrap","_start error",b,g);return c?Promise.reject(f(g.message)):f(g.message)});return d?a:Promise.resolve(f(!0))}};ai=q([H(),t("design:paramtypes",[Fa,Ee,Ph,Th,Uh,Wh,Xh,Zh])],ai);let bi=class{constructor(a,b){this.pubId="4fbba76f-7987-4fa2-9733-c27eb3a2170b";
this.adUnitExclusions=new Set(["Interstitial"]);this.amznTargetingKeys=[];this.advertiserId=4526447244;this._amznDecryptedTargetingKeys=["amz_pb","amz_bidder","amz_pb_sp","amz_bidder_sp"];this._amznEncryptedTargetingKeys="amznbid amzniid amznp amznsz mediaType amznbid_sp amzniid_sp amznp_sp amznsz_sp mediaType_sp".split(" ");this.enabled=b.amazonEnabled&&!0===a.siteAds.adOptions.amazonUAM;this.amznTargetingKeys=["amzndeal_sp",...this._amznEncryptedTargetingKeys,...this._amznDecryptedTargetingKeys]}getEncryptedTargetingKeys(a=
{dealKeys:!1,nonDealKeys:!1}){return a.dealKeys?this._amznEncryptedTargetingKeys.filter(b=>b.includes("_sp")).concat("amzndeal_sp"):a.nonDealKeys?this._amznEncryptedTargetingKeys.filter(b=>!b.includes("_sp")):this._amznEncryptedTargetingKeys}};bi=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Fa])],bi);let ci=class{constructor(a){this._bootstrapConfig=a;this.nonCompliantBidders=["unruly"];this.ccpaNotApplicable="1---";this.consentChange=new L;this.optOutText="Do not sell or share my personal information.";
this.optInText="Customize my ad experience.";this.ccpaOptIn=this._bootstrapConfig.ccpaOptIn;this.ccpaOptOut=this._bootstrapConfig.ccpaOptOut;this.required=this._bootstrapConfig.ccpaRequired;this.consentChange=this._bootstrapConfig.ccpaConsentChange;this.privacyString=this._bootstrapConfig.ccpaPrivacyString;this.gpcEnabled=U.getLocalStorageValue("gpc");this.userOptedOut=this._bootstrapConfig.ccpaUserOptedOut;this.consentChange.on(b=>{this.privacyString=b});this.userOptedOut=this.privacyString===this.ccpaOptOut?
!0:!1;this.required&&(this.comscoreParams=this.userOptedOut?"0":"1")}get enabled(){return this._bootstrapConfig.ccpaEnabled}};ci=q([y(),t("design:paramtypes",[Fa])],ci);let Qt=(a,b)=>{var c;a=a||navigator.userAgent;if(!nh(a,b||navigator.vendor))return!1;b=(null===(c=/ Version\/(1\d)\.(\d+)/.exec(a))||void 0===c?void 0:c.slice(-2))||[];c="15"===b[0]&&4>+b[1];return"14"===b[0]||c},Rt=()=>{Qt()&&window.addEventListener("beforeunload",()=>{window.addEventListener("visibilitychange",a=>{a.stopImmediatePropagation()},
!0)},!0)},Ra=class{setupOnceEvent(a,b,c=window){let d=()=>{c.removeEventListener(a,d);b()};c.addEventListener(a,d)}setupOnceEventWithPromise(a,b=window){return new Promise(c=>{let d=e=>{b.removeEventListener(a,d);return c(e)};b.addEventListener(a,d)})}addEventListener(a,b,c=window){c.addEventListener(a,()=>{b.emit()},!1)}constructor(){this.beforeUnload=new L;this.pageHide=new L;this.resize=new L;this.scroll=new L;this.visibilityChange=new L;this.keydown=new L;this.addEventListener("beforeunload",
this.beforeUnload);this.addEventListener("pagehide",this.pageHide);this.addEventListener("resize",this.resize);this.addEventListener("scroll",this.scroll);this.addEventListener("visibilitychange",this.visibilityChange,document);this.addEventListener("keydown",this.keydown,document);Rt()}};Ra=q([v("PageManager"),y(),t("design:paramtypes",[])],Ra);let St=a=>{a=Na("_ga");const b=Na("_gid");if(!a&&!b)S.resolve(Ra).beforeUnload.on(()=>{})},Jc=class{constructor(a,b,c){this.connectionTargeting=[];this.sessionData=
{key:"session_key",timeout:864E5,rolling:!0,lowercase:!0,cb:F=>{U.removeLocalStorageValue("fpv");St()}};let {bucket:d,core:e,plugin:f,branch:g,debug:h,deployment:k,baseUrl:m,host:n,fastAds:p,siteAds:r,styleUrl:w,invalidTraffic:z,integration:x,deliveryVersion:B}=a,{tablet:E,desktop:C}=r.breakpoints;this.host=n;this.privacySandboxHost=this._getPrivacySandboxHost();this.baseUrl=m;this.branch=g;this.bucket=d;this.country=e&&e.country;this.plugin=f;this.fastAds=p;this.invalidTraffic=z;this.deployment=
k;this.domain=window.location.host;this.device=te(E,C);this.pageUrl=window.location.href;this.pageviewKey=c;a=this.querystring=jc();this.sessionKey=this.setSessionKey();this.styleUrl=w;this.debug=h;this.integration=x;this.deliveryVersion=B;this.savedReferrer=U.getLocalStorageValue("referrer",!0,!0,18E5);this.isFirstPageview=b.checkIsFirstPageview();this.isWordPressLogin=this._isWordPressLogin();try{var I=window.localStorage.getItem("pbjs-id5id");this.gpid=I?JSON.parse(decodeURIComponent(I)).gp:void 0}catch(F){}this.ri=
a.has("ri")?a.get("ri"):String(Math.floor(200*Math.random()));this.salesThrottle=a.has("st")?a.get("st"):String(Math.floor(200*Math.random()));I=this.rsi=(b=U.getLocalStorageValue("rsi"))||String(Math.floor(200*Math.random()));b||U.setLocalStorageValue("rsi",I);if(b=window.performance.getEntriesByType("resource").filter(F=>F.name.includes("ads.min.js")&&F.name.includes("ads.adthrive.com"))[0])b=Math.round(b.responseEnd-b.startTime).toString(),"NaN"!==b&&(this.adsMinLoadDuration=[b]);if(b=window.navigator&&
(window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection))b.effectiveType&&this.connectionTargeting.push(`niet:${b.effectiveType}`),(this.downlink=b.downlink||b.bandwidth)&&this.connectionTargeting.push(`dl:${this.downlink}`);b=U.getLocalStorageValue("browsing_topics");this.browsingTopics=Array.isArray(b)?b:[]}setSessionKey(){return U.getOrSetLocalStorageValue(this.sessionData,()=>Dc())}get browsingTopicsSupported(){return gp()}get browsingTopicsTaxonomyVersion(){var a,
b;return null===(b=null===(a=this.browsingTopics)||void 0===a?void 0:a[0])||void 0===b?void 0:b.taxonomy_version}_isWordPressLogin(){return document.getElementById("wpadminbar")?!0:window.location.href?window.location.href.includes("/wp-admin"):!1}_getPrivacySandboxHost(){var a;return null!==(a=(new URLSearchParams(window.location.search)).get("at_privacy_sandbox_host"))&&void 0!==a?a:"privacysandbox.adthrive.com"}};Jc=q([y(),ha(0,fa("AdThrive")),ha(2,fa("PageviewKey")),t("design:paramtypes",[Object,
Fa,String])],Jc);class Tt extends Jp{constructor(a){super();this._featureRollouts=a.enabled?a.siteAds.featureRollouts||{}:{}}}class Kc{constructor(){this._clsGlobalData=window.adthriveCLS}get enabled(){return!!this._clsGlobalData&&!!this._clsGlobalData.siteAds&&Dp(this._clsGlobalData.siteAds)}get error(){return!(!this._clsGlobalData||!this._clsGlobalData.error)}set siteAds(a){this._clsGlobalData.siteAds=a}get siteAds(){return this._clsGlobalData.siteAds}set disableAds(a){this._clsGlobalData.disableAds=
a}get disableAds(){return this._clsGlobalData.disableAds}set enabledLocations(a){this._clsGlobalData.enabledLocations=a}get enabledLocations(){return this._clsGlobalData.enabledLocations}get injectedFromPlugin(){return this._clsGlobalData.injectedFromPlugin}set injectedFromPlugin(a){this._clsGlobalData.injectedFromPlugin=a}get injectedFromSiteAds(){return this._clsGlobalData.injectedFromSiteAds}set injectedFromSiteAds(a){this._clsGlobalData.injectedFromSiteAds=a}overwriteInjectedSlots(a){this._clsGlobalData.injectedSlots=
a}setInjectedSlots(a){this._clsGlobalData.injectedSlots=this._clsGlobalData.injectedSlots||[];this._clsGlobalData.injectedSlots.push(a)}get injectedSlots(){return this._clsGlobalData.injectedSlots}setInjectedVideoSlots(a){this._clsGlobalData.injectedVideoSlots=this._clsGlobalData.injectedVideoSlots||[];this._clsGlobalData.injectedVideoSlots.push(a)}get injectedVideoSlots(){return this._clsGlobalData.injectedVideoSlots}setInjectedScripts(a){this._clsGlobalData.injectedScripts=this._clsGlobalData.injectedScripts||
[];this._clsGlobalData.injectedScripts.push(a)}get getInjectedScripts(){return this._clsGlobalData.injectedScripts}setExperiment(a,b,c=!1){this._clsGlobalData.experiments=this._clsGlobalData.experiments||{};this._clsGlobalData.siteExperiments=this._clsGlobalData.siteExperiments||{};(c?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)[a]=b}getExperiment(a,b=!1){return(b=b?this._clsGlobalData.siteExperiments:this._clsGlobalData.experiments)&&b[a]}setWeightedChoiceExperiment(a,b,c=
!1){this._clsGlobalData.experimentsWeightedChoice=this._clsGlobalData.experimentsWeightedChoice||{};this._clsGlobalData.siteExperimentsWeightedChoice=this._clsGlobalData.siteExperimentsWeightedChoice||{};(c?this._clsGlobalData.siteExperimentsWeightedChoice:this._clsGlobalData.experimentsWeightedChoice)[a]=b}getWeightedChoiceExperiment(a,b=!1){var c,d;return(b=b?null===(c=this._clsGlobalData)||void 0===c?void 0:c.siteExperimentsWeightedChoice:null===(d=this._clsGlobalData)||void 0===d?void 0:d.experimentsWeightedChoice)&&
b[a]}get branch(){return this._clsGlobalData.branch}get bucket(){return this._clsGlobalData.bucket}set videoDisabledFromPlugin(a){this._clsGlobalData.videoDisabledFromPlugin=a}get videoDisabledFromPlugin(){return this._clsGlobalData.videoDisabledFromPlugin}set targetDensityLog(a){this._clsGlobalData.targetDensityLog=a}get targetDensityLog(){return this._clsGlobalData.targetDensityLog}shouldHalveIOSDensity(){let a=new Tt(this);return Mb()&&a.isRolloutEnabled("iOS-Resolution")}getTargetDensity(a){return this.shouldHalveIOSDensity()?
a/2:a}get removeVideoTitleWrapper(){return this._clsGlobalData.siteAds.adOptions.removeVideoTitleWrapper}}let di=class{constructor(a,b,c,d){this._context=b;this._abgroup=c;this._clsOptions=d;this._defaultHeight=250;this._map=new Map([["phone",{Content:250,Recipe:250,Header:50,Footer:50,Below_Post:250,Sidebar:250}],["tablet",{Content:250,Recipe:250,Header:90,Footer:90,Below_post:250,Sidebar:250}],["desktop",{Content:250,Recipe:250,Header:90,Footer:90,Below_Post:250,Sidebar:250}]]);this._clsOptimizedAds=
a.siteAds.adOptions.clsOptimizedAds;this._clsOptions.enabled&&((a=this._clsOptions.getExperiment("clsins_ss"))&&this._abgroup.set("clsins_ss",String(a)),["cls-insertion","cls-header-insertion","cls-disable-ads"].filter(e=>this._clsOptions.branch?0<document.querySelectorAll("script[id^="+`${e}-${this._clsOptions.branch}`+"]").length:!1).forEach(e=>this._clsOptions.setInjectedScripts(e)))}get enabled(){return this._clsOptimizedAds||this._clsOptions.enabled&&(this._clsOptions.injectedFromPlugin||this._clsOptions.injectedFromSiteAds)}getDivHeight(a,
b){return(b=this._map.get(b))&&b[a]||this._defaultHeight}setStyle(a,b){if("Footer"===b||this.enabled&&this._map.get(this._context.device)[b])a.style.minHeight=`${this._map.get(this._context.device)[b]}px`,a.classList.add("adthrive-ad-cls")}};di=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Jc,Ia,Kc])],di);let ei=class{constructor(a,b){this._footerConfigEventBus=b;this.tracker=!0;this.gdpr=!1;this._footerMessages=new Map([["FamilyParenting","CafeMedia Family & Parenting"],["Finance","CafeMedia Finance"],
["Food","CafeMedia Food"],["General","CafeMedia"],["HomeDIY","CafeMedia Home/DIY"],["Lifestyle","CafeMedia Lifestyle"],["Pets","CafeMedia Pets"],["Tech","CafeMedia Tech"],["Travel","CafeMedia Travel"]]);let {comscore:c,comscoreFooter:d}=a.siteAds.adOptions;this.category=Q(c,"General");this.comscore=Q(d,!0);this.comscoreMessage=Q(this._footerMessages.get(this.category),"CafeMedia");this._footerConfigEventBus.comscoreInitialized.emit(this.comscore)}};ei=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",
[Object,nd])],ei);let fi=class{constructor(a,b){this.adthrive=a;this._clsOptions=b;this.video=this.recipe=this.content=this.all=!1;this.locations=new Set;this.reasons=new Set;this._clsDivs=["adthrive-below-post","adthrive-content","adthrive-header","adthrive-recipe","adthrive-sidebar"];this.init=()=>{if(this.urlHasEmail(window.location.href)||this.urlHasEmail(window.document.referrer))this.all=!0,this.reasons.add("all_email"),this.removeClsDivs(this._clsDivs);try{document.body.classList.contains("adthrive-disable-all")&&
(this.all=!0,this.reasons.add("all_plugin")),document.body.classList.contains("adthrive-disable-content")&&(this.recipe=this.content=!0,this.locations.add("Content"),this.locations.add("Recipe"),this.reasons.add("content_plugin")),null!==document.querySelector(".tag-novideo")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_tag")),document.body.classList.contains("adthrive-disable-video")&&(this.video=!0,this.locations.add("Video"),this.reasons.add("video_plugin"))}catch(c){A.error("DisableAds",
"constructor",{message:c.message});let d="classList"in document.createElement("_");A.error("BodyDeviceClassComponent","init.support",{support:d});A.error("BodyDeviceClassComponent","init.supportBody",{supportBody:"classList"in document.body})}this._log("init")};this.clear=()=>{this.video=this.recipe=this.content=this.all=!1;this.locations=new Set;this.reasons=new Set};this._log=c=>{};this.init()}removeClsDivs(a){if(this._clsOptions.enabled){var b=this._clsOptions.injectedSlots.filter(c=>{const d=
c.element;c=!1;d.parentNode&&a.some(e=>d.classList.contains(e))&&(d.parentNode.removeChild(d),c=!0);return!c});this._clsOptions.overwriteInjectedSlots(b)}}disableAllAds(a){if(!a||wh(a))this.all=!0,this.reasons.add("all_page"),this.removeClsDivs(this._clsDivs);this._log("disableAllAds")}disableContentAds(a){if(!a||wh(a))this.recipe=this.content=!0,this.locations.add("Content"),this.locations.add("Recipe"),this.reasons.add("content_page"),this.removeClsDivs(["adthrive-content","adthrive-recipe"]);this._log("disableContentAds")}disablePlaylistPlayers(a){if(!a||
wh(a))this.video=!0,this.locations.add("Video"),this.reasons.add("video_page"),this.adthrive.siteAds.videoPlayers?this._removeCLSVideoPlayers():this._removeLegacyCLSVideoPlayers();this._log("disablePlaylistPlayers")}_removeCLSVideoPlayers(){var a;null===(a=this.adthrive.siteAds.videoPlayers)||void 0===a?void 0:a.players.filter(b=>"stickyPlaylist"===b.type).map(b=>document.querySelectorAll(`#cls-video-container-${b.playlistId}`)).forEach(b=>{var c;for(let d=0;d<b.length;d++){let e=b[d];null===(c=e.parentNode)||
void 0===c?void 0:c.removeChild(e)}})}_removeLegacyCLSVideoPlayers(){var a,b,c=null===(a=this.adthrive.siteAds.video)||void 0===a?void 0:a.jwPlaylistId;if(c)for(a=document.querySelectorAll(`#cls-video-container-${c}`),c=0;c<a.length;c++){let d=a[c];null===(b=d.parentNode)||void 0===b?void 0:b.removeChild(d)}}urlHasEmail(a){return a?null!==/([A-Z0-9._%+-]+(@|%(25)*40)[A-Z0-9.-]+\.[A-Z]{2,})/i.exec(a):!1}};fi=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Kc])],fi);let gi=class extends Eb{init(){this._setAbGroup=
!1;this._key="DisplayOpenBidderExperiment"}};gi=q([v("DisplayOpenBidderExperiment"),y()],gi);let hi=class{constructor(a){this.bidders=a.result||["none"]}};hi=q([y(),t("design:paramtypes",[gi])],hi);let Bd=class extends fb{constructor(a,b){var c;super();this._abgroup=b;this._result=!1;this.key="ParallaxAdsExperiment";this.abgroup="parallax";this._choices=[{choice:!0},{choice:!1}];this.weight=.5;this.shouldUseCoreOverride=!1;b=(b=window.adthriveCLS)&&b.experiments;a=null===(c=null===a||void 0===a?void 0:
a.siteAds)||void 0===c?void 0:c.adTypes;c=ca()?null===a||void 0===a?void 0:a.largeFormatsMobile:!1;b&&this.abgroup in b?(this._result=b[this.abgroup],this._abgroup.set(this.abgroup,this._result?"on":"off")):c&&(this._result=this.run(),this._abgroup.set(this.abgroup,this._result?"on":"off"))}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};Bd=q([y(),v("ParallaxAdsExperiment"),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Ia])],Bd);let Te=class extends Fc{constructor(a,
b){super();this._siteExperiments=a;this._pubabgroup=b;this._choices=[];this._result=!1;this.key=bb.StickyOutstream;this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){return(new Ha(this._choices[0].weight/100)).get()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;
this._pubabgroup.set(a,this._result?"on":"off")}else A.error("StickyOutstreamSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config")}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Te.prototype,"run",null);Te=q([y(),t("design:paramtypes",[vb,pb])],Te);let ii=class extends fb{constructor(a){super();this._result=!1;this._choices=[{choice:!0},{choice:!1}];this.shouldUseCoreExperimentsConfig=!1;this.key="RemoveLargeSize";
this.abgroup="smhd100";var b=window.adthriveCLS;this._result=(b=b&&b.experiments)&&this.abgroup in b?b[this.abgroup]:this.run();a.set(this.abgroup,this._result?"on":"off")}get result(){return this._result}run(){return(new Ha(.1)).get()}};ii=q([v("RemoveLargeSizeExperiment"),y(),t("design:paramtypes",[Ia])],ii);let ji=class extends fb{constructor(a){super();this._result=!1;this._choices=[{choice:!0},{choice:!1}];this.shouldUseCoreExperimentsConfig=!1;this.abgroup=this.key="mrsf";var b=window.adthriveCLS;
(b=b&&b.experiments)&&this.abgroup in b?(this._result=b[this.abgroup],a.set(this.abgroup,this._result?"on":"off")):ca()&&(this._result=this.run(),a.set(this.abgroup,this._result?"on":"off"))}get result(){return this._result}run(){return(new Ha(1)).get()}};ji=q([v("MobileRecipeSizeFilterExperiment"),y(),t("design:paramtypes",[Ia])],ji);let ki=class{constructor(a,b,c,d,e,f){this._adOptions=b;this._removeLargeSizeExperiment=c;this._stickyOutstreamSiteExperiment=d;this._parallaxAdsExperiment=e;this._mobileRecipeSizeFilterExperiment=
f;this._stickyOutstreamEnabled=!1;this._supportedSizes=[[728,90],[300,250],[300,600],[320,50],[970,250],[160,600],[300,1050],[336,280],[970,90],[300,50],[320,100],[468,60],[250,250],[120,240],[1,1],[300,300],[552,334],[300,420],[728,250],[320,300],[300,390]];this._tallMobileContentAdsizes=[[300,600],[160,600]];this._interstitialSupportedSizes=[[320,50],[300,250],[300,600],[336,280],[320,480],[1,1]];this._adUnitAuctionPriorityMap=new Map([["Footer",1],["Header",2],["Sidebar",3],["Content",4],["Recipe",
5],["Sidebar_sticky",6],["Below Post",7]]);this._adUnitSettingTemplate={auctionPriority:8,autosize:!0,classNames:[],devices:["tablet","phone","desktop"],elementSelector:"body",every:1,lazy:!1,lazyMax:0,lazyMaxDefaulted:!1,location:"",max:1,pageSelector:"",position:"beforebegin",sequence:1,sizes:[],skip:0,spacing:0,special:[],sticky:!1,stickyOverlapSelector:"",name:""};this.isStickyUnit=(k,m)=>{let {location:n,sticky:p}=k;if("Recipe"===n&&m){let {recipeMobile:r,recipeDesktop:w}=m;if(ca()&&(null===
r||void 0===r?0:r.enabled)||!ca()&&(null===w||void 0===w?0:w.enabled))return!0}return"Footer"===n||p};let {tablet:g,desktop:h}=a.siteAds.breakpoints;this._device=te(g,h);this._adthriveSiteAds=a.siteAds;this._adthriveOptions=this._adthriveSiteAds.adOptions;this._adUnits=a.siteAds.adUnits;this.setupStickyOutstreamSettings(a);this.setupInterstitialSettings()}setupStickyOutstreamSettings(a){var b=this._adthriveSiteAds.videoPlayers&&this._adthriveSiteAds.videoPlayers.partners&&this._adthriveSiteAds.videoPlayers.partners.stickyOutstream;
b=a.siteAds.video&&a.siteAds.video.partners&&a.siteAds.video.partners.stickyOutstream||b;const {tablet:c,desktop:d}=a.siteAds.breakpoints;var e=te(c,d);const f=a.siteAds,g=f.videoPlayers&&f.videoPlayers.partners&&f.videoPlayers.partners.stickyOutstream;a=a.siteAds.adOptions;a=f.video&&f.video.partners&&f.video.partners.stickyOutstream||g||a&&a.stickyOutstream;e=!!(a&&("phone"===e?a.mobile.enabled:a.desktop.enabled));if(this._stickyOutstreamSiteExperiment.enabled?this._stickyOutstreamSiteExperiment.result:
e)this._stickyOutstreamEnabled=!0,e={...this._adUnitSettingTemplate,sticky:!0,location:"Video_StickyOutstream",position:"beforeend"},e.pageSelector=Q(b&&b.blockedPageSelectors,""),e.sizes="phone"===this._device?[[300,50]]:[[300,250]],this._stickyOutstreamSettingTemplate=e}setupInterstitialSettings(){let a={...this._adUnitSettingTemplate},b=this._adthriveOptions;a.location="Interstitial";a.sizes=this.interstitalSupportedSizes();a.pageSelector=Q(b.interstitialBlockedPageSelectors,"");this._interstitialSettingTemplate=
a}get(){this._adUnits.sort((c,d)=>{d="Sidebar"===d.location&&d.sticky?`${d.location}_sticky`:d.location;return this._adUnitAuctionPriorityMap.get("Sidebar"===c.location&&c.sticky?`${c.location}_sticky`:c.location)-this._adUnitAuctionPriorityMap.get(d)});let a=this._parallaxAdsExperiment.result,b=this._adUnits.filter(c=>void 0!==c.dynamic&&c.dynamic.enabled).map(c=>{const d=c.location.replace(/\s+/g,"_"),e="Sidebar"===d?0:2;return{auctionPriority:this._adUnitAuctionPriorityMap.get(d)||8,location:d,
sequence:Q(c.sequence,1),sizes:this.onlySupportedAdSizes(c.adSizes).filter(f=>this.includeCertainTallSizes(c,f)).concat(a&&"Content"===c.location?this._tallMobileContentAdsizes:[]),devices:c.devices,pageSelector:Q(c.dynamic.pageSelector,"").trim(),elementSelector:Q(c.dynamic.elementSelector,"").trim(),position:Q(c.dynamic.position,"beforebegin"),max:Math.floor(Q(c.dynamic.max,0)),spacing:Q(c.dynamic.spacing,0),skip:Math.floor(Q(c.dynamic.skip,0)),every:Math.max(Math.floor(Q(c.dynamic.every,1)),1),
classNames:c.dynamic.classNames||[],sticky:this.isStickyUnit(c,this._adthriveSiteAds.adOptions.stickyContainerConfig),stickyOverlapSelector:Q(c.stickyOverlapSelector,"").trim(),autosize:c.autosize,special:Q(c.targeting,[]).filter(f=>"special"===f.key).reduce((f,g)=>f.concat(...g.value),[]),lazy:Q(c.dynamic.lazy,!1),lazyMax:Q(c.dynamic.lazyMax,e),lazyMaxDefaulted:0===c.dynamic.lazyMax?!1:!c.dynamic.lazyMax,name:c.name}});this._stickyOutstreamEnabled&&this._stickyOutstreamSettingTemplate&&b.push(this._stickyOutstreamSettingTemplate);
this._adOptions.interstitial.gam&&this._interstitialSettingTemplate&&b.push(this._interstitialSettingTemplate);return b}onlySupportedAdSizes(a){return this._supportedSizes.filter(([b,c])=>a.some(([d,e])=>b===d&&c===e))}interstitalSupportedSizes(){return this._interstitialSupportedSizes.filter(([a,b])=>"phone"!==this._device&&"320,50"===`${a},${b}`?!1:!0)}includeCertainTallSizes(a,[b,c]){let {location:d,sequence:e}=a;return"Footer"===d?!("phone"===this._device&&320===b&&100===c):"Header"===d?!(100<
c&&this._removeLargeSizeExperiment.result):"Recipe"===d?!(this._mobileRecipeSizeFilterExperiment.result&&"phone"===this._device&&(300===b&&390===c||320===b&&300===c)):"Sidebar"===d?(b=a.adSizes.some(([,f])=>300>=f),(c=300<c)&&!b?!0:9===e?!0:e&&5>=e?c?a.sticky:!0:!c):!0}};ki=q([H(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,xd,ii,Te,Bd,ji])],ki);let li=class extends W{init(){this._key="FledgeGPT";this._default=!1}};li=q([v("FledgeGPTExperiment"),y()],li);let Ue=class{constructor(a){var b;this._cookieDeprecationLabel=
null!==(b=a.cookieDeprecationLabel)&&void 0!==b?b:null;this._supported=lt();this._enabled=this._isFledgeEnabled()}get supported(){return this._supported}get enabled(){return this._enabled}get cookieDeprecationLabel(){return this._cookieDeprecationLabel}_isFledgeEnabled(){var a;if(!this._supported)return!1;let b=(null!==(a=this._cookieDeprecationLabel)&&void 0!==a?a:"").replace("fake_","");a=mt(b);return"enabled"===a?!0:"disabled"===a?!1:S.resolve(li).result}};Ue=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",
[Object])],Ue);let mi=class{constructor(){this.elements=[]}};mi=q([y()],mi);let Ve=class{constructor(a){this.cafeMediaVendorId=996;this.nonCompliantBidders=[l.Colossus,l.Concert,l.ResetDigital,l.Roundel,l.ThirtyThreeAcross];this.cmpUserActionCompleteFired=this.revokedPurposeConsent=this.consentCaptured=!1;this._isRequired="true"===a.gdpr}get enabled(){return this._isRequired}};Ve=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],Ve);let ni=class{constructor(){this.gpcUpdated=!1;this.globalPrivacyControl=
!!window.navigator.globalPrivacyControl;this.gpcEnabled=!!window.localStorage.getItem("adthrive_gpc")}setGpcString(){!this.gpcEnabled&&this.globalPrivacyControl?(window.localStorage.setItem("adthrive_gpc",`${this.globalPrivacyControl}`),this._updateGPC()):this.gpcEnabled&&!this.globalPrivacyControl&&(window.localStorage.removeItem("adthrive_gpc"),this._updateGPC())}_updateGPC(){this.gpcEnabled=!!this.globalPrivacyControl;this.gpcUpdated=!0}};ni=q([y(),t("design:paramtypes",[])],ni);let oi=class extends Eb{init(){this._key=
"HBHO";this._default=["none"]}get choices(){return this._choices}};oi=q([v("HBHOExperiment"),y()],oi);let pi=class extends W{init(){this._key="OptimalDisplayBidders";this._default=!1}};pi=q([v("OptimalDisplayBiddersExperiment"),y()],pi);let qi=class{constructor(a,b){this.choicesList=[];this.bidders=a.result||["none"];this.useMlBidders=b.result;this.choicesList=a.choices&&a.choices.map(({choice:c})=>c)||[]}};qi=q([y(),t("design:paramtypes",[oi,pi])],qi);let ri=class{constructor(a){this.apiReady=new L;
this.optIn=new L;this._liveRampATS=Q(a.siteAds.adOptions.liveRampATS,!1)}get enabled(){return this._liveRampATS}};ri=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],ri);let Cd=class extends Eb{init(){this._key="IDHO"}setABGroup(a,b){let c=this._coreExperimentConfig.getCoreExperiment(this.key);c&&Array.isArray(a)&&(a=a.map(d=>`${d}`),this.abgroupClass.set(b||c.abgroup,a))}};Cd=q([v("IDHOExperiment"),y()],Cd);let We=class{constructor(a){this.subModule=a.result;a=a._choices;this.percentages=
null===a||void 0===a?void 0:a.map(b=>`${b.choice}:${"number"===typeof b.weight?b.weight:0}`)}};We=q([y(),t("design:paramtypes",[Cd])],We);let si=class extends W{init(){this._key="ImpressionLog";this._default=!1}};si=q([v("EventLogExperiment"),y()],si);let ti=class{constructor(a){this.enabled=a.result}};ti=q([y(),t("design:paramtypes",[si])],ti);let ui=class{constructor(){this.refreshSlots=new Set(["Footer"]);this.ajaxType=!1}};ui=q([y()],ui);let vi=class{constructor(){this.googleLazyLoadSettings=
{disabled:{fetchMarginPercent:-1,renderMarginPercent:-1,mobileScaling:-1},gam:{fetchMarginPercent:600,renderMarginPercent:100,mobileScaling:1.5},hbMarginPercent:700}}};vi=q([y(),t("design:paramtypes",[])],vi);let Xe=class{constructor(a){this._id="69e75073-3763-483e-a64c-0d281bfd9225";this.url=`https://launchpad-wrapper.privacymanager.io/${this._id}/launchpad-liveramp.js`;this.enabled=Q(a.siteAds.adOptions.liveRampATS,!0)}};Xe=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],Xe);let wi=
class{constructor(a){var b,c;this._adthrive=a;this.country=null===(c=null===(b=null===a||void 0===a?void 0:a.core)||void 0===b?void 0:b.country)||void 0===c?void 0:c.toUpperCase();this.tz=Intl.DateTimeFormat().resolvedOptions().timeZone}get targetingValue(){return this.isNewZealand()?"nz":this.isUnitedStates()?"us":this.isUnitedKingdom()?"uk":this.isCanada()?"ca":this.isGDPR()?"gdpr":"o"}isNewZealand(){return"NZ"===this.country}isUnitedStates(){return"US"===this.country}isUnitedKingdom(){return this.country?
"UK GB IM GG JE GI FK".split(" ").includes(this.country):!1}isCanada(){return"CA"===this.country}isGDPR(){var a;return this.country?"true"===(null===(a=this._adthrive)||void 0===a?void 0:a.gdpr):!1}};wi=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],wi);let Ut={AS:{location:"Sponsor_Tile",selectors:"h1.entry-title;h1.post-title;h1.posttitle;h1.story-title;h1.heading;.post > .post-title;h1.tdb-title-text;h1.post_title".split(";"),size:[[300,55],[234,60]],position:"afterend",classNames:["adthrive-sponsor-tile"],
find:a=>document.querySelector(a),requireSelectorMatch:!0,lazy:!1},NR:{location:"Native_Recipe",sequence:1,nativeRecipeSiteSpecificSelectors:{"5531445f4f3ba0833a7842a4":['[class*="recipe"] [class*="ingredient"] ul li:last-child']},selectors:'[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="recipeIngredient"]:last-child;[itemscope][itemtype$="//schema.org/Recipe"] [itemprop="ingredients"]:last-child;[itemscope][itemtype$="//schema.org/Recipe"] .ingredient:last-child;.wprm-recipe-ingredient:last-child;#recipe .ingredients;.wprm-recipe-ingredients-container;.tasty-recipe-ingredients;[class*="recipe"] [class*="ingredient"] ul li:last-child;[class*="create-ingredient"] ul li:last-child;[class*="tasty-recipe"] [class*="ingredient"] p:last-child;[class*=recipe] [class*=recipe] ~ p + ul li:last-child'.split(";"),
size:[[225,65],[234,60],[300,100]],position:"afterend",classNames:["adthrive-native-recipe"],find:a=>{a=document.querySelectorAll(a);return 0<a.length?a[a.length-1]:null},requireSelectorMatch:!1,lazy:!0}},Ye=class{constructor(a,b){this.loaded=!1;this.campaigns=[];this.filteredSiteCodes=[];this.siteCodes=[];this.adViewability=[];this.speed=navigator.connection&&"4g"===navigator.connection.effectiveType?"1":"0";this.adUnits=Ut;this.selectorMatches=[];this.ortbSegments=new Map;this.rfMcmpCodes=[];this.rfIabCodes=
[];this.rfDataProcessed=new L;this.hvThreshold=.6;this.mcmp=[];this.flpProdIds=[];this._targetCampaignSites=new Set(["divascancook.com","hungryhappens.net","whatsgabycooking.com","pinchofyum.com","isabeleats.com"]);this._bidderSiteCodeList="MINO_2021 FMLO_2021 FMOOI_2022 LGBTQ_2021 LGBTQOI_2021 HISPO_2022 HISP_2023 AAOSL_21 AFAM_2020 APIO_2022 ASOI_2022 CMINO_2022 AFOI_2020 MRLOI_22 MOMS_2020 GENZ_2023 PKDSU12_2021 NWPR_2021 RMOI_24 TGNAF_21".split(" ");this._activeCampaign=c=>{let d=Date.now();return d>=
this._parseDate(c.start_date).getTime()&&d<=this._parseDate(c.expiration_date).getTime()};if(a&&0<Object.keys(a).length)this._setMarmaladeData(a,b);else b.marmaladeResponseLoaded.once(c=>{this._setMarmaladeData(c,b);b.resetMarmaladeData.emit()})}_setMarmaladeData(a,b){var c;this.loaded=!0;let {host:d,page:e,adViewability:f,dcsllSiteSpecific:g}=a;d&&d.length&&(this.siteCodes=(d[0].site_codes||[]).filter(Lb),this.filteredSiteCodes=this.siteCodes.filter(h=>this._bidderSiteCodeList.includes(h)));e&&e.length&&
(this.campaigns=(e[0].campaigns||[]).filter(this._activeCampaign));f&&f.length&&(this.adViewability=f);g&&(this.dcsllSiteSpecific=g);a=null===(c=window.location.hostname)||void 0===c?void 0:c.replace("www.","");this._targetCampaignSites.has(a)&&(this.adUnits.NR.lazy=!1);this._targetCampaignSites.has(a)&&document.body.classList.contains("single-post")&&!this.campaigns.some(h=>"NR_TNFLK23"===h.dfp_id)&&this.campaigns.push({casale_id:"NR_TNFLK23",dfp_id:"NR_TNFLK23",expiration_date:"2026-12-31",ingredient_line:"",
internal_id:"NR_TNFLK23",lead_ingredient:"",start_date:"2023-08-15"});c=this._getMcmpFlpIds();this.mcmp=c.mcmp||[];this.flpProdIds=c.flpProdIds||[];this.ortbSegments=this._getOrtbSegments();b.recencyFrequencyDataSet.on(this._handleRecencyFrequencyDataSet.bind(this),{handleEventsAlreadyEmitted:!0})}_getOrtbSegments(){return this.campaigns.reduce((a,b)=>{let [,c,,d]=(new RegExp(/(^iab(a|c))_(\d*)/)).exec(b.dfp_id)||[];d&&(b=a.get(c)||[],b.push({id:d}),c&&b.length&&a.set(c,b));return a},new Map)}_handleRecencyFrequencyDataSet(a){a.forEach(b=>
{let c=b[0];b=b[1];if("_A"===c.substring(c.length-2))this.rfMcmpCodes.push([c,b]);else{let d=c.substring(c.indexOf("_")+1);this.ortbSegments.set("iaba",[{id:d}]);this.rfIabCodes.push([c,b])}});this.rfDataProcessed.emit()}_isValidMarmaladeCampaign(a){a=a.dfp_id.substring(0,2);a=this.adUnits[a];var b=window.adthrive.siteAds.siteId;if(a){var c=a.find,d;b=(null===(d=a.nativeRecipeSiteSpecificSelectors)||void 0===d?0:d.hasOwnProperty(b))?a.nativeRecipeSiteSpecificSelectors[b]:a.selectors;(d=c.call(a,b.join(",")))&&
this.selectorMatches.push({adUnit:a,match:d});return!a.requireSelectorMatch||!!d}return!0}_getMcmpFlpIds(){return this.campaigns.filter(a=>this._isValidMarmaladeCampaign(a)).reduce((a,b)=>{a.mcmp.push(b.dfp_id);b.flp_prod_id&&a.flpProdIds.push(...JSON.parse(b.flp_prod_id));return a},{mcmp:[],flpProdIds:[]})}_parseDate(a){a=a.split("-");return new Date(Number(a[0]),Number(a[1])-1,Number(a[2]))}};Ye=q([y(),ha(0,fa("RecencyFrequencyMarmaladeResponse")),t("design:paramtypes",[Object,ob])],Ye);let Np=
a=>{a=a.substring(13).split(".").map(b=>parseInt(b));return{major:a[0],minor:a[1],patch:a[2]}},Op=(a,b)=>{a=Np(a);b=Np(b);if(a.major>b.major)return!1;if(a.major<b.major)return!0;if(a.minor>b.minor)return!1;if(a.minor<b.minor)return!0;if(a.patch>b.patch)return!1;if(a.patch<=b.patch)return!0},xi=class{constructor(a){this.settings=a.siteAds.adDensityLayout;this._adDensityEnabled=Q(a.siteAds.adDensityEnabled,!0);this.enabled=this.isEnabled()}isEnabled(){var a=window,b=a.adthrive&&a.adthrive.plugin;a=
(a=a.adthriveCLS)&&a.experiments;b=!!(a&&"clsins_ss"in a)||!(!b||!Op("adthrive-ads-1.1.0",b));return!!(this.settings&&this._adDensityEnabled&&b)}};xi=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],xi);let Vt=a=>{var b=a.downlink;b=void 0===b?"unknown":10>b?"slow":"fast";if("desktop"===a.device)switch(b){case "fast":return"InitialTimeoutDesktopFastExperiment";case "slow":return"InitialTimeoutDesktopSlowExperiment";case "unknown":return"InitialTimeoutDesktopUnknownExperiment"}else switch(b){case "fast":return"InitialTimeoutMobileFastExperiment";
case "slow":return"InitialTimeoutMobileSlowExperiment";case "unknown":return"InitialTimeoutMobileUnknownExperiment"}},yi=class extends X{init(){let a=S.resolve(Jc);this._key=Vt(a)}};yi=q([v("InitialTimeoutExperiment"),y()],yi);let zi=class{constructor(a){var b;this.initialBidsRequest=null!==(b=a.result)&&void 0!==b?b:2400;this.refreshBidsRequest=5E3}};zi=q([y(),t("design:paramtypes",[yi])],zi);let Ai=class{constructor(){this._data={}}set(a){this._data={...this._data,...a}}get(){return 0!==Object.keys(this._data).length?
this._data:void 0}getByKey(a){return this._data[a]}clear(){this.set({})}};Ai=q([v("UserPageDataLoggingStore"),y()],Ai);let Lc=class{constructor(a){this._userPageDataLoggingStore=a;this.loggingData=new L;this._maxTimeOnPage=36E5;this._listeners=[];this._callbacks=new Set;this._requestSent=!1;setTimeout(()=>{this._callbacks.forEach(b=>this._executeCallback(b));this.cleanup()},this._maxTimeOnPage)}_executeCallback(a){a();this._callbacks.delete(a);0===this._callbacks.size&&this.logUserPageData()}setUserPageData(a){a&&
this._userPageDataLoggingStore.set(a)}logUserPageData(){this._requestSent||(A.fetchEvent("UserPageDataLoggingComponent","logUserData",this._userPageDataLoggingStore.get()),this._requestSent=!0,this.cleanup())}addCallbackToQueue(a,b){this._callbacks.add(b);a.forEach(c=>{this._listeners.push(c.on(()=>this._executeCallback(b)))})}cleanup(){this._listeners.forEach(a=>{a()});this._listeners=[];this._callbacks.clear()}};Lc=q([v("UserPageDataLoggingEvents"),y(),t("design:paramtypes",[Ai])],Lc);let Ze=class{constructor(a,
b){this._userPageDataLoggingEvent=a;this._pageManager=b;this.optableDuration=this.optableFinished=this.optableStarted=this.prebidDuration=this.prebidFinished=this.prebidStarted=this.floorsDuration=this.floorsFinished=this.floorsStarted=this.marmaladeDuration=this.marmaladeFinished=this.marmaladeStarted=this.gamDuration=this.gamFinished=this.gamStarted=this.amazonDuration=this.amazonFinished=this.amazonStarted=this.bootstrapFinished=this.totalTimeOnPage=this.loading=this.delay=this.started=0;this.started=
ra();"visible"===document.visibilityState&&(this.timeOnPage=this.started);this._pageManager.visibilityChange.on(()=>this.documentVisibilityChanged());a.loggingData.on(()=>{"visible"===document.visibilityState&&(this.totalTimeOnPage+=ra()-this.timeOnPage)})}setNonBlockingLibraryTimingData(a){let b=a.get(Oa.Prebid),c=a.get(Oa.Amazon);a=a.get(Oa.Optable);this._setPrebidTimingData(b);this._setAmazonTimingData(c);this._setOptableTimingData(a)}_setPrebidTimingData(a){this.prebidStarted=a&&a.started||0;
this.prebidFinished=a&&a.finished||0;this.prebidDuration=a&&a.started&&a.finished&&a.finished-a.started||0}_setAmazonTimingData(a){this.amazonStarted=a&&a.started||0;this.amazonFinished=a&&a.finished||0;this.amazonDuration=a&&a.started&&a.finished&&a.finished-a.started||0}_setOptableTimingData(a){this.optableStarted=a&&a.started||0;this.optableFinished=a&&a.finished||0;this.optableDuration=a&&a.started&&a.finished&&a.finished-a.started||0}get timingData(){return{started:this.started,delay:this.delay,
loading:this.loading,totalTimeOnPage:this.totalTimeOnPage,bootstrapFinished:this.bootstrapFinished,amazonStarted:this.amazonStarted,amazonFinished:this.amazonFinished,amazonDuration:this.amazonDuration,gamStarted:this.gamStarted,gamFinished:this.gamFinished,gamDuration:this.gamDuration,marmaladeStarted:this.marmaladeStarted,marmaladeFinished:this.marmaladeFinished,marmaladeDuration:this.marmaladeDuration,floorsStarted:this.floorsStarted,floorsFinished:this.floorsFinished,floorsDuration:this.floorsDuration,
prebidStarted:this.prebidStarted,prebidFinished:this.prebidFinished,prebidDuration:this.prebidDuration,optableStarted:this.optableStarted,optableFinished:this.optableFinished,optableDuration:this.optableDuration,...(this.timeOnPage&&{timeOnPage:this.timeOnPage})}}documentVisibilityChanged(){"visible"===document.visibilityState?this.timeOnPage=ra():"hidden"===document.visibilityState&&(this.totalTimeOnPage+=ra()-this.timeOnPage,this.timeOnPage=void 0)}};Ze=q([y(),t("design:paramtypes",[Lc,Ra])],Ze);
let Bi=class extends X{init(){this._key="TKHO"}};Bi=q([v("TKHOExperiment"),y()],Bi);let Ci=class{constructor(a){this.tracker=a.result}};Ci=q([y(),t("design:paramtypes",[Bi])],Ci);let $e=class{constructor(){this._source=this._hash=null;this._hash=U.getLocalStorageValue("adt_ei",!1);this._source=U.getLocalStorageValue("adt_emsrc",!1)}get hash(){if(this._hash=U.getLocalStorageValue("adt_ei",!1))return"string"===typeof this._hash&&this._hash.match(/value/i)?this._retrieve64BitString(this._hash):this._hash}get source(){if(this._source=
U.getLocalStorageValue("adt_emsrc",!1))return this._source}_retrieve64BitString(a){return(a=a.match(/\w{64}/))?a[0]:void 0}};$e=q([y(),t("design:paramtypes",[])],$e);let Di=class extends Eb{init(){this._key="VBHO"}get choices(){return this._choices}};Di=q([v("VBHOExperiment"),y()],Di);let Ei=class extends W{init(){this._key="OptimalVideoBidders";this._default=!1}};Ei=q([v("OptimalVideoBiddersExperiment"),y()],Ei);let Fi=class{constructor(a,b){this.choicesList=[];this.bidders=a.result||["none"];this.useMlBidders=
b.result;this.choicesList=a.choices&&a.choices.map(({choice:c})=>c)||[]}};Fi=q([y(),t("design:paramtypes",[Di,Ei])],Fi);let af=class extends Fc{constructor(a,b){super();this._siteExperiments=a;this._pubabgroup=b;this._choices=[];this._result=!1;this.key=bb.VideoAdvancePlaylistRelatedPlayer;this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);a=this._siteExperiments.getVideoPlaylistByType("stickyPlaylist");this.enabled&&this.experimentConfig&&0<a.length&&(this._choices=this.experimentConfig.variants,
this._result=this.run(),this.setExperimentTargeting())}run(){return(new Ha(this._choices[0].weight/100)).get()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;this._pubabgroup.set(a,this._result?"on":"off")}else A.error("VideoAdvancePlaylistRelatedPlayerSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config")}};q([ea(),t("design:type",Function),t("design:paramtypes",
[]),t("design:returntype",void 0)],af.prototype,"run",null);af=q([y(),t("design:paramtypes",[vb,pb])],af);class ua{static getScrollTop(){return(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)}static getScrollBottom(){return this.getScrollTop()+(document.documentElement.clientHeight||0)}static shufflePlaylist(a){let b=a.length,c,d;for(;0!==b;)d=Math.floor(Math.random()*a.length),--b,c=a[b],a[b]=a[d],a[d]=c;return a}static isMobileLandscape(){return window.matchMedia("(orientation: landscape) and (max-height: 480px)").matches}static playerViewable(a){a=
a.getBoundingClientRect();return this.isMobileLandscape()?window.innerHeight>a.top+a.height/2&&0<a.top+a.height/2:window.innerHeight>a.top+a.height/2}static createQueryString(a){return Object.keys(a).map(b=>`${b}=${a[b]}`).join("&")}static createEncodedQueryString(a){return Object.keys(a).map(b=>`${b}=${encodeURIComponent(a[b])}`).join("&")}static setMobileLocation(a){a=a||"bottom-right";"top-left"===a?a="adthrive-collapse-top-left":"top-right"===a?a="adthrive-collapse-top-right":"bottom-left"===
a?a="adthrive-collapse-bottom-left":"bottom-right"===a?a="adthrive-collapse-bottom-right":"top-center"===a&&(a=ca()?"adthrive-collapse-top-center":"adthrive-collapse-bottom-right");return a}static addMaxResolutionQueryParam(a){let b=`max_resolution=${ca()?"320":"1280"}`,[c,d]=String(a).split("?");return`${c}?${d?d+`&${b}`:b}`}}let bf=class extends fb{constructor(a,b,c){super();this._result=!0;this.key="AdvancePlaylistRelated";this._choices=[{choice:!0},{choice:!1}];this.weight=1;var d=a.siteAds;a=
d.adOptions.advancePlaylistOptions||{};d=d.videoPlayers;d=(d&&d.players||[]).filter(e=>"stickyPlaylist"===e.type);(c=c.getCoreExperimentButMutateWeights(this.key))&&d.length&&Q(a.relatedPlayer&&a.relatedPlayer.enabled,!0)&&(this._expConfigABGroup=c.abgroup,this.weight=c.variants[0].weight,this._result=this.run(),b.set(c.abgroup,this._result?"on":"off"))}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",
void 0)],bf.prototype,"run",null);bf=q([v("AdvancePlaylistRelatedExperiment"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Ia,Ob])],bf);let cf=class extends X{constructor(){super(...arguments);this.abgroup="cbt"}init(){this._key="CloseButtonTimeout"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],cf.prototype,"run",null);cf=q([v("CloseButtonTimeoutExperiment"),y()],cf);let df=class extends X{init(){this._key="JwRequestTimeout"}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],df.prototype,"run",null);df=q([v("JwRequestTimeoutExperiment"),y()],df);let Gi=class extends W{init(){this._key="LogAdDuration";this._default=!1}};Gi=q([v("LogAdDurationExperiment"),y()],Gi);let Hi=class extends W{init(){this._key="LogAdLifeCycle";this._default=!1}};Hi=q([v("LogAdLifeCycleExperiment"),y()],Hi);let ef=class extends fb{constructor(a,b){super();this._result=!0;this.key="Playbackmethod";this._choices=
[{choice:!0},{choice:!1}];this._map=new Map([[M.Video_In_Post_ClicktoPlay_SoundOn,[3]],[M.Video_Collapse_Autoplay_SoundOff,[6]],[M.Video_Coll_SOff_Smartphone,[6]],[M.Video_Individual_Autoplay_SOff,[6]]]);this.weight=1;if(b=b.getCoreExperimentButMutateWeights(this.key))this._expConfigABGroup=b.abgroup,this.weight=b.variants[0].weight,this.playbackmethod=(this._result=this.run())?this._map:void 0,a.set(b.abgroup,this._result?"on":"off")}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],ef.prototype,"run",null);ef=q([v("PlaybackmethodExperiment"),y(),t("design:paramtypes",[Ia,Ob])],ef);let ff=class extends X{init(){this._key="Protocols"}setABGroup(){var a;if(this._result){let b=-1;null===(a=this._choices)||void 0===a?void 0:a.forEach(c=>{var d;c.choice.value===(null===(d=this._result)||void 0===d?void 0:d.value)&&(b=c.weight)});super.setABGroup(this._result.value,this.abgroup,b)}}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],ff.prototype,"run",null);ff=q([v("ProtocolsExperiment"),y()],ff);let Ii=class extends W{init(){this._key="ContentSpecificPlaylists";this._default=!1}};Ii=q([v("ContentSpecificPlaylistExperiment"),y()],Ii);let Wt=()=>{const a=Cc(".adthrive-content-specific-playlist");return a.valid&&a.elements&&a.elements.length?a.elements[0].getAttribute("data-playlist-id"):null},Xt=a=>{const b=[],c=[],d=Wt();if(d)return d;
a.forEach(e=>{e.isDraft||(e.categories.some(f=>{f=Cc(`.adthrive-cat-${f}`);return f.valid&&f.elements&&f.elements.length})?b.push(e.playlistId):0===e.categories.length&&c.push(e.playlistId))});a=0<b.length?b:c;return a[Math.floor(Math.random()*a.length)]},gf=a=>{if(S.resolve(Ii).result&&a.length)return Xt(a)},Ji=class extends X{init(){this._key="OutstreamPlacementExperiment"}run(){return super.run()}};Ji=q([v("OutstreamPlacementExperiment"),y()],Ji);let Ki=class extends W{init(){this._default=!1;
this._key="DisplayBackupRenderer"}};Ki=q([v("StandardOutstreamBackupRendererExperiment"),y()],Ki);let Li=class extends X{init(){this._key="VastTimeoutISV"}run(){return super.run()}};Li=q([v("VastTimeoutISVExperiment"),y()],Li);let Mi=class extends X{init(){this._key="VastTimeoutOSV"}run(){return super.run()}};Mi=q([v("VastTimeoutOSVExperiment"),y()],Mi);let Ni=class{constructor(a,b,c,d,e,f,g,h,k,m,n){var p;this.players=[];this.instreamAdUnits=new Set([M.Video_Collapse_Autoplay_SoundOff,M.Video_Individual_Autoplay_SOff,
M.Video_Coll_SOff_Smartphone,M.Video_In_Post_ClicktoPlay_SoundOn]);this.closeButtonTimeout=Q(b.result,4E3);this.vastTimeoutISV=Q(c.result,1E4);this.vastTimeoutOSV=Q(d.result,5E3);this.maxRedirect=8;this.apiValue=[2,7];this.videoWasClosed=Q(U.getLocalStorageValue("video_closed",!0,!0,18E5),!1);this.mobileStickyPlayerOnPage=!1;this.playbackmethod=f.playbackmethod;this.outstreamPlacement=m.result||0;this.logAdDuration=g.result;this.logAdLifeCycle=h.result;this.jwRequestTimeout=Q(k.result,15E3);this.mimeType=
navigator.userAgent&&-1===navigator.userAgent.search(/Chrom|firefox/i)?["video/mp4","application/javascript"]:["video/mp4","application/javascript","video/webm"];this.videoProtocols=e.result;this.position={id:1,name:"above"};this.removeVideoTitleWrapper=Q(a.siteAds.adOptions.removeVideoTitleWrapper,!1);b=a.siteAds.videoPlayers;this.footerSelector=Q(b&&b.footerSelector,"");this.players=Q(b&&b.players.map(r=>{r.mobileLocation=ua.setMobileLocation(r.mobileLocation);return r}),[]);this.relatedSettings=
b&&b.contextual;this.jwPlaylist=this.getPlayListPlayerVideos(a);this.advancePlaylist=this.getAdvancePlaylistConfig(a);this.contentSpecificPlaylists=null===(p=a.siteAds.videoPlayers)||void 0===p?void 0:p.contentSpecificPlaylists;this.setStandardOutstreamBackupRenderer=n.result;this.stickyOutstreamSettings=this._getStickyOutstreamSettings(a)}setupAdvanceRelatedExperiment(a){let b=S.resolve(af),c=S.resolve(bf),d=this.advancePlaylist.relatedPlayer;if(b.enabled)d.applyToFirst=b.result,d.shouldRun=this.jwPlaylist.then(e=>
"object"===typeof e&&b.result).catch(()=>Promise.reject().catch(()=>!1));else{let e=(a=a?d.sticky:d.static)?a.enabled:d.enabled;d.applyToFirst=a?a.applyToFirst:d.applyToFirst;d.shouldRun=this.jwPlaylist.then(f=>"object"===typeof f&&e&&c.result).catch(()=>Promise.reject().catch(()=>!1))}}getPlayListPlayerVideos(a){var b,c=a.siteAds.videoPlayers;c=(c&&c.players||[]).filter(d=>"stickyPlaylist"===d.type);return(b=(b=(a=null===(b=a.siteAds.videoPlayers)||void 0===b?void 0:b.contentSpecificPlaylists)&&
gf(a))?b:c.length&&c[0].playlistId)?rh(ua.addMaxResolutionQueryParam(`${"https://cdn.jwplayer.com/v2/playlists/"}${b}`)):Promise.reject().catch(()=>!1)}getAdvancePlaylistConfig(a){a=a.siteAds.adOptions.advancePlaylistOptions||{};let b=a.relatedPlayer||{};return{playlistPlayer:{enabled:Q(a.playlistPlayer.enabled,!0)},relatedPlayer:{applyToFirst:Q(b.applyToFirst,!0),enabled:Q(b.enabled,!0),shouldRun:Promise.reject().catch(()=>!1),static:b.static,sticky:b.sticky}}}_getStickyOutstreamSettings(a){let {video:b,
videoPlayers:c}=a.siteAds;a=b&&b.partners.stickyOutstream;return Q(c&&c.partners&&c.partners.stickyOutstream||a,{blockedPageSelectors:"",mobile:{enabled:!1},desktop:{enabled:!1},allowForPageWithStickyPlayer:{enabled:!1},allowOnHomepage:!1,mobileHeaderSelector:"",mobileLocation:"bottom-right",saveVideoCloseState:!1})}};Ni=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,cf,Li,Mi,ff,ef,Gi,Hi,df,Ji,Ki])],Ni);let hf=class extends Fc{constructor(a,b){super();this._siteExperiments=a;this._pubabgroup=
b;this._choices=[];this._result=!1;this.key=bb.RemoveVideoTitleWrapper;this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._result=this.run(),this.setExperimentTargeting())}run(){return(new Ha(this._choices[0].weight/100)).get()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;this._pubabgroup.set(a,
this._result?"on":"off")}else A.error("RemoveVideoTitleWrapperSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config")}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],hf.prototype,"run",null);hf=q([y(),t("design:paramtypes",[vb,pb])],hf);let Oi=class extends X{init(){this._key="JWPVersionExperiment"}};Oi=q([v("JWPVersionExperiment"),y()],Oi);let Pi=class extends X{constructor(){super(...arguments);this.abgroup=
"vmaxdur"}init(){this._key="VideoDuration"}};Pi=q([v("VideoMaxDurationExperiment"),y()],Pi);let Qi=class{constructor(a,b,c,d){this._videoAdOptions=a;this.apiValue=[2,7];this.relatedPlayerAdded=!1;this.footerSelector="";this.gamDiscount=.16;this.hasStickyOutstream=this.hasJwPlayer=!1;this.instreamAdUnits=new Set([M.Video_Collapse_Autoplay_SoundOff,M.Video_Individual_Autoplay_SOff,M.Video_Coll_SOff_Smartphone,M.Video_In_Post_ClicktoPlay_SoundOn]);this.jwpVersion=null;this.minFloor=.1753;this.playlistPlayerAdded=
this.mobileStickyPlayerOnPage=!1;this.plcmtUnits=new Map([[M.Video_Collapse_Autoplay_SoundOff,2],[M.Video_Individual_Autoplay_SOff,2],[M.Video_Coll_SOff_Smartphone,2],[M.Video_In_Post_ClicktoPlay_SoundOn,1]]);this.removeVideoTitleWrapper=this.preventStickyOutstream=!1;this.vidDiscount=.1753;a=this._videoAdOptions;this.position={id:1,name:"above"};this.maxRedirect=8;this.playbackmethod=a.playbackmethod;this.advancePlaylist=a.advancePlaylist;this.jwPlaylist=a.jwPlaylist;this.setupAdvanceRelatedExperiment=
a.setupAdvanceRelatedExperiment;this.relatedSettings=a.relatedSettings;this.mimeType=a.mimeType;this.outstreamPlacement=a.outstreamPlacement;this.videoProtocols=a.videoProtocols;this.closeButtonTimeout=a.closeButtonTimeout;this.jwRequestTimeout=a.jwRequestTimeout;this.logAdDuration=a.logAdDuration;this.logAdLifeCycle=a.logAdLifeCycle;this.vastTimeoutISV=a.vastTimeoutISV;this.vastTimeoutOSV=a.vastTimeoutOSV;this.videoWasClosed=a.videoWasClosed;this.removeVideoTitleWrapper=c.enabled?c.result:a.removeVideoTitleWrapper;
this.players=a.players;this.footerSelector=a.footerSelector;this.stickyOutstreamSettings=a.stickyOutstreamSettings;this.maxDuration=d.result||30;this.contentSpecificPlaylists=a.contentSpecificPlaylists;this.jwpVersion=b.result&&"none"!==b.result?b.result:null;this.setStandardOutstreamBackupRenderer=a.setStandardOutstreamBackupRenderer}};Qi=q([y(),t("design:paramtypes",[Ni,Oi,hf,Pi])],Qi);let Ri=class extends Eb{init(){this._setAbGroup=!1;this._key="VideoOpenBidderExperiment"}};Ri=q([v("VideoOpenBidderExperiment"),
y()],Ri);let Si=class{constructor(a){this.bidders=a.result||["none"]}};Si=q([y(),t("design:paramtypes",[Ri])],Si);let Ti=class{constructor(){this.active=!1}};Ti=q([y()],Ti);let Ui=class extends Eb{init(){this._key="AllBidderHO";this.abgroup="allbho";this._default=["off"]}};Ui=q([v("AllBidderHOExperiment"),y()],Ui);let Vi=class{constructor(a){this.bidders=a.result||["off"];this.useMlBidders=!1}};Vi=q([y(),t("design:paramtypes",[Ui])],Vi);let Wi=class{constructor(){this.realizedAdDensityCompReady=new L;
this.metricsRequested=new L}};Wi=q([y()],Wi);let Xi=class extends X{init(){this._key="TrackScrollExperiment"}get choices(){return this._choices}get result(){var a;return null!==(a=this._result)&&void 0!==a?a:"off"}};Xi=q([v("TrackScrollExperiment"),y()],Xi);var Pp="object"==typeof global&&global&&global.Object===Object&&global,Yt="object"==typeof self&&self&&self.Object===Object&&self,Hb=Pp||Yt||Function("return this")(),Gr=/\s/,Hr=/^\s+/,jf=Hb.Symbol,Qp=Object.prototype,Dr=Qp.hasOwnProperty,Er=Qp.toString,
Yc=jf?jf.toStringTag:void 0,Fr=Object.prototype.toString,Fn=jf?jf.toStringTag:void 0,Hn=0/0,Lr=/^[-+]0x[0-9a-f]+$/i,Ir=/^0b[01]+$/i,Jr=/^0o[0-7]+$/i,Kr=parseInt,Nr=Math.max,Mr=Math.min;let Yi=class{constructor(a){this.trackScrollExperiment=a;a=this.trackScrollExperiment.result;"off"!==a?(this.trackScrollEnabled=!0,this._timeForTracking=this._parseResult(a),this._setupScrollListener()):this.trackScrollEnabled=!1}getTargetingValue(){if(this._timeForTracking&&this._shouldUpdateTargeting())return`engage${this._timeForTracking}`}_parseResult(a){[,
a]=a.split("on");if(a)return Number(a)}_setupScrollListener(){let a=Zc(()=>{this._lastScrollTimestamp=Date.now()},500);window.addEventListener("scroll",a,{passive:!0})}_shouldUpdateTargeting(){return this._lastScrollTimestamp&&this._timeForTracking&&(Date.now()-this._lastScrollTimestamp)/1E3<=this._timeForTracking?!0:!1}};Yi=q([y(),t("design:paramtypes",[Xi])],Yi);let N=class{constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B,E,C,I,F,O,R,J,aa,qa,za,Ea,Ib,Jb,Ba,Sa,Kb,db,fc,Zi,$i,Mc,aj,bj,cj,Dd,kf,dj){this.abGroup=
a;this.act25=b;this.adOptions=c;this.adTypes=d;this.amazon=e;this.allBidderHO=f;this.ccpa=g;this.gpc=h;this.clsOptimizedAds=k;this.comscore=m;this.context=n;this.disableAds=p;this.displayOpenBidding=r;this.impressionLog=w;this.fledge=z;this.floors=x;this.footer=B;this.gam=E;this.gdpr=C;this.hbho=I;this.identityApi=F;this.idho=O;this.infiniteScroll=R;this.lazyLoad=J;this.liveRampAts=aa;this.locale=qa;this.marmalade=za;this.optable=Ea;this.partners=Ib;this.pubAbGroup=Jb;this.prebid=Ba;this.site=Sa;
this.targetDensity=Kb;this.timeouts=db;this.timing=fc;this.tkho=Zi;this.user=$i;this.vbho=Mc;this.video=aj;this.videoOpenBidding=bj;this.uid2TokenCleanup=cj;this._dynamicAdsMapper=Dd;this.realizedAdDensity=kf;this.trackScroll=dj;f.bidders.forEach(Rb=>{I.choicesList.includes(Rb)&&!I.bidders.includes(Rb)&&I.bidders.push(Rb);Mc.choicesList.includes(Rb)&&!Mc.bidders.includes(Rb)&&Mc.bidders.push(Rb)});this.dynamicAds=Dd.get();a=S.resolve(Kc);a.enabled&&(this.clsOptions=a)}resetDynamicAds(){this.dynamicAds=
this._dynamicAdsMapper.get()}shouldHalveIOSDensity(){let a=S.resolve(wd);return Mb()&&a.isRolloutEnabled("iOS-Resolution")}getTargetDensity(a){return this.shouldHalveIOSDensity()?a/2:a}};N=q([y(),t("design:paramtypes",[Ia,Mh,xd,Nh,bi,Vi,ci,ni,di,ei,Jc,fi,hi,ti,Ue,Ad,mi,De,Ve,qi,ri,We,ui,vi,Xe,wi,Ye,Pb,Ke,pb,Jh,He,xi,zi,Ze,Ci,$e,Fi,Qi,Si,Ti,ki,Wi,Yi])],N);let Zt={phone:"mobile",desktop:"desktop",tablet:"tablet"},$t=a=>{if(!a||0===a.length)return!0;if(100!==a.reduce((c,{weight:d})=>c+d,0))return A.error("DCSLLSiteSpecificMarmaladeExperiment",
"validation","Sum of weights is not 100"),!1;a=a.map(({choice:c})=>c);const b=[...(new Set(a))];return a.length!==b.length?(A.error("DCSLLSiteSpecificMarmaladeExperiment","validation","Duplicate choices found in DCSLLM site specific experiment"),!1):a.filter(c=>"off"!==c).every(c=>!isNaN(Number(c)))?!0:(A.error("DCSLLSiteSpecificMarmaladeExperiment","validation","Non-numeric choices found in DCSLLM site specific experiment"),!1)},au=a=>{const b=a.context.device;var c=(a=null===(c=a.marmalade)||void 0===
c?void 0:c.dcsllSiteSpecific)?a[Zt[b]]:void 0;c=null===c||void 0===c?void 0:c.variants.map(({value:d,weight:e})=>({choice:`${d}`,weight:e}));return $t(c)?c:null},ej=class{constructor(a,b){this.abgroup="dcsllm_ss";this._choices=this._result=void 0;b=au(b);this._choices=null!==b&&void 0!==b?b:void 0;this._result=this.run();a.set(this.abgroup,this._result)}get result(){return this._result}run(){return(new Ec(this._choices)).get()}};ej=q([v("DCSLLSiteSpecificMarmaladeExperiment"),y(),t("design:paramtypes",
[Ia,N])],ej);let fj=class extends T{constructor(a,b,c,d,e){super();this._slotEventBus=a;this._intersectionObserverManager=b;this._config=c;this.cpmThresholdMet=!1;this._dcsllSiteSpecificExperimentResult=this._config.adOptions.dynamicContentSlotLazyLoading?e.result||d.result:"off"}isContentSlot(a){return"Content"===a.location}isBelowPostSlot(a){return"Below_Post"===a.location}isRecipeSlot(a){return"Recipe"===a.location}isValidLocation(a){return this.isContentSlot(a)||this.isBelowPostSlot(a)||this.isRecipeSlot(a)}isValidSequence(a){return this.isBelowPostSlot(a)?
a.sequence&&1>=a.sequence:this.isRecipeSlot(a)?!0:a.sequence&&9>=a.sequence}isCPMSlot(a){return a.sequence&&2>=a.sequence&&this.isContentSlot(a)}isTargetSlot(a){return a.lazy&&!this.isCPMSlot(a)&&this.isValidSequence(a)&&this.isValidLocation(a)}_sortByCpm(a,b){return a.cpm===b.cpm?0:a.cpm<b.cpm?1:-1}getSlotCPM(a,b){return a.prebidAdUnit&&a.prebidAdUnit.length&&a.prebidAdUnit[0].code&&(a=b.getBidResponsesForAdUnitCode(a.prebidAdUnit[0].code).bids.sort(this._sortByCpm),0<a.length)?a[0].cpm:0}checkThresholdMet(a,
b){!this.cpmThresholdMet&&this.isCPMSlot(a)&&this._dcsllSiteSpecificExperimentResult&&(this.cpmThresholdMet=this.getSlotCPM(a,b)>=parseFloat(this._dcsllSiteSpecificExperimentResult))&&this.loadRemainingSlots();return this.cpmThresholdMet}loadRemainingSlots(){this._intersectionObserverManager.unobservedSlotIntersectionObservers.forEach((a,b)=>{this.isTargetSlot(b)&&(this._intersectionObserverManager.unobserve(b),this._slotEventBus.displaySlot.emit(b))})}lazyLoadingEnabledForSlot(a,b){if(!a||!a.googleTagSlot)A.error("DynamicContentSlotLazyLoadingComponent",
"lazyLoadingEnabledForSlot","Slot not configured");else if("off"!==this._dcsllSiteSpecificExperimentResult&&this.checkThresholdMet(a,b)&&this.isTargetSlot(a))return a.setSlotTargetingFlag("dcsll",["true"]),a.lazyDisabled=!0,!1;return a.lazy}};fj=q([v("DynamicContentSlotLazyLoadingComponent"),y(),t("design:paramtypes",[cb,vd,N,Lh,ej])],fj);let gj=class extends W{init(){this._key="InterstitialConfig";this._default=!1}};gj=q([v("InterstitialConfigExperiment"),y()],gj);let lf=class extends T{constructor(a,
b){super();this._interstitialConfigExperiment=a;this._adOptions=b}get enabled(){return this._interstitialConfigExperiment.result&&(this._adOptions.desktopInterstitial||this._adOptions.mobileInterstitial)}start(){this._addAttributeToInternalLinks()}_isInternalLink(a){let b=(new URL(window.location.href)).hostname;return a.startsWith("/")||a.startsWith("#")||a.includes(b)||a.startsWith(`//${b}`)}_addAttributeToInternalLinks(){document.querySelectorAll("a").forEach(a=>{this._isInternalLink(a.href)&&
a.setAttribute("data-google-interstitial","false")})}_setInterstitialConfig(a){a.googleTagSlot&&a.googleTagSlot.setConfig({interstitial:{triggers:{unhideWindow:!0}}})}};lf=q([H(),v("InterstitialConfigComponent"),t("design:paramtypes",[gj,xd])],lf);let hj=class extends W{init(){this._key="AdExpansion";this._default=!1}isEnabled(){let a=!S.resolve(wd).isRolloutEnabled("disable-expandable-ads");return super.isEnabled()&&!ca()&&a}};hj=q([v("AdExpansionExperiment"),y()],hj);var Va;let V=Va=class{constructor(a,
b,c,d,e,f,g,h,k,m,n,p){this._config=a;this._bootstrapEventBus=b;this._consentEventBus=c;this._slots=d;this.emailCapture=e;this._prebidMethods=f;this._demandChain=g;this._dynamicContentSlotLazyLoadingComponent=h;this._interstitialConfigComponent=k;this._adExpansionExperiment=m;this._piiEventBus=n;this._slotEventBus=p;this._started=!1;this._postStartTargetingWhiteList="abgroup bms flag fpv hi_au marmalade mcmp pubab pvk rf site_code".split(" ");this.impressionViewable=new L;this.slotOnload=new L;this.slotRenderEnded=
new L;this.slotVisibilityChanged=new L;this.slotRequested=new L;this.slotResponseReceived=new L;this.started=new L}init(){this.emailCapture.collectEmailFromStorage();Va.pushToQueue(()=>{let a=window.googletag.pubads();a.setSafeFrameConfig({sandbox:!0,allowOverlayExpansion:!0,allowPushExpansion:!0});a.set("page_url",this._config.context.pageUrl);a.enableSingleRequest();a.disableInitialLoad();a.setPrivacySettings({childDirectedTreatment:yd()});this._addGamEventListeners();this._bootstrapEventBus.libraryLoadFailed.on(({bootstrapType:b})=>
{b===Oa.Prebid&&this.setTargetingFlag("pbjs",["failed"])},{handleEventsAlreadyEmitted:!0});if(this._config.act25.required)this._consentEventBus.act25consentCaptured.on(b=>{this.setNonPersonalizedAds(!b)},{handleEventsAlreadyEmitted:!0});this._piiEventBus.optableResolved.on(b=>this._setOptableGamTargeting(b),{handleEventsAlreadyEmitted:!0})})}start(){Va.pushToQueue(()=>{window.googletag.enableServices();try{this.started.emit()}catch(a){A.error("GoogleAdManager","start","started",a)}this._started=!0})}reset(){this._started=
!1}static pushToQueue(a){window.googletag.cmd.push(a)}waitForQueue(){return new Promise(a=>{window.googletag.cmd.push(()=>{a(!0)})})}setTargeting(a){a=(Array.isArray(a)?a:[a]).filter(c=>!(!c.value||!c.value.length));let b=this._started?a.filter(c=>!this._postStartTargetingWhiteList.includes(c.key)):[];if(b.length)a=b.map(c=>c.key).join(""),A.error("GoogleAdManager","setTargeting","Attempted to set targeting after started",a);else for(let c of a)c&&Va.pushToQueue(()=>{window.googletag.pubads().setTargeting(c.key,
c.value)})}setSlotTargeting(a,b){a=Array.isArray(a)?a:[a];for(let c of a)c&&Va.pushToQueue(()=>{b.setTargeting(c.key,Array.isArray(c.value)?c.value.join(","):c.value)})}setTargetingFlag(a,b,c=!1){let d=()=>{const e=window.googletag.pubads().getTargeting("flag").filter(f=>{[f]=f.split(":");return!c||f!==a});this.setTargeting({key:"flag",value:[...e,...b.map(f=>`${a}:${f}`)]})};b&&0<b.length&&Va.pushToQueue(()=>d())}getTargeting(){return window.googletag.pubads().getTargetingKeys().map(a=>({key:a,value:window.googletag.pubads().getTargeting(a)}))}getTargetingValuesForKey(a){return window.googletag.pubads().getTargeting(a)}getTargetingMap(){let a=
window.googletag.pubads();return a.getTargetingKeys().reduce((b,c)=>{b[c]=a.getTargeting(c);return b},{})}clearTargetingForKey(a){Va.pushToQueue(()=>{window.googletag.pubads().clearTargeting(a)})}_getPathname(a){return"Content"===a.location&&a.sequence&&9<a.sequence||"Below_Post"===a.location&&a.sequence&&1<a.sequence?a.location:"Sidebar"===a.location&&a.sequence&&9<a.sequence?a.name.replace(/\d+/,"9"):"Recipe"===a.location&&a.sequence&&5<a.sequence?a.name.replace(/\d+/,"2"):a.name}defineSlots(a){let {id:b}=
this._config.site,{account:c,prefix:d}=this._config.gam;return a.map(e=>{var f=this._getPathname(e);f=`/${c}/${d}_${f}/${b}`;let g="Video_StickyOutstream"===e.location?[...e.sizes]:[...e.sizes,"fluid"];this._setupSlot(e,f,g);return e}).filter(kc)}displaySlots(a){Va.pushToQueue(async()=>{let b=window.googletag.pubads();window.googletag&&!window.googletag.pubadsReady&&A.error("index","load",Error(`Unexpected googletag.pubadsReady: ${window.googletag.pubadsReady}`));let c=[];await this._prebidMethods.waitForQueue().then(e=>
{!0===e&&(c=this._prebidMethods.getAllPrebidWinningBids())});this._setSlotScrollTrackTargeting(a);for(let e of a){var d=this._demandChain.getBidWithBsidForSlot(c,e);d&&(d=this._demandChain.getLastBsid(d.meta))&&e.googleTagSlot.setTargeting("hb_bsid",d);b.enableLazyLoad(this._dynamicContentSlotLazyLoadingComponent.lazyLoadingEnabledForSlot(e,this._prebidMethods)?this._config.lazyLoad.googleLazyLoadSettings.gam:this._config.lazyLoad.googleLazyLoadSettings.disabled);await this._emitBeforeRefreshSlots(a);
b.refresh([e.googleTagSlot])}})}refreshSlots(a){Va.pushToQueue(async()=>{this._setSlotScrollTrackTargeting(a);await this._emitBeforeRefreshSlots(a);a.forEach(b=>{b.addRequestTypeSlotFlag()});window.googletag.pubads().refresh(a.map(b=>b.googleTagSlot))})}_emitBeforeRefreshSlots(a){return this._slotEventBus.beforeGoogleAdManagerRefreshSlots.legacyEmit(a)}clearSlots(a){Va.pushToQueue(()=>{let b=a.map(c=>c.googleTagSlot);window.googletag.pubads().clear(b)})}destroySlots(a){Va.pushToQueue(()=>{let b=a.map(c=>
c.googleTagSlot);window.googletag.destroySlots(b)})}setSharedIdAsPPID(a){let b=a.replace(/[\W_]/g,"");32<=b.length&&150>=b.length&&Va.pushToQueue(()=>{window.googletag.pubads().setPublisherProvidedId(b)})}setGPIDasPPID(a){Va.pushToQueue(()=>{window.googletag.pubads().setPublisherProvidedId(a)})}setNonPersonalizedAds(a){Va.pushToQueue(()=>{window.googletag.pubads().setPrivacySettings({nonPersonalizedAds:a})})}_addGamEventListeners(){this._addEventListener(this.impressionViewable,"impressionViewable");
this._addEventListener(this.slotOnload,"slotOnload");this._addEventListener(this.slotRenderEnded,"slotRenderEnded");this._addEventListener(this.slotVisibilityChanged,"slotVisibilityChanged");this._addEventListener(this.slotRequested,"slotRequested");this._addEventListener(this.slotResponseReceived,"slotResponseReceived")}_addEventListener(a,b){Va.pushToQueue(()=>{window.googletag.pubads().addEventListener(b,c=>{let d=this._slots.get(c.slot.getSlotElementId());if(d)try{a.emit({slot:d,event:c})}catch(e){A.error("GoogleAdManager",
"addEventListener","emit",e)}})})}_setOptableGamTargeting(a){let {clusterCount:b,hemCount:c,accuracyResult:d,traits:e}=a;this.setTargetingFlag("n_clust",[`${b}`]);this.setTargetingFlag("n_hem",[`${c}`]);"hem-found"===d.status?this.setTargetingFlag("rog_ha",[d.matchingClusterIndex.toString()]):"hem-not-found"===d.status&&this.setTargetingFlag("rog_ha",["-1"]);this._setOptableGamTargetingForTraits(e)}_setOptableGamTargetingForTraits(a){[{key:"frequency180d",targetingName:"freq180"},{key:"frequency90d",
targetingName:"freq90"},{key:"frequency60d",targetingName:"freq60"},{key:"frequency30d",targetingName:"freq30"},{key:"last_seen",targetingName:"td_rec"},{key:"resolved_past_7_days",targetingName:"rl7"},{key:"resolved_past_15_days",targetingName:"rl15"},{key:"resolved_past_30_days",targetingName:"rl30"},{key:"resolved_past_90_days",targetingName:"rl90"}].forEach(b=>{var c;let {key:d,targetingName:e}=b;if(b=null===(c=a.find(f=>f.key===d))||void 0===c?void 0:c.value)switch(b){case "true":this.setTargetingFlag(e,
["t"]);break;case "false":this.setTargetingFlag(e,["f"]);break;default:this.setTargetingFlag(e,[b.toString()])}})}_setupSlot(a,b,c){let d=window.googletag.pubads();a.googleTagSlot="Interstitial"===a.location?window.googletag.defineOutOfPageSlot(b,window.googletag.enums.OutOfPageFormat.INTERSTITIAL):window.googletag.defineSlot(b,c,a.element.id);a.googleTagSlot?(a.googleTagSlot.addService(d).setTargeting("location",a.location).setTargeting("sequence",String(a.sequence)).setTargeting("id",a.id),"Content"!==
a.location&&"Below_Post"!==a.location||!this._adExpansionExperiment.result||a.googleTagSlot.setConfig({adExpansion:{enabled:!0}}),!this._interstitialConfigComponent.enabled||"Interstitial"!==a.location&&"Interstitial_1"!==a.location||this._interstitialConfigComponent._setInterstitialConfig(a),(1===a.sequence&&a.isAboveTheFold||"Footer"===a.location)&&a.googleTagSlot.setTargeting("ATF","true"),a.isSticky&&"Video_StickyOutstream"!==a.location&&a.googleTagSlot.setTargeting("sticky","true"),a.special&&
0<a.special.length&&a.googleTagSlot.setTargeting("special",a.special),"Sponsor_Tile"===a.location&&a.googleTagSlot.setCollapseEmptyDiv(!0,!0),a.location.includes("Native")&&a.googleTagSlot.setCollapseEmptyDiv(!0),d.isInitialLoadDisabled()&&window.googletag.display(a.googleTagSlot)):A.error("GoogleAdManager","defineSlots","Duplicate",b)}_setSlotScrollTrackTargeting(a){if(this._config.trackScroll.trackScrollEnabled){let b=this._config.trackScroll.getTargetingValue();a.forEach(c=>{c.googleTagSlot&&(b?
c.setTargeting({key:"mcmp",value:b}):c.clearTargeting("mcmp"))})}}};V=Va=q([v("GoogleAdManager"),y(),t("design:paramtypes",[N,Ee,md,Qa,Ic,ia,yh,fj,lf,hj,Db,cb])],V);let wb=class{constructor(a,b,c,d,e){this._config=a;this._prebidMethods=b;this._slots=c;this._slotEventBus=d;this._videoEventBus=e;this._videoFlagSlot={};this._amazonFloors=new Map;this._amazonRaptiveFloorKeys=new Map;this._floorPriority=this._config.floors.cmPriority;this._floorResetTypes=[na.refresh,na.lazyBidPool,na.lazy];this._prioritizedFloors=
new Map;this._vidDiscountRules={};this._host=window.location.hostname;this._expirationThreshold=5;this._usedFloorMap=new Map;this._floorAbbrv={[na.refresh]:"lr",[na.lazyBidPool]:"lbp",[na.lazy]:"ll",[na.session]:"ls"};this._refreshFloors=new Map;this._auctionFloors=new Map;this.SKIP_REASON_RANDOM="random";this.SKIP_REASON_NOT_FOUND="not_found";this._setupEventListeners();this._setVidDiscountRules()}setValues(a,b,c){a.values[`${this._host}|${b}`]=0<c?c:0}getDefaultFloorConfig(){return{currency:"USD",
schema:{fields:["domain","adUnitCode"],delimiter:"|"},values:{}}}setPrebidFloors(a,b){0<a.modelGroups.length&&this._setPrebidFloors(a,b)}setRaptiveFloors(a,b){var c;let d=(null===(c=null===a||void 0===a?void 0:a.modelGroups)||void 0===c?void 0:c[0])||{};c=(null===d||void 0===d?void 0:d.values)||{};this._raptiveFloors=a;b&&this._setPrebidFloors(a,na.raptive,!0);this._setAmazonFloors({values:c,currency:a.currency},!0)}auctionCaptured(a){return!!this._auctionFloors.get(a)}setAuctionFloors(a,b=0,c,d){this._auctionFloors.set(a,
{price:b,floorData:c,bidder:d})}getAuctionFloors(a,b){let {price:c,floorData:d,bidder:e}=this._auctionFloors.get(a)||{};a=d||b||{};return{floorPrice:!(null===d||void 0===d?0:d.skipped)&&c&&c.toFixed(4).toString()||"none",floorData:a,bidder:e}}saveBids(a,b){this._prebidMethods.getBidResponsesForAdUnitCode(a.id).bids.forEach(c=>{b.push(c.cpm)})}prioritizeFloorsConfig(a,b){if(Object.keys(a.values).length){var c=Object.keys(a.values),d=this._config.floors,e=this._prioritizedFloors.get(b);e=e&&e.values||
{};for(let f of c)e=this._addVidDiscountFloor({...e,[f]:a.values[f]});a.values=e;d.savePriorityFloorData(a,b);this._prioritizedFloors.set(b,a);return a}}setLegacyFloorsConfig(a){this._setAmazonFloors(a);let b=this._config.floors;a=!b.floorsExperiment.fbrap&&b.floorsData||{floorProvider:"legacy",floorsSchemaVersion:2,currency:"USD",modelGroups:[{...a,skipRate:0,modelWeight:100,modelVersion:"legacy"}]};this.setPrebidFloors(a);return a}updateBidTTL(a,b,c=""){(c?this._prebidMethods.getBidResponsesForBidPoolId(c):
this._prebidMethods.getBidResponsesForAdUnitCode(a)).bids.filter(d=>"rendered"!==d.status&&d.ttl&&!d.expired&&!d.sharedBidInUse).forEach(d=>{let e=d.responseTimestamp,f=d.ttl,g=a.includes("Video_StickyOutstream")?this._config.prebid.multistageStickyOutstreamActive:this._config.prebid.multistageActive;Number(e)+1E3*Number(f-this._expirationThreshold*(g?2:1))<b&&(d.ttl=0,d.expired=!0)})}setOGRefreshValue(a,b){this._refreshFloors.set(a,b)}get prioritizedFloorData(){return this._prioritizedFloors}createFloorValue(a=
[],b=0){return 0===a.length?0:1<a.length?ze(a,b):a[0]*b}getAmazonFloors(a,b){let c=this.getAmazonFloorsById(a);if(!c&&this._config.floors.floorsExperiment.raptive){a=this._getAmazonRaptiveFloorKeys([a,`${b||0}`]);for(let d of a)if(a=this.getAmazonFloorsById(d))return a}return c}clearVideoFlagSlot(a){if(a)return delete this._videoFlagSlot[a],!0}getVideoFlagSlot(a){return a&&a in this._videoFlagSlot?this._videoFlagSlot[a]:{}}setVideoFlagSlot(a,b={}){return a&&(this._videoFlagSlot[a]={...this._videoFlagSlot[a],
...b})}_addVidDiscountFloor(a){return{...this._vidDiscountRules,...a}}_setupEventListeners(){let {fbrap:a,legacy:b}=this._config.floors.floorsExperiment;if(b||a)this._slotEventBus.preRequestBids.on(this._setBannerAuctionFloor.bind(this)),this._videoEventBus.preRequestVideoBids.on(this._setVideoAuctionFloor.bind(this)),this._prebidMethods.onEvent("auctionEnd",c=>{c.adUnitCodes.forEach(d=>this._clearRefreshFloorValue(`${this._host}|${d}`))});this._prebidMethods.onEvent("auctionEnd",c=>{this.setFloorTargeting("auctionEnd",
c)})}_setVidDiscountRules(){Object.keys(M).forEach(a=>{this._vidDiscountRules[`${this._host}|${M[a]}`]=1E-5})}_clearRefreshFloorValue(a){this._floorResetTypes.forEach(b=>{let c=this._prioritizedFloors.get(b);c&&c.values&&c.values[a]&&(c.values[a],delete c.values[a],this._config.floors.savePriorityFloorData(c,b))})}_setBannerAuctionFloor(a){a.forEach(b=>{if(b=b.prebidAdUnit&&b.prebidAdUnit.length&&b.prebidAdUnit[0].code)this._usedFloorMap.delete(b),this._setAuctionFloor(b)})}_setVideoAuctionFloor(a){a.videos.forEach(b=>
{b=b.name;this._usedFloorMap.delete(b);this._setAuctionFloor(b)})}_setAuctionFloor(a){let b=this._raptiveFloors,c=this._floorPriority,d=!1;if(a){for(let e=0;e<=c.length;e++){let f=this._prioritizedFloors.get(c[e]);if(f&&f.values&&f.values[`${this._host}|${a}`]){d=!0;this.setLegacyFloorsConfig(f);this._usedFloorMap.set(a,c[e]);break}}!d&&b&&this._setPrebidFloors(b,na.raptive,!!b)}}_excludeSettingFloors(a){if(!a||a&&!this._config.floors.floorsTypeExcludes.has(a))return!1;let {ccpa:b,gdpr:c}=this._config,
d=b.enabled&&b.ccpaOptOut===b.privacyString,e=c.enabled&&c.revokedPurposeConsent;return a&&(d||e)}_setPrebidFloors(a,b,c){a=this._excludeSettingFloors(b)?{}:{floors:{enforcement:{enforceJS:!1},data:a,...(c&&{additionalSchemaFields:this._config.floors.customSchemaFields})}};this._prebidMethods.setConfig(a)}_getAmazonRaptiveFloorKeys(a){let b=a.join("-"),c=this._amazonRaptiveFloorKeys.get(b)||[];b&&!c.length&&(a=a.map(d=>[d,"*"]),c=pt(a,"-"),this._amazonRaptiveFloorKeys.set(b,c));return c}_setAmazonFloors({values:a,
currency:b},c=!1){Object.keys(a).forEach(d=>{var e,f=d.split("|");let g=f.length&&f[c?null!==(e=this._config.floors.getSchemaFieldOrder("adUnitCode"))&&void 0!==e?e:1:1]||d;e=g;c&&(f=f[this._config.floors.getSchemaFieldOrder("hvp")||1],e=`${g}-${f}`);this._amazonFloors.set(e.toLowerCase(),{value:a[d],currency:b||"USD"})})}getAmazonFloorsById(a){return this._amazonFloors.get(a.toLowerCase())||null}_getTargetingValue(a,b){a=this._usedFloorMap.get(a);a=b&&"legacy"===b.floorProvider&&(a&&this._floorAbbrv[a]||
"L");let c=!1;if(null===b||void 0===b?0:b.skipped)b.skippedReason===this.SKIP_REASON_RANDOM?c="sr":b.skippedReason===this.SKIP_REASON_NOT_FOUND?(c="se",A.event("Floors","_getTargetingValue","fv:se")):c="s";let d=null===b||void 0===b?void 0:b.modelVersion;return{modelVersion:c||a||d||"none",modelTimestamp:a?-1:d&&(null===b||void 0===b?void 0:b.modelTimestamp)||0,isLegacy:a}}_clearRefreshValue(a){return a&&this._refreshFloors.get(a)&&this._refreshFloors.set(a,0)}getFCVForAdUnit(a,b){let c=b?":":"%3A",
d=[];this._config.floors.activeFloorsTypes.forEach(e=>{if(e===na.refresh){var f=this._refreshFloors.get(a)||0;this._clearRefreshValue(a)}else f=(f=this._prioritizedFloors.get(e))&&f.values[`${this._host}|${a}`]||0;f&&d.push(`${uh[e]}${c}${f}`)});return d}setFloorTargeting(a,b){var c,d,e,f;let g=b.adUnitCodes[0];a=this._slots.get(g);let h=b.adUnits&&(null===(c=b.adUnits[0])||void 0===c?void 0:c.bids)&&(null===(e=null===(d=b.adUnits[0])||void 0===d?void 0:d.bids[0])||void 0===e?void 0:e.floorData);
c=a&&a.id===g;d=Object.keys(M).some(x=>M[x]===g);e=this._prebidMethods.getHighestCpmBids(g);e=!b.bidsReceived.length&&!!e.length;let k=this.getFCVForAdUnit(g,!!c),{floorPrice:m,floorData:n,bidder:p}=this.getAuctionFloors(b.auctionId,h),{modelVersion:r,modelTimestamp:w,isLegacy:z}=this._getTargetingValue(g,n);null!==(f=null===h||void 0===h?void 0:h.skipped)&&void 0!==f?f:!1;b=!z&&0<=Number(w);c?(a.setSlotTargetingFlag("fv",[r],!0),a.setSlotTargetingFlag("hbf",[m],!0),a.setSlotTargetingFlag("hbb",[p||
"none"],!0),b&&a.setSlotTargetingFlag("flrti",[`${w}`],!0),k.length&&a.setTargeting({key:"fcv",value:k}),e&&a.setSlotTargetingFlag("hbfcf",[m],!0)):d&&this.setVideoFlagSlot(g,{fv:r,hbf:m,...(k.length&&{fcv:k}),...(e&&{hbfcf:m}),...(b&&{flrti:`${w}`})})}getFloorPrice(a,b){var c;return b?"none":a?(null===(c=null===a||void 0===a?void 0:a.floorData)||void 0===c?void 0:c.floorValue.toFixed(2))||"none":"0.00"}};wb=q([v("Floors"),y(),t("design:paramtypes",[N,ia,Qa,cb,Ua])],wb);class Rp{get videoEnabled(){return!0}get enabled(){return!0}}
class Sp{getSupplyChainConfig(a){return{ver:"1.0",complete:1,nodes:[{asi:"cafemedia.com",sid:a,hp:1}]}}}let Tp=new Map([["10thu68",`a_${l.AppNexus}`],["16d9pts",`a_${l.GumGum}`],["1axt6o",`a_${l.OpenX}`],["1bkk3r4",`a_${l.AmazonTAM}`],["1dfpj4",`a_${l.AmazonTAM}`],["1e4ycjk",`a_${l.Triplelift}`],["1lcnshs",`a_${l.Sharethrough}`],["1skd8g0",`a_${l.Yieldmo}`],["1y4543k",`a_${l.Pubmatic}`],["3bcv7k",`a_${l.AmazonTAM}`],["j27tog",`a_${l.Rubicon}`],["me2y9s",`a_${l.IndexExchange}`],["qtwge8",`a_${l.Verizon}`],
["upqrr4",`a_${l.MediaGrid}`],["emebk0",`a_${l.Unruly}`],["f6dibk",`a_${l.Ogury}`]]),Up={"138wa9s":.01,lhm9s0:.02,"1l06ark":.03,clz9j4:.04,"1c4jaio":.05,ud9a0w:.06,"1tvtb0g":.07,"865reo":.08,"17opse8":.09,pxfrwg:.1,"1pfzsw0":.11,h1srnk:.12,"1gkcsn4":.13,yt2s5c:.14,"1ybmt4w":.15,"1ifi80":.16,"110zj7k":.17,j9pips:.18,"1is9jpc":.19,ae2igw:.2,"19wmjgg":.21,s5ciyo:.22,"1rnwjy8":.23,"5y90cg":.24,"15gt1c0":.25,npj0u8:.26,"1n831ts":.27,etw0lc:.28,"1ecg1kw":.29,wl6134:.3,"1w3q22o":.31,"2mdvr4":.32,"124xwqo":.33,
kdnw8w:.34,"1jw7x8g":.35,bi0w00:.36,"1b0kwzk":.37,t9awhs:.38,"1sruxhc":.39,"727dvk":.4,"16krev4":.41,othedc:.42,"1oc1fcw":.43,fxue4g:.44,"1fgef40":.45,xp4em8:.46,"1x7ofls":.47,eh4ow:.48,zx15og:.49,i5r56o:.5,"1hob668":.51,"9a44xs":.52,"18so5xc":.53,r1e5fk:.54,"1qjy6f4":.55,"4uamtc":.56,"14cunsw":.57,mlknb4:.58,"1m44oao":.59,dpxn28:.6,"1d8ho1s":.61,vh7nk0:.62,"1uzrojk":.63,"4abg1s":.64,"13svh1c":.65,m1lgjk:.66,"1lk5hj4":.67,d5ygao:.68,"1coiha8":.69,ux8gsg:.7,"1ufshs0":.71,"8q4y68":.72,"188oz5s":.73,
qheyo0:.74,"1pzyznk":.75,hlryf4:.76,"1h4bzeo":.77,zd1yww:.78,"1yvlzwg":.79,"22eozk":.8,"11kypz4":.81,jtophc:.82,"1jc8qgw":.83,ay1p8g:.84,"1aglq80":.85,spbpq8:.86,"1s7vqps":.87,"6i8740":.88,"160s83k":.89,o9i7ls:.9,"1ns28lc":.91,fdv7cw:.92,"1ewf8cg":.93,x557uo:.94,"1wnp8u8":.95,"36d2io":.96,"12ox3i8":.97,kxn30g:.98,"1kg7400":.99,c202rk:1,"1bkk3r4":1.01,tta39c:1.02,"1tbu48w":1.03,"7m6kn4":1.04,"174qlmo":1.05,pdgl4w:1.06,"1ow0m4g":1.07,ghtkw0:1.08,"1g0dlvk":1.09,y93lds:1.1,"1xrnmdc":1.11,ygbgg:1.12,"10h0cg0":1.13,
ipqby8:1.14,"1i8acxs":1.15,"9u3bpc":1.16,"19cncow":1.17,rldc74:1.18,"1r3xd6o":1.19,"5e9tkw":1.2,"14wtukg":1.21,n5ju2o:1.22,"1mo3v28":1.23,e9wtts:1.24,"1dsgutc":1.25,w16ubk:1.26,"1vjqvb4":1.27,"3gcnwg":1.28,"12ywow0":1.29,l7moe8:1.3,"1kq6pds":1.31,cbzo5c:1.32,"1bujp4w":1.33,u39on4:1.34,"1tltpmo":1.35,"7w660w":1.36,"17eq70g":1.37,png6io:1.38,"1p607i8":1.39,grt69s:1.4,"1gad79c":1.41,yj36rk:1.42,"1y1n7r4":1.43,"18fwu8":1.44,"10qzxts":1.45,izpxc0:1.46,"1ii9ybk":1.47,a42x34:1.48,"19mmy2o":1.49,rvcxkw:1.5,
"1rdwykg":1.51,"5o9eyo":1.52,"156tfy8":1.53,nfjfgg:1.54,"1my3gg0":1.55,ejwf7k:1.56,"1e2gg74":1.57,wb6fpc:1.58,"1vtqgow":1.59,"2ceadc":1.6,"11uybcw":1.61,k3oav4:1.62,"1jm8buo":1.63,b81am8:1.64,"1aqlbls":1.65,szbb40:1.66,"1shvc3k":1.67,"6s7shs":1.68,"16arthc":1.69,ojhszk:1.7,"1o21tz4":1.71,fnusqo:1.72,"1f6etq8":1.73,xf4t8g:1.74,"1wxou80":1.75,"4hjb4":1.76,zn1kao:1.77,hvrjsw:1.78,"1hebksg":1.79,"904jk0":1.8,"18iokjk":1.81,qrek1s:1.82,"1q9yl1c":1.83,"4kb1fk":1.84,"142v2f4":1.85,mbl1xc:1.86,"1lu52ww":1.87,
dfy1og:1.88,"1cyi2o0":1.89,v78268:1.9,"1ups35s":1.91,"40buo0":1.92,"13ivvnk":1.93,lrlv5s:1.94,"1la5w5c":1.95,cvyuww:1.96,"1ceivwg":1.97,un8veo:1.98,"1u5swe8":1.99,"8g5csg":2,"17ypds0":2.01,q7fda8:2.02,"1ppze9s":2.03,hbsd1c:2.04,"1guce0w":2.05,z32dj4:2.06,"1ylmeio":2.07,"1sf3ls":2.08,"11az4lc":2.09,jjp43k:2.1,"1j29534":2.11,ao23uo:2.12,"1a6m4u8":2.13,sfc4cg:2.14,"1rxw5c0":2.15,"688lq8":2.16,"15qsmps":2.17,nzim80:2.18,"1ni2n7k":2.19,f3vlz4:2.2,"1emfmyo":2.21,wv5mgw:2.22,"1wdpngg":2.23,"2wdh4w":2.24,
"12exi4g":2.25,knnhmo:2.26,"1k67im8":2.27,bs0hds:2.28,"1bakidc":2.29,tjahvk:2.3,"1t1uiv4":2.31,"7c6z9c":2.32,"16ur08w":2.33,p3gzr4:2.34,"1om10qo":2.35,g7tzi8:2.36,"1fqe0hs":2.37,xz4000:2.38,"1xho0zk":2.39,ogq2o:2.4,"1070r28":2.41,ifqqkg:2.42,"1hyark0":2.43,"9k3qbk":2.44,"192nrb4":2.45,rbdqtc:2.46,"1qtxrsw":2.47,"54a874":2.48,"14mu96o":2.49,mvk8ow:2.5,"1me49og":2.51,dzx8g0:2.52,"1dih9fk":2.53,vr78xs:2.54,"1v9r9xc":2.55,"3vc1z4":2.56,"13dw2yo":2.57,lmm2gw:2.58,"1l563gg":2.59,cqz280:2.6,"1c9j37k":2.61,
ui92ps:2.62,"1u0t3pc":2.63,"8b5k3k":2.64,"17tpl34":2.65,q2fklc:2.66,"1pkzlkw":2.67,h6skcg:2.68,"1gpclc0":2.69,yy2ku8:2.7,"1ygmlts":2.71,"1nfaww":2.72,"115zbwg":2.73,jepbeo:2.74,"1ix9ce8":2.75,aj2b5s:2.76,"1a1mc5c":2.77,sacbnk:2.78,"1rswcn4":2.79,"638t1c":2.8,"15lsu0w":2.81,nuitj4:2.82,"1nd2uio":2.83,eyvta8:2.84,"1ehfu9s":2.85,wq5ts0:2.86,"1w8purk":2.87,"2rdog0":2.88,"129xpfk":2.89,kinoxs:2.9,"1k17pxc":2.91,bn0oow:2.92,"1b5kpog":2.93,teap6o:2.94,"1swuq68":2.95,"7776kg":2.96,"16pr7k0":2.97,oyh728:2.98,
"1oh181s":2.99,g2u6tc:3,"1020ydc":3.05,r6dy4g:3.1,"1m94gzk":3.15,"4fb8qo":3.2,"1cti9z4":3.25,qmercw:3.3,"1z0lslc":3.35,b31hxc:3.4,"165s0sg":3.45,xa50jk:3.5,"1kl6wow":3.55,"7r6dc0":3.6,"1g5dekg":3.65,iuq4n4:3.7,"1r8x5vk":3.75,eewmio:3.8,"133whkw":3.85,u89hc0:3.9,"1pb0074":3.95,"1dfpj4":4,"19rmqrk":4.05,nkj85c:4.1,"1vyq9ds":4.15,bd13b4:4.2,"16frm68":4.25,xk4lxc:4.3,"1hjbdhc":4.35,"4pau4g":4.4,"1d3hvcw":4.45,lwlnuo:4.5,"1uasp34":4.55,hgs5q8:4.6,"11fyxa8":4.65,skbx1c:4.7,"1nn2fwg":4.75,"31d9ts":4.8,"1bfkb28":4.85,
p8gsg0:4.9,"1xmntog":4.95,"9p3j0g":5,"14ru1vk":5.05,vw71mo:5.1,"1kxoef4":5.15,"83nv28":5.2,"1ghuwao":5.25,j77mdc:5.3,"1rlenls":5.35,ere48w:5.4,"122g0e8":5.45,t6t05c:5.5,"1o9jj0g":5.55,bz8cg:5.6,"18q69kw":5.65,mj2qyo:5.7,"1ux9s74":5.75,d3gjy8:5.8,"18672tc":5.85,zak2kg:5.9,"1j9qu4g":5.95,"6fqark":6,"1etxc00":6.05,kv56o0:6.1,"1t9c7wg":6.15,gfbojk:6.2,"10eig3k":6.25,rivfuo:6.3,"1mllyps":6.35,"3durk0":6.4,"1bs1ssg":6.45,pkya68:6.5,"1xz5beo":6.55,a1l0qo:6.6,"154bjls":6.65,w8ojcw:6.7,"1jjqfi8":6.75,"6ppw5c":6.8,
"1f3wxds":6.85,ht9ngg:6.9,"1q7goow":6.95,ddg5c0:7,"13gdzb4":7.05,ukqz28:7.1,"1pnhhxc":7.15,"1px79c":7.2,"1a448hs":7.25,nx0pvk:7.3,"1wb7r40":7.35,bpil1c:7.4,"16s93wg":7.45,xwm3nk:7.5,"1hvsv7k":7.55,"51sbuo":7.6,"1dfzd34":7.65,lk464g:7.7,"1tyb7cw":7.75,h4ao00:7.8,"113hfk0":7.85,s7ufb4:7.9,"1naky68":7.95,"2ovs3k":8,ovzaps:8.1,"9cm1a8":8.2,"14fck5c":8.25,vjpjwg:8.3,"8smuio":8.4,jw6lts:8.5,fgd3pc:8.6,tvrzls:8.7,"1oyiigw":8.75,"10y7sw":8.8,n81qf4:8.9,cehkhs:9,yll340:9.1,"5qrbb4":9.2,"1e4ycjk":9.25,k6677k:9.3,
fqcp34:9.4,qtwge8:9.5,"42tr0g":9.6,q9x9mo:9.7,"1yo4av4":9.75,aqk074:9.8,wxnitc:9.9,"7eovls":10,ii8mww:10.1,e2f4sg:10.2,"137nc3k":10.25,uc0buo:10.3,"1h6k1s":10.4,noa2o0:10.5,bgrxts:10.6,xnvgg0:10.7,"1hn2800":10.75,"4t1on4":10.8,m0cidc:10.9,hkj08w:11,so2rk0:11.1,"3544cg":11.2,"1bjb5kw":11.25,pc7myo:11.3,"9sudj4":11.4,vzxw5c:11.5,"7ux7uo":11.6,iygz5s:11.7,"1rco0e8":11.75,einh1c:11.8,sy2cxs:11.9,"38l4w":12,mac3r4:12.1,cupwqo:12.2,"17xgfls":12.25,z1tfcw:12.3,"66znk0":12.4,kmejgg:12.5,g6l1c0:12.6,"1mcvbi8":12.7,
ra4sn4:12.75,"3u33sw":12.8,q16mf4:12.9,ahtczk:13,wowvls:13.1,"75y8e8":13.2,"1fk59mo":13.25,i9hzpc:13.3,dtohkw:13.4,v0zbb4:13.5,"265ji8":13.6,od924g:13.7,"1wrg3cw":13.75,c5qxa8:13.8,ycufwg:13.9,"5i0o3k":14,lbdiww:14.1,gvk0sg:14.2,"10uqscg":14.25,rz3s3k:14.3,"2g54w0":14.4,on8ni8:14.5,"93ve2o":14.6,vaywow:14.7,"1ldwqo0":14.75,"8jw7b4":14.8,jnfym8:14.9,f7mghs:15,tn1ce8:15.1,s7klc:15.2,"196elts":15.25,mzb37k:15.3,ci8f0g:15.4,ypbxmo:15.5,"5ui5ts":15.6,k9x1q8:15.7,"1so42yo":15.75,fu3jls:15.8,qxnaww:15.9,
"46klj4":16,qdo45c:16.1,auaups:16.2,"15x1dkw":16.25,x1edc0:16.3,"7ifq4g":16.4,ilzhfk:16.5,e65zb4:16.6,tziu4g:16.7,"1p29czk":16.75,"14p2bk":16.8,nbskxs:16.9,b4ag3k:17,xbdyps:17.1,"4gk6ww":17.2,"1cur85c":17.25,lnv0n4:17.3,h81iio:17.4,sbl9ts:17.5,"2smmm8":17.6,ozq58g:17.7,"1xdx6gw":17.75,"9gcvsw":17.8,vngef4:17.9,"87epkw":18,jaygw0:18.1,ev4yrk:18.2,"1266uww":18.25,tajuo0:18.3,fq2v4:18.4,mmtlhc:18.5,d77egw:18.6,zeax34:18.7,"1jdhon4":18.75,"6jh5a8":18.8,kyw16o:18.9,gj2j28:19,rmmadc:19.1,"3hlm2o":19.2,
"1bvsnb4":19.25,pop4ow:19.3,a5bv9c:19.4,wcfdvk:19.5,"6tgqo0":19.6,hx0hz4:19.7,"1qb7j7k":19.75,dh6zuo:19.8,uohtkw:19.9,"1to1s0":20,lgzsow:20.5,"99hnuo":21,tsnm68:21.5,"5nmxvk":22,q6sw74:22.5,dzarcw:23,xthq80:23.5,"3aqe4g":24,j438xs:24.5,d0c6io:25,rfr2f4:25.5,"6z30g0":26,o6du68:26.5,goosu8:27,v43oqo:27.5,lccn4:28,kfjbi8:28.5,azx4hs:29,u553wg:29.5,"4m6gow":30,p5cf0g:30.5,es0lc0:31,zb6jnk:31.5,"3eh8n4":32,htw4jk:32.5,bq524g:33,s8gwe8:33.5,"8t9bls":34,n8o7i8:34.5,fqz668:35,wy9zwg:35.5,"1e26m8":36,lx84xs:36.5,
"9pq03k":37,suxzi8:37.5,"63va4g":38,py28zk:38.5,dqk45c:39,y9q2gw:39.5,"2d0rgg":40,jkbl6o:40.5,cmai2o:41,r1pdz4:41.5,"7mht6o":42,nfuo00:42.5,hc3lkw:43,vrihhc:43.5,js5xc:44,l2y48w:44.5,a9dybk:45,usjwn4:45.5,"59l9fk":46,oraqkg:46.5,fbojk0:47,ygwiyo:47.5,"3y56v4":48,idk2rk:48.5,bku0w0:49,ss4um8:49.5,"7yzaww":50,mee6tc:50.5,gan4e8:51,wk8bgg:51.5,"21gzcw":52,l6oyrk:52.5,"8z6txc":53,tics8w:53.5,"62b3eo":54,qlh1q8:54.5,edyww0:55,xj6wao:55.5,"30fk74":56,j69wqo:56.5,d2iubk:57,rhxq80:57.5,"6os6io":58,nw308w:58.5,
h3cydc:59,viru9s:59.5,"100i68":60,k58hkw:60.5,apmakg:61,ucy1hc:61.5,"4tze9s":62,pd5clc:62.5,ejl6o0:63,z2r4zk:63.5,"3v0tfk":64,iafpc0:64.5,c6omww:65,s01hq8:65.5,"8ktwxs":66,n08su8:66.5,fv198g:67,x2c2yo:67.5,"15mry8":68,losq9s:68.5,"9halfk":69,tbhkao:69.5,"6keuww":70,ppmubk:70.5,di4phc:71,y1answ:71.5,"2ktp1c":72,js4irk:72.5,cafhfk:73,qpudc0:73.5,"7amsjk":74,nsymtc:74.5,hp7ke8:75,w4mgao:75.5,"7x5a8":76,kr33ls:76.5,aa0feo:77,ut6dq8:77.5,"5a7qio":78,offpxc:78.5,eztiww:79,yu0hs0:79.5,"4b95og":80,iqo1kw:80.5,
b8z08w:81,sg9tz4:81.5,"86bdog":82,mlq9kw:82.5,ghz75s:83,wbc1z4:83.5,"1skpvk":84,lmroqo:84.5,"9f9jwg":85,tyfi80:85.5,"5tetxc":86,qcks8w:86.5,e52neo:87,xms4jk:87.5,"340sg0":88,ixdn9c:88.5,ctmku8:89,r91gqo:89.5,"74uwhs":90,oc5q80:90.5,gugow0:91,v9vksg:91.5,r48ow:92,kckkcg:92.5,awydc0:93,u26cqo:93.5,"4j7pj4":94,p2dnuo:94.5,exshds:95,zgyfpc:95.5,"3k94ow":96,hzo0lc:96.5,bvwy68:97,s1raps:97.5,"8mjpxc":98,n1ylts:98.5,fk9khs:99,wrke80:99.5,"1ju2o0":100},Vp=a=>{const b=a.indexOf("_");return-1===b?a:a.substring(b+
1)},mf=class extends W{init(){this._key="AmazonHoldDisplay";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],mf.prototype,"run",null);mf=q([v("AmazonLibraryExperiment"),y()],mf);class ij{isAmazonLoaded(){return!!window.apstag}init(a){this.isAmazonLoaded()&&window.apstag.init(a)}fetchBids(a,b){this.isAmazonLoaded()&&window.apstag.fetchBids(a,b)}setDisplayBids(){this.isAmazonLoaded()&&window.apstag.setDisplayBids()}targetingKeys(){return this.isAmazonLoaded()?
window.apstag.targetingKeys():[]}rpa(a){this.isAmazonLoaded()&&window.apstag.rpa(a,this.tokenCallback,!1)}upa(a){this.isAmazonLoaded()&&window.apstag.upa(a,this.tokenCallback,!1)}tokenCallback(a){a&&(document.cookie=`AMZN-Token=${a.AIPToken}; expires=${a.cookieExpiry}; path=/;`)}dpa(a){this.isAmazonLoaded()&&window.apstag.dpa(a)}}let jj=class extends X{init(){this._key="AdInViewExperiment_2"}};jj=q([v("AdInViewExperiment"),y()],jj);let Nc=class extends fb{constructor(a){super();this._result=!1;this.abgroup=
"scre";this.key="StickyContainerRecipe";this._choices=[{choice:!0},{choice:!1}];this.weight=.99;this.shouldUseCoreOverride=!1;var b=window;this._result=(b=(b=b&&b.adthriveCLS)&&b.experiments)&&this.abgroup in b?b[this.abgroup]:this.run();a.set(this.abgroup,this._result?"on":"off")}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};Nc=q([v("StickyContainerRecipeExperiment"),y(),t("design:paramtypes",[Ia])],Nc);let kj=()=>new Promise(a=>setTimeout(a,0)),ja=class{constructor(a,
b,c,d,e,f,g,h){this._config=a;this._googleAdManager=b;this._slots=c;this._eventBus=d;this._marmaladeEventBus=e;this._adInViewExperiment=f;this._stickyContainerRecipeExperiment=g;this._multistagePrebidAuctionV=h;this.added=new L;this.cleared=new L;this.displayed=new L;this.displaying=new L;this.refreshed=new L;this.refreshing=new L;this.refreshingBids=new L;this.refreshedBids=new L;this.requestingBids=new L;this.requestedBids=new L;this.stickyOutstreamRefreshInterval=4E4;this.slotAdvertiserID=new Map;
this._refreshTargetingKeys="aop apd aopp appd pbop pbpd reqtype".split(" ");this._isDisplayMultiStage=this._stickyOutstreamShortVideo=!1;this._eventBus.displaySlot.on(k=>this.display(k));this.setupSlotRenderedListener();this.displayRefreshInterval=3E4-5E3*this._config.prebid.refreshAuctionCount}async add(a){await this._googleAdManager.waitForQueue();let b=sessionStorage.getItem("adthrive_footer_closed"),c=this._googleAdManager.defineSlots(this.castArray(a).filter(e=>"Footer"!==e.location||"Footer"===
e.location&&!b)),d=this._config.marmalade;if(!d.adViewability.length)this._marmaladeEventBus.resetMarmaladeData.once(()=>{c.forEach(e=>e.setViewability(d))});c.forEach(e=>{e.setViewability(d);e.setHighlyViewable(d);e.setBidPoolId(this._config.prebid.bidPoolSlots);e.setPassiveBidPoolId();"Recipe"===e.location&&e.sticky&&this._stickyContainerRecipeExperiment.result||this._config.clsOptimizedAds.setStyle(e.element,e.location)});this._eventBus.addSlots.emit(c);this._slots.add(c);await kj();await this.added.legacyEmit(c);
return c}async clear(a){a=this.castArray(a);a.forEach(b=>{b.displayed=!1;this.setMinDimensions(b.element)});this._googleAdManager.clearSlots(a);await this.cleared.legacyEmit(a);return a}destroy(a){a=this.castArray(a);this.pauseRefresh(a);this._slots.remove(a);this._googleAdManager.destroySlots(a);return a}destroyAll(){var a=this._slots.get();a=this.destroy(a);this._googleAdManager.reset();return a}rebuild(a){a=this.castArray(a);let b=this._googleAdManager;for(let c of a)V.pushToQueue(()=>{let d="refresh inf_scroll decref nref hvp lazy".split(" ").reduce((e,
f)=>{const g=c.getTargeting(f);g.length&&e.push({key:f,value:g});return e},[]);b.destroySlots(this.castArray(c));b.defineSlots(this.castArray(c));c.setTargeting(d)});return a}rebuildAll(){var a=this._slots.get();a=this.rebuild(a);this._googleAdManager.reset();return a}removeElement(a){a=this.castArray(a);let b=[];for(let c of a)c.element.remove(),b.push(c.element);return b}removeAllElements(){let a=this._slots.get();return this.removeElement(a)}async refresh(a,b=!0){let c=this.castArray(a);a=this._config.timeouts.refreshBidsRequest;
var d=c.some(k=>"Video_StickyOutstream"===k.location);for(var e of c)e.refreshCount++,e.servedPrebidBidResponse=void 0,e.isRefreshing=!0;await this.refreshing.legacyEmit(c);var f=c.some(k=>"Video_StickyOutstream"===k.location);e=Date.now();d=d?this._config.prebid.refreshStickyOutstreamAuctionCount:this._config.prebid.refreshAuctionCount;let g=1!==d&&!f;f=f&&this._shouldExecuteStickyOutstreamAuction(c);f=this._getInjectedAuctions(g,d,f);for(var [h]of f.entries())await this.refreshBids(c,h+1,!1),await this.refreshing.legacyEmit(c);
h=Date.now();a=Math.max(a*d-(h-e),0);await Promise.all([b?kp(a):!0,this.refreshBids(c,d,!0)]).then(()=>{this._googleAdManager.refreshSlots(c)});await this.refreshed.legacyEmit(c);for(let k of c)k.isRefreshing=!1;return c}async display(a){let b=this.castArray(a);await this.displaying.legacyEmit(b);await this.requestBids(b).then(()=>this._googleAdManager.displaySlots(b));b.forEach(c=>{c.displayed=!0});await this.displayed.legacyEmit(b);return b}inView(a){a=this.castArray(a);a.forEach(b=>this.setRefreshTimeout(b));
return a}outOfView(a){a=this.castArray(a);a.filter(b=>!b.alwaysInView).filter(b=>"IntersectionObserver"in window?b.outOfViewGPT&&b.outOfViewIO:b.outOfViewGPT).forEach(b=>{let c=b.element.querySelector("div > iframe");gd(b.element)&&c&&gd(c)&&this.clearRefreshTimeout(b)});return a}pauseRefresh(a){a=this.castArray(a);a.filter(b=>b.refreshTimeout).forEach(b=>{b.refreshPaused=!0;this.clearRefreshTimeout(b)});return a}resumeRefresh(a){a=this.castArray(a);a.filter(b=>b.refreshPaused).forEach(b=>{b.refreshPaused=
!1;this.setRefreshTimeout(b)});return a}updateRefreshTimeout(a,b,c){this._stickyOutstreamShortVideo=c||!1;a=this.castArray(a);a.forEach(d=>{d.refreshInterval=b;var e=d.element.querySelector("div > iframe");e=gd(d.element)&&e&&gd(e)&&!document.hidden;d.refreshTimeout&&("Video_StickyOutstream"!==d.location||e)?(this.clearRefreshTimeout(d),this.setRefreshTimeout(d)):d.refreshTimeout&&!e&&(this.setRefreshTimeout(d),this.clearRefreshTimeout(d))});return a}clearRefreshTimeout(a,b=!1){this.castArray(a).filter(c=>
c.refreshTimeout).forEach(c=>{window.clearTimeout(c.refreshTimeout);c.refreshTimeout=void 0;b?(c.viewableDuration=0,c.slotFullyRenderedDuration=0):(c.viewableSince&&(c.viewableDuration+=Date.now()-c.viewableSince.getTime()),c.slotFullyRenderedSince&&(c.slotFullyRenderedDuration=Date.now()-c.slotFullyRenderedSince.getTime()))})}getSlot(a){return this._slots.get(a)}getAllSlots(){return this._slots.get()}get amazonBidResponseReceived(){return this._eventBus.amazonBidResponseReceived}_getInjectedAuctions(a,
b,c){let d=[];if(a||c)d=Array.from({length:b-1});return d}setRefreshTimeout(a){this.castArray(a).filter(b=>!b.refreshTimeout&&(!b.isRefreshing||"Video_StickyOutstream"===b.location)).forEach(b=>{let c=this.calculateRemainingRefreshDuration(b,"Video_StickyOutstream"===b.location?this.stickyOutstreamRefreshInterval:this.displayRefreshInterval);b.viewableSince=new Date;0!==b.refreshInterval&&(b.refreshTimeout=window.setTimeout(()=>{b.viewableDuration=0;b.slotFullyRenderedDuration=0;b.refreshInterval=
void 0;b.refreshTimeout=void 0;this.refresh(b).catch(d=>{})},Math.max(c,0)))})}getAmazonBidderCode(a){var b,c;return 4526447244===this.slotAdvertiserID.get(a.element.id)?(null===(c=null===(b=a.getTargeting("amz_bidder"))||void 0===b?void 0:b[0])||void 0===c?void 0:c.substring(2))||"":""}getBidderAdInViewDurationOverride(a){var b;let c=new Set("kargo krgo_ss tripl_ss triplelift ogury nativo".split(" ")),d=(null===(b=a.servedPrebidBidResponse)||void 0===b?void 0:b.bidderCode)||"";a=this.getAmazonBidderCode(a);
return c.has(d)||c.has(a)?1E4:void 0}calculateRemainingRefreshDuration(a,b=25E3){var c=this._adInViewExperiment.result?this.getBidderAdInViewDurationOverride(a):void 0;c=Q(c||this._adInViewExperiment.result,b);c=Q(a.refreshInterval,c);b=Math.max(b-a.slotFullyRenderedDuration,c-a.viewableDuration);return"Video_StickyOutstream"===a.location||"Video_StickyOutstream_1"===a.location?Q(a.refreshInterval,"Video_StickyOutstream"===a.location?this.stickyOutstreamRefreshInterval:this.displayRefreshInterval)-
a.viewableDuration:b}async requestBids(a){a=this.castArray(a).filter(b=>b.enabledForAuction);if(0===a.length)return a;await this.requestingBids.legacyEmit(a);await this._eventBus.preRequestBids.legacyEmit(a);await this._eventBus.requestingBids.legacyEmit(a);await this.requestedBids.legacyEmit(a);return a}async refreshBids(a,b=0,c=!0){a=this.castArray(a).filter(d=>d.enabledForAuction);0<a.length&&(this._clearTargetingKeysOnRefresh(a),await this.refreshingBids.legacyEmit(a),await this._eventBus.preRequestBids.legacyEmit(a),
await this._eventBus.refreshingBids.legacyEmit({managedSlots:a,auctionCount:b,setTargeting:c}),await this.refreshedBids.legacyEmit(a));return a}castArray(a){return"string"===typeof a?(a=this._slots.get(a),void 0!==a?[a]:[]):Array.isArray(a)?a:[a]}setMinDimensions(a){let b=getComputedStyle(a,null);a.style.minHeight=b.getPropertyValue("height");a.style.minWidth=b.getPropertyValue("width")}setupSlotRenderedListener(){this._googleAdManager.slotRenderEnded.on(a=>{let b=this._slots.get(a.slot.id);this.slotAdvertiserID.set(a.slot.id,
a.event.advertiserId);b&&(b.slotFullyRenderedSince=new Date)})}_clearTargetingKeysOnRefresh(a){a.forEach(b=>{b.clearSlotTargetingFlag(this._refreshTargetingKeys)})}_shouldExecuteStickyOutstreamAuction(a){let b=this._multistagePrebidAuctionV.result;return("10s1"===b||"10s2"===b)&&"Video_StickyOutstream"===a[0].location&&!this._stickyOutstreamShortVideo&&!Mb()}};ja=q([v("SlotManager"),y(),t("design:paramtypes",[N,V,Qa,cb,ob,jj,Nc,Gc])],ja);let lc=class{constructor(a){this._videoEventBus=a;this.refreshingVideoBids=
new L;this.requestingVideoBids=new L}addVideoSlots(a){this._videoEventBus.videoPlayerAdded.emit(a)}async requestVideoBids(a,b){await this.requestingVideoBids.legacyEmit(a).catch();await this._determineIsRefreshing(a).catch();await this._videoEventBus.preRequestVideoBids.legacyEmit({videos:a,timeout:b});await this._videoEventBus.requestingVideoBids.legacyEmit({videos:a,timeout:b})}get amazonVideoBidResponseReceived(){return this._videoEventBus.amazonVideoBidResponseReceived}async _determineIsRefreshing(a){a=
a.filter(b=>0<b.prerollNum);a.length&&await this.refreshingVideoBids.legacyEmit(a)}};lc=q([v("VideoRequestManager"),y(),t("design:paramtypes",[Ua])],lc);let Oc=class{constructor(a){this._spaEventBus=a;this.segmentName="www.iris.tv";this.segtax=501;this._irisEndpoint="https://context.iris.tv/video_info";this._token="5d8f38ad6d7de4253cfa501b84c30b1014868d9884be5d68dc64bd50a6edb54c";this._clientToken="EXJQESR8SMWMZCJ";this._spaEventBus.routeChanged.on(()=>{this._resetIrisData()})}async setContextualData(a){return this.fetchIrisResponse(a).then(b=>
{if(b&&"boolean"!==typeof b){let c=(b=b.video_info)&&b.context;c&&c.length&&(this._contextualData=c,this._irisId=b.iris_id)}return!0}).catch(()=>!1)}get irisContextualData(){return this._contextualData}get irisId(){return this._irisId}fetchIrisResponse(a){return rh(`${this._irisEndpoint}?access_token=${this._token}&client_token=${this._clientToken}&platform_id=${a}`)}_resetIrisData(){this._irisId=this._contextualData=void 0}};Oc=q([y(),t("design:paramtypes",[Pa])],Oc);let nf=class extends T{constructor(a,
b){super();this._config=a;this._eventBus=b;this.setMcmpWithRFCodes=()=>new Promise(c=>{this._eventBus.recencyFrequencyDataSet.on(()=>{this.getAllMcmps();c(!0)},{handleEventsAlreadyEmitted:!0})})}getAllMcmps(){return[...this._config.marmalade.mcmp,...this._config.marmalade.rfMcmpCodes.map(a=>a[0]),...this._config.marmalade.rfIabCodes.map(a=>a[0])].filter(Lb)}};nf=q([v("RecencyAndFrequencyCodesComponent"),H(),t("design:paramtypes",[N,ob])],nf);let lj=class extends X{init(){this._key="ttddealflr"}};
lj=q([v("TTDDealFloorExperiment"),y()],lj);let bu=["IAB25","IAB26"],Wp=new Map([["alc",["IAB8-5","IAB8-18"]],["ast",["IAB15-1"]],["cosm",["IAB18-2"]],["dat",["IAB14-1"]],["gamv",["IAB9-30"]],["pol",["IAB11-4"]],["rel",["IAB23"]],["ssr",["IAB7-39"]],["srh",["IAB7-30","IAB6-7","IAB7-45"]],["wtl",["IAB7-44"]]]),of=class extends T{get staticFirstPartyData(){return this._staticFirstPartyData}get staticIXFirstPartyData(){return this._staticIXFirstPartyData}constructor(a,b,c,d,e,f,g,h){super();this._slotManager=
a;this._config=b;this._prebidMethods=c;this._videoRequestManager=d;this._irisTv=e;this._rfcodes=f;this._spaEventBus=g;this._ttdDealFloorExperiment=h;this._staticFirstPartyData={mcmp:this._rfcodes.getAllMcmps(),site_id:[this._config.site.id],verticals:this._config.site.verticals,pmp_elig:[this._config.adOptions.pmp],sens:this._config.site.filteredSensitiveCategories};this._staticIXFirstPartyData={site_code:this._config.marmalade.filteredSiteCodes,sens:this._config.site.filteredSensitiveCategories,
topic:this._config.site.verticals,pd:`${this._config.adOptions.pmp?"":"no"}${this._config.context.device}`,pmp_elig:this._config.adOptions.pmp?"TRUE":"FALSE",source:""};a=xe(this._config.context.savedReferrer);this._staticIXFirstPartyData.source=a?wp(a):"direct"}init(){this._onAddedEvent();this._onRequestingEvent();this._onRefreshingEvent();this._onVideoRequestingEvent();this._onVideoRefreshingEvent();this._setGlobalFirstPartyData();this._spaEventBus.routeChanged.on(()=>{this._onAddedEvent()})}_resetMCMPData(){this._staticFirstPartyData.mcmp=
this._rfcodes.getAllMcmps()}_getTheTradeDeskFirstPartyData(){var a=this._ttdDealFloorExperiment.result||"1";a=+("off"===a?"1":a).replace("_",".");return{deals:[{id:"opath-192-1-xpscexs57t",at:1,bidfloor:10*a,bidfloorcur:"USD",isVideo:!0},{id:"opath-192-1-47pf1rhzaq",at:1,bidfloor:2.5*a,bidfloorcur:"USD",isVideo:!1}],private_auction:0}}_onAddedEvent(){this._slotManager.added.once(()=>{var a=this._getTheTradeDeskFirstPartyData();this._setBidderSpecificFirstPartyData({bidders:[l.TTD],location:"pmp",
fpdData:a,isExtData:!1});a=this._config.context.bucket;this._setBidderSpecificFirstPartyData({bidders:[l.IndexExchange],fpdData:{refresh:"0",vp:"0"}});this._setBidderSpecificFirstPartyData({bidders:[l.Rubicon,l.RubiconServer],fpdData:{site_code:this._config.marmalade.filteredSiteCodes,refresh:["false"],vp:"0",bucket:a}});this._setBlockedCategoriesForBidders({bidders:[l.Pubmatic,l.PubmaticServer],bcatValues:this._getPubmaticBlockedCategories()})})}_getPubmaticBlockedCategories(){return[...[...Wp.keys()].filter(a=>
!this._config.site.filteredSensitiveCategories.includes(a)).reduce((a,b)=>a.concat(Wp.get(b)||[]),[]),...bu]}_onRequestingEvent(){this._slotManager.requestingBids.on(a=>{let b=this._config.context.bucket;a.forEach(c=>{this.setIXHVPParam(c,this._prebidMethods);c.lazy&&(this._setBidderSpecificFirstPartyData({bidders:[l.Rubicon,l.RubiconServer],fpdData:{site_code:this._config.marmalade.filteredSiteCodes,refresh:["false"],vp:"0",bucket:b}}),this._setBidderSpecificFirstPartyData({bidders:[l.IndexExchange],
fpdData:{refresh:"0",vp:"0"}}))})})}_onRefreshingEvent(){this._slotManager.refreshingBids.on(a=>{a.forEach(b=>{this.setIXHVPParam(b,this._prebidMethods)});a=a[0]&&a[0].refreshCount;this._setBidderSpecificFirstPartyData({bidders:[l.Rubicon,l.RubiconServer],fpdData:{site_code:this._config.marmalade.filteredSiteCodes,refresh:["true"],vp:"0",bucket:this._config.context.bucket}});this._setBidderSpecificFirstPartyData({bidders:[l.IndexExchange],fpdData:{refresh:`${a}`,vp:"0"}})})}_onVideoRequestingEvent(){this._videoRequestManager.requestingVideoBids.on(a=>
{a.forEach(()=>{let b=this._irisTv,c=b.irisContextualData;c&&c.length&&this._setBidderSpecificFirstPartyData({bidders:[l.Pubmatic,l.PubmaticServer],fpdData:{content:{id:b.irisId}},isExtData:!1})})})}_onVideoRefreshingEvent(){this._videoRequestManager.refreshingVideoBids.on(a=>{let b=this._config.context.bucket;a.forEach(c=>{if(0<c.vp&&10>=c.prerollNum){let d=c.vp.toString();this._setBidderSpecificFirstPartyData({bidders:[l.Rubicon,l.RubiconServer],fpdData:{site_code:this._config.marmalade.filteredSiteCodes,
refresh:["true"],vp:d,bucket:b}});this._prebidMethods.addToQueue(()=>{this.setIXVPParam(c.vp)});this._setBidderSpecificFirstPartyData({bidders:[l.IndexExchange],fpdData:{refresh:`${c.prerollNum}`,vp:d}})}})})}setIXHVPParam(a,b){V.pushToQueue(()=>{b.addToQueue(()=>{var c=b.getConfig(l.IndexExchange);if(c&&c.firstPartyData){c=c.firstPartyData.HVP||{};var d=qh(a);d=d?d:0;d=xp.includes(d)?d:0;c[a.id]=d;0<a.refreshCount?fd({HVP:c,Refresh:"True"},b):fd({HVP:c},b,!0)}})})}setIXVPParam(a){let b=this._prebidMethods.getConfig(l.IndexExchange);
b&&b.firstPartyData&&0<a&&fd({vp:a.toString()},this._prebidMethods)}_setBidderSpecificFirstPartyData({bidders:a,fpdData:b,location:c="site",isExtData:d=!0}){if("site"===c&&a.includes(l.IndexExchange)&&d){b=this._setupIXFirstPartyData(b);let e=this._updateMcmpWithScrollTargeting(b.mcmp);e&&(b.mcmp=e)}b=this._generateFPD(b,d);this._setPrebidBidderSpecificFirstPartyData(a,b,c)}_generateFPD(a,b){return b?{ext:{data:a}}:a}_setupIXFirstPartyData(a){return{...a,...this.staticIXFirstPartyData}}_setGlobalFirstPartyData(){this._config.marmalade.rfDataProcessed.emitted||
this._rfcodes.setMcmpWithRFCodes().then(()=>{this._resetMCMPData();this._setPrebidGlobalFirstPartyData()}).catch(()=>{});this._setPrebidGlobalFirstPartyData()}_setBlockedCategoriesForBidders({bidders:a,bcatValues:b}){this._setPrebidBidderSpecificFirstPartyData(a,b,"bcat")}_setPrebidGlobalFirstPartyData(){this._prebidMethods.addToQueue(()=>{let a=this._prebidMethods.getConfig("ortb2");this._prebidMethods.setConfig({ortb2:{...a,site:{...a.site,ext:{data:this.staticFirstPartyData}}}})})}_setPrebidBidderSpecificFirstPartyData(a,
b,c){this._prebidMethods.setBidderConfig({bidders:a,config:{ortb2:{[c]:b}}})}_updateMcmpWithScrollTargeting(a){let b=this._config.trackScroll.getTargetingValue();return b?a?[...a,b]:[b]:a}};of=q([v("FirstPartyDataComponent"),H(),t("design:paramtypes",[ja,N,ia,lc,Oc,nf,Pa,lj])],of);var cu=Array.prototype.splice;zb.prototype.clear=function(){this.__data__=[];this.size=0};zb.prototype["delete"]=function(a){var b=this.__data__;a=Xd(b,a);if(0>a)return!1;a==b.length-1?b.pop():cu.call(b,a,1);--this.size;
return!0};zb.prototype.get=function(a){var b=this.__data__;a=Xd(b,a);return 0>a?void 0:b[a][1]};zb.prototype.has=function(a){return-1<Xd(this.__data__,a)};zb.prototype.set=function(a,b){var c=this.__data__,d=Xd(c,a);0>d?(++this.size,c.push([a,b])):c[d][1]=b;return this};var mj=Hb["__core-js_shared__"],Jn=function(){var a=/[^.]+$/.exec(mj&&mj.keys&&mj.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Qr=Function.prototype.toString,Pr=/^\[object .+?Constructor\]$/,Or=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,
"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xp=wg(Hb,"Map"),Ed=wg(Object,"create"),du=Object.prototype.hasOwnProperty,eu=Object.prototype.hasOwnProperty;bc.prototype.clear=function(){this.__data__=Ed?Ed(null):{};this.size=0};bc.prototype["delete"]=function(a){a=this.has(a)&&delete this.__data__[a];this.size-=a?1:0;return a};bc.prototype.get=function(a){var b=this.__data__;return Ed?(a=b[a],"__lodash_hash_undefined__"===a?void 0:a):du.call(b,a)?b[a]:void 0};
bc.prototype.has=function(a){var b=this.__data__;return Ed?void 0!==b[a]:eu.call(b,a)};bc.prototype.set=function(a,b){var c=this.__data__;this.size+=this.has(a)?0:1;c[a]=Ed&&void 0===b?"__lodash_hash_undefined__":b;return this};uc.prototype.clear=function(){this.size=0;this.__data__={hash:new bc,map:new (Xp||zb),string:new bc}};uc.prototype["delete"]=function(a){a=Yd(this,a)["delete"](a);this.size-=a?1:0;return a};uc.prototype.get=function(a){return Yd(this,a).get(a)};uc.prototype.has=function(a){return Yd(this,
a).has(a)};uc.prototype.set=function(a,b){var c=Yd(this,a),d=c.size;c.set(a,b);this.size+=c.size==d?0:1;return this};vc.prototype.clear=function(){this.__data__=new zb;this.size=0};vc.prototype["delete"]=function(a){var b=this.__data__;a=b["delete"](a);this.size=b.size;return a};vc.prototype.get=function(a){return this.__data__.get(a)};vc.prototype.has=function(a){return this.__data__.has(a)};vc.prototype.set=function(a,b){var c=this.__data__;if(c instanceof zb){var d=c.__data__;if(!Xp||199>d.length)return d.push([a,
b]),this.size=++c.size,this;c=this.__data__=new uc(d)}c.set(a,b);this.size=c.size;return this};var Zd=function(){try{var a=wg(Object,"defineProperty");a({},"",{});return a}catch(b){}}(),Xr=function(a){return function(b,c,d){var e=-1,f=Object(b);d=d(b);for(var g=d.length;g--;){var h=d[a?g:++e];if(!1===c(f[h],h,f))break}return b}}(),Sn=Hb.Uint8Array,Yp=Object.create,as=function(){function a(){}return function(b){if(!mb(b))return{};if(Yp)return Yp(b);a.prototype=b;b=new a;a.prototype=void 0;return b}}(),
Tn=function(a,b){return function(c){return a(b(c))}}(Object.getPrototypeOf,Object),Rr=Object.prototype,Zp=Object.prototype,fu=Zp.hasOwnProperty,gu=Zp.propertyIsEnumerable,Cg=Ln(function(){return arguments}())?Ln:function(a){return tc(a)&&fu.call(a,"callee")&&!gu.call(a,"callee")},Bg=Array.isArray,$p="object"==typeof exports&&exports&&!exports.nodeType&&exports,aq=$p&&"object"==typeof module&&module&&!module.nodeType&&module,bq=aq&&aq.exports===$p?Hb.Buffer:void 0,Pn=(bq?bq.isBuffer:void 0)||Sr,Un=
Function.prototype.toString,Yr=Object.prototype.hasOwnProperty,Zr=Un.call(Object),sa={};sa["[object Float32Array]"]=sa["[object Float64Array]"]=sa["[object Int8Array]"]=sa["[object Int16Array]"]=sa["[object Int32Array]"]=sa["[object Uint8Array]"]=sa["[object Uint8ClampedArray]"]=sa["[object Uint16Array]"]=sa["[object Uint32Array]"]=!0;sa["[object Arguments]"]=sa["[object Array]"]=sa["[object ArrayBuffer]"]=sa["[object Boolean]"]=sa["[object DataView]"]=sa["[object Date]"]=sa["[object Error]"]=sa["[object Function]"]=
sa["[object Map]"]=sa["[object Number]"]=sa["[object Object]"]=sa["[object RegExp]"]=sa["[object Set]"]=sa["[object String]"]=sa["[object WeakMap]"]=!1;var cq="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fd=cq&&"object"==typeof module&&module&&!module.nodeType&&module,nj=Fd&&Fd.exports===cq&&Pp.process,dq=function(){try{var a=Fd&&Fd.require&&Fd.require("util").types;return a?a:nj&&nj.binding&&nj.binding("util")}catch(b){}}(),eq=dq&&dq.isTypedArray,Qn=eq?Ur(eq):Tr,$r=Object.prototype.hasOwnProperty,
Vr=/^(?:0|[1-9]\d*)$/,Wr=Object.prototype.hasOwnProperty,Wn=Math.max,hu=Date.now,fs=function(a){var b=0,c=0;return function(){var d=hu(),e=16-(d-c);c=d;if(0<e){if(800<=++b)return arguments[0]}else b=0;return a.apply(void 0,arguments)}}(Zd?function(a,b){return Zd(a,"toString",{configurable:!0,enumerable:!1,value:ds(b),writable:!0})}:Vn),iu=function(a){return es(function(b,c){var d=-1,e=c.length,f=1<e?c[e-1]:void 0,g=2<e?c[2]:void 0;f=3<a.length&&"function"==typeof f?(e--,f):void 0;var h;if(h=g){h=
c[0];var k=c[1];if(mb(g)){var m=typeof k;h=("number"==m?zg(g)&&Nn(k,g.length):"string"==m&&k in g)?Wd(g[k],h):!1}else h=!1}h&&(f=3>e?void 0:f,e=1);for(b=Object(b);++d<e;)(g=c[d])&&a(b,g,d,f);return b})}(function(a,b,c){Rn(a,b,c)});let Gd=class extends W{init(){this._key="JwBoost";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Gd.prototype,"run",null);Gd=q([v("JwBoostExperiment"),y()],Gd);let oj={Crafts:{id:"540522cb5c0eb47de4152801",
iabCode:"IAB9-2",iabCat:"Arts & Crafts"},Family_and_Parenting:{id:"540522cb5c0eb47de4152802",iabCode:"IAB9-2",iabCat:"Family & Parenting"},Personal_Finance:{id:"540522cb5c0eb47de4152803",iabCode:"IAB13",iabCat:"Personal Finance"},Food:{id:"540522cb5c0eb47de4152804",iabCode:"IAB8",iabCat:"Food & Drink"},Home_Decor_and_Design:{id:"540522cb5c0eb47de4152807",iabCode:"IAB10",iabCat:"Home & Garden"},Sports:{id:"540522cb5c0eb47de4152809",iabCode:"IAB17",iabCat:"Sports"},Entertainment:{id:"55d374253d3884315c3d0bca",
iabCode:"IAB1",iabCat:"Arts & Entertainment"},Gardening:{id:"5a4fab0ce6ec1959fd678d46",iabCode:"IAB10-4",iabCat:"Gardening"},Mens_Style_and_Grooming:{id:"5a4fab1de6ec1959fd678d47",iabCode:"IAB18",iabCat:"Style & Fashion"},Pets:{id:"5a4fab2ee6ec1959fd678d49",iabCode:"IAB16",iabCat:"Pets"},Tech:{id:"5a4fab38e6ec1959fd678d4a",iabCode:"IAB19",iabCat:"Technology & Computing"},Wedding:{id:"5a4fab42e6ec1959fd678d4b",iabCode:"IAB14-7",iabCat:"Weddings"},Professional_Finance:{id:"5aa2f3a7fdf4d60603ab3a65",
iabCode:"IAB13",iabCat:"Personal Finance"},Deals:{id:"5c05a3d19e385c167333449c",iabCode:"IAB13",iabCat:"Personal Finance"},Vegetarian:{id:"5c113968b4fc765c1cbd3a54",iabCode:"IAB8-17",iabCat:"Vegetarian"},Auto:{id:"5c11399bb4fc765c1cbd3a91",iabCode:"IAB2",iabCat:"Automotive"},Fitness:{id:"5e5571361237cb073f4c414a",iabCode:"IAB7-1",iabCat:"Exercise"},Gaming:{id:"615cb84741a24b73b7c34703",iabCode:"IAB9-30",iabCat:"Video & Computer Games"},Beauty:{id:"540522cb5c0eb47de4152800",iabCode:"IAB18-1",iabCat:"Beauty"},
Health_and_Wellness:{id:"540522cb5c0eb47de4152806",iabCode:"IAB7",iabCat:"Health & Fitness"},Clean_Eating:{id:"58ebb95fb628206640771353",iabCode:"IAB8-12",iabCat:"Health/Lowfat Cooking"},Natural_Parenting:{id:"58ebba85b628206640771355",iabCode:"IAB6",iabCat:"Family & Parenting"},Baby:{id:"58ebba8bb628206640771356",iabCode:"IAB6-2",iabCat:"Babies & Toddlers"},Pregnancy:{id:"58ebba92b628206640771357",iabCode:"IAB6-7",iabCat:"Pregnancy"},Toddler:{id:"58ebba9ab628206640771358",iabCode:"IAB6-2",iabCat:"Babies & Toddlers"},
Womens_Style:{id:"58ebbaccb628206640771359",iabCode:"IAB18",iabCat:"Style & Fashion"},Travel:{id:"58ebbafbb62820664077135a",iabCode:"IAB20",iabCat:"Travel"},"History_&_Culture":{iabCode:"IAB14",iabCat:"Society"},"Arts_&_Creativity":{iabCode:"IAB1",iabCat:"Arts & Entertainment"},Education:{iabCode:"IAB5",iabCat:"Education"},Business:{iabCode:"IAB3",iabCat:"Business"},"Hobbies_&_Interests":{iabCode:"IAB9",iabCat:"Hobbies & Interests"},Science:{iabCode:"IAB15",iabCat:"Science"},"Religion_&_Spirituality":{iabCode:"IAB23",
iabCat:"Religion & Spirituality"},Shopping:{iabCode:"IAB22",iabCat:"Shopping"},"Law,_Gov't_&_Politics":{iabCode:"IAB11",iabCat:"Law, Gov't & Politics"},Careers:{iabCode:"IAB4",iabCat:"Careers"},Real_Estate:{iabCode:"IAB21",iabCat:"Real Estate"}},Sb=class{constructor(a,b,c,d,e,f){this._config=a;this._jwBoostExperiment=b;this._prebidMethods=c;this._spaEventBus=d;this._marmaladeEventBus=e;this._browsingTopicsApiEventBus=f;this._data={};this.createOrtbDataObj();this._onConsentEvent();this._marmaladeEventBus.resetMarmaladeData.once(()=>
{this._setORTB2Data()});this._config.marmalade.rfDataProcessed.on(()=>{this._setORTB2Data()});if(!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&this._config.context.browsingTopicsSupported&&0===this._config.context.browsingTopics.length)this._browsingTopicsApiEventBus.topicsReceived.on(g=>{this._setDelayedTopicsData(this._convertTopicData(g))})}_setORTB2Data(){this._prebidMethods.addToQueue(()=>{var a=this._prebidMethods.getConfig("ortb2")||{};this.createOrtbDataObj();a=iu(a,this._data);
this._prebidMethods.setConfig({ortb2:a})});this._spaEventBus.routeChanged.on(()=>{this._prebidMethods.addToQueue(()=>{this.createOrtbDataObj();this._prebidMethods.setConfig({ortb2:{...this._data}})})})}createOrtbDataObj(){var a;this._userSegments=this._getUserSegments();this._siteSegments=this._getSiteSegments();var b=null!==(a=navigator.userAgentData&&navigator.userAgentData.mobile)&&void 0!==a?a:ca();let c=document.documentElement.lang,d=this._config.site.verticals,e=d.length?d[0].replace(/ /g,
"_"):"";a={site:{content:{...(this._siteSegments.length&&{data:this._siteSegments})}},...(!this._config.ccpa.userOptedOut&&this._userSegments.length&&{user:{data:this._userSegments}})};b={cur:["USD"],at:1,device:{deviceType:b?1:2,language:navigator.language.slice(0,2),js:1},site:{content:{...(this._siteSegments.length&&{data:this._siteSegments}),...(c&&{language:c.slice(0,2)})},...(d.length&&oj[e]&&{cat:[oj[e].iabCode],pagecat:[oj[e].iabCode]}),privacypolicy:1,mobile:1},...(this._userSegments.length&&
{user:{data:this._userSegments}}),source:{fd:0}};this._data=this._config.prebid.ortbEnrich?{...b}:{...a}}get data(){return this._data}_onConsentEvent(){let a=this._config.ccpa;a.consentChange.on(b=>{this._prebidMethods.addToQueue(()=>{if(b===a.ccpaOptOut){let c=this._prebidMethods.getConfig("ortb2")||{};c.user&&(delete c.user,this._prebidMethods.setConfig({ortb2:c}))}})})}_getSiteSegments(){return this.buildSegmentData(this._config.marmalade.ortbSegments.get("iabc")||[],6)}_getUserSegments(){if(this._config.ccpa.userOptedOut)return[];
let a=this.buildSegmentData(this._config.marmalade.ortbSegments.get("iaba")||[],4),b=this._convertTopicData(this._config.context.browsingTopics);return a.concat(b)}_convertTopicData(a){let b=a.some(c=>"2"===c.taxonomy_version)?601:600;return this.buildSegmentData(a.reduce((c,d)=>[...c,{id:String(d.id)}],[]),b,"adthrive.com")}_setDelayedTopicsData(a){this._prebidMethods.addToQueue(()=>{let b=this._prebidMethods.getConfig("ortb2")||{};b.user=b.user||{};b.user.data=b.user.data||[];b.user.data=b.user.data.concat(a);
this._prebidMethods.setConfig({ortb2:b})})}buildSegmentData(a,b,c="cafemedia.com"){return a.length?[{name:c,segment:a,ext:{segtax:b}}]:[]}buildSegmentDataFromArray(a,b,c){return this.buildSegmentData(a.map(d=>({id:d})),b,c)}setOrtb2Imp(a,b){if(b)for(let c of Object.keys(a))b[c]=a[c]}setOrtb2ImpExt(a,b){b&&(b.ext={...b.ext,...a})}setOrtb2ImpExtData(a,b){var c;b&&(b.ext=null!==(c=b.ext)&&void 0!==c?c:{},b.ext.data={...b.ext.data,...a})}_setVideoOrtb2ImpData(a,b){this.setOrtb2ImpExtData({adserver:{name:"gam",
adslot:`/${this._config.gam.account}/${this._config.gam.prefix}_${b.name}/${this._config.site.id}`}},a);void 0!==b.getJwBoostTargeting&&!this._config.ccpa.userOptedOut&&this._jwBoostExperiment.result&&this.setOrtb2ImpExtData({jwTargeting:b.getJwBoostTargeting()},a)}addOrtb2Imp(a,b=!1,c){let {slot:d,video:e}=a;a=c||{ext:{data:{}}};this._config.fledge.enabled&&(this.setOrtb2ImpExt({ae:1},a),d&&this.setOrtb2ImpExt({banner:{sizes:d.sizes}},a),e&&this.setOrtb2ImpExt({video:{sizes:e.size}},a));e?this._setVideoOrtb2ImpData(a,
e):d&&(c=(c=qh(d))?c:0,c=xp.includes(c)?c:0,this.setOrtb2ImpExtData({hvp:`${c}`},a));d&&b&&this.setOrtb2Imp({instl:1},a);d&&d.isHighlyViewable()&&this.setOrtb2ImpExtData({pos:"atf"},a);return a}addOrtb2Reg(a,b){this._prebidMethods.addToQueue(()=>{let c=this._prebidMethods.getConfig("ortb2")||{};c.regs={gpp:a,gpp_sid:b};this._prebidMethods.setConfig({ortb2:c})})}updateOrtb2WithIris(a){var b,c,d;let e=this._prebidMethods.getConfig("ortb2")||{},{irisId:f,segmentName:g,irisContextualData:h}=a;a={ext:{segtax:a.segtax,
...(f&&{cids:[f]})},name:g,segment:null!==(b=null===h||void 0===h?void 0:h.map(k=>({id:k})))&&void 0!==b?b:[]};(null===(d=null===(c=e.site)||void 0===c?void 0:c.content)||void 0===d?0:d.data)?e.site.content.data.push(a):e.site.content.data=[a];this._prebidMethods.setConfig({ortb2:e})}};Sb=q([y(),t("design:paramtypes",[N,Gd,ia,Pa,ob,ld])],Sb);let fq=class extends T{constructor(a){super();this._config=a}init(){yd()||Pe()||this.addPrivacyPreferencesFooter()}addPrivacyPreferencesFooter(){let a=document.createElement("div");
a.className="adthrive-privacy-preferences";let b=document.createElement("a");b.href="javascript:adthrive.cmd.push(adthrive.showPrivacyPreferences);";b.innerText="Update Privacy Preferences";a.appendChild(b);this._config.footer.elements.push({order:1,element:a})}};fq=q([v("GDPRComponent"),H(),t("design:paramtypes",[N])],fq);let Tb=class{constructor(){this.consentCaptured=new L}};Tb=q([y()],Tb);let mc=class extends T{constructor(a,b){super();this._events=a;this._config=b;this._queues=[U,A]}init(){this.checkConsentOnLoad().then(a=>
{let b=a&&a.tcString;b?(this._config.gdpr.consentCaptured=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(a.purpose),this._events.consentCaptured.emit(b),this._clearGdprQueues()):this.listenForConsentSubmit().catch(c=>{A.error("GDPREnforcementComponent","init","listenForConsentSubmit",c)})}).catch(a=>{A.error("GDPREnforcementComponent","init","checkConsentOnLoad",a)})}checkConsentOnLoad(){return new Promise(a=>{window.__tcfapi("addEventListener",2,(b,c)=>c&&b&&"tcloaded"===
b.eventStatus&&b.tcString&&!yd()&&!Pe()?a(b):a({}))})}checkConsentForVendor(a,b){return new Promise(c=>{window.__tcfapi("checkConsent",2,(d,e)=>e?c(d):c(!1),{data:[{vendorId:a,purposeIds:b}]})})}_clearGdprQueues(){this._queues.forEach(a=>{this.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,a.purposes).then(b=>{b?a.clearQueue(!0):(a.disable=!0,a.clearQueue(!1))}).catch(b=>{A.error("listenForConsentSubmit","clearGdprQueues",b)})})}listenForConsentSubmit(){return new Promise(a=>{window.__tcfapi("addEventListener",
2,(b,c)=>{c&&(b&&"useractioncomplete"===b.eventStatus&&(this._config.gdpr.consentCaptured=!0,this._config.gdpr.cmpUserActionCompleteFired=!0,this._config.gdpr.revokedPurposeConsent=this._checkForRevokedPurpose(b.purpose),this._events.consentCaptured.emit(b.tcString),this._clearGdprQueues(),window.__tcfapi("removeEventListener",2,d=>{},b.listenerId)),a(!0));a(!1)})})}_checkForRevokedPurpose(a){a=a&&a.consents||{};return!a[1]||!a[4]}get enabled(){return"function"===typeof window.__tcfapi}};mc=q([v("GDPREnforcementComponent"),
H(),t("design:paramtypes",[Tb,N])],mc);let pf=class extends Rp{constructor(a,b,c,d,e,f,g,h,k,m,n){super();this._config=a;this._amazonMethods=b;this._amazonHoldDisplayExperiment=c;this._floors=d;this._videoEventBus=e;this._bootstrapConfig=f;this._firstPartyDataComponent=g;this._ortb2=h;this._gdprEnforcement=k;this._gdprEvents=m;this._slotEventBus=n;this.videoSlotNames=new Map;this._gptSlot=new Map;this._encrypted_cpm_key="amznbid";this._encrypted_bidder_key="amznp";this._encrypted_deal_cpm_key="amznbid_sp";
this._encrypted_deal_bidder_key="amznp_sp";this._decrypted_cpm_key="amz_pb";this._decrypted_bidder_key="amz_bidder";this._decrypted_deal_cpm_key="amz_pb_sp";this._decrypted_deal_bidder_key="amz_bidder_sp";this._amazon_size_key="amznsz";this._amazonEncryptedTargetingKeysToRemove=["amznp","amznp_sp"];this._amazonConfig={pubID:this._config.amazon.pubId,deals:this._config.adOptions.pmp,adServer:"googletag",videoAdServer:"DFP",...(this._config.ccpa.required&&this._config.ccpa.privacyString&&{params:{us_privacy:this._config.ccpa.privacyString}}),
schain:(new Sp).getSupplyChainConfig(this._config.site.id)}}init(){void this._checkLibLoaded("init").then(()=>{this._setupFpdForCCPA();this._setupFpdForGDPR();this._config.ccpa.required||this._config.gdpr.enabled||this._toggleFPDToAmzConfig(!0);this._listenForSlotRefreshEvents();this._amazonMethods.init(this._amazonConfig)}).catch(a=>{A.error("AmazonAuctionManager","init","Failed to initialize apstag",a)});this.videoSlotNames=this._initVideoSlotMap()}_listenForSlotRefreshEvents(){this._slotEventBus.beforeGoogleAdManagerRefreshSlots.on(a=>
{this._setDecryptedBidsBasedOnSlotTargetingForSlots(a);this._removeAmazonEncryptedSlotTargetingForSlots(a)})}_setupFpdForGDPR(){if(this._config.gdpr.enabled)this._gdprEvents.consentCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1]).then(a=>{this._toggleFPDToAmzConfig(!!a);this._amazonMethods.init(this._amazonConfig)}).catch(()=>{})})}_setupFpdForCCPA(){this._config.ccpa.required&&(this._config.ccpa.userOptedOut||this._toggleFPDToAmzConfig(!0),this._config.ccpa.consentChange.on(a=>
{this._amazonConfig.params&&a&&(this._amazonConfig.params.us_privacy=a);this._toggleFPDToAmzConfig(a!==this._config.ccpa.ccpaOptOut);this._amazonMethods.init(this._amazonConfig)}))}_toggleFPDToAmzConfig(a=!0){if(a){a={site:{...this._ortb2.data.site,cattax:1},user:{...this._ortb2.data.user}};let b={ext:{data:{mcmp:[...this._config.marmalade.mcmp,...this._config.marmalade.rfMcmpCodes.map(c=>c[0])],...this._firstPartyDataComponent.staticFirstPartyData}}};a.site={...a.site,...b};this._amazonConfig={...this._amazonConfig,
signals:{ortb2:{...a}}}}else delete this._amazonConfig.signals}async requestBids(a,b=this._config.timeouts.initialBidsRequest-200,c=!1){try{if(await this._checkLibLoaded("requestBids")){var d=this.filterExcludedSlots(a,this._config.amazon.adUnitExclusions);if(d.length)return this._mapGptSlotsFromManagedSlots(d),await this._requestBidsFromAmazon(d,b,c)}}catch(e){A.error("AmazonAuctionManager","requestBids",e)}}filterExcludedSlots(a,b){return a.filter(c=>void 0!==c.googleTagSlot&&!b.has(c.location)&&
"Native_Recipe"!==c.location)}getAmazonSlots(a){let {id:b}=this._config.site,{networkCode:c,prefix:d}=this._config.gam;return a.map(e=>{let f=e.element.id,g=this._getAmazonFloors(f,e.hvp);return{slotID:f,slotName:`/${c}/${d}_${e.name}/${b}`,sizes:e.sizes,...("Video_StickyOutstream"===e.location&&{mediaType:"video"}),...(g&&0<g.value&&g.currency&&{floor:{value:Math.ceil(100*g.value),currency:g.currency}})}})}_getAmazonFloors(a,b){return this._floors.getAmazonFloors(a,b)}_mapGptSlotsFromManagedSlots(a,
b=this._gptSlot){a.forEach(c=>b.set(c.element.id,c.googleTagSlot))}get amazonHoldDisplayExperimentResult(){return this._amazonHoldDisplayExperiment.result}_requestBidsFromAmazon(a,b,c){return new Promise(d=>{let e={slots:this.getAmazonSlots(a),timeout:b,params:{adRefresh:c?"1":"0"}};this._amazonMethods.fetchBids(e,()=>{V.pushToQueue(()=>{try{this._amazonMethods.setDisplayBids()}catch(f){A.error("AmazonAuctionManager","_requestBidsFromAmazon",f)}a.forEach(f=>{this._resetAmazonSlotCpm(f)});d()})});
this.amazonHoldDisplayExperimentResult||d()})}_resetAmazonSlotCpm(a){a="id"in a?a.id:a.name;this.amazonSlotCpm.get(a)&&this.amazonSlotCpm.set(a,0)}_setDecryptedBidsBasedOnSlotTargetingForSlots(a){a.forEach(b=>this._setDecryptedBidsBasedOnSlotTargeting(b))}_removeAmazonEncryptedSlotTargetingForSlots(a){a.forEach(b=>this._removeAmazonEncryptedSlotTargeting(b))}_removeAmazonEncryptedSlotTargeting(a){let b=a.googleTagSlot.getTargetingKeys();this._amazonEncryptedTargetingKeysToRemove.forEach(c=>{b.includes(c)&&
a.googleTagSlot.clearTargeting(c)})}_setDecryptedBidsBasedOnSlotTargeting(a,b=this._gptSlot){this._decryptAmazonDisplayBidAndSetTargeting(this._getReconstructedAmazonBidBasedOnSlotTargeting(a),b,a)}_getReconstructedAmazonBidBasedOnSlotTargeting(a){var b;let c={};this._config.amazon.getEncryptedTargetingKeys().forEach(d=>{var e;let f=null===(e=a.googleTagSlot)||void 0===e?void 0:e.getTargeting(d);if(null===f||void 0===f?0:f.length)c[d]=f[0]});return{slotID:a.element.id,size:null!==(b=c.amznsz)&&void 0!==
b?b:"",targeting:c}}_decryptAmazonDisplayBidAndSetTargeting(a,b=this._gptSlot,c){b=b.get(a.slotID);let {bidder:d,cpm:e,mediaType:f,pmpCpm:g,pmpBidder:h,pmpMediaType:k}=this._decryptAmazonBid(a.targeting||a),m=!!d&&this._partnerEnabled(d),n=!!h&&this._partnerEnabled(h),p={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}};if(b){if(e&&d&&m){var r=re(this._config,a,d,e,f),w=qe(r);r=e-r;p.standard.originalCpm=e;p.standard.discount=r;this._setDisplayTargeting(a,d,w,b,f,this._decrypted_cpm_key,
this._decrypted_bidder_key)}else this._clearAmazonKeys([c],this._config.amazon.getEncryptedTargetingKeys({nonDealKeys:!0}));g&&h&&n?(r=re(this._config,a,h,g,k),w=qe(r),r=g-r,p.pmp.originalCpm=g,p.pmp.discount=r,this._setDisplayTargeting(a,h,w,b,k,this._decrypted_deal_cpm_key,this._decrypted_deal_bidder_key)):this._clearAmazonKeys([c],this._config.amazon.getEncryptedTargetingKeys({dealKeys:!0}));if(m||n)this._setAmazonSlotCpm(c,p.standard.originalCpm,p.pmp.originalCpm),this._setAmazonDiscountTargeting(p,
c)}}_partnerEnabled(a){return this._config.partners.getBidderConfig(a,!1).enabled}_setAmazonSlotCpm(a,b,c){let d=b>c?b:c;"id"in a?(this._config.floors.amazonSlotCpm.set(a.id,d),this._slotEventBus.amazonBidResponseReceived.emit([{slot:a,cpm:b},{slot:a,cpm:c}])):(this._config.floors.amazonSlotCpm.set(a.name,d),this._videoEventBus.amazonVideoBidResponseReceived.emit([{video:a,cpm:b},{video:a,cpm:c}]))}_setAmazonDiscountTargeting(a,b){let {standard:c,pmp:d}=a;c.originalCpm&&b.setSlotTargetingFlag("aop",
[c.originalCpm.toFixed(6).toString()]);c.discount&&b.setSlotTargetingFlag("apd",[c.discount.toFixed(6).toString()]);d.originalCpm&&b.setSlotTargetingFlag("aopp",[d.originalCpm.toFixed(6).toString()]);d.discount&&b.setSlotTargetingFlag("appd",[d.discount.toFixed(6).toString()])}_setDisplayTargeting(a,b,c,d,e,f,g){d.setTargeting(f,c);d.setTargeting(g,b)}refreshBids(a){this._clearAmazonKeys(a);return this.requestBids(a,this._config.timeouts.refreshBidsRequest-200,!0)}_clearAmazonKeys(a,b){let c=b||this._config.amazon.amznTargetingKeys;
a.forEach(d=>{if(d.googleTagSlot){let e=d.googleTagSlot.getTargetingKeys();c.forEach(f=>e.includes(f)&&d.googleTagSlot.clearTargeting(f))}})}requestVideoBids(a,b=this._config.timeouts.initialBidsRequest-200){let c=this._amazonMethods;a.forEach(d=>{this._resetAmazonSlotCpm(d)});return Promise.all(a.map(d=>{let e=this._floors.getAmazonFloors(d.name)||{value:0,currency:"USD"},f=Math.ceil(100*(Number(e&&e.value||0)+this._config.video.minFloor)),g={slotID:this.videoSlotNames.get(d.name),mediaType:"video",
floor:{value:f,currency:e.currency||"USD"}};return new Promise(h=>{this._checkLibLoaded("requestVideoBids").then(k=>{if(!k)return h();g?c.fetchBids({slots:[g],timeout:b},m=>{m.length&&m.forEach(n=>{let {cpm:p,amznBid:r,discounts:w}=this._setDecryptedAmazonVideoKVs(n);this._setAmazonSlotCpm(d,w.standard.originalCpm,w.pmp.originalCpm);this._videoEventBus.addAPStagSlotBidResponse.legacyEmit({playlistId:d._playlistId,bid:r,discounts:w});h(p)});h()}):h()}).catch(k=>{A.error("AmazonAuctionManager","requestVideoBids",
k)})})})).then(()=>Promise.resolve()).catch()}get videoEnabled(){return this._config.partners.video.get("AmazonUAM")}get enabled(){return this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled}get amazonSlotCpm(){return this._config.floors.amazonSlotCpm}_decryptAmazonBid(a){var b=a[hd.amznbid]||"";let c=Up[Vp(b)],d=Tp.get(a[hd.amznp]||"")||"",e=a.amznbid_sp||"",f=this._getMediaTypeFromEncryptedBidCpm(e),g=Up[Vp(e)];a=Tp.get(a[`${hd.amznp}_sp`]||"")||"";b=this._getMediaTypeFromEncryptedBidCpm(b);
return{bidder:d,cpm:c,mediaType:b,...(e.length&&{pmpCpm:g,pmpBidder:a,pmpMediaType:f})}}_getMediaTypeFromEncryptedBidCpm(a){return a.includes("o_")?"stickyOutstream":a.includes("v_")?"instream":"default"}async _checkLibLoaded(a){try{return await this._bootstrapConfig.bootstrapLoaders[Oa.Amazon],!0}catch(b){return A.error("AmazonAuctionManager","checkLibLoaded",a,b),!1}}_initVideoSlotMap(){return Ta()?new Map([[M.Video_Collapse_Autoplay_SoundOff,"Sticky_Playlist_Desktop"],[M.Video_Individual_Autoplay_SOff,
"Sticky_Related_Desktop"],[M.Video_In_Post_ClicktoPlay_SoundOn,"CTP_Desktop"]]):new Map([[M.Video_Coll_SOff_Smartphone,"Sticky_Playlist_Mobile"],[M.Video_Individual_Autoplay_SOff,"Sticky_Related_Mobile"],[M.Video_In_Post_ClicktoPlay_SoundOn,"CTP_Mobile"]])}_setDecryptedAmazonVideoKVs(a){let b={standard:{originalCpm:0,discount:0},pmp:{originalCpm:0,discount:0}},c={...a},{bidder:d,cpm:e,mediaType:f,pmpCpm:g,pmpBidder:h,pmpMediaType:k}=this._decryptAmazonBid(a.targeting||a);if(d&&e){var m=re(this._config,
c,d,e,f);a=qe(m);m=e-m;b.standard.originalCpm=e;b.standard.discount=m;c[this._decrypted_cpm_key]=`${a}`;c[this._decrypted_bidder_key]=d}g&&h&&(m=re(this._config,c,h,g,k),a=qe(m),m=g-m,b.pmp.originalCpm=g,b.pmp.discount=m,c.targeting?(c.targeting[this._decrypted_deal_cpm_key]=`${a}`,c.targeting[this._decrypted_deal_bidder_key]=`${h}`):(c[this._decrypted_deal_cpm_key]=`${a}`,c[this._decrypted_deal_bidder_key]=`${h}`));return{amznBid:c,cpm:e,discounts:b}}};pf=q([v("AmazonAuctionManager"),H(),t("design:paramtypes",
[N,ij,mf,wb,Ua,Fa,of,Sb,mc,Tb,cb])],pf);let gq=class extends W{init(){this._key="OpenXLiveIntent";this._default=!1}};var ju=gq=q([v("OpenXLiveIntentExperiment"),y()],gq);let hq=class extends W{init(){this._key="TripleLiftLiveIntent";this._default=!1}};var ku=hq=q([v("TripleLiftLiveIntentExperiment"),y()],hq);let pj=class extends X{init(){this._key="LiveIntentTimeOutExperiment"}};pj=q([v("LiveIntentTimeOutExperiment"),y()],pj);let Wa=(a,b)=>{var c;return!(null===(c=a.subModule)||void 0===c?0:c.some(d=>
d===b))},xb=class{_setUid2Token(){try{if(""!==this._uid2Token&&this._uid2Token.includes("uid2"))return JSON.parse(this._uid2Token)}catch(a){}}constructor(a,b,c,d,e,f,g,h,k,m){var n,p,r;this._user=a;this._context=b;this._idho=c;this._gdpr=d;this._liveRampAts=e;this._optableConfig=f;this._hemSourceAllowlist=g;this._openXLiveIntentExperiment=h;this._tripleLiftLiveIntentExperiment=k;this._liveIntentTimeoutExperiment=m;this._pixelUrl=`${window.location.origin}/wp-json/adthrive-pubcid/v1/extend`;this._sharedIdCookie=
Na("_pubcid");this._sharedIdLocalNew=U.getLocalStorageValue("_pubcid",!1);this._sharedIdLocalLegacy=U.getLocalStorageValue("pbjs-pubcommonid",!1);this._sharedIdExpLocalLegacy=U.getLocalStorageValue("pbjs-pubcommonid_exp",!1);this._uid2Token=null!==(n=U.getLocalStorageValue("__uid2_server_token",!1))&&void 0!==n?n:"";this._connectIdConfig=["connectId",{id:{name:"connectId",params:{pixelId:58404,...(this._getSharedId()&&{puid:this._getSharedId()}),...(this._shareHemWithUserIdModule({blockGraphHem:!0})&&
{he:this._user.hash})},storage:{name:"connectid",type:"html5",expires:15}},enabled:Wa(this._idho,"connectId")&&this._liveRampAts.enabled,targetingKey:"cid"}];this._unifiedIdConfig=["unifiedId",{id:{name:"unifiedId",params:{url:"https://match.adsrvr.org/track/rid?ttd_pid=iowij76&fmt=json"},storage:{type:"html5",name:"pbjs-unifiedid",expires:60}},enabled:Wa(this._idho,"unifiedId"),targetingKey:"uid1"}];this._unifiedId2Config=["uid2",{id:{name:"uid2",params:{uid2Token:null!==(p=this._setUid2Token())&&
void 0!==p?p:"",storage:"localStorage"}},enabled:Wa(this._idho,"unifiedId2")&&!this._gdpr.enabled,targetingKey:"uid2",storageKey:"__uid2_advertising_token"}];this._id5IdConfig=["id5Id",{id:{name:"id5Id",params:{partner:367,...(this.sharedIdValue&&this._shareHemWithUserIdModule({blockGraphHem:!0})&&{pd:btoa(`1=${this._user.hash}&5=${this.getSharedIdValue()}&12=${Ca}`)})},storage:{type:"html5",name:"pbjs-id5id",expires:60,refreshInSeconds:28800}},enabled:Wa(this._idho,"id5Id"),targetingKey:"id5-d"}];
this._merkuryIdConfig=["merkuryId",{id:{name:"merkleId",params:{sv_pubid:"9262",ssp_ids:["534404531"]},storage:{type:"html5",name:"pbjs-merkleId",expires:30}},enabled:Wa(this._idho,"merkuryId")&&!this._gdpr.enabled,targetingKey:"mrk"}];this._identityLinkConfig=["identityLink",{id:{name:"identityLink",params:{pid:"111"},storage:{type:"html5",name:"pbjs-identitylink",expires:60}},enabled:Wa(this._idho,"identityLink"),targetingKey:"idl"}];this._pairIdConfig=["pairId",{id:{name:"pairId",params:{liveramp:{}},
storage:{type:"html5",name:"pbjs-pairId",expires:30,refreshInSeconds:1800}},enabled:Wa(this._idho,"pairId")&&this._liveRampAts.enabled,targetingKey:"pair"}];this._criteoIdConfig=["criteo",{id:{name:"criteo",storage:{type:"html5",name:"pbjs-criteo",expires:60}},enabled:Wa(this._idho,"criteo"),targetingKey:"cri"}];this._sharedIdConfigStorage=["sharedId",{id:{name:"sharedId",storage:{type:"html5",name:this._validateLegacySharedId()?"pbjs-pubcommonid":"_pubcid",expires:60}},enabled:Wa(this._idho,"sharedId"),
targetingKey:"shl"}];this._sharedIdConfigCookie=["sharedId",{id:{name:"sharedId",storage:{type:"cookie",name:"_pubcid",expires:60},params:this._context.integration&&Op("adthrive-ads-2.3.0",this._context.plugin)?{create:!1,pixelUrl:this._pixelUrl}:void 0},enabled:Wa(this._idho,"sharedId"),targetingKey:"shc"}];this._fabrickIdConfig=["fabrickId",{id:{name:"fabrickId",params:{apiKey:"2215608639",...(this._shareHemWithUserIdModule({blockGraphHem:!0})&&{e:this._user.hash})},storage:{type:"html5",name:"pbjs_fabrickId",
expires:60}},enabled:Wa(this._idho,"fabrickId")&&!this._gdpr.enabled,targetingKey:"fab"}];this._fTrackIdConfig=["ftrack",{id:{name:"FTrack",params:{url:"https://d9.flashtalking.com/d9core",ids:{"device id":!0,"single device id":!0,"household id":!0}},storage:{type:"html5",name:"FTrackId",expires:60,refreshInSeconds:28800}},enabled:Wa(this._idho,"FTrack")&&!this._gdpr.enabled,targetingKey:"ftr"}];this._33AcrossIdConfig=["33acrossId",{id:{name:"33acrossId",params:{pid:"0013300001i0fyfAAA"},storage:{name:"33acrossId",
type:"html5",expires:90,refreshInSeconds:28800}},enabled:Wa(this._idho,"33acrossId")&&!this._gdpr.enabled,targetingKey:"33a"}];this._liveIntentIdConfig=["liveIntentId",{id:{name:"liveIntentId",params:{distributorId:"did-001w",requestedAttributesOverrides:{uid2:!0,medianet:!0,bidswitch:!0,magnite:!0,index:!0,pubmatic:!0,sovrn:!0,openx:this._openXLiveIntentExperiment.result,triplelift:this._tripleLiftLiveIntentExperiment.result,thetradedesk:!0},...(this._shareHemWithUserIdModule({blockGraphHem:!0})&&
{emailHash:this._user.hash}),ajaxTimeout:null!==(r=this._liveIntentTimeoutExperiment.result)&&void 0!==r?r:5E3},storage:{name:"pbjs_li_nonid",type:"html5",expires:1,refreshInSeconds:28800}},enabled:Wa(this._idho,"liveIntentId"),targetingKey:"liid"}];this._lotamePanoramaIdConfig=["lotamePanoramaId",{id:{name:"lotamePanoramaId",params:{clientId:"17297"}},enabled:Wa(this._idho,"lotamePanoramaId"),targetingKey:"lpid",storageKey:"panoramaId"}];this._lmpIdConfig=["lmpId",{id:{name:"lmpId"},enabled:Wa(this._idho,
"lmpId")&&this._optableConfig.loblawEnabled,targetingKey:"lmpid",storageKey:"__lmpid"}];this.ids=new Map([this._getSharedIdConfig(),this._connectIdConfig,this._unifiedIdConfig,this._unifiedId2Config,this._id5IdConfig,this._identityLinkConfig,this._merkuryIdConfig,this._pairIdConfig,this._criteoIdConfig,this._fabrickIdConfig,this._fTrackIdConfig,this._33AcrossIdConfig,this._liveIntentIdConfig,this._lotamePanoramaIdConfig,this._lmpIdConfig]);this._removeIdsOnWordpressPage()}get sharedIdValue(){return this.getSharedIdValue()}_shareHemWithUserIdModule({blockGraphHem:a}=
{blockGraphHem:!1}){var b;let {hash:c,source:d}=this._user;if(!c||!d)return!1;let e=!(!this._user.source||!Bc(this._user.source));return null!==(b=e&&a)&&void 0!==b&&b||e&&!this._optableConfig.useOptableHem?!1:c&&d?this._hemSourceAllowlist.checkSource(d):!1}_removeIdsOnWordpressPage(){this._context.isWordPressLogin&&(this.ids=new Map)}get(a){return"FTrack"===a?this.ids.get("ftrack"):"merkleId"===a?this.ids.get("merkuryId"):this.ids.get(a)}forEach(a){return this.ids.forEach(a)}values(){return this.ids.values()}getSharedIdValue(){let a=
Na("_pubcid"),b=localStorage.getItem("_pubcid");return a||b}_getSharedIdConfig(){let a=this._sharedIdCookie;this._sharedIdCookie||this._sharedIdLocalNew||this._validateLegacySharedId()||(U.setLocalStorageValue("_pubcid","null",!1),U.setLocalStorageValue("_pubcid_exp","Sun, 20 Nov 2022 18:48:47 GMT",!1));return a?this._sharedIdConfigCookie:this._sharedIdConfigStorage}_validateLegacySharedId(){var a;if(a=this._sharedIdExpLocalLegacy&&this._sharedIdLocalLegacy)a=(new Date(this._sharedIdExpLocalLegacy)).getTime(),
a=!(a?a<(new Date).getTime():1);return a}_getSharedId(){return this._sharedIdCookie?this._sharedIdCookie:this._validateLegacySharedId()?this._sharedIdLocalLegacy:this._sharedIdLocalNew}};xb=q([v("UserIds"),y(),t("design:paramtypes",[$e,Jc,We,Ve,Xe,Pb,zd,ju,ku,pj])],xb);class Fb{get enabled(){return!0}}let qf=class extends W{constructor(){super(...arguments);this.source=""}init(){this._key="IdGraphLiveRamp";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",
[]),t("design:returntype",void 0)],qf.prototype,"run",null);qf=q([v("IdGraphLiveRampExperiment"),y()],qf);let rf=class extends Fb{constructor(a){var b;super();this._config=a;this._localKey="_lr_env";this._isEnvelopeModuleReady=!1;this._enabled=(null===(b=this._config.liveRampAts)||void 0===b?void 0:b.enabled)&&"localStorage"in window;window.addEventListener("envelopeModuleReady",()=>{this._isEnvelopeModuleReady=!0})}get enabled(){return this._enabled}_runLiveRamp(a){var b,c;if(!Bc(a.source)||S.resolve(qf).result){var d=
"";if(this._config.gdpr.enabled){var e="gdpr";d=null!==(b=a.consent)&&void 0!==b?b:""}else this._config.ccpa.required&&(e="ccpa",d=null!==(c=this._config.ccpa.privacyString)&&void 0!==c?c:this._config.ccpa.ccpaOptIn);try{let f=[a.sha256Hash,a.sha1Hash].filter(g=>g&&g.length);window.atsenvelopemodule.setAdditionalData({consentString:d,...(void 0!==e?{consentType:e}:{}),id:f.length?f:a.email,type:a.sha256Hash||a.sha1Hash?"emailHashes":"email"})}catch(f){A.error("LiveRampPiiPartner","processPii","Error setting ATS additional data",
f)}}}processPii(a){this._isEnvelopeModuleReady?this._runLiveRamp(a):window.addEventListener("envelopeModuleReady",()=>{this._runLiveRamp(a)})}get _shouldSetTargeting(){return this._enabled&&!!U.getLocalStorageValue(this._localKey,!1)}};rf=q([v("LiveRampPiiPartner"),H(),t("design:paramtypes",[N])],rf);let qj=class extends T{constructor(a){super();this._config=a;this._comscoreId="6035453";this._isValidTraffic=this._gdprEnabled=!1;this._gdprEnabled=this._config.gdpr.enabled;this._isValidTraffic=!zp()}init(){var a=
this._config.ccpa.comscoreParams||"0";a={c1:"2",c2:this._comscoreId,cs_fpid:Na("_pubcid")||localStorage.getItem("_pubcid"),cs_fpit:"o",cs_fpdm:"*null",cs_fpdt:"*null",options:{enableFirstPartyCookie:!0},...(this._gdprEnabled&&{cs_ucfr:"1"}),...(this._config.ccpa.required&&{cs_ucfr:a})};window._comscore=window._comscore||[];window._comscore.push(a);this._import()}_import(){nb(`https://sb.scorecardresearch.com/cs/${this._comscoreId}/beacon.js`).catch(a=>{A.error("ComscoreTrackerComponent","init",`Error during Comscore beacon.js import in ${this._gdprEnabled?
"GDPR":"non-GDPR"} region: `,a)})}get enabled(){return this._isValidTraffic}};qj=q([v("ComscoreTrackerComponent"),H(),t("design:paramtypes",[N])],qj);let rj=class extends T{constructor(a,b){super();this._gam=a;this._config=b;this._trackerHoldoutKey="hawk"}init(){this._gam.slotOnload.once(()=>{this.import().then(()=>this.syncData()).catch(a=>A.error("HawkeyeTrackerComponent","init","slotOnload",a))})}get enabled(){return this._config.tkho.tracker!==this._trackerHoldoutKey}async import(){return await nb("https://pghub.io/js/pandg-sdk.js",
!0)}syncData(){window.Tapad.init({ccpa:this._config.ccpa.privacyString?this._config.ccpa.privacyString:null,bp_id:"cafemedia"},{name:"P&G",pixelUrl:"https://pandg.tapad.com/tag"}).sync({}).then(a=>{})}};rj=q([v("HawkeyeTrackerComponent"),H(),t("design:paramtypes",[V,N])],rj);let sj=class extends T{constructor(a,b){super();this._config=a;this._gam=b;this._trackerHoldoutKey="ats"}init(){try{this._importATS()}catch(a){A.error("LiveRampAtsTrackerComponent","init",a)}}get enabled(){return this._config.liveRampAts.enabled&&
!this._config.disableAds.all&&this._config.tkho.tracker!==this._trackerHoldoutKey}_setECSTags(){let a={},b=this._config.marmalade.mcmp;for(let c of b)a[c]="mcmp";window.__launchpad("ecst",a,c=>{})}_setListener(){window.addEventListener("lrEnvelopePresent",()=>{this._setECSTags()})}_importATS(){this._setListener();nb(this._config.liveRampAts.url).then(()=>{}).catch(a=>{A.error("LiveRampAtsTrackerComponent","error importing liveramp with ATS",a)})}};sj=q([v("LiveRampAtsTrackerComponent"),H(),t("design:paramtypes",
[N,V])],sj);let sf=class extends T{constructor(a,b,c){super();this._config=a;this._gam=b;this._idhoExperiment=c;this.ptk="17c1789b-e660-493b-aa74-3c8fb990dc5f";this.pubid="CAFEMEDIA";this.merkleStorageKey="IXWRAPPERMerkleIp"}init(){if(U.getLocalStorageValue(`${this.merkleStorageKey}`,!1))this.spoof();else this._gam.slotOnload.once(()=>{this.load().then(a=>{a instanceof Error||!Object.keys(a).length||(U.setLocalStorageValue(`${this.merkleStorageKey}`,encodeURIComponent(JSON.stringify(a)),!1),this.spoof())}).catch(()=>
{})})}async load(){let a=`https://mid.rkdms.com/idsv2?ptk=${this.ptk}&pubid=${this.pubid}`;return new Promise((b,c)=>{let d=new XMLHttpRequest;d.open("get",a);d.withCredentials=!0;d.addEventListener("load",()=>200!==d.status?c(Error(`Error status: ${d.status} response: ${d.responseText}`)):b(JSON.parse(d.responseText)));d.addEventListener("error",()=>c(Error("Request failed")));d.send()})}spoof(){window.headertag||(window.headertag={getIdentityInfo:()=>{var a;let b=JSON.parse(decodeURIComponent(U.getLocalStorageValue("pbjs-unifiedid",
!1)||"{}")),c=JSON.parse(decodeURIComponent(U.getLocalStorageValue(`${this.merkleStorageKey}`,!1)||"{}"));return{AdserverOrgIp:{data:{source:"adserver.org",uids:Object.keys(b).map(d=>({id:b[d],ext:{rtiPartner:d}}))},responsePending:!1},MerkleIp:{data:{source:"merkleinc.com",uids:[{id:null===(a=null===c||void 0===c?void 0:c.ppid)||void 0===a?void 0:a.id,ext:{enc:0}}]},responsePending:!1}}}})}get _shouldSetTargeting(){return this.enabled&&null!==U.getLocalStorageValue(`${this.merkleStorageKey}`,!1)}get enabled(){var a;
return!this._config.gdpr.enabled&&!this._config.ccpa.enabled&&!(null===(a=this._idhoExperiment.result)||void 0===a?0:a.includes("merkleId"))}};sf=q([v("MerkleTrackerComponent"),H(),t("design:paramtypes",[N,V,Cd])],sf);let tj=class extends W{init(){this._key="NielsenTracker";this._default=!1}isEnabled(){return super.isEnabled()&&ic()}};tj=q([v("NielsenTrackerExperiment"),H()],tj);let uj=class extends T{constructor(a,b,c){super();this._config=a;this._nielsenTrackerExperiment=b;this._gam=c}init(){try{this._gam.slotOnload.once(()=>
{this.loadImage()})}catch(a){A.error("NielsenTrackerComponent","init",a)}}get enabled(){return this._nielsenTrackerExperiment.result}loadImage(){let a=this._config.context.device,b="https://secure-gl.imrworldwide.com/cgi-bin/m?am=3&at=view&rt=banner&st=image&cr=adthrive&ce=cafemedia",c={phone:"nlsn290957",tablet:"nlsn291137",desktop:"nlsn291136"}[a],d={phone:"nlsn287186",tablet:"nlsn287188",desktop:"nlsn287187"},e=xe(this._config.context.savedReferrer);e&&(e.toLowerCase().includes("instagram.com")||
e.toLowerCase().includes("pinterest.com"))&&(c=d[a]);b+=`&ci=${"nlsnci542"}&ca=${c}&pc=${window.location.host}&r=${Date.now()}`;(new Image).src=`${b}`}};uj=q([v("NielsenTrackerComponent"),H(),t("design:paramtypes",[N,tj,V])],uj);let vj=class extends T{constructor(a,b,c){super();this._config=a;this._gam=b;this._slotManager=c;this._accountId="2773249";this._adId="81938";this._configId="2092";this._affDomain="goto.target.com";this._targetDomain="target.com";this._commonPath=this._commonParams="";this._trackerHoldoutKey=
"tgtaff";this._commonParams=ot({subid1:this._config.site.id,subid2:location.href,sharedid:this._config.site.name});this._commonPath=`${this._accountId}/${this._adId}/${this._configId}`}init(){try{let a=setTimeout(()=>{this.rewriteAllTargetLinksOnPage()},5E3);this._slotManager.added.once(()=>{this._gam.slotOnload.once(()=>{a&&clearTimeout(a);this.rewriteAllTargetLinksOnPage()})})}catch(a){A.error("TargetRewriteTrackerComponent","getAllTargetLinksOnPage",a)}}rewriteAllTargetLinksOnPage(){let a=0;Array.prototype.map.call(document.querySelectorAll(`a[href*="${this._targetDomain}"]`),
b=>b).filter(b=>this.isTargetLink(b)).forEach(b=>{this.fireImpression(b.href);this.replaceTargetLink(b);a++});a&&A.event("TargetRewriteTrackerComponent","logTargetRewrite",{message:"targetRewrite",countRewrite:a})}fireImpression(a){a=this.getImpressionPixel(a);return(new Image).src=a}getImpressionPixel(a){let b=`https://${this._affDomain}/i/${this._commonPath}?`,c=`U1|${this.getUUID()}`;b+=`_ir=${encodeURIComponent(c)}`+"&"+this._commonParams+"&subid3="+encodeURIComponent(a);a=a.split("?");1<a.length&&
(b+="&"+a[1]);return b}getUUID(){return`${Date.now().toString()}.${Math.random().toString(36).substring(2,15)}`}replaceTargetLink(a){var b=this.removeHashtagsFromUrl(a.href);b=encodeURIComponent(b);a.classList.add(...["noskimlinks","norewrite"]);a.href=`https://${this._affDomain}/c/${this._commonPath}?${this._commonParams}&subid3=${b}&u=${b}#donotlink`}removeHashtagsFromUrl(a){return a.split("#")[0]}isTargetLink(a){return(a=this.extractDomain(a.href))&&!a.includes(this._affDomain)}extractDomain(a){return(a=
/^https?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i.exec(a))&&a[1]||""}get enabled(){return this._config.tkho.tracker!==this._trackerHoldoutKey&&!this._config.ccpa.enabled&&this._config.adOptions.targetAff}};vj=q([v("TargetRewriteTrackerComponent"),H(),t("design:paramtypes",[N,V,ja])],vj);let wj=class extends T{constructor(a){super();this._gam=a}init(){try{this._gam.slotOnload.once(()=>{this.loadImage()})}catch(a){A.error("TheTradeDeskTrackerComponent","init",a)}}get enabled(){return!0}loadImage(){(new Image).src=
"https://insight.adsrvr.org/track/evnt/?adv=z127r4i&ct=0:p21aj7j&fmt=3"}};wj=q([v("TheTradeDeskTrackerComponent"),H(),t("design:paramtypes",[V])],wj);let xj=class{constructor(a,b,c,d){this._userIds=a;this._prebidMethods=b;this.liveRampPiiPartner=c;this._merkleTracker=d}getSyncedIdModules(a){return[...a].reduce((b,c)=>{(c=this._userIds.get(c.name))&&this.getStoredUserIds(c)&&b.push(c.id.name);return b},[])}getSyncedPartners(a){a=this.getSyncedIdModules(a).map(f=>{var g;return null===(g=this._userIds.get(f))||
void 0===g?void 0:g.targetingKey}).filter(f=>!!f);let b=this._getLiveIntentModulePartners(),c=this.getMagniteCarbonId(),d=this.getAmazonPublisherAudienceId(),e=this._getConditionalPiiPartners();return[...a,...b,...c,...d,...e]}_getLiveIntentModulePartners(){let a=[];this._prebidMethods.addToQueue(()=>{var b,c=this._prebidMethods.getUserIds();let d=this._prebidMethods.getUserIdsAsEids();c&&c.lipb&&(c.lipb.uid2&&a.push("li_uid2"),c.lipb.sovrn&&a.push("li_sovrn"));(c=null===d||void 0===d?void 0:d.find(e=>
"adserver.org"===e.source))&&0<c.uids.length&&(null===(b=c.uids[0].ext)||void 0===b?0:b.hasOwnProperty("provider"))&&a.push("li_uid1")});return a}_getConditionalPiiPartners(){let a=[];this.liveRampPiiPartner._shouldSetTargeting&&a.push("ats");this._merkleTracker._shouldSetTargeting&&a.push("mrk_leg");return a}getAmazonPublisherAudienceId(){return Na("AMZN-Token")?["amzn"]:[]}getMagniteCarbonId(){let a=U.getLocalStorageValue("carbon_ccuid"),b=Na("ccuid"),c=Na("ccsid");return a||b||c?["mgncrbn"]:[]}getStoredUserIds(a){let {id:{storage:b},
storageKey:c}=a,d;b&&"cookie"===b.type&&window.navigator.cookieEnabled?d=Na(b.name):b&&"html5"===b.type?d=U.getLocalStorageValue(b.name,!1,!1):c&&(d=window.localStorage.getItem(c));return d}};xj=q([v("UserIdTargeting"),H(),t("design:paramtypes",[xb,ia,rf,sf])],xj);let Pc=class extends T{constructor(a,b,c,d,e,f){super();this._prebidMethods=a;this._userIdTargeting=b;this._userIds=c;this._gam=d;this._slotEventBus=e;this._idhoExperiment=f;this._enabledUserIds=[];this._ppid=null;this._enabledUserIds=[...c.values()].filter(g=>
g.enabled).map(g=>{"sharedId"===g.id.name&&(this._ppid=U.getLocalStorageValue(g.id.storage&&g.id.storage.name||"",!1))&&(g.id.value={pubcid:this._ppid});return g.id});this._slotEventBus.requestingBids.once(this._setPPID.bind(this));this._slotEventBus.refreshingBids.once(this._setPPID.bind(this))}getUserIdTargeting(){return this._userIdTargeting.getSyncedPartners(this._enabledUserIds)}get enabledUserIds(){return[...this._userIds.values()].map(a=>a.id)}init(){let a={userIds:this._enabledUserIds};this._ppid&&
(a.ppid="pubcid.org");this.setUserIdsWithPrebid(a)}convertToBinary(a){return a.split("").map(b=>b.charCodeAt(0).toString(2)).join(" ")}setUserIdsWithPrebid(a){this._prebidMethods.setConfig({userSync:a})}_setPPID(){let a=this._userIds.sharedIdValue,b=e=>{this._gam.setTargetingFlag("ppid",e,!0);return e};if(this._idhoExperiment.result&&this._idhoExperiment.result.includes("id5Id"))a?(b(["sh_id"]),this._prebidMethods.setConfig({ppid:a}),this._gam.setSharedIdAsPPID(a)):b(["no_sharedIDAvail_noPPIDSet"]);
else{var c=window.localStorage.getItem("pbjs-id5id");if(!c&&a)b(["no_id5StorageAvail_sharedIdSent"]),this._prebidMethods.setConfig({ppid:a}),this._gam.setSharedIdAsPPID(a);else if(c){if((c=JSON.parse(decodeURIComponent(c)).gp)||a){if(!c){b(["gpid_na_sharedIdSent"]);this._prebidMethods.setConfig({ppid:a});this._gam.setSharedIdAsPPID(a);return}if(!a){b(["no_sharedIdAvail_gpidSent"]);this._prebidMethods.setConfig({ppid:c});this._gam.setGPIDasPPID(c);return}}else b(["both_na_noPPIDSet"]);var d=this.convertToBinary(c);
"error during binary conversion"===d?(b(["errorDuringGPIDBinaryConversion_sharedIdSent"]),this._prebidMethods.setConfig({ppid:a}),this._gam.setSharedIdAsPPID(a)):0===parseInt(d.charAt(d.length-1))%2?(b(["gpid"]),this._prebidMethods.setConfig({ppid:c}),this._gam.setGPIDasPPID(c)):(b(["sh_id"]),this._prebidMethods.setConfig({ppid:a}),this._gam.setSharedIdAsPPID(a))}else b(["no_id5StorageAvail_noSharedIdAvail_noPPIDset"])}}};Pc=q([v("UserIdComponent"),y(),t("design:paramtypes",[ia,xj,xb,V,cb,Cd])],Pc);
class lu{}let tf=class extends X{init(){this._key="Analytics"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],tf.prototype,"run",null);tf=q([v("AnalyticsExperiment"),y()],tf);let yj=class extends lu{constructor(a,b,c){super();this._config=a;this._prebidMethods=b;this._analyticsExperiment=c;this.name="roxot"}init(){if(window.localStorage)try{this._prebidMethods.enableAnalytics({provider:"roxot",options:{publisherIds:["ffcc0e40-07d0-4238-92e4-f711915afb5a"],
host:`${this._config.context.bucket}.com`}})}catch(a){A.error("RoxotAnalytics","init - ignored",a)}else A.error("RoxotAnalytics","init",Error("Disabled roxot because localStorage is undefined"))}get enabled(){return"roxot"===this._analyticsExperiment.result}};yj=q([v("RoxotAnalytics"),H(),t("design:paramtypes",[N,ia,tf])],yj);let zj=class extends X{init(){this._key="EventHistoryTTLExperiment";this.abgroup="ttle"}};zj=q([v("EventHistoryTTLExperiment"),y()],zj);class mu{constructor(a){this._config=
a}updateBidParams(a,b){}get enabled(){return!0}get videoEnabled(){return!0}get name(){return this.bidderConfig.bidder_name}_addPositionParam(a,b){a.params.position=b}_addPlacementIdParam(a,b){a.params.placementId=b}_addBidLabel(a,b,c={},d=!0){let e=[],f=this._config;c.outstreamActive&&e.push(`outstreamActive_${a}`);c.outstreamCapable&&e.push(`outstreamCapable_${a}`);c.refresh&&e.push("refresh");d&&1<f.prebid.refreshAuctionCount&&(a=a.includes("Video_StickyOutstream"),c=[],!a&&1<f.prebid.refreshAuctionCount&&
(c=f.prebid.getBidderLabel(b||this.name)),a&&(c=f.prebid.getVideoBidderLabel(b||this.name)),e=e.concat(c));return e.length?{labelAll:e}:{}}}class ma extends mu{getSlotBidRequests(a){}getBannerSlotBidRequests(a){}getMultiFormatSlotBidRequests(a,b){A.error("PrebidAuctionManager","getMultiFormatSlotBidRequests","This method should be overridden")}getOutstreamSlotBidRequests(a){}getNativeSlotBidRequests(a){}getVideoSlotBidRequests(a){}getBannerBidRequests(a){return a.filter(b=>!this.multiformatBidder||
!b.multiformat).reduce((b,c)=>{b.set(c.id,this.getBannerSlotBidRequests(c));return b},new Map)}bannerEligibleReducer(a,b){a.set(b.id,this.getMultiFormatSlotBidRequests(b,!1));return a}getMultiFormatBidRequests(a){return a.reduce(this.bannerEligibleReducer.bind(this),new Map)}getOutstreamBidRequests(a){return a.filter(b=>!this.multiformatBidder||!b.multiformat).reduce((b,c)=>{b.set(c.id,this.getOutstreamSlotBidRequests(c));return b},new Map)}getNativeBidRequests(a){return a.filter(b=>!this.multiformatBidder||
!b.multiformat).reduce((b,c)=>{b.set(c.id,this.getNativeSlotBidRequests(c));return b},new Map)}getVideoBidRequests(a){return a.reduce((b,c)=>{b.set(c.name,this.getVideoSlotBidRequests(c));return b},new Map)}}let Aj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.ThirtyThreeAcross);this.videoCreativeIds=[["138395447475",l.ThirtyThreeAcross],["138395937226",l.ThirtyThreeAcross],["138395937256",l.ThirtyThreeAcross],["138395937310",l.ThirtyThreeAcross],
["138395937325",l.ThirtyThreeAcross],["138395447241",l.ThirtyThreeAcross],["138395937274",l.ThirtyThreeAcross],["138395937313",l.ThirtyThreeAcross],["138395937319",l.ThirtyThreeAcross],["138395937343",l.ThirtyThreeAcross],["138395937349",l.ThirtyThreeAcross],["138395937304",l.ThirtyThreeAcross],["138395937307",l.ThirtyThreeAcross],["138395937322",l.ThirtyThreeAcross],["138395937346",l.ThirtyThreeAcross],["138395445846",l.ThirtyThreeAcross]];this._bannerProductId="siab";this._videoProductId="instream";
this._bannerMap=new Map([["Below_Post","dqjinO_Lqr6i5uaKkv7mNO"],["Content_1","dzqsVw_Lqr6iHHaKlId8sQ"],["Content_2","dGYL36_Lqr6iHHaKlId8sQ"],["Content_3","dPmBLW_Lqr6ikXaKkGJozW"],["Content_4","dYmdO4_Lqr6ikXaKkGJozW"],["Content_5","d73_q4_Lqr6ikfaKlId8sQ"],["Content_6","aeCNc8_Lur6ikfaKlId8sQ"],["Content_7","amEJ90_Lur6ikXaKkGJozW"],["Content_8","avcDUU_Lur6ikXaKkGJozW"],["Content_9","aE0F5q_Lur6iHHaKlId8sQ"],["Footer_1","aMbGkS_Lur6ikXaKkGJozW"],["Header_1","aZCnyg_Lur6ikfaKlId8sQ"],["Header_2",
"a7S6ye_Lur6ikXaKkGJozW"],["Recipe_1","bfXhLW_Lur6ioMaKkGJozW"],["Recipe_2","bmQVLo_Lur6ikfaKlId8sQ"],["Recipe_3","d7kcPCUhur6yo-aKkGJozW"],["Recipe_4","agAjkaUhyr6yo9aKlId8sQ"],["Sidebar_1","buEy3O_Lur6ikfaKlId8sQ"],["Sidebar_2","bCOsqy_Lur6ikfaKlId8sQ"],["Sidebar_3","bOGvrc_Lur6ikXaKkGJozW"],["Sidebar_4","bW-wb0_Lur6ikfaKlId8sQ"],["Sidebar_5","b8nVxi_Lur6ikXaKkGJozW"],["Sidebar_9","cggK7W_Lur6ikfaKlId8sQ"]]);this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,"a_lKMg0Iar7k8brkHcnlxd"],[M.Video_Coll_SOff_Smartphone,
"b7sKMM0Iar7ikGrkHcnnVW"],[M.Video_In_Post_ClicktoPlay_SoundOn,"c98www0Iar7ioerkHcnlKl"],[M.Video_Individual_Autoplay_SOff,"bhUZlu0Ier7ioerkHcnlKl"]])}get enabled(){return this._config.partners.display.get(l.ThirtyThreeAcross)}get videoEnabled(){let a=this._config;return a.partners.video.get(l.ThirtyThreeAcross)&&!!a.video.playbackmethod}getBannerSlotBidRequests(a){return this._getBidParams(a)}getOutstreamSlotBidRequests(a){return this._getBidParams(a,!0)}_getBidParams(a,b=!1){var c=this._bannerMap;
if(c=c.has(a.placementMapName)&&c.get(a.placementMapName))return[{bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{outstreamActive:b}),params:{siteId:c,productId:this._bannerProductId}}]}getVideoSlotBidRequests(a){let b=this._videoMap;if(a=b.has(a.name)&&b.get(a.name))return[{bidder:this.name,params:{siteId:a,productId:this._videoProductId}}]}};Aj=q([v("ThirtyThreeAcrossBidder"),H(),t("design:paramtypes",[N])],Aj);let Ub=class{constructor(a,b,c){this._gam=a;this._pageManager=b;this._spaEventBus=
c;this.scroll=new L;this.resize=new L;this.pageVisibility=new L;this.videoPlaying=new L;this.videoSlotRendered=new L;this.footerRefreshed=new L;this.spaListeners=[];this._setupSpaListeners();this.addEventListeners();this._gam.slotResponseReceived.on(({slot:d})=>{"Footer"===d.location&&void this.footerRefreshed.emit()})}_setupSpaListeners(){this._spaEventBus.routeChanged.on(()=>{this.spaListeners.forEach(a=>a());this.spaListeners.length=0});this._spaEventBus.resetCompleted.on(()=>{this.addEventListeners()})}addEventListeners(){let a=
!1,b=!1,c=()=>{a||(a=!0,setTimeout(()=>{void this.scroll.emit();a=!1},100))},d=()=>{b||(b=!0,setTimeout(()=>{void this.resize.emit();b=!1},100))};this.spaListeners.push(this._pageManager.scroll.on(()=>c()));this.spaListeners.push(this._pageManager.resize.on(()=>d()));this.spaListeners.push(this._pageManager.visibilityChange.on(()=>{void this.pageVisibility.emit(document.hidden)}))}emitVideoPlayingEvent(a,b){this.videoPlaying.emit({playerId:a,mediaIdCount:b})}emitVideoSlotRenderedEvent(a){this.videoSlotRendered.emit(a)}};
Ub=q([y(),t("design:paramtypes",[V,Ra,Pa])],Ub);var iq;(function(a){a.ABORT="abort";a.CAN_PLAY="canplay";a.CAN_PLAY_THROUGH="canplaythrough";a.DURATION_CHANGE="durationchange";a.EMPTIED="emptied";a.ENDED="ended";a.ERROR="error";a.LOADED_DATA="loadeddata";a.LOADED_METADATA="loadedmetadata";a.LOAD_START="loadstart";a.PAUSE="pause";a.PLAY="play";a.PLAYING="playing";a.PROGRESS="progress";a.RATE_CHANGE="ratechange";a.SEEKED="seeked";a.SEEKING="seeking";a.STALLED="stalled";a.SUSPEND="suspend";a.TIME_UPDATE=
"timeupdate";a.VOLUME_CHANGE="volumechange";a.WAITING="waiting"})(iq||(iq={}));var ta;(function(a){a.AD_BREAK_READY="adBreakReady";a.AD_BUFFERING="adBuffering";a.AD_ERROR="adError";a.AD_CAN_PLAY="adCanPlay";a.ADS_MANAGER_LOADED="adsManagerLoaded";a.AD_METADATA="adMetadata";a.AD_PROGRESS="adProgress";a.ALL_ADS_COMPLETED="allAdsCompleted";a.CLICK="click";a.COMPLETE="complete";a.CONTENT_PAUSE_REQUESTED="contentPauseRequested";a.CONTENT_RESUME_REQUESTED="contentResumeRequested";a.DURATION_CHANGE="durationChange";
a.EXPANDED_CHANGED="expandedChanged";a.FIRST_QUARTILE="firstQuartile";a.IMPRESSION="impression";a.INTERACTION="interaction";a.LINEAR_CHANGED="linearChanged";a.LOADED="loaded";a.LOG="log";a.MIDPOINT="midpoint";a.PAUSED="pause";a.RESUMED="resume";a.SKIPPABLE_STATE_CHANGED="skippableStateChanged";a.SKIPPED="skip";a.STARTED="start";a.THIRD_QUARTILE="thirdQuartile";a.USER_CLOSE="userClose";a.VIDEO_CLICKED="videoClicked";a.VIDEO_ICON_CLICKED="videoIconClicked";a.VIEWABLE_IMPRESSION="viewable_impression";
a.VOLUME_CHANGED="volumeChange";a.VOLUME_MUTED="mute"})(ta||(ta={}));var jq;(function(a){a.AD_LOAD="adLoadError";a.AD_PLAY="adPlayError"})(jq||(jq={}));var kq;(function(a){a[a.ADSLOT_NOT_VISIBLE=-1]="ADSLOT_NOT_VISIBLE";a[a.ADS_REQUEST_NETWORK_ERROR=1012]="ADS_REQUEST_NETWORK_ERROR";a[a.ASSET_FALLBACK_FAILED=1021]="ASSET_FALLBACK_FAILED";a[a.AUTOPLAY_DISALLOWED=1205]="AUTOPLAY_DISALLOWED";a[a.COMPANION_AD_LOADING_FAILED=-1]="COMPANION_AD_LOADING_FAILED";a[a.COMPANION_REQUIRED_ERROR=602]="COMPANION_REQUIRED_ERROR";
a[a.CONSENT_MANAGEMENT_PROVIDER_NOT_READY=1300]="CONSENT_MANAGEMENT_PROVIDER_NOT_READY";a[a.DEPRECATED_ERROR_CODE=-1]="DEPRECATED_ERROR_CODE";a[a.FAILED_TO_REQUEST_ADS=1005]="FAILED_TO_REQUEST_ADS";a[a.INVALID_AD_TAG=1013]="INVALID_AD_TAG";a[a.INVALID_ARGUMENTS=1101]="INVALID_ARGUMENTS";a[a.NATIVE_MESSAGE_ERROR=1204]="NATIVE_MESSAGE_ERROR";a[a.NONLINEAR_DIMENSIONS_ERROR=501]="NONLINEAR_DIMENSIONS_ERROR";a[a.OVERLAY_AD_LOADING_FAILED=-1]="OVERLAY_AD_LOADING_FAILED";a[a.OVERLAY_AD_PLAYING_FAILED=500]=
"OVERLAY_AD_PLAYING_FAILED";a[a.Rh=2002]="Rh";a[a.STREAM_INITIALIZATION_FAILED=1020]="STREAM_INITIALIZATION_FAILED";a[a.UNKNOWN_AD_RESPONSE=1010]="UNKNOWN_AD_RESPONSE";a[a.UNKNOWN_ERROR=900]="UNKNOWN_ERROR";a[a.UNSUPPORTED_LOCALE=1011]="UNSUPPORTED_LOCALE";a[a.VAST_ASSET_NOT_FOUND=1007]="VAST_ASSET_NOT_FOUND";a[a.VAST_EMPTY_RESPONSE=1009]="VAST_EMPTY_RESPONSE";a[a.VAST_LINEAR_ASSET_MISMATCH=403]="VAST_LINEAR_ASSET_MISMATCH";a[a.VAST_LOAD_TIMEOUT=301]="VAST_LOAD_TIMEOUT";a[a.VAST_MALFORMED_RESPONSE=
-1]="VAST_MALFORMED_RESPONSE";a[a.VAST_MEDIA_ERROR=-1]="VAST_MEDIA_ERROR";a[a.VAST_MEDIA_LOAD_TIMEOUT=402]="VAST_MEDIA_LOAD_TIMEOUT";a[a.VAST_NONLINEAR_ASSET_MISMATCH=503]="VAST_NONLINEAR_ASSET_MISMATCH";a[a.VAST_NO_ADS_AFTER_WRAPPER=303]="VAST_NO_ADS_AFTER_WRAPPER";a[a.VAST_PROBLEM_DISPLAYING_MEDIA_FILE=405]="VAST_PROBLEM_DISPLAYING_MEDIA_FILE";a[a.VAST_SCHEMA_VALIDATION_ERROR=101]="VAST_SCHEMA_VALIDATION_ERROR";a[a.VAST_TOO_MANY_REDIRECTS=302]="VAST_TOO_MANY_REDIRECTS";a[a.VAST_TRAFFICKING_ERROR=
200]="VAST_TRAFFICKING_ERROR";a[a.VAST_UNEXPECTED_DURATION_ERROR=202]="VAST_UNEXPECTED_DURATION_ERROR";a[a.VAST_UNEXPECTED_LINEARITY=201]="VAST_UNEXPECTED_LINEARITY";a[a.VAST_UNSUPPORTED_VERSION=102]="VAST_UNSUPPORTED_VERSION";a[a.VAST_WRAPPER_ERROR=300]="VAST_WRAPPER_ERROR";a[a.VIDEO_ELEMENT_REQUIRED=-1]="VIDEO_ELEMENT_REQUIRED";a[a.VIDEO_ELEMENT_USED=-1]="VIDEO_ELEMENT_USED";a[a.VIDEO_PLAY_ERROR=400]="VIDEO_PLAY_ERROR";a[a.VPAID_ERROR=901]="VPAID_ERROR"})(kq||(kq={}));class lq extends T{constructor(a,
b,c,d,e,f,g,h){super();this._playerId=a;this._playlistId=b;this._playerType=c;this._pageElement=d;this.size=e;this._config=f;this._eventProxy=g;this._autoplay=h;this.adClick=new L;this.adError=new L;this.adCompleted=new L;this.adFirstQuartile=new L;this.adImpression=new L;this.adLoaded=new L;this.adMidpoint=new L;this.adRequest=new L;this.adPause=new L;this.adPlay=new L;this.adSkipped=new L;this.adStarted=new L;this.adThirdQuartile=new L;this.adProgress=new L;this.adsManagerLoaded=new L;this.adViewableImpression=
new L;this.allAdsCompleted=new L;this.contentPauseRequested=new L;this.contentResumeRequested=new L;this.error=new L;this.seeking=new L;this.seeked=new L;this.firstFrame=new L;this.fullscreen=new L;this.isFirstPlay=!0;this.mute=new L;this.loaded=new L;this.pause=new L;this.play=new L;this.click=new L;this.playerVolumeChange=new L;this.loadedMetaData=new L;this.ended=new L;this.timeupdate=new L;this.playlist=[];this.ready=new L;this.setupError=new L;this.state="idle";this.time=new L;this.volume=new L;
this._adContainer=document.createElement("DIV");this._videoTitleDiv=document.createElement("DIV");this._videoDescriptionDiv=document.createElement("DIV");this._videoTitleOverlayContainer=document.createElement("DIV");this._container=document.createElement("DIV");this._playerPosition=document.createElement("DIV");this._playAdInStreamAttempted=!1;this._videoElement=document.createElement("VIDEO");this.volumeLevel=0;this.muted=!0;this._imaLibraryEnpoint="https://imasdk.googleapis.com/js/sdkloader/ima3.js";
this._isInstream=this._userPaused=!1;this._instreamTypes=["embedded-stationary","auto-injected"];this._isMobile=ca();this.requestVideoBids=()=>{throw Error("Request video bids not set");};this.buildVideoUrl=()=>{throw Error("Build video url not set");};this.waitForConsent=()=>{throw Error("Wait for consent not set");};this._boundHandlers=new Map;this._isInstream=this._instreamTypes.includes(this._playerType);this.volumeLevel="embedded-stationary"===c?.5:0;this.muted="embedded-stationary"===c?!1:!0}attachEventHandlers(a){for(let b of a)this.addEventHandler(b.target,
b.event,b.handler)}addEventHandler(a,b,c){c=c.bind(this);let d=this.getHandlerKey(a,b);this._boundHandlers.set(d,c);a.addEventListener(b,c,!1)}getHandlerKey(a,b){return`${a.constructor.name}_${b}`}removeEventHandler(a,b){let c=this.getHandlerKey(a,b),d=this._boundHandlers.get(c);d&&(a.removeEventListener(b,d,!1),this._boundHandlers.delete(c))}detachEventHandlers(a){for(let b of a)this.removeEventHandler(b.target,b.event)}get imaVersion(){return window.google.ima.VERSION}async init(){await this._importIMAScript();
(this._ima=window.google&&window.google.ima)?(this._injectPlayer(),this.ready.emit(),this._addSlickDialogListener()):A.error("VideoPlayer","init",this._playerType,"Failed to initialize player. IMA is not defined.")}_play(a){this.play.emit(a)}_playerClick(a){this.click.emit(a)}_playerVolumeChange(a){this.playerVolumeChange.emit(a)}_loadedMetaData(a){this.loadedMetaData.emit(a)}_pause(a){this.pause.emit(a)}_error(a){this.error.emit(a)}_seeking(a){this.seeking.emit(a)}_seeked(a){this.seeked.emit(a)}_ended(a){this.ended.emit(a)}_timeupdate(a){this.timeupdate.emit(a)}playAd(a){let b=
this._adsLoader,c=this._adsRequest,d=this.size,{adResponse:e,adTagUrl:f}=a;c.linearAdSlotWidth=d[0];c.linearAdSlotHeight=d[1];c.nonLinearAdSlotWidth=d[0];c.nonLinearAdSlotHeight=d[1];e&&(c.adsResponse=e);f&&(c.adTagUrl=f);this.attachEventHandlers([{target:b,event:ta.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:b,event:ta.AD_ERROR,handler:this._adError}]);b.requestAds(c)}playAdInStream(){this._playAdInStreamAttempted=!0;this._adsManager.setVolume(this.volumeLevel);this._adsManager.start()}requestAd(a){let b=
this._adsRequest,c=this.size,{adResponse:d,adTagUrl:e}=a;b.linearAdSlotWidth=c[0];b.linearAdSlotHeight=c[1];b.nonLinearAdSlotWidth=c[0];b.nonLinearAdSlotHeight=c[1];d&&(b.adsResponse=d);e&&(b.adTagUrl=e);this.attachEventHandlers([{target:this._adsLoader,event:ta.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:ta.AD_ERROR,handler:this._adError}]);this._adsLoader.requestAds(b)}_adComplete(a){a=this._getAdRenderDetails(a);this.adCompleted.emit(a)}_adError(a){a=a&&a.error&&
a.error.data;this.adError.emit(a?{code:a.errorCode,message:a.errorMessage,type:a.type}:{})}_adImpression(a){a=this._getAdRenderDetails(a);this.adImpression.emit(a)}_adLoaded(a){this._enablePlayerAdControls();a=this._getAdRenderDetails(a);this.adLoaded.emit(a)}_adStarted(a){a=this._getAdRenderDetails(a);this.adStarted.emit(a);this.state="playing";this._isInstream?this._adsManager.setVolume(this.volumeLevel):(this._container.classList.remove("adthrive-player-idle"),this._container.classList.add("adthrive-player-playing"),
this._adsManager.setVolume(0))}_adProgress(a){(a=a.getAdData())&&this.adProgress.emit({duration:a.duration,position:a.currentTime})}_allAdsComplete(a){a=this._getAdRenderDetails(a);this.allAdsCompleted.emit(a)}_adSkipped(a){a=this._getAdRenderDetails(a);this.adSkipped.emit(a)}_click(a){a=this._getAdRenderDetails(a);this.adClick.emit(a)}_contentPauseRequested(a){a=this._getAdRenderDetails(a);this.contentPauseRequested.emit(a)}_contentResumeRequested(a){a=this._getAdRenderDetails(a);this.contentResumeRequested.emit(a)}_firstQuartile(a){a=
this._getAdRenderDetails(a);this.adFirstQuartile.emit(a)}handlePageVisibilityChange(a){"playing"===this.state&&a?this._pauseAd():"paused"!==this.state||a||this._userPaused||this._playAd()}_midpoint(a){a=this._getAdRenderDetails(a);this.adMidpoint.emit(a)}_paused(a){a=this._getAdRenderDetails(a);this.adPause.emit(a);this.state="paused";let b=(a=document.getElementById(`adthrive-player-icon-pause-${this._playerType}`))&&a.previousSibling;a&&this._toggleClass(a,"adthrive-player-icon-hidden");b&&this._toggleClass(b,
"adthrive-player-icon-hidden")}_resumed(a){a=this._getAdRenderDetails(a);this.adPlay.emit(a);this.state="playing";this._userPaused=!1;let b=(a=document.getElementById(`adthrive-player-icon-play-${this._playerType}`))&&a.nextSibling;b&&this._toggleClass(b,"adthrive-player-icon-hidden");a&&this._toggleClass(a,"adthrive-player-icon-hidden")}_thirdQuartile(a){a=this._getAdRenderDetails(a);this.adThirdQuartile.emit(a)}_pauseAd(a){a&&(this._userPaused=!0);"paused"!==this.state&&this._adsManager.pause()}_playAd(){"playing"!==
this.state&&this._adsManager.resume()}_remove(a=!1){!this._isInstream||a?(this._removePlayer(),this._removeAdsLoaderEvents(),this._adsLoader&&this._adsLoader.destroy(),this._adDisplayContainer&&this._adDisplayContainer.destroy()):this._adsLoader&&this._removeAdsLoaderEvents();this.state="idle";this._adsManager&&this._adsManager.destroy()}_toggleClass(a,b){b=this._castArray(b);b.forEach(c=>{a.classList.contains(c)?a.classList.remove(c):a.classList.add(c)})}_volume(a){a=this._getAdRenderDetails(a);
this.volume.emit(a)}_adsManagerLoaded(a){let b=this._ima,c=new b.AdsRenderingSettings;c.restoreCustomPlaybackStateOnAdBreakComplete=!0;c.enablePreloading=!0;let d=this.size;a=this._adsManager=a.getAdsManager(this._videoElement,c);this._setAdsManagerEvents();try{a.init(this._isInstream?this._adContainer.clientWidth:d[0],this._isInstream?this._adContainer.clientHeight:d[1],b.ViewMode.NORMAL),this._isInstream||a.start(),this.adsManagerLoaded.emit()}catch(e){A.error("VideoPlayer","_adsManagerLoaded",
this._playerType,e)}}_castArray(a){return Array.isArray(a)?a:[a]}_createPauseButton(){let a=document.createElement("DIV");a.classList.add("adthrive-player-icon","adthrive-player-icon-pause");a.id=`adthrive-player-icon-pause-${this._playerType}`;let b=this._createSvg("white",!1);b.appendChild(this._createRect("white","5","18","2.29"));b.appendChild(this._createRect("white","5","18","10.71"));a.addEventListener("click",this._pauseAd.bind(this));a.appendChild(b);return a}_createPlayButton(){let a=document.createElement("DIV");
a.classList.add("adthrive-player-icon","adthrive-player-icon-play","adthrive-player-icon-hidden");a.id=`adthrive-player-icon-play-${this._playerType}`;let b=this._createSvg("white",!1);b.appendChild(this._createPolygon("white","2.29,0 2.29,18 15.71,9"));a.addEventListener("click",this._playAd.bind(this));a.appendChild(b);return a}_createPath(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",b);c.setAttribute("fill",a);return c}_createPolygon(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg",
"polygon");c.setAttribute("points",b);c.setAttribute("fill",a);return c}_createRect(a,b,c,d,e,f){let g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("x",d);g.setAttribute("height",c);g.setAttribute("width",b);g.setAttribute("fill",a);e&&g.setAttribute("y",e);f&&g.setAttribute("transform",f);return g}_createSvg(a,b){let c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("focusable",`${b}`);c.setAttribute("width","18");c.setAttribute("height",
"18");c.setAttribute("viewBox","0 0 18 18");c.setAttribute("fill",a);return c}_createVolumeSlider(){let a=document.createElement("DIV");a.className="adthrive-player-volume-control adthrive-player-icon-hidden";let b=document.createElement("INPUT");b.setAttribute("type","range");b.setAttribute("min","0");b.setAttribute("max","100");b.setAttribute("step","1");b.addEventListener("input",this._volumeChange.bind(this),!1);a.appendChild(b);return a}_createVolumeMutedButton(){let a=document.createElement("DIV");
a.classList.add("adthrive-player-icon","adthrive-player-icon-volume-muted");this.muted||a.classList.add("adthrive-player-icon-hidden");let b=this._createSvg("white",!1);b.appendChild(this._createPath("white","M16.45,9.02c0,1.64-0.57,2.97-1.33,4.03l1.2,1.15C17.29,12.94,18,11.26,18,9.04c0-6.95-6.96-8.7-6.96-8.7v1.32C11.04,1.66,16.45,3.96,16.45,9.02z"));b.appendChild(this._createPath("white","M13.27,14.94c-1.18,0.91-2.23,1.33-2.23,1.33v1.44c0,0,1.68-0.42,3.39-1.67L13.27,14.94z"));b.appendChild(this._createRect("white",
"1.71","22.61","8.15","-2.28","matrix(0.6917 -0.7222 0.7222 0.6917 -3.7421 9.2833)"));b.appendChild(this._createPath("white","M12.98,11c0.31-0.55,0.52-1.2,0.52-1.98c0-2.95-2.99-4.24-2.99-4.24v3.86L12.98,11z"));b.appendChild(this._createPath("white","M10.52,12.3v0.86c0,0,0.24-0.1,0.58-0.3L10.52,12.3z"));b.appendChild(this._createPolygon("white","9.21,7.4 9.24,0.74 5.82,4.15"));b.appendChild(this._createPolygon("white","3.69,5.77 0.06,5.77 0,12.07 4.14,12.07 9.18,17.11 9.2,11.04"));a.addEventListener("click",
this._toggleVolume.bind(this));a.appendChild(b);return a}_createVolumeUnMutedButton(){let a=document.createElement("DIV");a.classList.add("adthrive-player-icon","adthrive-player-icon-volume-unmuted");this.muted&&a.classList.add("adthrive-player-icon-hidden");let b=this._createSvg("white",!1);b.appendChild(this._createPolygon("white","9.18,17.11 4.14,12.07 0,12.07 0.06,5.77 4.2,5.77 9.24,0.74"));b.appendChild(this._createPath("white","M11.04,0.34c0,0,6.96,1.75,6.96,8.7s-6.96,8.67-6.96,8.67v-1.44c0,0,5.42-2.18,5.42-7.25s-5.42-7.37-5.42-7.37V0.34z"));
b.appendChild(this._createPath("white","M10.52,4.79c0,0,2.99,1.28,2.99,4.24s-2.99,4.14-2.99,4.14V4.79z"));a.addEventListener("click",this._toggleVolume.bind(this));a.appendChild(b);return a}_enablePlayerAdControls(){if(!(0<this._container.getElementsByClassName("adthrive-player-ad-controls").length)){var a=document.createElement("DIV");a.className="adthrive-player-ad-controls";var b=document.createElement("DIV");b.className="adthrive-player-ad-controls-play";var c=document.createElement("DIV");c.className=
"adthrive-player-ad-controls-volume";c.addEventListener("mouseenter",this._toggleVolumeControl.bind(this));c.addEventListener("mouseleave",this._toggleVolumeControl.bind(this));var d=this._createPlayButton(),e=this._createPauseButton(),f=this._createVolumeMutedButton(),g=this._createVolumeUnMutedButton(),h=this._createVolumeSlider();b.appendChild(d);b.appendChild(e);c.appendChild(f);c.appendChild(g);c.appendChild(h);a.appendChild(b);a.appendChild(c);this._adContainer.appendChild(a);this._visibilityListener=
this._eventProxy.pageVisibility.on(this.handlePageVisibilityChange.bind(this))}}_importIMAScript(){return window.google&&window.google.ima?new Promise(a=>{a(!0)}):nb(this._imaLibraryEnpoint,!1,!1,!0)}_injectPlayer(){var a=this._container;let b=this._videoElement,c=this._playerPosition,d=this._adContainer;var e=this._ima;let f=this._playerType;var g=this.size;let h=this._videoContentSource;a.id=`adthrive-${f}-container`;d.id=`adthrive-${f}-ad-container`;d.className="adthrive-player-ad-container";if("outstream"===
f||"stickyoutstream"===f)this._pageElement.classList.add("adthrive-video-stickyoutstream-new-player"),a.className=`adthrive-${f}-container adthrive-player-idle`,a.style.width=`${g[0]}px`,a.style.height=`${g[1]}px`,b.style.width=`${g[0]}px`,b.style.height=`${g[1]}px`,d.style.width=`${g[0]}px`,d.style.height=`${g[1]}px`,a.appendChild(b),a.appendChild(d),b.load();this._isInstream&&(this._initVideoListeners(),a.className=`adthrive-${f}-player-container`,"auto-injected"===this._playerType&&a.classList.add("adthrive-collapse-player"),
c.classList.add("adthrive-player-position","adthrive-player-fixed-ratio"),g=document.createElement("div"),g.id=`adthrive-${f}-loading-spinner`,g.className="active",this._videoTitleOverlayContainer.id="adthrive-title-overlay",this._videoTitleOverlayContainer.className="adthrive-video-text",this._videoTitleDiv.id="adthrive-video-title-text",this._videoDescriptionDiv.id="adthrive-video-description-text",document.createElement("DIV").id="adthrive-video-play-button",this._videoTitleOverlayContainer.appendChild(this._videoTitleDiv),
this._isMobile?this._playerPosition.classList.add("adthrive-player-position-mobile"):this._videoTitleOverlayContainer.appendChild(this._videoDescriptionDiv),c.appendChild(this._videoTitleOverlayContainer),a.appendChild(c),d.classList.add("adthrive-player-ad-container-idle"),d.appendChild(g),b.classList.add("adthrive-player-video"),c.appendChild(b),c.appendChild(d),a.appendChild(c),d.style.width="100%",d.style.height="100%");b.setAttribute("webkit-playsinline","true");b.setAttribute("playsinline",
"true");h&&(b.src=h);this._pageElement.appendChild(a);window.google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0);a=this._adDisplayContainer=new e.AdDisplayContainer(d,b);a.initialize();a=(this._adsLoader=new e.AdsLoader(a)).getSettings();a.setNumRedirects(this._config.video.maxRedirect);a.setVpaidMode(e.ImaSdkSettings.VpaidMode.ENABLED);a.setVpaidMode(e.ImaSdkSettings.VpaidMode.INSECURE);e=this._adsRequest=new e.AdsRequest;this._autoplay&&(e.setAdWillAutoPlay(!0),e.setAdWillPlayMuted(!0))}_initVideoListeners(){this.attachEventHandlers([{target:this._videoElement,
event:"ended",handler:this._ended},{target:this._videoElement,event:"error",handler:this._error},{target:this._videoElement,event:"seeking",handler:this._seeking},{target:this._videoElement,event:"seeked",handler:this._seeked},{target:this._videoElement,event:"loadedmetadata",handler:this._loadedMetaData},{target:this._videoElement,event:"pause",handler:this._pause},{target:this._videoElement,event:"play",handler:this._play},{target:this._videoElement,event:"click",handler:this._playerClick},{target:this._videoElement,
event:"volumechange",handler:this._playerVolumeChange},{target:this._videoElement,event:"timeupdate",handler:this._timeupdate}])}reInitIMA(){let a=this._adsRequest=new this._ima.AdsRequest;this._autoplay&&(a.setAdWillAutoPlay(!0),a.setAdWillPlayMuted(!0))}_getAdRenderDetails(a){var b=this._adsRequest;let c=b.adTagUrl;b=b.adsResponse;if(a&&a.getAd){var d=a.getAd();var e=Object.keys(d)||[];d=d&&e.length&&d[e[0]]}e=a&&Object.keys(a)||[];d=d||e.reduce((f,g)=>{a[g]&&"object"===typeof a[g]&&!Array.isArray(a[g])&&
(f=Object.keys(a[g]),f&&f.length&&a[g][f[0]])},{});return{ad:d,userRequestContext:{...(c&&{adTagUrl:c}),...(b&&{vastXml:b})}}}_removeAdsLoaderEvents(){this._isInstream&&this.detachEventHandlers([{target:this._adsLoader,event:ta.ADS_MANAGER_LOADED,handler:this._adsManagerLoaded},{target:this._adsLoader,event:ta.AD_ERROR,handler:this._adError}]);this._visibilityListener&&this._visibilityListener()}_removePlayer(){let a=this._container;a&&a.parentElement&&a.parentElement.removeChild(a)}_setAdsManagerEvents(){this.attachEventHandlers([{target:this._adsManager,
event:ta.AD_ERROR,handler:this._adError},{target:this._adsManager,event:ta.ALL_ADS_COMPLETED,handler:this._allAdsComplete},{target:this._adsManager,event:ta.CLICK,handler:this._click},{target:this._adsManager,event:ta.COMPLETE,handler:this._adComplete},{target:this._adsManager,event:ta.CONTENT_PAUSE_REQUESTED,handler:this._contentPauseRequested},{target:this._adsManager,event:ta.CONTENT_RESUME_REQUESTED,handler:this._contentResumeRequested},{target:this._adsManager,event:ta.FIRST_QUARTILE,handler:this._firstQuartile},
{target:this._adsManager,event:ta.IMPRESSION,handler:this._adImpression},{target:this._adsManager,event:ta.LOADED,handler:this._adLoaded},{target:this._adsManager,event:ta.MIDPOINT,handler:this._midpoint},{target:this._adsManager,event:ta.PAUSED,handler:this._paused},{target:this._adsManager,event:ta.RESUMED,handler:this._resumed},{target:this._adsManager,event:ta.STARTED,handler:this._adStarted},{target:this._adsManager,event:ta.THIRD_QUARTILE,handler:this._thirdQuartile},{target:this._adsManager,
event:ta.VOLUME_CHANGED,handler:this._volume},{target:this._adsManager,event:ta.AD_PROGRESS,handler:this._adProgress},{target:this._adsManager,event:ta.SKIPPED,handler:this._adSkipped}])}_toggleVolume(a){a=a.target;let b=a.nextElementSibling,c=a.previousElementSibling,d=this._adsManager,e=this._toggleClass.bind(this);this.muted?(this.volumeLevel=.5,d.setVolume(this.volumeLevel),this.muted=!1,a&&b&&(e(a,"adthrive-player-icon-hidden"),e(b,"adthrive-player-icon-hidden"))):(this.volumeLevel=0,d.setVolume(this.volumeLevel),
this.muted=!0,a&&c&&(e(a,"adthrive-player-icon-hidden"),e(c,"adthrive-player-icon-hidden")))}_toggleVolumeControl(a){(a=(a=a.target)&&a.lastElementChild)&&this._toggleClass(a,"adthrive-player-icon-hidden")}trimEventData(a){var b,c;a={...a};let d=a.ima&&a.ima.ad;(null===a||void 0===a?0:a.tag)&&delete a.tag;d&&d.traffickingParameters&&delete d.traffickingParameters;(null===(c=null===(b=null===a||void 0===a?void 0:a.ima)||void 0===b?void 0:b.userRequestContext)||void 0===c?0:c.adTagUrl)&&delete a.ima.userRequestContext.adTagUrl;
(null===a||void 0===a?0:a.mediaFile)&&delete a.mediaFile;return a}_volumeChange(a){if(a=a.target){if(this.muted){let b=this._toggleClass.bind(this),c=a&&a.parentElement,d=c&&c.previousElementSibling,e=d&&d.previousElementSibling;if(!c||!d||!e)return;b(d,"adthrive-player-icon-hidden");b(e,"adthrive-player-icon-hidden");this.muted=!1}this.volumeLevel=Number(a.value)/100;this._adsManager.setVolume(this.volumeLevel)}}_addSlickDialogListener(){document.addEventListener("slick-auth-dialog-opened",()=>{"paused"!==
this.state&&this._adsManager.pause()});document.addEventListener("slick-auth-dialog-closed",()=>{this._userPaused||this._playAd()})}}class nu extends lq{constructor(a,b,c,d,e,f,g,h,k){super(a,b,c,d,f,h,e,g);this.adId=k;this.adPlaying=!1;this.ready.on(this._handleReady.bind(this));this.adStarted.on(this._handleAdStart.bind(this));this.allAdsCompleted.on(this._handleAdErrorOrComplete.bind(this));this.adError.on(this._handleAdErrorOrComplete.bind(this))}_handleReady(){this.adPlaying=!1;let a=document.getElementsByClassName("adthrive-sticky-outstream-idle")[0],
b=document.getElementsByClassName("adthrive-sticky-outstream-active")[0];a?a.classList.add("adthrive-new-outstream-player"):b&&this._toggleActive()}_handleAdStart(){this.adPlaying=!0;this._toggleActive()}_handleAdErrorOrComplete(){this.adPlaying=!1;this._toggleActive();this._remove()}_toggleActive(){let a=document.getElementsByClassName("adthrive-new-outstream-player")[0];a&&(this._toggleClass(a,"adthrive-sticky-outstream-active"),this._toggleClass(a,"adthrive-sticky-outstream-idle"))}}let uf=class{constructor(a,
b,c,d,e){this._config=a;this._slotManager=b;this._videoEventProxy=c;this._gam=d;this._multistagePrebidAuctionV=e;this._sharedConfig={context:"outstream",mimes:["video/mp4","application/javascript"],api:[2],skip:0,pos:1,protocols:[2,3,5,6,7,8],linearity:1,minduration:0,maxduration:this._config.video.maxDuration,playbackmethod:[2],plcmt:4};this._forcedRefreshLimit=3;this._imaEndpoint="https://imasdk.googleapis.com/js/sdkloader/ima3.js";this._viewableImpressionDelay=1001;this._rendererConfig={renderer:{url:this._imaEndpoint,
render:h=>{this._renderer(h)}}};this._offEvents=[];this._stickyOutstreamShortVideo=!1;let {desktop:f,tablet:g}=this._config.site.breakpoints;this._stickyOutstreamSize="phone"===te(g,f)?[178,100]:[227,150];this._gam.slotRenderEnded.on(h=>this._noFillForceRefresh(h))}callRendererWithUrl(a,b,c=!1){this._callRenderAd({adTagUrl:a},b,c?"stickyoutstream":"outstream",c?this._stickyOutstreamSize:[300,225])}get standardOutstreamConfig(){let a=this._config.video,b={...this._rendererConfig},c=a.outstreamPlacement;
a.setStandardOutstreamBackupRenderer&&(b.renderer.backupOnly=!0);return{playerSize:[640,480],...(c&&{placement:c}),...this._sharedConfig,...b}}get stickyOutstreamConfig(){return{...this._sharedConfig,...this._rendererConfig,startdelay:0,placement:5,playerSize:this._stickyOutstreamSize}}_callRenderer(a,b,c,d=!1){let e=this._slotManager.getSlot(a),f=d?"stickyoutstream":"outstream";e&&d&&(e.stickyOutstreamErrorLogged=!1,e.stickyOutstreamRenderedTimestamp=Date.now());this._callRenderAd(b,a,f,c)}_callRenderAd(a,
b,c,d){let e=document.getElementById(b);e&&(b=new nu(Math.floor(1E8*Math.random()).toString(),"",c,e,this._videoEventProxy,d,!0,this._config,b),this._setPlayerEvents(b,a),b.init())}_handleComplete(a){this._slotManager.getSlot(a);a.includes("StickyOutstream")}_handleErrorEvent(a,b){this._handleOffEvent();a.includes("StickyOutstream")&&(A.error("StickyOutstream","adError",{adId:a,...b}),this._setSlotForceRefresh(a,!0))}_handleAdTimeChange(a,b){let c=this._slotManager.getSlot(b);if(b.includes("StickyOutstream")&&
c){var {duration:d,position:e}=a;a=(d||30)-e;this._stickyOutstreamShortVideo=10>d;var f=("10s1"===this._multistagePrebidAuctionV.result||"10s2"===this._multistagePrebidAuctionV.result)&&!Mb(),g=100>e&&30<e&&e<d;(a=f&&!this._stickyOutstreamShortVideo?0<a&&10>=a||g:0<a&&5>=a||g)&&!c.isRefreshing&&this._setSlotForceRefresh(b)}}_handleAdSkip(a){a.includes("StickyOutstream")&&this._setSlotForceRefresh(a)}_handleOffEvent(){this._offEvents=this._offEvents.filter(a=>{a();return!1})}_renderer(a){let b=a.ad||
a.vastXml,c=-1!==a.adUnitCode.indexOf("StickyOutstream");this._callRenderer(a.sharedBidInUse||a.adUnitCode,b?{adResponse:b}:{adTagUrl:a.vastUrl},c?this._stickyOutstreamSize:[300,225],c)}_setPlayerEvents(a,b){let c=this._offEvents;c.push(a.adError.on(d=>this._handleErrorEvent(a.adId,d)));c.push(a.adCompleted.on(()=>this._handleComplete(a.adId)));c.push(a.ready.on(()=>a.playAd(b)));c.push(a.adProgress.on(d=>this._handleAdTimeChange(d,a.adId)));c.push(a.adSkipped.on(()=>this._handleAdSkip(a.adId)))}_setSlotForceRefresh(a,
b=!1,c=!1){let d=this._slotManager,e=d.getSlot(a),f=a.includes("StickyOutstream");a=!b&&!c;e&&f&&!e.isRefreshing&&(e.isRefreshing=!0,c=c&&void 0!==e.noAdRefreshCount&&e.noAdRefreshCount<this._forcedRefreshLimit,b&&void 0!==e.stickyOutstreamErrorCount&&e.stickyOutstreamErrorCount<this._forcedRefreshLimit?(e.stickyOutstreamErrorCount++,a=!0):c?(e.noAdRefreshCount++,e.setSlotTargetingFlag("fref",[`${e.noAdRefreshCount}`],!0),a=!0):(e.stickyOutstreamErrorCount=0,e.setSlotTargetingFlag("fref",["off"],
!0)),d.updateRefreshTimeout(e,a?this._viewableImpressionDelay:15E3,this._stickyOutstreamShortVideo))}_noFillForceRefresh({event:a,slot:b}){"Video_StickyOutstream"===b.location&&(a.isEmpty?this._setSlotForceRefresh(b.id,!1,!0):(b.noAdRefreshCount=0,b.setSlotTargetingFlag("fref",[`${b.noAdRefreshCount}`],!0)))}};uf=q([y(),t("design:paramtypes",[N,ja,Ub,V,Gc])],uf);let Bj=class extends W{init(){this._key="AdditionalOutstreamUnitsExperiment";this._default=!1}isEnabled(){return super.isEnabled()}};Bj=
q([v("AdditionalOutstreamUnitsExperiment"),y()],Bj);let Cj=class extends W{init(){this._key="OneVideoStream";this._default=!1}};Cj=q([v("OneVideoStreamExperiment"),y()],Cj);let Dj=class extends X{init(){this._key="SuppressOutreamSlowConnection"}};Dj=q([v("OutstreamSOCONExperiment"),y()],Dj);let Ej=class extends X{init(){this._key="NativeContentRatio"}run(){return super.run()}};Ej=q([v("NativeRatioExperiment"),y()],Ej);let Fj=class extends X{init(){this._key="NativeTitleLength"}get result(){return this._result}};
Fj=q([v("NativeTitleLengthExperiment"),y()],Fj);let Gj=class extends X{init(){this._key="NativeDescriptionLength"}get result(){return this._result}};Gj=q([v("NativeDescriptionLengthExperiment"),y()],Gj);let ou=new Map([["Content",{"11_1":[200,200],"11_2":[300,300],"11_3":[400,400],"11_4":[500,500],"11_5":[600,600],"1911_1":[191,100],"1911_2":[382,200],"1911_3":[573,300],"1911_4":[764,400],"1911_5":[955,500],"21_1":[200,100],"21_2":[300,150],"21_3":[400,200],"21_4":[500,250],"21_5":[600,300],"169_1":[160,
90],"169_2":[320,180],"169_3":[480,270],"169_4":[640,360],"169_5":[800,450],"43_1":[200,150],"43_2":[400,300],"43_3":[600,450],"43_4":[800,600],"43_5":[1E3,800]}]]),gb=class{constructor(a,b,c,d,e,f,g,h){this._config=a;this._gam=b;this._outstream=c;this._oneVideoStreamExperiment=d;this._soconExperiment=e;this._nativeExperiment=f;this.additionalOutstreamUnitsExperiment=!1;this._standardOutstreamSlots=new Set(["Content_1","Below_Post","Video_StickyOutstream_1"]);this._nativeEligibleSlots=["Content"];
this.native={size:[300,300],titleLength:g.result||20,descriptionLength:h.result||0}}runOneStreamExperiment(){let a=S.resolve(Bj);this._gam.setTargeting({key:"abgroup",value:this._config.abGroup.groups.join(",")});(this.additionalOutstreamUnitsExperiment=a.result)&&["Content_3","Content_5","Recipe_1"].forEach(b=>{this._standardOutstreamSlots.add(b)})}isOutstreamAllowed(){return!this._oneVideoStreamExperiment.result||!this._config.video.hasJwPlayer}isSlowConnection(){var a;let b=null!==(a=this._soconExperiment.result)&&
void 0!==a?a:0;return void 0!==this._config.context.downlink?this._config.context.downlink<=b:!1}outstreamEnabled(a){var b=a.viewability;let c="Video_StickyOutstream"===a.location;b=1<=a.refreshCount||.5<=b||c;let d=!c&&this.isSlowConnection();a=(this._config.adTypes.outstreamEnabled||c)&&this.outstreamSlots.has(a.placementMapName)&&this.isOutstreamAllowed()&&!d;return{outstreamCapable:a,currentlyActive:a&&b}}nativeEnabled(a){return this._config.adTypes.has(ca()?`nativeMobile${a.location}`:`nativeDesktop${a.location}`)&&
this._nativeEligibleSlots.includes(a.location)}getMediaType(a,b={}){let c={},{slot:d,video:e}=a;e&&this._config.video.instreamAdUnits.has(e.name)&&this._config.video.plcmtUnits.has(e.name)?(b=this.getInstreamConfig(e),c.video=b):d&&(a={sizes:d.sizes,...(d.isHighlyViewable()&&{pos:1})},b.banner&&(c.banner=a),b.outstream&&(c.video="Video_StickyOutstream"!==d.location?this._outstream.standardOutstreamConfig:this._outstream.stickyOutstreamConfig),b.native&&(c.native=this._getNativeConfig(d.location)));
return c}get outstreamSlots(){return this._standardOutstreamSlots}getInstreamConfig(a){var b,c,d;return{context:"instream",playerSize:a.size,mimes:this._config.video.mimeType,protocols:null===(b=this._config.video.videoProtocols)||void 0===b?void 0:b.protocols,...((null===(c=this._config.video.plcmtUnits)||void 0===c?void 0:c.get(a.name))&&{plcmt:this._config.video.plcmtUnits.get(a.name)}),maxduration:this._config.video.maxDuration,...((null===(d=this._config.video.playbackmethod)||void 0===d?void 0:
d.get(a.name))&&{playbackmethod:this._config.video.playbackmethod.get(a.name)}),...(a.collapsible&&{playbackend:3}),linearity:1,api:this._config.video.apiValue,w:a.size[0],h:a.size[1],pos:this._config.video.position.id,minduration:1,startdelay:0,placement:1,skip:0}}_getNativeSize(a){let b=this._nativeExperiment;a=ou.get(a);return(null===a||void 0===a?void 0:a[b.result||"11_2"])||this.native.size}_getNativeConfig(a){let b=this.native;a=this._getNativeSize(a);return{ortb:{ver:"1.2",plcmttype:1,eventtrackers:[{event:1,
methods:[1,2]}],assets:[{id:1,required:1,title:{len:b.titleLength}},{id:2,required:1,img:{type:3,wmin:a[0],hmin:a[1]}},{id:3,required:1,img:{type:1,wmin:20,hmin:20}},{id:4,required:1,data:{type:1}},{id:5,required:1,data:{type:2,...(b.descriptionLength&&{len:b.descriptionLength})}}]}}}};gb=q([y(),t("design:paramtypes",[N,V,uf,Cj,Dj,Ej,Fj,Gj])],gb);let Hj=class extends ma{constructor(a,b,c){super(a);this._mediaType=b;this._rfcodes=c;this.bidderConfig=this._config.partners.getBidderConfig(l.AppNexus);
this.videoCreativeIds=[["138323232312",l.AppNexus],["138323908966",l.AppNexus],["138323900998",l.AppNexus],["138323900548",l.AppNexus],["138323457386",l.AppNexus],["138323908963",l.AppNexus],["138323908960",l.AppNexus],["138323901004",l.AppNexus],["138323901001",l.AppNexus],["138323521089",l.AppNexus],["138323457473",l.AppNexus],["138323908969",l.AppNexus],["138323908957",l.AppNexus],["138323908954",l.AppNexus],["138323900995",l.AppNexus],["138323521092",l.AppNexus]];this._keywords={keywords:{...(this._config.site.filteredSensitiveCategories.length&&
{sens:this._config.site.filteredSensitiveCategories}),bucket:[this._config.context.bucket],Chrome:`${ic()}`,Mobile:(!!(navigator.userAgent&&-1<navigator.userAgent.search(/Mobi/i))).toString(),...(this._config.site.verticals.length&&{verticals:this._config.site.verticals}),mcmp:this._rfcodes.getAllMcmps()}};this.outstreamType=ca()?"outstreamMobile":"outstreamDesktop";this._map=new Map([["Below_Post",[{placementId:13036386}]],["Content_1",[{placementId:13036388},{placementId:16808429,adType:this.outstreamType,
playback_method:["auto_play_sound_off"]}]],["Content_2",[{placementId:13036389}]],["Content_3",[{placementId:13036391}]],["Content_4",[{placementId:13036393}]],["Content_5",[{placementId:13036394}]],["Content_6",[{placementId:13036396}]],["Content_7",[{placementId:13036398}]],["Content_8",[{placementId:13036399}]],["Content_9",[{placementId:13036400}]],["Footer_1",[{placementId:13036401}]],["Header_1",[{placementId:13036404}]],["Header_2",[{placementId:13036405}]],["Interstitial_1",[{placementId:21240886}]],
["Recipe_1",[{placementId:13036406}]],["Recipe_2",[{placementId:13036407}]],["Recipe_3",[{placementId:15014787}]],["Recipe_4",[{placementId:15998791}]],["Sidebar_1",[{placementId:13036408}]],["Sidebar_2",[{placementId:13036409}]],["Sidebar_3",[{placementId:13036410}]],["Sidebar_4",[{placementId:13036411}]],["Sidebar_5",[{placementId:13036412}]],["Sidebar_9",[{placementId:13036416}]],["Video_StickyOutstream_1",[{placementId:22366045}]],[M.Video_Collapse_Autoplay_SoundOff,[{placementId:15504193,playback_method:["auto_play_sound_off"]}]],
[M.Video_Coll_SOff_Smartphone,[{placementId:15504209,playback_method:["auto_play_sound_off"]}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{placementId:15504166,playback_method:["click_to_play"]}]],[M.Video_Individual_Autoplay_SOff,[{placementId:17947919,playback_method:["auto_play_sound_off"]}]]]);this._playbackmethodMap=new Map([[3,"click_to_play"],[6,"auto_play_sound_off"]])}get enabled(){return this._config.partners.display.get(l.AppNexus)}get videoEnabled(){return this._config.partners.video.get(l.AppNexus)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._map.get(a.placementMapName).filter(({adType:b})=>
!b||this._config.adTypes.has(b)).map(({placementId:b})=>({bidder:this.name,...this._addBidLabel(a.placementMapName),params:{...this._keywords,allowSmallerSizes:this._config.adOptions.allowSmallerAdSizes,placementId:b,...(a.isHighlyViewable()&&{position:"above"})}}))}getOutstreamSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._map.get(a.placementMapName).filter(({adType:b})=>!b||this._config.adTypes.has(b)).map(({placementId:b,playback_method:c})=>({bidder:this.name,...this._addBidLabel(a.placementMapName,
void 0,{outstreamActive:"Video_StickyOutstream"!==a.location}),params:{...this._keywords,allowSmallerSizes:this._config.adOptions.allowSmallerAdSizes,placementId:b,video:{playback_method:c},...(a.isHighlyViewable()&&{position:"above"})}}))}getVideoSlotBidRequests(a){var b;if(this._map.has(a.name))return[{bidder:this.name,params:{...this._keywords,placementId:this._map.get(a.name)[0].placementId,position:this._config.video.position.name,video:{mimes:this._config.video.mimeType,...((null===(b=this._config.video.playbackmethod)||
void 0===b?void 0:b.get(a.name))&&{playback_method:this._playbackmethodMap.get(this._config.video.playbackmethod.get(a.name)[0])}),frameworks:this._config.video.apiValue}}}]}updateBidParams(a){this._addPositionParam(a,"above")}};Hj=q([v("AppNexusBidder"),H(),t("design:paramtypes",[N,gb,nf])],Hj);let Ij=class extends ma{constructor(a,b){super(a);this._colossusExperiment=b;this.adapterName="colossusssp";this.bidderConfig=this._config.partners.getBidderConfig(l.Colossus);this.videoCreativeIds=[["138384629372",
l.Colossus],["138384629375",l.Colossus],["138384699576",l.Colossus],["138384629339",l.Colossus],["138384699561",l.Colossus],["138384699546",l.Colossus],["138384629351",l.Colossus],["138384629381",l.Colossus],["138384629366",l.Colossus],["138384629378",l.Colossus],["138384629384",l.Colossus],["138384699564",l.Colossus],["138384629363",l.Colossus],["138384699582",l.Colossus],["138384699579",l.Colossus]];this._desktopBannerMap=new Map([["Below_Post",{id:"318",size:[300,250]}],["Content",{id:"319",size:[300,
250]}],["Content_1",{id:"320",size:[300,250]}],["Content_2",{id:"321",size:[300,250]}],["Content_3",{id:"322",size:[300,250]}],["Content_4",{id:"323",size:[300,250]}],["Content_5",{id:"324",size:[300,250]}],["Content_6",{id:"325",size:[300,250]}],["Content_7",{id:"326",size:[300,250]}],["Content_8",{id:"327",size:[300,250]}],["Content_9",{id:"328",size:[300,250]}],["Footer_1",{id:"329",size:[728,90]}],["Header_1",{id:"330",size:[728,90]}],["Header_2",{id:"331",size:[728,90]}],["Recipe_1",{id:"332",
size:[300,250]}],["Recipe_2",{id:"333",size:[300,250]}],["Recipe_3",{id:"334",size:[300,250]}],["Recipe_4",{id:"335",size:[300,250]}],["Recipe_5",{id:"336",size:[300,250]}],["Sidebar_1",{id:"337",size:[300,250]}],["Sidebar_2",{id:"338",size:[300,250]}],["Sidebar_3",{id:"339",size:[300,250]}],["Sidebar_4",{id:"340",size:[300,250]}],["Sidebar_5",{id:"341",size:[300,250]}],["Sidebar_9",{id:"342",size:[300,250]}]]);this._mobileBannerMap=new Map([["Below_Post",{id:"343",size:[300,250]}],["Content",{id:"344",
size:[300,250]}],["Content_1",{id:"345",size:[300,250]}],["Content_2",{id:"346",size:[300,250]}],["Content_3",{id:"347",size:[300,250]}],["Content_4",{id:"348",size:[300,250]}],["Content_5",{id:"349",size:[300,250]}],["Content_6",{id:"350",size:[300,250]}],["Content_7",{id:"351",size:[300,250]}],["Content_8",{id:"352",size:[300,250]}],["Content_9",{id:"353",size:[300,250]}],["Footer_1",{id:"354",size:[320,50]}],["Header_1",{id:"355",size:[320,50]}],["Header_2",{id:"356",size:[320,50]}],["Recipe_1",
{id:"357",size:[300,250]}],["Recipe_2",{id:"358",size:[300,250]}],["Recipe_3",{id:"359",size:[300,250]}],["Recipe_4",{id:"360",size:[300,250]}],["Recipe_5",{id:"361",size:[300,250]}],["Sidebar_1",{id:"362",size:[300,250]}],["Sidebar_2",{id:"363",size:[300,250]}],["Sidebar_3",{id:"364",size:[300,250]}],["Sidebar_4",{id:"365",size:[300,250]}],["Sidebar_5",{id:"366",size:[300,250]}],["Sidebar_9",{id:"367",size:[300,250]}]]);this._bannerMap={desktop:this._desktopBannerMap,mobile:this._mobileBannerMap};
this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,"368"],[M.Video_Coll_SOff_Smartphone,"369"],[M.Video_In_Post_ClicktoPlay_SoundOn,"370"],[M.Video_Individual_Autoplay_SOff,"371"]]);a=this._bannerMap;this._map=ca()?a.mobile:a.desktop}get enabled(){return this._config.partners.display.get(l.Colossus)&&"server"!==this._colossusExperiment.result}get videoEnabled(){return this._config.partners.video.get(l.Colossus)&&"server"!==this._colossusExperiment.result}getBannerSlotBidRequests(a){let b=
this._map.get(a.placementMapName);if(b&&a.hasSize(b.size))return[{bidder:this.name,params:{group_id:b.id,traffic:"banner"},...this._addBidLabel(a.placementMapName)}]}getVideoSlotBidRequests(a){if(this._videoMap.has(a.name))return[{bidder:this.name,params:{group_id:this._videoMap.get(a.name),traffic:"video"}}]}};Ij=q([v("ColossusBidder"),H(),t("design:paramtypes",[N,pd])],Ij);let Jj=class extends ma{constructor(a){super(a);this.adapterName="colossus";this.bidderConfig=this._config.partners.getBidderConfig(l.ColossusServer);
this.videoCreativeIds=[["138399171431",l.ColossusServer],["138396598194",l.ColossusServer],["138397072123",l.ColossusServer],["138397072117",l.ColossusServer],["138397070791",l.ColossusServer],["138396598191",l.ColossusServer],["138397072120",l.ColossusServer],["138397070788",l.ColossusServer],["138396598197",l.ColossusServer],["138396598188",l.ColossusServer],["138396598158",l.ColossusServer],["138396598152",l.ColossusServer],["138397073191",l.ColossusServer],["138397072102",l.ColossusServer],["138396598200",
l.ColossusServer],["138396598155",l.ColossusServer]];this._desktopBannerMap=new Map([["Below_Post",{id:"455",size:[300,250]}],["Content",{id:"456",size:[300,250]}],["Content_1",{id:"457",size:[300,250]}],["Content_2",{id:"458",size:[300,250]}],["Content_3",{id:"459",size:[300,250]}],["Content_4",{id:"460",size:[300,250]}],["Content_5",{id:"461",size:[300,250]}],["Content_6",{id:"462",size:[300,250]}],["Content_7",{id:"463",size:[300,250]}],["Content_8",{id:"464",size:[300,250]}],["Content_9",{id:"465",
size:[300,250]}],["Footer_1",{id:"466",size:[728,90]}],["Header_1",{id:"467",size:[728,90]}],["Header_2",{id:"468",size:[728,90]}],["Recipe_1",{id:"469",size:[300,250]}],["Recipe_2",{id:"470",size:[300,250]}],["Recipe_3",{id:"471",size:[300,250]}],["Recipe_4",{id:"472",size:[300,250]}],["Recipe_5",{id:"473",size:[300,250]}],["Sidebar_1",{id:"474",size:[300,250]}],["Sidebar_2",{id:"475",size:[300,250]}],["Sidebar_3",{id:"476",size:[300,250]}],["Sidebar_4",{id:"477",size:[300,250]}],["Sidebar_5",{id:"478",
size:[300,250]}],["Sidebar_9",{id:"479",size:[300,250]}]]);this._mobileBannerMap=new Map([["Below_Post",{id:"481",size:[300,250]}],["Content",{id:"482",size:[300,250]}],["Content_1",{id:"483",size:[300,250]}],["Content_2",{id:"484",size:[300,250]}],["Content_3",{id:"485",size:[300,250]}],["Content_4",{id:"486",size:[300,250]}],["Content_5",{id:"487",size:[300,250]}],["Content_6",{id:"488",size:[300,250]}],["Content_7",{id:"489",size:[300,250]}],["Content_8",{id:"490",size:[300,250]}],["Content_9",
{id:"491",size:[300,250]}],["Footer_1",{id:"492",size:[320,50]}],["Header_1",{id:"493",size:[320,50]}],["Header_2",{id:"494",size:[320,50]}],["Recipe_1",{id:"495",size:[300,250]}],["Recipe_2",{id:"496",size:[300,250]}],["Recipe_3",{id:"497",size:[300,250]}],["Recipe_4",{id:"498",size:[300,250]}],["Recipe_5",{id:"499",size:[300,250]}],["Sidebar_1",{id:"500",size:[300,250]}],["Sidebar_2",{id:"501",size:[300,250]}],["Sidebar_3",{id:"502",size:[300,250]}],["Sidebar_4",{id:"503",size:[300,250]}],["Sidebar_5",
{id:"504",size:[300,250]}],["Sidebar_9",{id:"505",size:[300,250]}]]);this._bannerMap={desktop:this._desktopBannerMap,mobile:this._mobileBannerMap};this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,"450"],[M.Video_Coll_SOff_Smartphone,"451"],[M.Video_In_Post_ClicktoPlay_SoundOn,"452"],[M.Video_Individual_Autoplay_SOff,"453"]]);a=this._bannerMap;this._map=ca()?a.mobile:a.desktop}get enabled(){return this._config.prebid.s2s.bidders.includes(l.ColossusServer)&&this._config.partners.display.get(l.Colossus)}get videoEnabled(){return this._config.prebid.s2s.bidders.includes(l.ColossusServer)&&
this._config.partners.video.get(l.Colossus)}getBannerSlotBidRequests(a){let b=this._map.get(a.placementMapName);if(b&&a.hasSize(b.size))return[{bidder:this.name,params:{groupId:b.id},...this._addBidLabel(a.placementMapName,this.serverBidderName)}]}getVideoSlotBidRequests(a){if(this._videoMap.has(a.name))return[{bidder:this.name,params:{groupId:this._videoMap.get(a.name)}}]}};Jj=q([v("ColossusServerBidder"),H(),t("design:paramtypes",[N])],Jj);let Kj=class extends ma{constructor(a){super(a);this.bidderConfig=
this._config.partners.getBidderConfig(l.Conversant);this._siteId="203587";this._map=new Map([["Below_Post",{tag_id:"8c6e3091"}],["Content",{tag_id:"f4f67b17"}],["Content_1",{tag_id:"9cbc79fd"}],["Content_2",{tag_id:"8fdfa3de"}],["Content_3",{tag_id:"ff6c383c"}],["Content_4",{tag_id:"972f654c"}],["Content_5",{tag_id:"bd1aadb5"}],["Content_6",{tag_id:"ce4f5d6e"}],["Content_7",{tag_id:"d85e90b"}],["Content_8",{tag_id:"f02f4ba"}],["Content_9",{tag_id:"2c01cbc"}],["Footer_1",{tag_id:"1b2dec1"}],["Header_1",
{tag_id:"44d21b5"}],["Header_2",{tag_id:"3488dd9"}],["Recipe_1",{tag_id:"f6cf917"}],["Recipe_2",{tag_id:"31d9c43"}],["Recipe_3",{tag_id:"a7b4d19"}],["Recipe_4",{tag_id:"245c673"}],["Recipe_5",{tag_id:"0bf3576"}],["Sidebar_1",{tag_id:"bf73d45"}],["Sidebar_2",{tag_id:"0a57500"}],["Sidebar_3",{tag_id:"cceddcd"}],["Sidebar_4",{tag_id:"872fffd4"}],["Sidebar_5",{tag_id:"a7653e4"}],["Sidebar_9",{tag_id:"517df454"}]])}get enabled(){return this._config.partners.display.get(l.Conversant)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return[{bidder:this.name,
params:{tag_id:this._map.get(a.placementMapName).tag_id,site_id:this._siteId},...this._addBidLabel(a.placementMapName)}]}};Kj=q([v("ConversantBidder"),H(),t("design:paramtypes",[N])],Kj);let Lj=class extends ma{constructor(a,b,c){super(a);this._prebidMethods=b;this._mediaType=c;this.bidderConfig=this._config.partners.getBidderConfig(l.Criteo);this.videoCreativeIds=[["138381583896",l.Criteo],["138381548372",l.Criteo],["138381548387",l.Criteo],["138381548384",l.Criteo],["138381548525",l.Criteo],["138381548522",
l.Criteo],["138381548516",l.Criteo],["138381548513",l.Criteo],["138382062244",l.Criteo],["138382062241",l.Criteo],["138382062238",l.Criteo],["138382062235",l.Criteo],["138382062232",l.Criteo],["138382062226",l.Criteo],["138382062223",l.Criteo],["138381584697",l.Criteo]];this.settings={storageAllowed:["html5"]};this._params={banner:{networkId:3927},outstream:{zoneId:1709027},stickyOutstream:{zoneId:1709026}};this._map=new Set("Below_Post Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9 Video_StickyOutstream_1".split(" "));
this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,"1629631"],[M.Video_Coll_SOff_Smartphone,"1629630"],[M.Video_In_Post_ClicktoPlay_SoundOn,"1629629"],[M.Video_Individual_Autoplay_SOff,"1629401"]]);this._prebidMethods.setConfig({criteo:{fastBidVersion:"none"}});"joinAdInterestGroup"in navigator&&this._setInterestGroupIframe().then(d=>{}).catch(d=>{A.error("CriteoBidder","_setInterestGroupIframe",d)})}get enabled(){return this._config.partners.display.get(l.Criteo)}get videoEnabled(){return this._config.partners.video.get(l.Criteo)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName)){var b=
this._params.banner,c=[];c.push({bidder:this.name,...this._addBidLabel(a.placementMapName),params:b});return c}}getOutstreamSlotBidRequests(a){if(this._map.has(a.placementMapName)){var b="Video_StickyOutstream"===a.location,c=b?this._params.stickyOutstream:this._params.outstream,d=[];d.push({bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{outstreamActive:!b}),params:c});return d}}getVideoSlotBidRequests(a){var b;if(this._videoMap.has(a.name))return[{bidder:this.name,params:{zoneId:this._videoMap.get(a.name),
video:{playbackmethod:(null===(b=this._config.video.playbackmethod)||void 0===b?void 0:b.get(a.name))||[]}}}]}async _setInterestGroupIframe(){let a=document.getElementById("criteo-ig");return a?a:new Promise((b,c)=>{try{let d=document.createElement("iframe");d.id="criteo-ig";d.style.display="none";d.onload=()=>{b(d)};d.onerror=()=>{c("Interest Group iframe loading failed")};d.src="https://gpsb-reims.criteo.com/paapi/join_ig?advertiser_id=500002_500329&ig_name=r6NnpiEx";document.body.appendChild(d)}catch(d){c(d)}})}};
Lj=q([v("CriteoBidder"),H(),t("design:paramtypes",[N,ia,gb])],Lj);let Mj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.GumGum);this.videoCreativeIds=[["138330842944",l.GumGum],["138330432527",l.GumGum],["138330466869",l.GumGum],["138330842389",l.GumGum],["138330842452",l.GumGum],["138330432530",l.GumGum],["138330432548",l.GumGum],["138330432551",l.GumGum],["138330466908",l.GumGum],["138330842464",l.GumGum],["138330842470",l.GumGum],["138330466872",
l.GumGum],["138330842458",l.GumGum],["138330842461",l.GumGum],["138330842467",l.GumGum],["138330842455",l.GumGum]];this._zoneIds={client:"g95nznmj",s2s:{desktop:"0yo5ozig",tablet:"0yo5ozig",phone:"nedjcoh9"},expandableFooter:{client:"klpfgzhj",s2s:"wspaezyl"}};this._map=new Map([["Interstitial_1",[{slotId:110743}]],["Content_1",[{slotId:913891}]],["Content_2",[{slotId:913892}]],["Content_3",[{slotId:913893}]],["Content_4",[{slotId:913894}]],["Content_5",[{slotId:913895}]],["Content_6",[{slotId:913896}]],
["Content_7",[{slotId:913897}]],["Content_8",[{slotId:913898}]],["Content_9",[{slotId:913899}]],["Footer_1",[]]]);this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,"glpmwixo"],[M.Video_Coll_SOff_Smartphone,"5zl85htf"],[M.Video_Individual_Autoplay_SOff,"8jzhuyj5"]]);this.isExpandableFooter=!1;this._animatedFooterEnabled=this._config.adTypes.animatedFooter;this._interstitialEnabled=this._config.adOptions.interstitial.prebid;a=ca()?"phone":/Tablet|iPad|Playbook|Nook|webOS|Kindle|Android (?!.*Mobile).*Safari/i.test(navigator.userAgent)?
"tablet":"desktop";this._device=a;this._contextualAuctionParams={zone:this._config.prebid.s2s.bidders.includes(this.name)?this._zoneIds.s2s[this._device]:this._zoneIds.client};this.isExpandableFooter=this._config.adTypes.has("expandableFooter")}get enabled(){return this._config.partners.display.get(l.GumGum)}get videoEnabled(){return this._config.partners.video.get(l.GumGum)}getBannerSlotBidRequests(a){let b=this._map.get(a.placementMapName)||this._map.get(a.location),c="Footer"===a.location&&this._animatedFooterEnabled,
d="Content"===a.location,e=this._interstitialEnabled&&"Interstitial"===a.location;if(b){let f=[];c&&f.push({bidder:this.name,params:{...this._contextualAuctionParams},...this._addBidLabel(a.placementMapName)});(e||d)&&b.filter(({size:g})=>!g||a.hasSize(g)).forEach(g=>{f.push({bidder:this.name,params:{...this._contextualAuctionParams,...(g.slotId&&!this._config.prebid.s2s.bidders.includes(this.name)&&{slot:g.slotId})},...this._addBidLabel(a.placementMapName)})});c&&this.isExpandableFooter&&f.push({bidder:this.name,
params:{zone:this._config.prebid.s2s.bidders.includes(this.name)?this._zoneIds.expandableFooter.s2s:this._zoneIds.expandableFooter.client}});return f}}getVideoSlotBidRequests(a){if(this._videoMap.has(a.name))return[{bidder:this.name,params:{...(this._config.prebid.s2s.bidders.includes(this.name)&&{...this._contextualAuctionParams}),video:this._videoMap.get(a.name)}}]}};Mj=q([v("GumGumBidder"),H(),t("design:paramtypes",[N])],Mj);let Nj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.ImproveDigitalServer);
this.adapterName=l.ImproveDigital;this.serverBidderName=l.ImproveDigitalServer;this.gvlid=253;this._publisherId=2250;this._displayPlacementId=22983142;this._stickyOutstreamPlacementId=23006106;this.videoCreativeIds=[["138436972580",l.ImproveDigitalServer],["138436972724",l.ImproveDigitalServer],["138436972727",l.ImproveDigitalServer],["138436972736",l.ImproveDigitalServer],["138437681002",l.ImproveDigitalServer],["138437681251",l.ImproveDigitalServer],["138437681254",l.ImproveDigitalServer],["138437681257",
l.ImproveDigitalServer]];this._displaySet=new Set("Below_Post Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9".split(" "));this._outstreamSet=new Set(["Video_StickyOutstream_1"]);this._videoSet=new Set([M.Video_Coll_SOff_Smartphone,M.Video_Collapse_Autoplay_SoundOff,M.Video_In_Post_ClicktoPlay_SoundOn,M.Video_Individual_Autoplay_SOff])}get enabled(){return this._config.partners.display.get(l.ImproveDigital)}get videoEnabled(){return this._config.partners.video.get(l.ImproveDigital)}getBannerSlotBidRequests(a){if(this._displaySet.has(a.placementMapName)){let b=
this._displayPlacementId;return[{bidder:this.name,...this._addBidLabel(a.placementMapName,this.name),params:{publisherId:this._publisherId,placementId:b}}]}}getOutstreamSlotBidRequests(a){if(this._outstreamSet.has(a.placementMapName)){let b=this._stickyOutstreamPlacementId;return[{bidder:this.name,...this._addBidLabel(a.placementMapName,this.name),params:{publisherId:this._publisherId,placementId:b}}]}}getVideoSlotBidRequests(a){if(this._videoSet.has(a.name))return[{bidder:this.name,params:{publisherId:this._publisherId,
placementId:22983143}}]}};Nj=q([v("ImproveDigitalBidder"),H(),t("design:paramtypes",[N])],Nj);let mq=new Map([["Content_1",{siteId:"943837"}],["Content_2",{siteId:"943837"}],["Content_3",{siteId:"943837"}],["Content_4",{siteId:"943837"}],["Content_5",{siteId:"943837"}],["Content_6",{siteId:"943837"}],["Content_7",{siteId:"943837"}],["Content_8",{siteId:"943837"}],["Content_9",{siteId:"943837"}]]),Oj=new Map([["Below_Post",{siteId:"185759"}],["Content_1",{siteId:"185761",outstreamSiteId:"820298"}],
["Content_2",{siteId:"185762"}],["Content_3",{siteId:"185763"}],["Content_4",{siteId:"185764"}],["Content_5",{siteId:"185765"}],["Content_6",{siteId:"185766"}],["Content_7",{siteId:"185767"}],["Content_8",{siteId:"185768"}],["Content_9",{siteId:"185769"}],["Footer_1",{siteId:"185770"}],["Header_1",{siteId:"185774"}],["Interstitial_1",{siteId:"631834"}],["Recipe_1",{siteId:"185776"}],["Recipe_2",{siteId:"185777"}],["Recipe_3",{siteId:"304909"}],["Recipe_4",{siteId:"371523"}],["Sidebar_1",{siteId:"185787"}],
["Sidebar_2",{siteId:"185788"}],["Sidebar_3",{siteId:"185789"}],["Sidebar_4",{siteId:"185790"}],["Sidebar_5",{siteId:"185791"}],["Sidebar_9",{siteId:"185795"}],["Video_StickyOutstream_1",{siteId:"745167",outstreamSiteId:"745167"}]]),pu=new Map([["Below_Post",[{size:[728,90],id:"1_1"},{size:[300,250],id:"1_2"}]],["Content_1",[{size:[728,90],id:"3_1"},{size:[300,250],id:"3_2"},{size:[320,480],id:"3_2"},{size:[320,50],id:"3_4"},{size:[320,100],id:"3_5"},{size:[300,50],id:"3_6"},{size:[728,250]}]],["Content_2",
[{size:[728,90],id:"4_1"},{size:[300,250],id:"4_2"},{size:[728,410],id:"4_2"},{size:[320,50],id:"4_4"},{size:[320,100],id:"4_5"},{size:[300,50],id:"4_6"},{size:[728,250]}]],["Content_3",[{size:[300,250],id:"5_1"},{size:[320,50],id:"5_2"},{size:[320,100],id:"5_3"},{size:[300,50],id:"5_4"},{size:[728,250]}]],["Content_4",[{size:[300,250],id:"6_1"},{size:[320,50],id:"6_2"},{size:[320,100],id:"6_3"},{size:[300,50],id:"6_4"},{size:[728,250]}]],["Content_5",[{size:[300,250],id:"7_1"},{size:[320,50],id:"7_2"},
{size:[320,100],id:"7_3"},{size:[300,50],id:"7_4"},{size:[728,250]}]],["Content_6",[{size:[300,250],id:"8_1"},{size:[320,50],id:"8_2"},{size:[320,100],id:"8_3"},{size:[300,50],id:"8_4"},{size:[728,250]}]],["Content_7",[{size:[300,250],id:"9_1"},{size:[320,50],id:"9_2"},{size:[300,50],id:"9_3"},{size:[728,250]}]],["Content_8",[{size:[300,250],id:"10_1"},{size:[320,50],id:"10_2"},{size:[300,50],id:"10_3"},{size:[728,250]}]],["Content_9",[{size:[300,250],id:"11_1"},{size:[320,50],id:"11_2"},{size:[300,
50],id:"11_3"},{size:[728,250]}]],["Footer_1",[{size:[728,90],id:"12_1"},{size:[970,90],id:"12_2"},{size:[320,50],id:"12_3"},{size:[320,100],id:"12_4"},{size:[300,50],id:"12_5"}]],["Header_1",[{size:[728,90],id:"15_1"},{size:[970,90],id:"15_2"},{size:[970,250],id:"15_3"},{size:[320,50],id:"15_4"},{size:[320,100],id:"15_5"},{size:[300,50],id:"15_6"}]],["Interstitial_1",[{size:[300,600],id:"36_1"},{size:[336,280],id:"36_2"},{size:[320,480],id:"36_3"},{size:[300,250],id:"36_4"},{size:[320,50],id:"36_5"}]],
["Recipe_1",[{size:[300,250],id:"17_1"},{size:[320,50],id:"17_3"},{size:[320,100],id:"17_4"},{size:[300,50],id:"17_5"}]],["Recipe_2",[{size:[300,250],id:"18_1"},{size:[320,50],id:"18_3"},{size:[320,100],id:"18_4"},{size:[300,50],id:"18_5"}]],["Recipe_3",[{size:[300,250],id:"42_1"},{size:[320,50],id:"42_3"},{size:[320,100],id:"42_4"},{size:[300,50],id:"42_5"}]],["Recipe_4",[{size:[300,250],id:"43_1"},{size:[320,50],id:"43_3"},{size:[320,100],id:"43_4"},{size:[300,50],id:"43_5"}]],["Sidebar_1",[{size:[300,
250],id:"27_1"},{size:[300,600],id:"27_2"},{size:[300,1050],id:"27_3"},{size:[160,600],id:"27_4"},{size:[300,50],id:"27_5"}]],["Sidebar_2",[{size:[300,250],id:"28_1"},{size:[300,600],id:"28_2"},{size:[160,600],id:"28_3"},{size:[300,50],id:"28_4"}]],["Sidebar_3",[{size:[300,250],id:"29_1"},{size:[300,600],id:"29_2"},{size:[160,600],id:"29_3"},{size:[300,50],id:"29_4"}]],["Sidebar_4",[{size:[300,250],id:"30_1"},{size:[300,600],id:"30_2"},{size:[160,600],id:"30_3"},{size:[300,50],id:"30_4"}]],["Sidebar_5",
[{size:[300,250],id:"31_1"},{size:[300,600],id:"31_2"},{size:[160,600],id:"31_3"},{size:[300,50],id:"31_4"}]],["Sidebar_9",[{size:[300,250],id:"35_1"},{size:[300,600],id:"35_2"},{size:[300,1050],id:"35_3"},{size:[160,600],id:"35_4"},{size:[300,50],id:"35_5"}]],["Video_StickyOutstream_1",[{size:[300,250],id:"48_1",sizeOverride:[227,150]},{size:[320,50],id:"48_2",sizeOverride:[178,100]}]]]),nq=new Map([[M.Video_Collapse_Autoplay_SoundOff,[{size:[640,360],siteId:"185255",id:"44_1"}]],[M.Video_Coll_SOff_Smartphone,
[{size:[400,225],siteId:"321341",id:"45_1"}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{size:[640,360],siteId:"385287",device:"desktop",id:"46_1"},{size:[400,225],siteId:"385288",device:"mobile",id:"46_2"}]],[M.Video_Individual_Autoplay_SOff,[{size:[640,360],siteId:"385285",device:"desktop",id:"47_1"},{size:[400,225],siteId:"385286",device:"mobile",id:"47_2"}]]]),Pj=class extends X{init(){this._key="IxNativeExperiment"}run(){return super.run()}};Pj=q([v("IxNativeExperiment"),y()],Pj);let Qj=class extends ma{constructor(a,
b,c,d){super(a);this._prebidMethods=b;this._mediaType=c;this._nativeExperiment=d;this._bidderName=l.IndexExchange;this._device=Ta()?"desktop":"mobile";this._largeFormatSizes=(this._hasLargeFormatsEnabled=Ta()?this._config.adTypes.largeFormatsDesktop:this._config.adTypes.largeFormatsMobile)?"desktop"===this._device?[[728,410]]:[[320,480]]:[];this.bidderConfig=this._config.partners.getBidderConfig(l.IndexExchange);this.videoCreativeIds=[["138323461889",l.IndexExchange],["138365130553",l.IndexExchange],
["138323602520",l.IndexExchange],["138323911414",l.IndexExchange],["138365130307",l.IndexExchange],["138323648223",l.IndexExchange],["138323911009",l.IndexExchange],["138364758402",l.IndexExchange],["138323523396",l.IndexExchange],["138364703774",l.IndexExchange],["138323464748",l.IndexExchange],["138364758405",l.IndexExchange],["138323911423",l.IndexExchange],["138365130310",l.IndexExchange],["138323911420",l.IndexExchange],["138365130313",l.IndexExchange],["138323911411",l.IndexExchange],["138364758408",
l.IndexExchange],["138323911012",l.IndexExchange],["138364703777",l.IndexExchange],["138323523390",l.IndexExchange],["138364758411",l.IndexExchange],["138323523387",l.IndexExchange],["138365130316",l.IndexExchange],["138323911426",l.IndexExchange],["138364758414",l.IndexExchange],["138323911408",l.IndexExchange],["138364703780",l.IndexExchange],["138323911405",l.IndexExchange],["138364703783",l.IndexExchange],["138323523393",l.IndexExchange],["138364758417",l.IndexExchange],["138323911417",l.IndexExchange],
["138365130319",l.IndexExchange]]}get enabled(){return this._config.partners.display.get(l.IndexExchange)}get videoEnabled(){return this._config.partners.video.get(l.IndexExchange)}init(){var a=xe(this._config.context.savedReferrer);let b=this._config;var c=b.site;let d=[...c.verticals].filter(Lb);c=c.filteredSensitiveCategories;a={PD:`${b.adOptions.pmp?"":"no"}${b.context.device}`,...(d.length&&{Topic:d.join("#Topic:")}),...(c.length&&{Sens:c.join("#Sens:")}),Source:a?wp(a):"direct",Browser:ep(),
vp:"0"};fd(a,this._prebidMethods);this._largeFormatSizes.length&&yt(this._largeFormatSizes,this._prebidMethods)}getVideoBidRequests(a){return a.reduce((b,c)=>{const d=this.getVideoSizeSites(a).filter(e=>e.video===c).map(e=>{const {siteId:f,size:g,id:h}=e.sizeSite;e=this.getPrebidAdUnitBidRequest(f,g,h,"",!1,!0);e.params.video=this.getVideoParams(c.name);return e});return b.set(c.name,d)},new Map)}getBannerSlotBidRequests(a){let b=[];return Oj.get(a.placementMapName)?this._getSlotBids(a):b}getOutstreamSlotBidRequests(a){let b=
[];return Oj.get(a.placementMapName)?this._getSlotBids(a,!0):b}getNativeSlotBidRequests(a){if(!mq.get(a.placementMapName)||!a.location.includes("Content")||a.location.includes("Content")&&a.sequence&&3<=a.sequence&&"ec3"===this._nativeExperiment.result)return[];let b=mq.get(a.placementMapName).siteId,c=[];c.push(this.getPrebidAdUnitBidRequest(b,void 0,void 0,a.placementMapName,!1,!1,"arl"===this._nativeExperiment.result));return c}getVideoParams(a,b){var c;b={...this._config.video,...b};a=b.playbackmethod&&
b.playbackmethod.get(a);let d=new Map([[3,[3]],[6,[2]]]);a=a&&{playbackmethod:d.get(a[0])};b.videoProtocols&&b.videoProtocols.protocols||A.error("IndexExchangeBidder","getVideoParams",b.videoProtocols?"protocols is undefined":"videoProtocols is undefined");return{api:b.apiValue,mimes:b.mimeType,...a,minduration:0,maxduration:30,protocols:null===(c=b.videoProtocols)||void 0===c?void 0:c.protocols,pos:b.position.id}}getPrebidAdUnitBidRequest(a,b,c,d="",e=!1,f=!1,g=!1){return{bidder:this._bidderName,
...this._addBidLabel(d,void 0,{outstreamActive:!d.includes("Video_StickyOutstream")&&e,refresh:g},!f),params:{...(c&&{id:c}),siteId:a,...(e?{video:{}}:b?{size:b}:{})}}}_getSlotBids(a,b=!1){let c=[],d=pu.get(a.placementMapName),e=Oj.get(a.placementMapName);d&&d.filter(({size:f})=>a.hasSize(f)||this.largeFormatSizeEnabled(f)).forEach(({size:f,id:g})=>{var h;let k=b?null!==(h=e.outstreamSiteId)&&void 0!==h?h:e.siteId:e.siteId;c.push(this.getPrebidAdUnitBidRequest(k,f,g,a.placementMapName,b))});return c}largeFormatSizeEnabled([a,
b]){return this._largeFormatSizes.some(([c,d])=>a===c&&b===d)}getVideoSizeSites(a){return a.filter(b=>nq.has(b.name)).reduce((b,c)=>{const d=nq.get(c.name).filter(({device:e,size:f})=>(!e||e&&e===this._device)&&c.size[0]===f[0]&&c.size[1]===f[1]).map(e=>({video:c,sizeSite:e}));return[...b,...d]},[])}};Qj=q([v("IndexExchangeBidder"),H(),t("design:paramtypes",[N,ia,gb,Pj])],Qj);let qu=new Map([[M.Video_Collapse_Autoplay_SoundOff,[{siteId:P.Natashas_Kitchen,client:"_bRbD9p9sZK",server:"_tyXFRsb7b4",
size:Ja},{siteId:P.Spend_With_Pennies,client:"_x8sgYI55G4",server:"_jg4wlPdEog",size:Ja},{siteId:P.AZ_Animals,client:"_d4LW55Tz6Z",server:"_vw404TGZKZ",size:Ja},{siteId:P.RecipeTin_Eats,client:"_hhjZvYrxAc",server:"_rsajlrnhno",size:Ja},{siteId:P.Sallys_Baking_Recipes,client:"_uEi7eMPnxq",server:"_gPZIDLm8j2",size:Ja},{siteId:P.Default,client:"_kWJDXIuROl",server:"_kkLiJTt47x",size:Ja}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{siteId:P.Natashas_Kitchen,client:"_iSNq3tefXu",server:"_zXaUPeITLG",size:Ja},
{siteId:P.Spend_With_Pennies,client:"_lCb7dfvNjq",server:"_cHXAF6BKmN",size:Ja},{siteId:P.AZ_Animals,client:"_tyYmCc4eCT",server:"_g2LAwxEvEs",size:Ja},{siteId:P.RecipeTin_Eats,client:"_bB1dCkFu32",server:"_sBUGeiExbU",size:Ja},{siteId:P.Sallys_Baking_Recipes,client:"_g9cki8b6xC",server:"_mBNCdbBCg7",size:Ja},{siteId:P.Default,client:"_fR1aawM8Zo",server:"_j08PBtvK4B",size:Ja}]],[M.Video_Individual_Autoplay_SOff,[{siteId:P.Natashas_Kitchen,client:"_cSmQNecEfo",server:"_s5shEWGvJC",size:Ja},{siteId:P.Spend_With_Pennies,
client:"_atcYOwsv5N",server:"_vx63n2bPCt",size:Ja},{siteId:P.AZ_Animals,client:"_qdsWDke6KD",server:"_ySOwZdo8WZ",size:Ja},{siteId:P.RecipeTin_Eats,client:"_eZmQSTrIMN",server:"_qxKutqq3kR",size:Ja},{siteId:P.Sallys_Baking_Recipes,client:"_gVAQIoM4cp",server:"_i2ILdAGFrc",size:Ja},{siteId:P.Default,client:"_nmpcOw19lD",server:"_mX7o0eM1jT",size:Ja}]]]),ru=new Map([[M.Video_Coll_SOff_Smartphone,[{siteId:P.Natashas_Kitchen,client:"_oqaQNDGjZ4",server:"_cjATjOt7M3",size:Ka},{siteId:P.Spend_With_Pennies,
client:"_g47ukW03bo",server:"_jdef3qyaew",size:Ka},{siteId:P.RecipeTin_Eats,client:"_kp8W0sdhdE",server:"_p3pJYWNuxp",size:Ka},{siteId:P.Sallys_Baking_Recipes,client:"_rsmG36HH8x",server:"_ngr9SeXdE7",size:Ka},{siteId:P.AZ_Animals,client:"_ghA53Kjqrh",server:"_xRJtnJlLcg",size:Ka},{siteId:P.Default,client:"_kUg4kKElHf",server:"_wraUX6ObGH",size:Ka}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{siteId:P.Natashas_Kitchen,client:"_tBeS7Z4US3",server:"_pnaFOGgJHk",size:Ka},{siteId:P.Spend_With_Pennies,client:"_lsGboL0uST",
server:"_el6JVb9qoD",size:Ka},{siteId:P.RecipeTin_Eats,client:"_wqAAlYzlij",server:"_dc6prrDilF",size:Ka},{siteId:P.Sallys_Baking_Recipes,client:"_zn7ZLevuPn",server:"_bjw2WhZN1K",size:Ka},{siteId:P.AZ_Animals,client:"_qaJQvOMII9",server:"_pCPyKofX1S",size:Ka},{siteId:P.Default,client:"_upDLM7q4jV",server:"_iNqGr1ZsCR",size:Ka}]],[M.Video_Individual_Autoplay_SOff,[{siteId:P.Natashas_Kitchen,client:"_vWJq7i6Hsr",server:"_jE3UrcJ5WA",size:Ka},{siteId:P.Spend_With_Pennies,client:"_mx5iL6Bejc",server:"_rRtn5dy9zf",
size:Ka},{siteId:P.RecipeTin_Eats,client:"_oUwmSg3ct7",server:"_bCZv43HA5e",size:Ka},{siteId:P.Sallys_Baking_Recipes,client:"_akUrKNgwMu",server:"_dZQibxLKPI",size:Ka},{siteId:P.AZ_Animals,client:"_uFi5ptAWHm",server:"_kCaQmZiXGS",size:Ka},{siteId:P.Default,client:"_fyab3CymN5",server:"_qeYOrszj4C",size:Ka}]]]),oq=new Map([["100000",[{siteId:P.Natashas_Kitchen,client:{mobile:"_hAsShWhZrX",desktop:"_hGHupdqGkR"},server:{mobile:"_dBn42PEYpT",desktop:"_bNu9DxaovG"},isOutstream:!1},{siteId:P.Spend_With_Pennies,
client:{mobile:"_ua1Af0iqiz",desktop:"_tHHlCZoftJ"},server:{mobile:"_yiSiyTNTr9",desktop:"_zOvUvvugIj"},isOutstream:!1},{siteId:P.AZ_Animals,client:{mobile:"_lI4BEQnUxI",desktop:"_nVsVVfpDjN"},server:{mobile:"_d2hBOhJhxF",desktop:"_uo8nEFxOVu"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_wVm3mYeRml",desktop:"_iRqGIvmzUs"},server:{mobile:"_fK6uPhLCLl",desktop:"_yaaHKyz3Zk"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_jvVwL9Fnun",desktop:"_nJqZtOhz0Q"},server:{mobile:"_dzb8opas5y",
desktop:"_yC15vgTB1T"},isOutstream:!1},{siteId:P.Default,client:{mobile:"_htv2gWQDl4",desktop:"_hIMWOFYOkG"},server:{mobile:"_fc3We7MSf8",desktop:"_p9dR36E2p7"},isOutstream:!1}]],["010000",[{siteId:P.Natashas_Kitchen,client:{mobile:"_eIhMof7yqe",desktop:"_byCkELixPr"},server:{mobile:"_lCC4Vz5HVq",desktop:"_c0YtPZCFAN"},isOutstream:!1},{siteId:P.Spend_With_Pennies,client:{mobile:"_f1sGSYRKR3",desktop:"_q3eCqZRhdS"},server:{mobile:"_d6K4oqtod2",desktop:"_wwAn0mcH6d"},isOutstream:!1},{siteId:P.AZ_Animals,
client:{mobile:"_qwYKU8Qi3G",desktop:"_ohqIx8jj4D"},server:{mobile:"_ycHhS8LeQg",desktop:"_go3v3cJHBo"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_whqXDci8eJ",desktop:"_c8mUVLDZhB"},server:{mobile:"_a4F7BDxYvO",desktop:"_ry2nukXJCM"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_fp2BsPBxqI",desktop:"_hYVLy7Ua4r"},server:{mobile:"_jHYRZMA3Rv",desktop:"_e1zarT1nQu"},isOutstream:!1},{siteId:P.Default,client:{mobile:"_bDJEtXJaCQ",desktop:"_vzS4k9rMKu"},server:{mobile:"_mTkU31vSyD",
desktop:"_uBJBQkzM4x"},isOutstream:!1}]],["101000",[{siteId:P.Natashas_Kitchen,client:{mobile:"_finwQXYsdW",desktop:"_hqpdpEgPND"},server:{mobile:"_aMXALPX3fS",desktop:"_hY1xJfGGVe"},isOutstream:!0},{siteId:P.Spend_With_Pennies,client:{mobile:"_f8CIFfN0X9",desktop:"_u8FSFfE7br"},server:{mobile:"_ijhi0w8YvT",desktop:"_s5QXHlZsTW"},isOutstream:!0},{siteId:P.AZ_Animals,client:{mobile:"_agHXJxfEse",desktop:"_eEANDb6t2k"},server:{mobile:"_l2FGd0utDq",desktop:"_zhrJRRWVYf"},isOutstream:!0},{siteId:P.RecipeTin_Eats,
client:{mobile:"_gSKH6aK6R4",desktop:"_jaMt5ZbQgI"},server:{mobile:"_ePFeBkTZqT",desktop:"_nn2s0plngX"},isOutstream:!0},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_kIAYcCNe7d",desktop:"_rFrgDRiaQp"},server:{mobile:"_wUz9lluZW9",desktop:"_cKmNoetgxX"},isOutstream:!0},{siteId:P.Default,client:{mobile:"_rEapvpk6cZ",desktop:"_oCKJ4D9jsI"},server:{mobile:"_d1ofpEpOuE",desktop:"_pJRjrqANDE"},isOutstream:!0}]],["101100",[{siteId:P.Natashas_Kitchen,client:{mobile:"_ecQ46kpFH4",desktop:"_hDLFEUkifu"},
server:{mobile:"_cRzdV4tRUN",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:P.Spend_With_Pennies,client:{mobile:"_vOhgG6ZGQc",desktop:"_hDLFEUkifu"},server:{mobile:"_oBErk6NgT9",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:P.AZ_Animals,client:{mobile:"_dZU1BlrcQe",desktop:"_hDLFEUkifu"},server:{mobile:"_aGjeC3sjY2",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:P.RecipeTin_Eats,client:{mobile:"_zcdgs90WxP",desktop:"_hDLFEUkifu"},server:{mobile:"_sRHWp1P95W",desktop:"_hDLFEUkifu"},isOutstream:!0},
{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_lLcxnJnUL0",desktop:"_hDLFEUkifu"},server:{mobile:"_mKff6SG1V4",desktop:"_hDLFEUkifu"},isOutstream:!0},{siteId:P.Default,client:{mobile:"_hDLFEUkifu",desktop:"_hDLFEUkifu"},server:{mobile:"_d4LMbFjRkk",desktop:"_hDLFEUkifu"},isOutstream:!0}]],["100100",[{siteId:P.Natashas_Kitchen,client:{mobile:"_qy8FZvprXY",desktop:"_kEvPWSnblw"},server:{mobile:"_aYXzmplV9F",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:P.Spend_With_Pennies,client:{mobile:"_gsOgkDslR3",
desktop:"_kEvPWSnblw"},server:{mobile:"_u5EkrC5vYV",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:P.AZ_Animals,client:{mobile:"_lGIFrPovZn",desktop:"_kEvPWSnblw"},server:{mobile:"_f4bL87KId1",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_gn64RSSM57",desktop:"_kEvPWSnblw"},server:{mobile:"_yDuCGfXmql",desktop:"_kEvPWSnblw"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_gD0lSine9a",desktop:"_kEvPWSnblw"},server:{mobile:"_lx9tkSimU2",desktop:"_kEvPWSnblw"},
isOutstream:!1},{siteId:P.Default,client:{mobile:"_kEvPWSnblw",desktop:"_kEvPWSnblw"},server:{mobile:"_jiqa71nZQy",desktop:"_kEvPWSnblw"},isOutstream:!1}]],["000011",[{siteId:P.Natashas_Kitchen,client:{mobile:"_v5SMFEjDrr",desktop:"_fTbDngf8Ub"},server:{mobile:"_jGV537FxMJ",desktop:"_rzRzo7jEiB"},isOutstream:!1},{siteId:P.Spend_With_Pennies,client:{mobile:"_lX0mmLqXOH",desktop:"_zQGKRsK2OR"},server:{mobile:"_qH1l1kyPi3",desktop:"_pBJnthmHgl"},isOutstream:!1},{siteId:P.AZ_Animals,client:{mobile:"_lUXeoSZAf0",
desktop:"_pXYJ80T5VN"},server:{mobile:"_jxiRracsTG",desktop:"_ndFYWLoiBo"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_qQ8NEcQY1C",desktop:"_gGD1SYrcGe"},server:{mobile:"_dbjFQeqonB",desktop:"_yG4Q6pfCcA"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_kFc3pV1c0n",desktop:"_mzspF6n1E6"},server:{mobile:"_aSfWWLCYIF",desktop:"_oFaxWSuc5h"},isOutstream:!1},{siteId:P.Default,client:{mobile:"_hRaLC9FgYn",desktop:"_yI7yqradgk"},server:{mobile:"_qkzet6WYFk",desktop:"_cw6zRI7FoH"},
isOutstream:!1}]],["000010",[{siteId:P.Natashas_Kitchen,client:{mobile:"_r4fIEDQTLY",desktop:"_baT851TDWI"},server:{mobile:"_ecjCX4kPwm",desktop:"_qQwA2mxuBj"},isOutstream:!1},{siteId:P.Spend_With_Pennies,client:{mobile:"_rAF97HOGTF",desktop:"_l4gY7l7f5a"},server:{mobile:"_jTzFFJiTJD",desktop:"_hBe1suFVbp"},isOutstream:!1},{siteId:P.AZ_Animals,client:{mobile:"_mqFteTH9Rj",desktop:"_d7BTJmSlpc"},server:{mobile:"_vuHz64bKFd",desktop:"_r9dNt9173p"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_qs6lmj0Pbf",
desktop:"_p950SHR2Xv"},server:{mobile:"_lx5UxDlx0g",desktop:"_lLRgz2kTfw"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,client:{mobile:"_maZsbF5qjH",desktop:"_lZNyxSw6Ss"},server:{mobile:"_vTQcRjZrSS",desktop:"_gund5mIKg5"},isOutstream:!1},{siteId:P.Default,client:{mobile:"_iyznbek6ki",desktop:"_fPM3feDxUE"},server:{mobile:"_xgNGHBHpEp",desktop:"_uqR67yraqv"},isOutstream:!1}]],["000001",[{siteId:P.Natashas_Kitchen,client:{mobile:"_cxVgq7bff1",desktop:"_paxUDMm9of"},server:{mobile:"_oMCKtxsq0T",
desktop:"_uXClSLcqiX"},isOutstream:!1},{siteId:P.Spend_With_Pennies,client:{mobile:"_nhQCrEk0GT",desktop:"_iGYXTwKJkq"},server:{mobile:"_vg5Tj9cQlS",desktop:"_ix2Vu5yio6"},isOutstream:!1},{siteId:P.AZ_Animals,client:{mobile:"_yc0KcUV2Sb",desktop:"_gaEp6ub3Uz"},server:{mobile:"_lhuIK8d0HO",desktop:"_s1YBpsN41s"},isOutstream:!1},{siteId:P.RecipeTin_Eats,client:{mobile:"_vwzo4mlIdf",desktop:"_p3pvAJLdvb"},server:{mobile:"_ol6ZhRXMRV",desktop:"_k5zqurOzN9"},isOutstream:!1},{siteId:P.Sallys_Baking_Recipes,
client:{mobile:"_vKGlgbERMK",desktop:"_x7OEkwJGD9"},server:{mobile:"_vaUAWXhKWM",desktop:"_wzZeDPhHwx"},isOutstream:!1},{siteId:P.Default,client:{mobile:"_g1dEyYpnCU",desktop:"_wtAZ5wepHr"},server:{mobile:"_p2WCSP0fm1",desktop:"_bSkTYI5gwN"},isOutstream:!1}]]]),su="Below_Post Content_1 Content_2 Content_3 Content_4 Content_5 Content_5 Content_6 Content_7 Content_8 Content_9 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9".split(" "),pq=["Below_Post",
"Content_1"],tu=["Below_Post","Content","Recipe"],uu={desktop:qu,mobile:ru},vu=["Below_Post","Content_1","Content_3","Content_5","Recipe_1"],Rj=class extends ma{constructor(a,b,c){super(b);this._kargoExperiment=a;this._mediaType=c;this.bidderConfig=this._config.partners.getBidderConfig(l.Kargo);this.adapterName=l.Kargo;this.serverBidderName=l.KargoServer;this.gvlid=972;this._device=ca()?"mobile":"desktop";this._videoMap=uu[this._device];this._bidders=[];this._displaySiteMappings=[P.AZ_Animals,P.RecipeTin_Eats,
P.Sallys_Baking_Recipes,P.Natashas_Kitchen,P.Spend_With_Pennies];this._videoSiteMappings=[P.RecipeTin_Eats,P.Sallys_Baking_Recipes,P.AZ_Animals,P.Natashas_Kitchen,P.Spend_With_Pennies];this._siteID=this._displaySiteMappings.includes(this._config.site.id)?this._config.site.id:"default";this._videoSiteID=this._videoSiteMappings.includes(this._config.site.id)?this._config.site.id:"default";this.videoCreativeIds=[["138381592896",l.Kargo],["138381553202",l.Kargo],["138381553217",l.Kargo],["138381553238",
l.Kargo],["138381553328",l.Kargo],["138381553214",l.Kargo],["138381553235",l.Kargo],["138381553244",l.Kargo],["138381553331",l.Kargo],["138381553334",l.Kargo],["138382066465",l.Kargo],["138381553241",l.Kargo],["138381553325",l.Kargo],["138381553337",l.Kargo],["138381553340",l.Kargo],["138382066468",l.Kargo]];this.videoServerCreativeIds=[["138412278583",l.KargoServer],["138411680693",l.KargoServer],["138411680690",l.KargoServer],["138411680687",l.KargoServer],["138411680684",l.KargoServer],["138411680681",
l.KargoServer],["138411680678",l.KargoServer],["138411680264",l.KargoServer]];this.settings={storageAllowed:["html5"]};a="both"===this._kargoExperiment.result||"client"===this._kargoExperiment.result;"both"!==this._kargoExperiment.result&&"server"!==this._kargoExperiment.result||this._bidders.push({name:this.serverBidderName,type:"server"});a&&this._bidders.push({name:this.name,type:"client"})}get enabled(){return this._config.partners.display.get(l.Kargo)}get videoEnabled(){return this._config.partners.video.get(l.Kargo)}addLazySlotsToTypes(a){"mobile"===
this._device&&tu.includes(a.location)&&a.lazy&&pq.push(a.name)}createBitStringAdOptions(a,b=!1){let c=a.hasSize([300,250]),d=a.hasSize([320,50]),e=a.hasSize([728,90]),f=a.hasSize([300,600]);this.addLazySlotsToTypes(a);return[+this.isBanner(a,c,d,f),+this.isHeader(a,e,d),+this.isOutstream(a,c,b),+this.isInterscroller(a),+this.isAnimatedFooter(a,d),+this.isExpandableFooter(a,d)].join("")}isBanner(a,b,c,d){let e="Sidebar"===a.location;return(b||c||d&&e)&&su.includes(a.placementMapName)}isHeader(a,b,
c){let d=["Header_1","Header_2"];return(b||c)&&d.includes(a.placementMapName)}isOutstream(a,b,c=!1){let d=["Content","Header","Below_Post","Sidebar","Recipe"];return b&&("desktop"===this._device&&d.includes(a.location)||"mobile"===this._device&&c&&vu.includes(a.placementMapName)&&this._mediaType.outstreamEnabled(a).outstreamCapable)}isInterscroller(a){return"mobile"===this._device&&this._config.adTypes.has("interscroller")&&pq.includes(a.placementMapName)}isAnimatedFooter(a,b){return("desktop"===
this._device||this._config.adTypes.has("animatedFooter"))&&b&&"Footer_1"===a.placementMapName}isExpandableFooter(a,b){return"mobile"===this._device&&b&&this._config.adTypes.has("expandableFooter")&&"Footer_1"===a.placementMapName}getBannerSlotBidRequests(a){return this._getBidParams(a)}getOutstreamSlotBidRequests(a){if("desktop"!==this._device)return this._getBidParams(a,!0)}getVideoSlotBidRequests(a){let b=[];if(!this._videoMap.get(a.name))return b;this._bidders.forEach(c=>{let d="server"===c.type?
"adSlotID":"placementId",e=this._videoMap.get(a.name).filter(f=>f.siteId===this._videoSiteID)[0][c.type];b.push({bidder:c.name,params:{[d]:e}})});return b}_getBidParams(a,b=!1){let c=this.createBitStringAdOptions(a,b);if(oq.has(c))return this._bidders.map(d=>{let e="server"===d.type?"adSlotID":"placementId",f=oq.get(c).filter(g=>g.siteId===this._siteID)[0];return{bidder:d.name,...this._addBidLabel(a.placementMapName,"server"===d.type?this.serverBidderName:this.adapterName,{outstreamCapable:f.isOutstream&&
b}),params:{[e]:f[d.type][this._device]}}})}};Rj=q([v("KargoBidder"),y(),t("design:paramtypes",[qd,N,gb])],Rj);let Sj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.MediaGrid);this.settings={bidCpmAdjustment:(b,c)=>this._getCPMAdjustment(b,c),adserverTargeting:[{key:"hb_format",val:b=>b&&b.meta&&"trustx"===b.meta.demandSource?`trustx_${b.mediaType}`:b.mediaType}]};this._getCPMAdjustment=(b,c)=>{var d=c.dealId;d=("vastUrl"in c||"vastXml"in c)&&d&&
d.toString().includes("G-TRUSTX");return lh(this._config,b,l.MediaGrid,{...c,...(d&&{dealId:void 0})})};this._displayMap=new Map([["Below_Post",357],["Content_1",358],["Content_2",359],["Content_3",360],["Content_4",361],["Content_5",362],["Content_6",363],["Content_7",364],["Content_8",365],["Content_9",366],["Footer_1",367],["Header_1",368],["Header_2",369],["Interstitial_1",48428],["Recipe_1",370],["Recipe_2",371],["Recipe_3",372],["Recipe_4",373],["Sidebar_1",375],["Sidebar_2",376],["Sidebar_3",
377],["Sidebar_4",378],["Sidebar_5",379],["Sidebar_9",380]]);this._outstreamMap=new Map([["Below_Post",357],["Content_1",358],["Content_2",359],["Content_3",360],["Content_4",361],["Content_5",362],["Content_6",363],["Content_7",364],["Content_8",365],["Content_9",366],["Video_StickyOutstream_1",133519]])}get enabled(){return this._config.partners.display.get(l.MediaGrid)}get videoEnabled(){return this._config.partners.video.get(l.MediaGrid)}getBannerSlotBidRequests(a){if(this._displayMap.has(a.placementMapName))return[{bidder:this.name,
params:{uid:this._displayMap.get(a.placementMapName)},...this._addBidLabel(a.placementMapName)}]}getOutstreamSlotBidRequests(a){if(this._outstreamMap.has(a.placementMapName))return[{bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{outstreamActive:"Video_StickyOutstream"!==a.location}),params:{uid:this._outstreamMap.get(a.placementMapName)}}]}};Sj=q([v("MediaGridBidder"),H(),t("design:paramtypes",[N])],Sj);let Tj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.MediaGridVideo);
this.adapterName="grid";this.videoCreativeIds=[["138323922262",l.MediaGridVideo],["138323922901",l.MediaGridVideo],["138323922886",l.MediaGridVideo],["138323922898",l.MediaGridVideo],["138323922904",l.MediaGridVideo],["138323923042",l.MediaGridVideo],["138323922889",l.MediaGridVideo],["138323923018",l.MediaGridVideo],["138323922907",l.MediaGridVideo],["138323922859",l.MediaGridVideo],["138323923048",l.MediaGridVideo],["138323923045",l.MediaGridVideo],["138323923051",l.MediaGridVideo],["138323923021",
l.MediaGridVideo],["138323922895",l.MediaGridVideo],["138323922892",l.MediaGridVideo]];this._map=new Map([[M.Video_Collapse_Autoplay_SoundOff,[{uid:2163}]],[M.Video_Coll_SOff_Smartphone,[{uid:2165}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{device:"desktop",uid:2164},{device:"mobile",uid:6056}]],[M.Video_Individual_Autoplay_SOff,[{device:"desktop",uid:2166},{device:"mobile",uid:6057}]]])}get enabled(){return this._config.partners.display.get(l.MediaGridVideo)}get videoEnabled(){return this._config.partners.video.get(l.MediaGridVideo)}getVideoSlotBidRequests(a){let b=
Ta()?"desktop":"mobile";if(this._map.has(a.name))return this._map.get(a.name).filter(({device:c})=>!c||c===b).map(({uid:c})=>({bidder:this.name,params:{uid:c}}))}};Tj=q([v("MediaGridVideoBidder"),H(),t("design:paramtypes",[N])],Tj);let Uj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Nativo);this.adapterName=l.Nativo;this._map=new Set("Content_1 Content_2 Content_3 Header_1 Footer_1 Recipe_1 Recipe_2 Recipe_3 Sidebar_1 Sidebar_2".split(" "))}get enabled(){return this._config.partners.display.get(l.Nativo)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return[{bidder:this.name,
params:{},...this._addBidLabel(a.placementMapName)}]}};Uj=q([v("NativoBidder"),H(),t("design:paramtypes",[N])],Uj);let Vj=class extends ma{constructor(a,b){super(a);this.openxExperiment=b;this.bidderConfig=this._config.partners.getBidderConfig(l.OpenX);this.adapterName=l.OpenX;this.serverBidderName=l.OpenXServer;this.gvlid=69;this._bidders=[];this.videoCreativeIds=[["138323525262",l.OpenX],["138323914702",l.OpenX],["138323526741",l.OpenX],["138323526186",l.OpenX],["138323526738",l.OpenX],["138323526744",
l.OpenX],["138323526747",l.OpenX],["138323526189",l.OpenX],["138323914588",l.OpenX],["138323526192",l.OpenX],["138323526750",l.OpenX],["138323466806",l.OpenX],["138323468969",l.OpenX],["138323914705",l.OpenX],["138323526183",l.OpenX],["138323526753",l.OpenX]];this.videoServerCreativeIds=[["138411286398",l.OpenXServer],["138411786451",l.OpenXServer],["138411286395",l.OpenXServer],["138411286392",l.OpenXServer],["138411286401",l.OpenXServer],["138411286389",l.OpenXServer],["13841117744",l.OpenXServer],
["138411178055",l.OpenXServer]];this._params={delDomain:"cafemedia-d.openx.net"};this._highImpactParamsMap=new Map([["Content_1",["interscroller","miniscroller"]]]);this._lazyImpactParamsMap=new Map([["Content",["interscroller","miniscroller"]],["Recipe",["miniscroller"]],["Below_Post",["interscroller","miniscroller"]]]);this._map=new Map([["Below_Post",{client:{unit:"538699862"},server:{unit:"558245996"}}],["Content_1",{client:{unit:"538699864"},server:{unit:"558245997"}}],["Content_2",{client:{unit:"538699865"},
server:{unit:"558245998"}}],["Content_3",{client:{unit:"538699866"},server:{unit:"558245999"}}],["Content_4",{client:{unit:"538699867"},server:{unit:"558246000"}}],["Content_5",{client:{unit:"538699868"},server:{unit:"558246001"}}],["Content_6",{client:{unit:"538699869"},server:{unit:"558246002"}}],["Content_7",{client:{unit:"538699870"},server:{unit:"558246003"}}],["Content_8",{client:{unit:"538699871"},server:{unit:"558246004"}}],["Content_9",{client:{unit:"538699872"},server:{unit:"558246005"}}],
["Footer_1",{client:{unit:"538699840"},server:{unit:"558246006"}}],["Header_1",{client:{unit:"538699873"},server:{unit:"558246007"}}],["Header_2",{client:{unit:"538699874"},server:{unit:"558246008"}}],["Interstitial_1",{client:{unit:"543876568"},server:{unit:"543876568"}}],["Recipe_1",{client:{unit:"538699843"},server:{unit:"558246009"}}],["Recipe_2",{client:{unit:"538699844"},server:{unit:"558246010"}}],["Recipe_3",{client:{unit:"540594416"},server:{unit:"558246011"}}],["Recipe_4",{client:{unit:"540751624"},
server:{unit:"558246012"}}],["Sidebar_1",{client:{unit:"538699853"},server:{unit:"558246014"}}],["Sidebar_2",{client:{unit:"538699854"},server:{unit:"558246015"}}],["Sidebar_3",{client:{unit:"538699855"},server:{unit:"558246016"}}],["Sidebar_4",{client:{unit:"538699856"},server:{unit:"558246017"}}],["Sidebar_5",{client:{unit:"538699857"},server:{unit:"558246018"}}],["Sidebar_9",{client:{unit:"538699861"},server:{unit:"558246019"}}],["Video_StickyOutstream_1",{client:{unit:"545721971"},server:{unit:"558246697"}}],
[M.Video_Collapse_Autoplay_SoundOff,{client:{unit:"540679731"},server:{unit:"558246727"}}],[M.Video_Coll_SOff_Smartphone,{client:{unit:"540679733"},server:{unit:"558246726"}}],[M.Video_In_Post_ClicktoPlay_SoundOn,{client:{unit:"540679727"},server:{unit:"558246662"}}],[M.Video_Individual_Autoplay_SOff,{client:{unit:"540925853"},server:{unit:"558246728"}}]]);this._custParams={...(this._config.site.filteredSensitiveCategories.length&&{sens:this._config.site.filteredSensitiveCategories}),bucket:[this._config.context.bucket]};
a="both"===b.result||"client"===b.result;"both"!==b.result&&"server"!==b.result||this._bidders.push({name:this.serverBidderName,type:"server"});a&&this._bidders.push({name:this.name,type:"client"})}get enabled(){return this._config.partners.display.get(l.OpenX)}get videoEnabled(){return this._config.partners.video.get(l.OpenX)}_lazyActiveTypes(a){return a.lazy&&this._lazyImpactParamsMap.has(a.location)&&this._lazyImpactParamsMap.get(a.location).filter(b=>this._config.adTypes[b])}activeAdTypes(a){return this._highImpactParamsMap.has(a.placementMapName)&&
this._highImpactParamsMap.get(a.placementMapName).filter(b=>this._config.adTypes[b])}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._getBidParams(a)}getOutstreamSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._getBidParams(a,!0)}getVideoSlotBidRequests(a){var b;if(this._map.has(a.name)){let c="all"===(null===(b=this._config.video.videoProtocols)||void 0===b?void 0:b.scope)?{protocols:this._config.video.videoProtocols.protocols}:"",d=this._map.get(a.name);
return this._bidders.map(e=>{var f;return{bidder:e.name,params:{...this._params,unit:d[e.type].unit,video:{mimes:this._config.video.mimeType,api:this._config.video.apiValue,...c,pos:this._config.video.position.id,...((null===(f=this._config.video.playbackmethod)||void 0===f?void 0:f.get(a.name))&&{playbackmethod:this._config.video.playbackmethod.get(a.name)})}}}})}}_getBidParams(a,b=!1){let c=this.activeAdTypes(a)||this._lazyActiveTypes(a)||[],d=this._map.get(a.placementMapName);return this._bidders.map(e=>
({bidder:e.name,...this._addBidLabel(a.placementMapName,"server"===e.type?this.serverBidderName:e.name,{outstreamActive:b&&"Video_StickyOutstream"!==a.location}),params:{...this._params,unit:d[e.type].unit,customParams:{...this._custParams,...(c.length&&{hi_au:c.filter(f=>this._config.adTypes[f])})}}}))}};Vj=q([v("OpenXBidder"),H(),t("design:paramtypes",[N,rd])],Vj);let Wj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Ozone);this.adapterName=l.Ozone;
this._params={publisherId:"OZONERAP0001",siteId:"1500000160"};this._map=new Map([["Content",{placementId:"3500013089"}],["Content_1",{placementId:"3500013090"}],["Content_2",{placementId:"3500013091"}],["Content_3",{placementId:"3500013092"}],["Content_4",{placementId:"3500013093"}],["Content_5",{placementId:"3500013094"}],["Content_6",{placementId:"3500013095"}],["Content_7",{placementId:"3500013096"}],["Content_8",{placementId:"3500013097"}],["Content_9",{placementId:"3500013098"}],["Header_1",
{placementId:"3500013099"}],["Header_2",{placementId:"3500013100"}],["Sidebar_1",{placementId:"3500013101"}],["Sidebar_2",{placementId:"3500013102"}],["Sidebar_3",{placementId:"3500013103"}],["Sidebar_4",{placementId:"3500013104"}],["Sidebar_5",{placementId:"3500013105"}],["Sidebar_9",{placementId:"3500013106"}],["Below_Post",{placementId:"3500013107"}],["Below_Post_1",{placementId:"3500013108"}],["Footer_1",{placementId:"3500013109"}],["Recipe_1",{placementId:"3500013110"}],["Recipe_2",{placementId:"3500013111"}],
["Recipe_3",{placementId:"3500013112"}],["Recipe_4",{placementId:"3500013113"}],["Recipe_5",{placementId:"3500013114"}]])}get enabled(){return this._config.partners.display.get(l.Ozone)&&this._config.gdpr.enabled&&"GB"===this._config.context.country}getBannerSlotBidRequests(a){var b;if(this._map.has(a.placementMapName))return[{bidder:this.name,params:{placementId:null===(b=this._map.get(a.placementMapName))||void 0===b?void 0:b.placementId,...this._params}}]}};Wj=q([v("OzoneBidder"),H(),t("design:paramtypes",
[N])],Wj);let Xj=class extends ma{constructor(a,b){super(a);this._irisTv=b;this.multiformatBidder=!0;this.bidderConfig=this._config.partners.getBidderConfig(l.Pubmatic);this.adapterName=l.Pubmatic;this.serverBidderName=l.PubmaticServer;this.gvlid=76;this.videoCreativeIds=[["138323526825",l.Pubmatic],["138323915419",l.Pubmatic],["138323915299",l.Pubmatic],["138323527095",l.Pubmatic],["138323469392",l.Pubmatic],["138323915422",l.Pubmatic],["138323469395",l.Pubmatic],["138323469389",l.Pubmatic],["138323469383",
l.Pubmatic],["138323469320",l.Pubmatic],["138323469317",l.Pubmatic],["138323527092",l.Pubmatic],["138323469401",l.Pubmatic],["138323469398",l.Pubmatic],["138323469386",l.Pubmatic],["138323469404",l.Pubmatic]];this.videoServerCreativeIds=[["138337271609",l.PubmaticServer],["138337343196",l.PubmaticServer],["138337343229",l.PubmaticServer],["138337720879",l.PubmaticServer],["138337720885",l.PubmaticServer],["138337343202",l.PubmaticServer],["138337343211",l.PubmaticServer],["138337343217",l.PubmaticServer],
["138337343232",l.PubmaticServer],["138337720597",l.PubmaticServer],["138337720888",l.PubmaticServer],["138337343199",l.PubmaticServer],["138337343214",l.PubmaticServer],["138337343223",l.PubmaticServer],["138337343226",l.PubmaticServer],["138337343220",l.PubmaticServer]];this.pubId="157347";this._map=new Map([["Below_Post",{client:"BelowPost1",server:"BelowPost1_XandrS2S"}],["Content_1",{client:"Content1",server:"Content1_XandrS2S"}],["Content_2",{client:"Content2",server:"Content2_XandrS2S"}],["Content_3",
{client:"Content3",server:"Content3_XandrS2S"}],["Content_4",{client:"Content4",server:"Content4_XandrS2S"}],["Content_5",{client:"Content5",server:"Content5_XandrS2S"}],["Content_6",{client:"Content6",server:"Content6_XandrS2S"}],["Content_7",{client:"Content7",server:"Content7_XandrS2S"}],["Content_8",{client:"Content8",server:"Content8_XandrS2S"}],["Content_9",{client:"Content9",server:"Content9_XandrS2S"}],["Footer_1",{client:"Footer1",server:"Footer1_XandrS2S"}],["Header_1",{client:"Header1",
server:"Header1_XandrS2S"}],["Header_2",{client:"Header2",server:"Header2_XandrS2S"}],["Interstitial_1",{client:"interstitial",server:"interstitial_XandrS2S"}],["Recipe_1",{client:"Recipe1",server:"Recipe1_XandrS2S"}],["Recipe_2",{client:"Recipe2",server:"Recipe2_XandrS2S"}],["Recipe_3",{client:"Recipe3",server:"Recipe3_XandrS2S"}],["Recipe_4",{client:"Recipe4",server:"Recipe4_XandrS2S"}],["Sidebar_1",{client:"Sidebar1",server:"Sidebar1_XandrS2S"}],["Sidebar_2",{client:"Sidebar2",server:"Sidebar2_XandrS2S"}],
["Sidebar_3",{client:"Sidebar3",server:"Sidebar3_XandrS2S"}],["Sidebar_4",{client:"Sidebar4",server:"Sidebar4_XandrS2S"}],["Sidebar_5",{client:"Sidebar5",server:"Sidebar5_XandrS2S"}],["Sidebar_9",{client:"Sidebar9",server:"Sidebar9_XandrS2S"}],["Video_StickyOutstream_1",{client:"2267845",server:"4018943"}],[M.Video_Collapse_Autoplay_SoundOff,{client:"1961309",server:"3437231"}],[M.Video_Coll_SOff_Smartphone,{client:"1961310",server:"3437234"}],[M.Video_In_Post_ClicktoPlay_SoundOn,{client:"1961308",
server:"3437232"}],[M.Video_Individual_Autoplay_SOff,{client:"2503033",server:"3443766"}]]);this._nativeMap=new Map([["Content_1",{client:"Content1_Native",server:"Content1_Native_S2S"}],["Content_2",{client:"Content2_Native",server:"Content2_Native_S2S"}],["Content_3",{client:"Content3_Native",server:"Content3_Native_S2S"}],["Content_4",{client:"Content4_Native",server:"Content4_Native_S2S"}],["Content_5",{client:"Content5_Native",server:"Content5_Native_S2S"}],["Content_6",{client:"Content6_Native",
server:"Content6_Native_S2S"}],["Content_7",{client:"Content7_Native",server:"Content7_Native_S2S"}],["Content_8",{client:"Content8_Native",server:"Content8_Native_S2S"}],["Content_9",{client:"Content9_Native",server:"Content9_Native_S2S"}]])}get enabled(){return this._config.partners.display.get(l.Pubmatic)}get videoEnabled(){return this._config.partners.video.get(l.Pubmatic)}getBannerSlotBidRequests(a){return this._getDisplayBidRequests(a)}getMultiFormatSlotBidRequests(a){return this._getDisplayBidRequests(a)}_getDisplayBidRequests(a){let b=
[],c={banner:this._map,native:this._nativeMap};Object.keys(c).forEach(d=>{var e="native"===d;if((d=c[d].get(a.placementMapName))&&(!e||a.nativeEnabled)){var f=this._getBidParams(this.name,d.client,a,!1,e);b.push(f);e=this._getBidParams(this.serverBidderName,d.server,a,!1,e);b.push(e)}});return b}getOutstreamSlotBidRequests(a){let b=[];this._map.has(a.placementMapName)&&(b.push(this._getBidParams(this.name,this._map.get(a.placementMapName).client,a,!1)),b.push(this._getBidParams(this.serverBidderName,
this._map.get(a.placementMapName).server,a,!1)));return b}_getBidParams(a,b,c,d=!1,e=!1){return{bidder:a,...this._addBidLabel(c.placementMapName,a,{outstreamActive:d}),params:{publisherId:this.pubId,adSlot:e?b:`${b}@${c.sizes[0][0]}x${c.sizes[0][1]}`,...(this._config.site.filteredSensitiveCategories.length&&{pmzoneid:this._config.site.filteredSensitiveCategories.join(",")})}}}getVideoSlotBidRequests(a){let b=[];this._map.has(a.name)&&(b.push(this.getVideoBidParams(this.name,this._map.get(a.name).client,
a)),b.push(this.getVideoBidParams(this.serverBidderName,this._map.get(a.name).server,a)));return b}getDCTRParam(){let a=[],b=this._irisTv.irisContextualData;b&&b.length&&a.push(`iris_context=${b.toString()}`);return a.join("|")}getVideoBidParams(a,b,c){var d,e;let f=this.getDCTRParam();return{bidder:a,params:{publisherId:this.pubId,...(f&&{dctr:f}),video:{mimes:this._config.video.mimeType,api:this._config.video.apiValue,...("all"===(null===(d=this._config.video.videoProtocols)||void 0===d?void 0:
d.scope)&&{protocols:this._config.video.videoProtocols.protocols}),...((null===(e=this._config.video.playbackmethod)||void 0===e?void 0:e.get(c.name))&&{playbackmethod:this._config.video.playbackmethod.get(c.name)})},adSlot:`${b}@${c.size[0]}x${c.size[1]}`,...(this._config.site.filteredSensitiveCategories.length&&{pmzoneid:this._config.site.filteredSensitiveCategories.join(",")})}}}};Xj=q([v("PubMaticBidder"),H(),t("design:paramtypes",[N,Oc])],Xj);let Yj=class extends ma{constructor(a){super(a);this.bidderConfig=
this._config.partners.getBidderConfig(l.ResetDigital);this.videoCreativeIds=[["138413962354",l.ResetDigital],["138413962351",l.ResetDigital],["138413962348",l.ResetDigital],["138413454348",l.ResetDigital],["138413351039",l.ResetDigital],["138413346701",l.ResetDigital],["138413346611",l.ResetDigital],["138413169413",l.ResetDigital]];this._pubId="118";this._displaySet=new Set("Below_Post Content Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9 Video_StickyOutstream_1".split(" "));
this._videoSet=new Set([M.Video_Coll_SOff_Smartphone,M.Video_Collapse_Autoplay_SoundOff,M.Video_In_Post_ClicktoPlay_SoundOn,M.Video_Individual_Autoplay_SOff])}get enabled(){return this._config.partners.display.get(l.ResetDigital)}get videoEnabled(){return this._config.partners.video.get(l.ResetDigital)}getBannerSlotBidRequests(a){return this._getBidParams(a)}getOutstreamSlotBidRequests(a){return this._getBidParams(a,!0)}getVideoSlotBidRequests(a){if(this._videoSet.has(a.name))return a=`Adthrive${a.name}`.split("_").join(""),
[{bidder:this.name,params:{pubId:this._pubId,zoneId:a}}]}_getBidParams(a,b=!1){if(this._displaySet.has(a.placementMapName)){let c=a.id.split("_").slice(0,-1).join("");return[{bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{outstreamActive:b&&"Video_StickyOutstream"!==a.location}),params:{pubId:this._pubId,zoneId:c}}]}}};Yj=q([v("ResetDigitalBidder"),H(),t("design:paramtypes",[N])],Yj);let Zj=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Roundel);
this.adapterName=l.IndexExchange;this.videoCreativeIds=[["138323538893",l.Roundel],["138323592675",l.Roundel],["138323592663",l.Roundel],["138323592660",l.Roundel],["138323983633",l.Roundel],["138323970739",l.Roundel],["138323983639",l.Roundel],["138323592699",l.Roundel],["138323592672",l.Roundel],["138323983636",l.Roundel],["138323970742",l.Roundel],["138323592693",l.Roundel],["138323592696",l.Roundel],["138323592690",l.Roundel],["138323592687",l.Roundel],["138323592684",l.Roundel]];this._params=
{siteId:"377190"};this._map=new Map([["Below_Post",[{size:[728,90]},{size:[300,250]}]],["Content_1",[{size:[728,90]},{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_2",[{size:[728,90]},{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_3",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_4",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_5",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_6",[{size:[300,250]},{size:[320,50]},{size:[300,
50]}]],["Content_7",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_8",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Content_9",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Header_1",[{size:[728,90]},{size:[970,250]},{size:[320,50]},{size:[300,50]}]],["Header_2",[{size:[728,90]},{size:[970,250]},{size:[320,50]},{size:[300,50]}]],["Footer_1",[{size:[728,90]},{size:[970,90]},{size:[320,50]},{size:[320,100]},{size:[300,50]}]],["Recipe_1",[{size:[300,250]},{size:[320,50]},
{size:[300,50]}]],["Recipe_2",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Recipe_3",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Recipe_4",[{size:[300,250]},{size:[320,50]},{size:[300,50]}]],["Sidebar_1",[{size:[300,250]},{size:[300,600]},{size:[160,600]}]],["Sidebar_2",[{size:[300,250]},{size:[300,600]},{size:[160,600]}]],["Sidebar_3",[{size:[300,250]},{size:[300,600]},{size:[160,600]}]],["Sidebar_4",[{size:[300,250]},{size:[300,600]},{size:[160,600]}]],["Sidebar_5",[{size:[300,
250]},{size:[300,600]},{size:[160,600]}]],["Sidebar_9",[{size:[300,250]},{size:[300,600]},{size:[160,600]}]]]);this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,[{size:[640,360],siteId:"485376",device:"desktop"}]],[M.Video_Coll_SOff_Smartphone,[{size:[400,225],siteId:"485377",device:"mobile"}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{size:[640,360],siteId:"485380",device:"desktop"},{size:[400,225],siteId:"485381",device:"mobile"}]],[M.Video_Individual_Autoplay_SOff,[{size:[640,360],siteId:"485378",
device:"desktop"},{size:[400,225],siteId:"485379",device:"mobile"}]]]);this._playbackmethodMap=new Map([[3,[3]],[6,[2]]])}get enabled(){return this._config.partners.display.get(l.Roundel)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._map.get(a.placementMapName).filter(({size:b})=>a.hasSize(b)).map(({size:b})=>({bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{refresh:a.viewability<this._config.marmalade.hvThreshold}),params:{...this._params,size:b}}))}getVideoSlotBidRequests(a){var b,
c;if(this._videoMap.has(a.name)){let d=Ta()?"desktop":"mobile",e=this._videoMap.get(a.name).filter(f=>f.device===d).map(({...f})=>f)[0];return[{bidder:this.name,params:{...e,video:{mimes:this._config.video.mimeType,...((null===(b=this._config.video.playbackmethod)||void 0===b?void 0:b.get(a.name))&&{playbackmethod:this._playbackmethodMap.get(this._config.video.playbackmethod.get(a.name)[0])}),api:this._config.video.apiValue,minduration:0,maxduration:30,protocols:null===(c=this._config.video.videoProtocols)||
void 0===c?void 0:c.protocols}}}]}}};Zj=q([v("RoundelBidder"),H(),t("design:paramtypes",[N])],Zj);let ak=class extends W{init(){this._key="RtbHouseExperiment";this._default=!1}};ak=q([v("RtbHouseExperiment"),y()],ak);let bk=class extends ma{constructor(a,b){super(a);this._rtbHouseExperiment=b;this.bidderConfig=this._config.partners.getBidderConfig(l.Rtbhouse);this.gvlid=16;this._map=new Set("Below_Post Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9".split(" "))}get enabled(){let a=
this._config;return this._rtbHouseExperiment.result&&a.fledge.enabled&&a.partners.display.get(l.Rtbhouse)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return[{bidder:this.name,params:{publisherId:"puHY4pgB9FOPeQBYYZEM",region:"prebid-us"},...this._addBidLabel(a.placementMapName)}]}};bk=q([v("RtbHouseBidder"),H(),t("design:paramtypes",[N,ak])],bk);let ck=class extends W{init(){this._key="RubiconMultiformatParamExperimentUpdate";this.abgroup="rmpu";this._default=!1}};ck=q([v("RubiconMultiformatParamUpdate"),
y()],ck);let dk=class extends ma{getDisplayParams(a,b){let c={server:363698,client:180726},d={server:420534,client:386004};return{accountId:9262,siteId:"Video_StickyOutstream"===b?d[a]:c[a],...("Video_StickyOutstream"===b&&{video:{language:"en"}})}}getVideoParams(a){return{accountId:9262,siteId:{server:375144,client:253996}[a],video:{language:"en"}}}constructor(a,b,c){super(a);this._rubiconExperiment=b;this._rubiconMultiformatParamExperimentUpdate=c;this.multiformatBidder=!0;this.bidderConfig=this._config.partners.getBidderConfig(l.Rubicon);
this.adapterName=l.Rubicon;this.serverBidderName=l.RubiconServer;this.gvlid=52;this.videoCreativeIds=[["138323536473",l.Rubicon],["138323540955",l.Rubicon],["138323540961",l.Rubicon],["138323540964",l.Rubicon],["138323929606",l.Rubicon],["138323480624",l.Rubicon],["138323536455",l.Rubicon],["138323540856",l.Rubicon],["138323929612",l.Rubicon],["138323480642",l.Rubicon],["138323929516",l.Rubicon],["138323480600",l.Rubicon],["138323480636",l.Rubicon],["138323536467",l.Rubicon],["138323926693",l.Rubicon],
["138323536476",l.Rubicon]];this.videoServerCreativeIds=[["138323542002",l.RubiconServer],["138323932663",l.RubiconServer],["138323544525",l.RubiconServer],["138323932642",l.RubiconServer],["138323544531",l.RubiconServer],["138323544528",l.RubiconServer],["138323932765",l.RubiconServer],["138323932768",l.RubiconServer],["138323932852",l.RubiconServer],["138323932855",l.RubiconServer],["138323544354",l.RubiconServer],["138323932858",l.RubiconServer],["138323544357",l.RubiconServer],["138323544339",
l.RubiconServer],["138323932672",l.RubiconServer],["138323932669",l.RubiconServer]];this._bidders=[];this._map=new Map([["Below_Post",{client:881394,server:1974272}],["Content_1",{client:881398,server:1974276}],["Content_2",{client:881400,server:1974280}],["Content_3",{client:881402,server:1974282}],["Content_4",{client:881404,server:1974284}],["Content_5",{client:881406,server:1974286}],["Content_6",{client:881408,server:1974288}],["Content_7",{client:881410,server:1974290}],["Content_8",{client:881412,
server:1974292}],["Content_9",{client:881414,server:1974294}],["Footer_1",{client:881416,server:1974296}],["Header_1",{client:881422,server:1974304}],["Header_2",{client:881426,server:1974306}],["Interstitial_1",{client:1979348,server:1979354}],["Recipe_1",{client:881428,server:1974308}],["Recipe_2",{client:881430,server:1974310}],["Recipe_3",{client:1187188,server:1974312}],["Recipe_4",{client:1279328,server:1974314}],["Sidebar_1",{client:881440,server:1974316}],["Sidebar_2",{client:881454,server:1974318}],
["Sidebar_3",{client:881460,server:1974320}],["Sidebar_4",{client:881462,server:1974322}],["Sidebar_5",{client:881466,server:1974324}],["Sidebar_9",{client:881478,server:1974332}],["Video_StickyOutstream_1",{client:2150398,server:2384630}],[M.Video_Collapse_Autoplay_SoundOff,{client:1259006,server:2055644}],[M.Video_Coll_SOff_Smartphone,{client:1259010,server:2055648}],[M.Video_In_Post_ClicktoPlay_SoundOn,{client:1259008,server:2055642}],[M.Video_Individual_Autoplay_SOff,{client:1506800,server:2055646}]]);
a="both"===this._rubiconExperiment.result||"client"===this._rubiconExperiment.result;this._config.prebid.s2s.bidders.includes(l.RubiconServer)&&this._bidders.push({name:this.serverBidderName,type:"server"});a&&this._bidders.push({name:this.name,type:"client"})}get enabled(){return this._config.partners.display.get(l.Rubicon)}get videoEnabled(){return this._config.partners.video.get(l.Rubicon)}getBannerSlotBidRequests(a){return this._getBidParams(a)}getMultiFormatSlotBidRequests(a){return this._getMultiformatBidParams(a)}getOutstreamSlotBidRequests(a){return this._getBidParams(a,
!0)}getVideoSlotBidRequests(a){if(this._map.has(a.name))return this._bidders.map(b=>({bidder:b.name,params:{...this.getVideoParams(b.type),zoneId:this._map.get(a.name)[b.type]}}))}updateBidParams(a){this._addPositionParam(a,"atf")}_getMultiformatBidParams(a){(a=this._getBidParams(a,!1))&&this._rubiconMultiformatParamExperimentUpdate.result&&a.forEach(b=>{b.params&&(b.params.bidonmultiformat=!0)});return a}_getBidParams(a,b=!1){let c=b&&"Video_StickyOutstream"!==a.location;if(this._map.has(a.placementMapName))return this._bidders.reduce((d,
e)=>{"client"===e.type&&c||d.push({bidder:e.name,...this._addBidLabel(a.placementMapName,e.name,{outstreamActive:c}),params:{...this.getDisplayParams(e.type,a.location),zoneId:this._map.get(a.placementMapName)[e.type],...(a.isHighlyViewable()&&{position:"atf"})}});return d},[])}};dk=q([v("RubiconBidder"),H(),t("design:paramtypes",[N,sd,ck])],dk);let qq=new Map([["Below_Post",[{size:[728,90],pkey:"WoVFJAUvQg9oowjifOQLhHfb"}]],["Content_1",[{size:[728,90],pkey:"9kDU40A4BJXchR7ikuWND5Ui"}]],["Content_2",
[{size:[728,90],pkey:"ocdg6DMXhAfaTk7KgImuPCPi"}]],["Content_3",[{size:[728,90],pkey:"JQXmRwXj1jOjHCQF8ufXkKIJ"}]],["Content_4",[{size:[728,90],pkey:"7DEh5436UHnmeKGzVXQVsvRk"}]],["Content_5",[{size:[728,90],pkey:"ZWVmSVe4txKlxxCQoqMcGIus"}]],["Content_6",[{size:[728,90],pkey:"T3CRI7sep8LYNDkOrvgSZUPQ"}]],["Content_7",[{size:[728,90],pkey:"T4LKxfIKZJCqFzBemjae6MGu"}]],["Content_8",[{size:[728,90],pkey:"TIHmP6MqapPY4RpbkOm3pYpV"}]],["Content_9",[{size:[728,90],pkey:"mBGMr6mqftj8c2qcQky6UjEB"}]],["Footer_1",
[{size:[970,90],pkey:"B1C8tQAkMN7kpCuxh1hW6CY8"}]],["Header_1",[{size:[970,250],pkey:"jStKXZxN8Ccuf6XS4dKqhKr9"}]],["Header_2",[{size:[970,250],pkey:"TJx2N6gevlYeFawnBbRy4gRl"}]],["Recipe_1",[{size:[300,250],pkey:"lklI3sAvIozfaIGNQGORtPOR"}]],["Recipe_2",[{size:[300,250],pkey:"nWhVYiRycgz0snwL4hTcS3vA"}]],["Recipe_3",[{size:[300,250],pkey:"XTsNJ5wTa3CksG40rnRNHiib"}]],["Recipe_4",[{size:[300,250],pkey:"BpO7D8zDzdyGmFUOGNcRhUUm"}]],["Sidebar_1",[{size:[300,600],pkey:"1BptSVedVseFELcEHmSjZmDr"}]],["Sidebar_2",
[{size:[300,600],pkey:"TAk15aJmBw3jMFoV9vSYYWLl"}]],["Sidebar_3",[{size:[300,600],pkey:"oSwBRQCb6174NZ0wDEyxZW9E"}]],["Sidebar_4",[{size:[300,600],pkey:"UMKQPvhCYMOH1sOPVdYEDEQt"}]],["Sidebar_5",[{size:[300,600],pkey:"WdPWJ92IfPqKgO5vRXvlsDO4"}]],["Sidebar_9",[{size:[300,600],pkey:"k8W1t71k8qmkYsiK4v3pop6j"}]],["Video_StickyOutstream_1",[{size:[300,250],pkey:"qKjlCz8NOStHzB15G18scbgS"}]]]),wu=new Map([[M.Video_Collapse_Autoplay_SoundOff,[{size:[640,360],pkey:"I5VjN89qESPMegBdpCt92W8S"}]],[M.Video_Coll_SOff_Smartphone,
[{size:[400,225],pkey:"iZXbFkwkNrOgpI7ue8o3mJda"}]],[M.Video_In_Post_ClicktoPlay_SoundOn,[{size:[640,360],pkey:"sMLWZBQNa6GaKC2khQiIg5Tj"},{size:[400,225],pkey:"yHkEhAMj24ubV101Fklbp6fA"}]],[M.Video_Individual_Autoplay_SOff,[{size:[640,360],pkey:"GCV9Do84nDBEFaVjb507H4iE"},{size:[400,225],pkey:"6lY8mDlZX6W7ijhbh6OuDCfj"}]]]),ek=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Sharethrough);this.videoCreativeIds=[["138377683089",l.Sharethrough],["138377670131",
l.Sharethrough],["138377670158",l.Sharethrough],["138377670173",l.Sharethrough],["138378141751",l.Sharethrough],["138377670161",l.Sharethrough],["138377670167",l.Sharethrough],["138377670170",l.Sharethrough],["138377670209",l.Sharethrough],["138377670212",l.Sharethrough],["138377670224",l.Sharethrough],["138377669645",l.Sharethrough],["138377670218",l.Sharethrough],["138377670221",l.Sharethrough],["138378141754",l.Sharethrough],["138377670215",l.Sharethrough]]}get enabled(){return this._config.partners.display.get(l.Sharethrough)}get videoEnabled(){return this._config.partners.video.get(l.Sharethrough)}getBannerSlotBidRequests(a){let b=
qq.get(a.placementMapName);if(b&&"Video_StickyOutstream"!==a.location)return this._getBidParams(a,b)}getOutstreamSlotBidRequests(a){let b=qq.get(a.placementMapName);if(b&&"Video_StickyOutstream"===a.location)return this._getBidParams(a,b)}getVideoSlotBidRequests(a){return wu.get(a.name).filter(({size:b})=>a.size[0]===b[0]&&a.size[1]===b[1]).map(({pkey:b})=>({bidder:this.name,params:{pkey:b}}))}_getBidParams(a,b){return b.filter(({size:c})=>a.hasSize(c)).map(({pkey:c})=>({bidder:this.name,params:{pkey:c},
...this._addBidLabel(a.placementMapName)}))}};ek=q([v("SharethroughBidder"),H(),t("design:paramtypes",[N])],ek);let fk=class extends ma{constructor(a,b){super(a);this._mediaType=b;this.bidderConfig=this._config.partners.getBidderConfig(l.Teads);this._pageId=112062;this._adTypeBitIndexMap=new Map([["outstream",{adType:ca()?"outstreamMobile":"outstreamDesktop",index:1}],["miniscroller",{adType:"miniscroller",index:2}],["interscroller",{adType:"interscroller",index:3}]]);this._adUnitsMap=new Map([["Below_Post",
[]],["Content_1",["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],["Content_2",["miniscroller","interscroller"]],["Content_3",["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],["Content_4",["miniscroller","interscroller"]],["Content_5",["outstreamDesktop","outstreamMobile","miniscroller","interscroller"]],["Content_6",["miniscroller","interscroller"]],["Content_7",["miniscroller","interscroller"]],["Content_8",["miniscroller","interscroller"]],["Content_9",
["miniscroller","interscroller"]],["Footer_1",[]],["Header_1",[]],["Header_2",[]],["Recipe_1",["outstreamDesktop","outstreamMobile","miniscroller"]],["Recipe_2",["miniscroller"]],["Recipe_3",["miniscroller"]],["Recipe_4",["miniscroller"]],["Sidebar_1",[]],["Sidebar_2",[]],["Sidebar_3",[]],["Sidebar_4",[]],["Sidebar_5",[]],["Sidebar_9",[]]]);this._deviceAdTypes={mobile:["outstreamMobile","interscroller","miniscroller"],desktop:["outstreamDesktop"]};this._placementIdMap=new Map([["1000",{id:121842}],
["1001",{id:121836}],["1010",{id:121835}],["1011",{id:121840}],["1100",{id:121834}],["1101",{id:121838}],["1110",{id:121837}],["1111",{id:121895}]])}get enabled(){return this._config.partners.display.get(l.Teads)}lazyActiveTypes(a,b){if(!a.lazy)return!1;let c=["interscroller","miniscroller"];return["Content","Recipe","Below_Post"].includes(a.location)&&c.includes(b)}createBitArrayAdOptions(a,b=!1){let c=ca()?this._deviceAdTypes.mobile:this._deviceAdTypes.desktop,d=["1","0","0","0"],e=this._adUnitsMap.get(a.placementMapName);
this._adTypeBitIndexMap.forEach((f,g)=>{let h=f.adType;c.includes(h)&&this._config.adTypes.has(h)&&(e.includes(h)||this.lazyActiveTypes(a,h))&&(d[f.index]="outstream"===g?b&&this._mediaType.outstreamEnabled(a).currentlyActive?"1":"0":"1")});return d}getBannerSlotBidRequests(a){if(this._adUnitsMap.has(a.placementMapName)){var b=this.createBitArrayAdOptions(a);b=this._placementIdMap.get(b.join(""));return[{bidder:this.name,params:{placementId:b.id,pageId:this._pageId},...this._addBidLabel(a.placementMapName,
this.name)}]}}getOutstreamSlotBidRequests(a){if(this._adUnitsMap.has(a.placementMapName)){var b=this.createBitArrayAdOptions(a,!0);b=this._placementIdMap.get(b.join(""));return[{bidder:this.name,...this._addBidLabel(a.placementMapName,this.name,{outstreamActive:"Video_StickyOutstream"!==a.location}),params:{placementId:b.id,pageId:this._pageId}}]}}};fk=q([v("TeadsBidder"),H(),t("design:paramtypes",[N,gb])],fk);let rq=new Map([["Interstitial_1",{desktop:{adTypes:[]},mobile:{adTypes:[]}}],["Below_Post",
{desktop:{adTypes:["nativeDesktopBelowPost"],sizes:[[728,250],[728,90]]},mobile:{adTypes:["nativeMobileBelowPost"],sizes:[[300,250],[320,100]]}}],["Content_1",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_2",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_3",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_4",{desktop:{adTypes:["nativeDesktopContent"]},
mobile:{adTypes:["nativeMobileContent"]}}],["Content_5",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_6",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_7",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_8",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],["Content_9",{desktop:{adTypes:["nativeDesktopContent"]},mobile:{adTypes:["nativeMobileContent"]}}],
["Footer_1",{desktop:{adTypes:[]},mobile:{adTypes:[]}}],["Header_1",{desktop:{adTypes:["nativeDesktopHeader"],sizes:[[970,250],[728,90]]},mobile:{adTypes:["nativeMobileHeader"],sizes:[[320,100]]}}],["Header_2",{desktop:{adTypes:["nativeDesktopHeader"],sizes:[[970,250],[728,90]]},mobile:{adTypes:["nativeMobileHeader"],sizes:[[320,100]]}}],["Recipe_1",{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],["Recipe_2",{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],
["Recipe_3",{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],["Recipe_4",{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],["Recipe_5",{desktop:{adTypes:["nativeDesktopRecipe"]},mobile:{adTypes:["nativeMobileRecipe"]}}],["Sidebar_1",{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],["Sidebar_2",{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],["Sidebar_3",{desktop:{adTypes:["nativeDesktopSidebar"]},
mobile:{adTypes:[]}}],["Sidebar_4",{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],["Sidebar_5",{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],["Sidebar_9",{desktop:{adTypes:["nativeDesktopSidebar"]},mobile:{adTypes:[]}}],["Video_StickyOutstream_1",{desktop:{adTypes:[]},mobile:{adTypes:[]}}]]),gk=new Map([[M.Video_Collapse_Autoplay_SoundOff,{client:"AdThriveRON_instream_desktopcollapse_prebid_c2s",server:"AdThriveRON_instream_desktopcollapse_prebid"}],[M.Video_Coll_SOff_Smartphone,
{client:"AdThriveRON_instream_mwebsticky_prebid_c2s",server:"AdThriveRON_instream_mwebsticky_prebid"}],[M.Video_In_Post_ClicktoPlay_SoundOn,{client:"AdThriveRON_instream_CTP_prebid_c2s",server:"AdThriveRON_instream_CTP_prebid"}],[M.Video_Individual_Autoplay_SOff,{client:"AdThriveRON_instream_contextcollapse_prebid_c2s",server:"AdThriveRON_instream_contextcollapse_prebid"}]]),hk=class extends ma{constructor(a,b,c){super(a);this._tripleLiftExperiment=b;this._mediaType=c;this.multiformatBidder=!0;this.bidderConfig=
this._config.partners.getBidderConfig(l.Triplelift);this.adapterName=l.Triplelift;this.serverBidderName=l.TripleliftServer;this.gvlid=28;this.videoCreativeIds=[["138323510289",l.Triplelift],["138323472959",l.Triplelift],["138323472731",l.Triplelift],["138323472671",l.Triplelift],["138323472641",l.Triplelift],["138323473061",l.Triplelift],["138323473058",l.Triplelift],["138323473019",l.Triplelift],["138323473016",l.Triplelift],["138323472986",l.Triplelift],["138323472734",l.Triplelift],["138323473064",
l.Triplelift],["138323473055",l.Triplelift],["138323472728",l.Triplelift],["138323472674",l.Triplelift],["138323472737",l.Triplelift],["138326649881",l.Triplelift],["138326691825",l.Triplelift],["138326691828",l.Triplelift],["138326691831",l.Triplelift],["138326691834",l.Triplelift],["138326691837",l.Triplelift],["138326691840",l.Triplelift],["138326691843",l.Triplelift],["138326691846",l.Triplelift],["138326691783",l.Triplelift],["138326691786",l.Triplelift],["138326691789",l.Triplelift],["138326691792",
l.Triplelift],["138326691753",l.Triplelift],["138326691756",l.Triplelift],["138326691570",l.Triplelift]];this.videoServerCreativeIds=[["138348653814",l.TripleliftServer],["138348654438",l.TripleliftServer],["138349054156",l.TripleliftServer],["138349054168",l.TripleliftServer],["138349054201",l.TripleliftServer],["138348654432",l.TripleliftServer],["138348654444",l.TripleliftServer],["138349054186",l.TripleliftServer],["138349054204",l.TripleliftServer],["138349054210",l.TripleliftServer],["138349054435",
l.TripleliftServer],["138349054189",l.TripleliftServer],["138349054207",l.TripleliftServer],["138349054426",l.TripleliftServer],["138349054429",l.TripleliftServer],["138349054432",l.TripleliftServer]];this._serverEnabled=this._clientEnabled=!1;this._standardInclusionAdTypes=["nativeMobileHeader","nativeMobileBelowPost","nativeDesktopHeader","nativeDesktopBelowPost"];this.settings={adserverTargeting:[{key:"hb_format",val:({meta:d,tl_source:e})=>d&&d.mediaType||this.tlSourceMap.get(e||"")}]};this.tlSourceMap=
new Map([["hdx","banner"],["tlx","native"]]);this._verticalCategoryMap=new Map([["Baby","family"],["Family and Parenting","family"],["Natural Parenting","family"],["Pregnancy","family"],["Toddler","family"],["Personal Finance","finance"],["Professional Finance","finance"],["Deals","finance"],["Clean Eating","food"],["Food","food"],["Crafts","home"],["Gardening","home"],["Green Living","home"],["Home Decor and Design","home"],["Pets","home"],["Travel","travel"],["News","news"],["Lifestyle","lifestyle"],
["Beauty","lifestyle"],["Other","lifestyle"],["Health and Fitness","health"],["Entertainment","entertainment"],["Sports","sports"],["Womens Style","womensstyle"],["Mens Style and Grooming","mensstyle"],["Tech","tech"],["Wedding","wedding"],["Auto","auto"]]);this._categoryPriorityList=new Set("food home family finance travel news health entertainment sports womensstyle mensstyle tech wedding auto lifestyle".split(" "));this._category=Q(this._getCategory(),"lifestyle");this._deviceAdTypes={mobile:["nativeMobileContent",
"nativeMobileRecipe","nativeMobileHeader","nativeMobileBelowPost"],desktop:["nativeDesktopContent","nativeDesktopRecipe","nativeDesktopSidebar","nativeDesktopHeader","nativeDesktopBelowPost"]};this._clientEnabled="both"===this._tripleLiftExperiment.result||"client"===this._tripleLiftExperiment.result;this._serverEnabled=this._config.prebid.s2s.bidders.includes(l.TripleliftServer)}get enabled(){return this._config.partners.display.get(l.Triplelift)}get videoEnabled(){return this._config.partners.video.get(l.Triplelift)}_getSharedSlotBidRequests(a){let b=
this._mediaType.outstreamEnabled(a).outstreamCapable&&"Video_StickyOutstream"!==a.location;var c=ca()?"mobile":"desktop";let d=this._deviceAdTypes[c].filter(f=>this._config.adTypes.has(f)),e=[];if(rq.has(a.placementMapName)){let f="Interstitial"===a.location?"interstitial":"standard";c=rq.get(a.placementMapName)[c];c.adTypes.forEach(g=>{d.includes(g)&&(f=g)});this.getInventoryCode(f,a,c.sizes).forEach(g=>{let h=this._addBidLabel(a.placementMapName,this._serverEnabled?this.serverBidderName:this.name,
{outstreamActive:b&&-1<g.indexOf("hive")});this._clientEnabled&&e.push({bidder:this.name,...h,params:{inventoryCode:g}});this._serverEnabled&&e.push({bidder:this.serverBidderName,...h,params:{inventoryCode:`${g}_pbs2s`}})})}return e}getBannerSlotBidRequests(a){return this._getSharedSlotBidRequests(a)}getOutstreamSlotBidRequests(a){return this._getSharedSlotBidRequests(a)}getMultiFormatSlotBidRequests(a){return this._getSharedSlotBidRequests(a)}_isOutstreamAndContentCapable(a){return"Content"===a.location&&
this._mediaType.outstreamEnabled(a).outstreamCapable}getInventoryCode(a,b,c){let d=ca()?"mobile":"desktop",e=[];"standard"===a||this._standardInclusionAdTypes.includes(a)?(a="Video_StickyOutstream_1"===b.placementMapName?`_${d}`:"",e.push(`adthrive_${("Below_Post"===b.placementMapName?"Below_Post_1":b.placementMapName).toLowerCase()}${a}_hdx`)):"interstitial"===a&&e.push("adthriveron_interstitial_multisize");a="Content_1"===b.placementMapName||"Sidebar_9"===b.placementMapName?b.location.toLowerCase():
b.placementMapName.toLowerCase().replace(/_(?!.*_)/,"");if(c){let f=b.location.toLowerCase().replace(/_(?!.*_)/,"");c.filter(g=>b.sizes.some(([h,k])=>h===g[0]&&k===g[1])).forEach(g=>{e.push(`adthriveron_${f}_${d}_${g[0]}x${g[1]}`)},[])}return e.length?e:[`adthrive${this._category}_${a}_fixed_${d}`,...(this._isOutstreamAndContentCapable(b)?[`adthriveron_content_${d}_hive`]:[])]}_getVideoBidParams(a,b,c){var d,e,f;return{bidder:a,params:{inventoryCode:c,video:{...(Ta()?{w:640,h:360}:{w:400,h:225}),
api:this._config.video.apiValue,mimes:this._config.video.mimeType,...("all"===(null===(d=this._config.video.videoProtocols)||void 0===d?void 0:d.scope)&&{protocols:this._config.video.videoProtocols.protocols}),playbackmethod:null===(f=null===(e=this._config.video.playbackmethod)||void 0===e?void 0:e.get(b.name))||void 0===f?void 0:f[0],pos:this._config.video.position.id}}}}getVideoSlotBidRequests(a){let b=[];gk.has(a.name)&&(this._clientEnabled&&b.push(this._getVideoBidParams(this.name,a,gk.get(a.name).client)),
this._serverEnabled&&b.push(this._getVideoBidParams(this.serverBidderName,a,gk.get(a.name).server)));return b}_getCategory(){let a=this._config.site.verticals.filter(b=>this._verticalCategoryMap.has(b)).map(b=>this._verticalCategoryMap.get(b));for(let b of this._categoryPriorityList)if(a.includes(b))return b}};hk=q([v("TripleLiftBidder"),H(),t("design:paramtypes",[N,td,gb])],hk);let ik=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.TTD);this.videoCreativeIds=
[["138323472896",l.TTD],["138323532681",l.TTD],["138323532645",l.TTD],["138323532675",l.TTD],["138323532678",l.TTD],["138323922211",l.TTD],["138323530488",l.TTD],["138323532606",l.TTD],["138323532648",l.TTD],["138323922202",l.TTD],["138323532672",l.TTD],["138323922205",l.TTD],["138323922010",l.TTD],["138323922208",l.TTD],["138323532642",l.TTD],["138323921998",l.TTD]];this._device=this._config.context.device;this._set=new Set(["Below_Post","Content_1","Content_2","Content_3","Content_4","Content_5",
"Content_6","Content_7","Content_8","Content_9","Footer_1","Header_1","Recipe_1","Recipe_2","Recipe_3","Recipe_4","Sidebar_1","Sidebar_2","Sidebar_3","Sidebar_4","Sidebar_5","Sidebar_9","Video_StickyOutstream_1",M.Video_Collapse_Autoplay_SoundOff,M.Video_Coll_SOff_Smartphone,M.Video_In_Post_ClicktoPlay_SoundOn,M.Video_Individual_Autoplay_SOff])}get enabled(){return this._config.partners.display.get(l.TTD)}get videoEnabled(){return this._config.partners.video.get(l.TTD)}getBannerSlotBidRequests(a){if(this._set.has(a.placementMapName)&&
"Video_StickyOutstream"!==a.location)return this._getBidParams(a)}getOutstreamSlotBidRequests(a){if(this._set.has(a.placementMapName))return this._getBidParams(a,"Video_StickyOutstream"!==a.location)}getVideoSlotBidRequests(a){if(this._set.has(a.name))return[{bidder:this.name,params:{publisherId:this._config.site.id,siteId:this._config.site.id,placementId:`${a.name}`,supplySourceId:"cafemedia"}}]}_getBidParams(a,b=!1){let c=a.id,d=new RegExp(`_${this._device}`);return[{bidder:this.name,...this._addBidLabel(a.placementMapName,
void 0,{outstreamCapable:b}),params:{publisherId:this._config.site.id,siteId:this._config.site.id,placementId:c.replace(d,""),supplySourceId:"cafemedia"}}]}};ik=q([v("TTDBidder"),H(),t("design:paramtypes",[N])],ik);let jk=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Undertone);this._params={publisherId:2002};this._deviceAdTypes={mobile:["animatedFooter","expandableFooter","interscroller","miniscroller"],desktop:[]};this._map=new Map([["Below_Post",
[{placementId:"2002034",size:[[1,2]],adType:"interscroller",highViewability:!0},{placementId:"2002036",size:[[300,250]],highViewability:!0}]],["Content_1",[{placementId:"2002001",size:[[1,2]],adType:"interscroller"},{placementId:"2002002",size:[[1,2],[300,250],[728,90]]}]],["Content_2",[{placementId:"2002003",size:[[1,2],[300,250],[728,90]]}]],["Content_3",[{placementId:"2002004",size:[[1,2],[300,250],[728,90]]}]],["Content_4",[{placementId:"2002005",size:[[1,2],[300,250],[728,90]]}]],["Footer_1",
[{placementId:"2002033",size:[[320,50]],adType:"expandableFooter"},{placementId:"2002038",size:[[1,1]],adType:"expandableFooter",mobileCollapsePlayer:!0},{placementId:"2002039",size:[[1,1]],adType:"animatedFooter"}]],["Header_1",[{placementId:"2002037",size:[[970,250]]}]],["Interstitial_1",[{placementId:"2002040",size:[[1,1]]}]],["Recipe_1",[{placementId:"2002020",size:[[300,250]]}]],["Recipe_2",[{placementId:"2002021",size:[[300,250]]}]],["Recipe_3",[{placementId:"2002022",size:[[300,250]]}]],["Recipe_4",
[{placementId:"2002023",size:[[300,250]]}]],["Sidebar_9",[{placementId:"2002032",size:[[300,250],[160,600],[300,600]]}]]])}get enabled(){return this._config.partners.display.get(l.Undertone)}getBannerSlotBidRequests(a){let b=(ca()?this._deviceAdTypes.mobile:this._deviceAdTypes.desktop).filter(d=>this._config.adTypes.has(d)),c=d=>d.some(e=>a.hasSize(e));if(this._map.has(a.placementMapName))return this._map.get(a.placementMapName).filter(({adType:d,mobileCollapsePlayer:e,size:f})=>(!d&&c(f)||d&&b.includes(d))&&
(!e||!this._config.video.mobileStickyPlayerOnPage)).map(({placementId:d,size:e,highViewability:f,adType:g})=>({bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{refresh:f&&a.viewability<this._config.marmalade.hvThreshold}),params:{...this._params,placementId:d,size:e.filter(h=>a.hasSize(h)||g&&b.includes(g))}}))}};jk=q([v("UndertoneBidder"),y(),t("design:paramtypes",[N])],jk);let kk=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.UndertoneServer);
this.adapterName=l.Undertone;this.videoCreativeIds=[["138422425195",l.UndertoneServer],["138421771020",l.UndertoneServer],["138421771017",l.UndertoneServer],["138421771014",l.UndertoneServer],["138421761770",l.UndertoneServer],["138421761767",l.UndertoneServer],["138421761764",l.UndertoneServer],["138421761761",l.UndertoneServer]];this._params={publisherId:2002};this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,{placementId:2002044}],[M.Video_Coll_SOff_Smartphone,{placementId:2002045}],
[M.Video_In_Post_ClicktoPlay_SoundOn,{placementId:2002046}],[M.Video_Individual_Autoplay_SOff,{placementId:2002047}]])}get videoEnabled(){return this._config.partners.video.get(l.UndertoneServer)}getVideoSlotBidRequests(a){if(this._videoMap.has(a.name))return[{bidder:this.name,params:{publisherId:this._params.publisherId,placementId:this._videoMap.get(a.name).placementId}}]}};kk=q([v("UndertoneServerBidder"),H(),t("design:paramtypes",[N])],kk);let lk=class extends ma{constructor(a,b){super(a);this._mediaType=
b;this.bidderConfig=this._config.partners.getBidderConfig(l.Unruly);this.videoCreativeIds=[["138398568419",l.Unruly],["138398715243",l.Unruly],["138398716629",l.Unruly],["138398716632",l.Unruly],["138398716656",l.Unruly],["138398716659",l.Unruly],["138398716662",l.Unruly],["138398716665",l.Unruly],["138398716683",l.Unruly],["138398716686",l.Unruly],["138398716689",l.Unruly],["138398716692",l.Unruly],["138398716695",l.Unruly],["138398716698",l.Unruly],["138398716701",l.Unruly],["138398716704",l.Unruly]];
this._params={siteId:249232}}get enabled(){return this._config.partners.display.get(l.Unruly)}get videoEnabled(){return this._config.partners.video.get(l.Unruly)}getBannerSlotBidRequests(a){return[{bidder:this.name,params:{...this._params},...this._addBidLabel(a.placementMapName)}]}getVideoSlotBidRequests(){return[{bidder:this.name,params:{...this._params}}]}};lk=q([v("UnrulyBidder"),H(),t("design:paramtypes",[N,gb])],lk);let mk=class extends ma{constructor(a){super(a);this._config=a;this.bidderConfig=
this._config.partners.getBidderConfig(l.Verizon);this.adapterName="aol";this._params={dcn:ca()?"8a969d580177771bc13c2047d6290082":"8a9694d00177771bcae21c6941d30023"};this._desktopMap=new Map([["Content_1",[{size:[300,250],id:"8a969d580177771bc13c20458198007e"},{size:[728,90],id:"8a96918c0177771bc65220467ff60092"}]],["Content_2",[{size:[300,250],id:"8a96918c0177771bc652204531fe0091"}]],["Content_3",[{size:[300,250],id:"8a9694d00177771bcae220463a710058"}]],["Footer_1",[{size:[728,90],id:"8a9694d00177771bcae21c6a7d880025"},
{size:[970,90],id:"8a969d580177771bc13c2046cd280081"},{size:[320,50],id:"8a9694d00177771bcae2204408520056"}]],["Header_1",[{size:[728,90],id:"8a969d580177771bc13c2045cac4007f"}]],["Interstitial_1",[{size:[300,250],id:"8a969449017c7c9d384d9f8170b10066"},{size:[300,600],id:"8a969449017c7c9d384d9f80b9970064"},{size:[320,480],id:"8a969958017c7c9d2d8a9f812d360081"},{size:[336,280],id:"8a969449017c7c9d384d9f80f2a20065"}]],["Sidebar_1",[{size:[300,250],id:"8a9694d00177771bcae2204449d80057"}]],["Sidebar_9",
[{size:[320,50],id:"8a969d580177771bc13c2045ff6b0080"},{size:[300,600],id:"8a96918c0177771bc6522043c8540090"},{size:[160,600],id:"8a969d580177771bc13c2044ea91007d"},{size:[300,250],id:"8a96918c0177771bc6521c6b5f4e003f"}]],["Recipe_1",[{size:[300,250],id:"8a9694d00177771bcae21c6bc7e80027"}]],["Recipe_2",[{size:[300,250],id:"8a969d580177771bc13c2044ac08007c"}]]]);this._mobileMap=new Map([["Content_1",[{size:[300,250],id:"8a969d580177771bc13c2048bd0e0085"},{size:[320,50],id:"8a969d580177771bc13c204b68670088"}]],
["Content_2",[{size:[300,250],id:"8a96918c0177771bc652204877c50094"},{size:[320,50],id:"8a96918c0177771bc652204b257e0097"}]],["Content_3",[{size:[300,250],id:"8a96918c0177771bc6522048f24e0095"}]],["Content_4",[{size:[300,250],id:"8a9694d00177771bcae220497831005a"}]],["Content_5",[{size:[300,250],id:"8a969d580177771bc13c204a5f240087"}]],["Content_6",[{size:[300,250],id:"8a9694d00177771bcae2204a9092005c"}]],["Footer_1",[{size:[320,100],id:"8a96918c0177771bc652204a27cb0096"},{size:[300,50],id:"8a9694d00177771bcae22049449a0059"},
{size:[728,90],id:"8a9694d00177771bcae2204ad481005d"},{size:[320,50],id:"8a969d580177771bc13c20480cf50084"}]],["Interstitial_1",[{size:[300,250],id:"8a969161017c7c9d32879f82491c007d"},{size:[300,600],id:"8a969161017c7c9d32879f8195b3007c"},{size:[320,480],id:"8a969958017c7c9d2d8a9f81f2c50082"},{size:[336,280],id:"8a969449017c7c9d384d9f81c5660067"},{size:[320,50],id:"8a969449017c7c9d384d9f8279950068"}]],["Recipe_1",[{size:[300,250],id:"8a96918c0177771bc6522048483a0093"}]],["Recipe_2",[{size:[300,250],
id:"8a9694d00177771bcae22049e596005b"}]],["Recipe_3",[{size:[300,250],id:"8a969d580177771bc13c2049b47f0086"}]]]);this._map=ca()?this._mobileMap:this._desktopMap}get enabled(){return this._config.partners.display.get(l.Verizon)}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName))return this._map.get(a.placementMapName).filter(({size:b})=>a.hasSize(b)).map(({id:b})=>({bidder:this.name,params:{...this._params,...(this._config.site.filteredSensitiveCategories.length&&{ext:{sens:this._config.site.filteredSensitiveCategories}}),
pos:b},...this._addBidLabel(a.placementMapName)}))}};mk=q([v("VerizonBidder"),H(),t("design:paramtypes",[N])],mk);let sq=new Map([[M.Video_Collapse_Autoplay_SoundOff,{client:"8a96941a017e7e91c49492261bdf000c",server:"8a9695b901888852d78e6cde78c2003e"}],[M.Video_Coll_SOff_Smartphone,{client:"8a9690ee017e7e91bee0922682f1000b",server:"8a9698af01888852cc626cde79b3002e"}],[M.Video_In_Post_ClicktoPlay_SoundOn,{client:"8a969951017e7e91ba38923576c20011",server:"8a9695b901888852d78e6cde7a3b003f"}],[M.Video_Individual_Autoplay_SOff,
{client:"8a969951017e7e91ba389236dc470014",server:"8a9691d801888852d23d6cde79390031"}]]),xu={desktop:new Map([["Content_1",[{size:[300,250],id:"8a969d580177771bc13c20458198007e"},{size:[728,90],id:"8a96918c0177771bc65220467ff60092"}]],["Content_2",[{size:[300,250],id:"8a96918c0177771bc652204531fe0091"}]],["Content_3",[{size:[300,250],id:"8a9694d00177771bcae220463a710058"}]],["Footer_1",[{size:[728,90],id:"8a9694d00177771bcae21c6a7d880025"},{size:[970,90],id:"8a969d580177771bc13c2046cd280081"},{size:[320,
50],id:"8a9694d00177771bcae2204408520056"}]],["Header_1",[{size:[728,90],id:"8a969d580177771bc13c2045cac4007f"}]],["Interstitial_1",[{size:[300,250],id:"8a969449017c7c9d384d9f8170b10066"},{size:[300,600],id:"8a969449017c7c9d384d9f80b9970064"},{size:[320,480],id:"8a969958017c7c9d2d8a9f812d360081"},{size:[336,280],id:"8a969449017c7c9d384d9f80f2a20065"}]],["Sidebar_1",[{size:[300,250],id:"8a9694d00177771bcae2204449d80057"}]],["Sidebar_9",[{size:[320,50],id:"8a969d580177771bc13c2045ff6b0080"},{size:[300,
600],id:"8a96918c0177771bc6522043c8540090"},{size:[160,600],id:"8a969d580177771bc13c2044ea91007d"},{size:[300,250],id:"8a96918c0177771bc6521c6b5f4e003f"}]],["Recipe_1",[{size:[300,250],id:"8a9694d00177771bcae21c6bc7e80027"}]],["Recipe_2",[{size:[300,250],id:"8a969d580177771bc13c2044ac08007c"}]],["Video_StickyOutstream_1",[{size:[300,250],id:"8a969d87017b7be074aae07a22b70005"}]]]),mobile:new Map([["Content_1",[{size:[300,250],id:"8a969d580177771bc13c2048bd0e0085"},{size:[320,50],id:"8a969d580177771bc13c204b68670088"}]],
["Content_2",[{size:[300,250],id:"8a96918c0177771bc652204877c50094"},{size:[320,50],id:"8a96918c0177771bc652204b257e0097"}]],["Content_3",[{size:[300,250],id:"8a96918c0177771bc6522048f24e0095"}]],["Content_4",[{size:[300,250],id:"8a9694d00177771bcae220497831005a"}]],["Content_5",[{size:[300,250],id:"8a969d580177771bc13c204a5f240087"}]],["Content_6",[{size:[300,250],id:"8a9694d00177771bcae2204a9092005c"}]],["Footer_1",[{size:[320,100],id:"8a96918c0177771bc652204a27cb0096"},{size:[300,50],id:"8a9694d00177771bcae22049449a0059"},
{size:[728,90],id:"8a9694d00177771bcae2204ad481005d"},{size:[320,50],id:"8a969d580177771bc13c20480cf50084"}]],["Interstitial_1",[{size:[300,250],id:"8a969161017c7c9d32879f82491c007d"},{size:[300,600],id:"8a969161017c7c9d32879f8195b3007c"},{size:[320,480],id:"8a969958017c7c9d2d8a9f81f2c50082"},{size:[336,280],id:"8a969449017c7c9d384d9f81c5660067"},{size:[320,50],id:"8a969449017c7c9d384d9f8279950068"}]],["Recipe_1",[{size:[300,250],id:"8a96918c0177771bc6522048483a0093"}]],["Recipe_2",[{size:[300,250],
id:"8a9694d00177771bcae22049e596005b"}]],["Recipe_3",[{size:[300,250],id:"8a969d580177771bc13c2049b47f0086"}]],["Video_StickyOutstream_1",[{size:[300,50],id:"8a969d87017b7be074aae07a22b70005"}]]])},yu={desktop:new Map([["Content_1",[{size:[300,250],id:"8a9698af01888852cc626cdc9c8a0024"},{size:[728,90],id:"8a9698af01888852cc626cdca2ac0026"}]],["Content_2",[{size:[300,250],id:"8a9695b901888852d78e6cdc9c0a0036"}]],["Content_3",[{size:[300,250],id:"8a9698af01888852cc626cdc9e100025"}]],["Footer_1",[{size:[728,
90],id:"8a9691d801888852d23d6cdc9b7e0027"},{size:[970,90],id:"8a9695b901888852d78e6cdc9fb40039"},{size:[320,50],id:"8a9691d801888852d23d6cdc9f220029"}]],["Header_1",[{size:[728,90],id:"8a9691d801888852d23d6cdca335002a"}]],["Interstitial_1",[{size:[300,250],id:"8a969449017c7c9d384d9f8170b10066"},{size:[300,600],id:"8a969449017c7c9d384d9f80b9970064"},{size:[320,480],id:"8a969958017c7c9d2d8a9f812d360081"},{size:[336,280],id:"8a969449017c7c9d384d9f80f2a20065"}]],["Sidebar_1",[{size:[300,250],id:"8a9695b901888852d78e6cdc9a960035"}]],
["Sidebar_9",[{size:[320,50],id:"8a9695b901888852d78e6cdca1b7003a"},{size:[300,600],id:"8a9698af01888852cc626cdc9b0e0023"},{size:[160,600],id:"8a9698af01888852cc626cdca3db0027"},{size:[300,250],id:"8a9691d801888852d23d6cdc9cfd0028"}]],["Recipe_1",[{size:[300,250],id:"8a9695b901888852d78e6cdc9d800037"}]],["Recipe_2",[{size:[300,250],id:"8a9695b901888852d78e6cdc9ea70038"}]],["Video_StickyOutstream_1",[{size:[300,250],id:"8a9695b901888852d78e6ce0245f0040"}]]]),mobile:new Map([["Content_1",[{size:[300,
250],id:"8a9698af01888852cc626cdca59d0028"},{size:[320,50],id:"8a9698af01888852cc626cdca7a8002a"}]],["Content_2",[{size:[300,250],id:"8a9695b901888852d78e6cdca71a003c"},{size:[320,50],id:"8a9695b901888852d78e6cdca952003d"}]],["Content_3",[{size:[300,250],id:"8a9698af01888852cc626cdca8b7002b"}]],["Content_4",[{size:[300,250],id:"8a9691d801888852d23d6cdca525002c"}]],["Content_5",[{size:[300,250],id:"8a9698af01888852cc626cdcab10002d"}]],["Content_6",[{size:[300,250],id:"8a9691d801888852d23d6cdca44d002b"}]],
["Footer_1",[{size:[320,100],id:"8a9698af01888852cc626cdca68b0029"},{size:[300,50],id:"8a9695b901888852d78e6cdca4b6003b"},{size:[728,90],id:"8a9691d801888852d23d6cdca60e002d"},{size:[320,50],id:"8a9691d801888852d23d6cdcab9a0030"}]],["Interstitial_1",[{size:[300,250],id:"8a969161017c7c9d32879f82491c007d"},{size:[300,600],id:"8a969161017c7c9d32879f8195b3007c"},{size:[320,480],id:"8a969958017c7c9d2d8a9f81f2c50082"},{size:[336,280],id:"8a969449017c7c9d384d9f81c5660067"},{size:[320,50],id:"8a969449017c7c9d384d9f8279950068"}]],
["Recipe_1",[{size:[300,250],id:"8a9691d801888852d23d6cdcaa71002f"}]],["Recipe_2",[{size:[300,250],id:"8a9691d801888852d23d6cdca826002e"}]],["Recipe_3",[{size:[300,250],id:"8a9698af01888852cc626cdca9ed002c"}]],["Video_StickyOutstream_1",[{size:[300,50],id:"8a9695b901888852d78e6ce0245f0040"}]]])},nk=class extends ma{constructor(a,b,c){super(a);this._prebidMethods=b;this._yahooSSPExperiment=c;this.bidderConfig=this._config.partners.getBidderConfig(l.YahooSSP);this.adapterName=l.YahooSSP;this.serverBidderName=
l.YahooSSPServer;this.gvlid=25;this._device=ca()?"mobile":"desktop";this._map=new Map;this._bidders=[];this.videoCreativeIds=[["138379204183",l.YahooSSP],["138378707447",l.YahooSSP],["138378707558",l.YahooSSP],["138378717711",l.YahooSSP],["138378717726",l.YahooSSP],["138378706907",l.YahooSSP],["138378706928",l.YahooSSP],["138378707468",l.YahooSSP],["138378707561",l.YahooSSP],["138378717720",l.YahooSSP],["138378717783",l.YahooSSP],["138378707552",l.YahooSSP],["138378717723",l.YahooSSP],["138378717780",
l.YahooSSP],["138378717786",l.YahooSSP],["138378707555",l.YahooSSP]];this.videoServerCreativeIds=[["138437164046",l.YahooSSPServer],["138437164367",l.YahooSSPServer],["138437170553",l.YahooSSPServer],["138437192487",l.YahooSSPServer],["138437199522",l.YahooSSPServer],["138437199525",l.YahooSSPServer],["138437199528",l.YahooSSPServer],["138437854447",l.YahooSSPServer]];this._params={display:{client:{dcn:ca()?"8a969d580177771bc13c2047d6290082":"8a9694d00177771bcae21c6941d30023"},server:{dcn:ca()?"8a9691d801888852d23d6cda98130025":
"8a9698af01888852cc626cda97350021"}},video:{client:{dcn:"8a969469017b7bdf59b2e07862af0281"},server:{dcn:"8a9695b901888852d78e6cda98760033"}}};a="both"===this._yahooSSPExperiment.result||"client"===this._yahooSSPExperiment.result;"both"!==this._yahooSSPExperiment.result&&"server"!==this._yahooSSPExperiment.result||this._bidders.push({name:this.serverBidderName,type:"server"});a&&this._bidders.push({name:this.name,type:"client"});this._setYahooMediaConfig()}get enabled(){return this._config.partners.display.get(l.YahooSSP)}get videoEnabled(){return this._config.partners.video.get(l.YahooSSP)}getBannerSlotBidRequests(a){return this._getBidParams(a)}getOutstreamSlotBidRequests(a){return this._getBidParams(a,
!0)}getVideoSlotBidRequests(a){let b=[];this._bidders.map(c=>{sq.has(a.name)&&b.push({bidder:c.name,params:{...this._params.video[c.type],pos:sq.get(a.name)[c.type]}})});return b}_getBidParams(a,b=!1){let c=[];this._bidders.forEach(d=>{this._map="server"===d.type?yu[this._device]:xu[this._device];!this._map.has(a.placementMapName)||b&&"Video_StickyOutstream"!==a.location||this._map.get(a.placementMapName).filter(({size:e})=>a.hasSize(e)).forEach(({id:e})=>{c.push({bidder:d.name,params:{...(b?this._params.video[d.type]:
this._params.display[d.type]),pos:e},...this._addBidLabel(a.placementMapName,this.serverBidderName)})})});return c}_setYahooMediaConfig(){this._prebidMethods.setConfig({yahoossp:{mode:"all"}})}};nk=q([v("YahooSSPBidder"),H(),t("design:paramtypes",[N,ia,ud])],nk);let ok=class extends ma{getCreativeFormatId(a){a=/creative_format_id":([0-9]*)/.exec(a);if(null!==a)return a[1]}constructor(a,b){super(a);this._mediaType=b;this.bidderConfig=this._config.partners.getBidderConfig(l.Yieldmo);this.videoCreativeIds=
[["138463806447",l.Yieldmo],["138463975208",l.Yieldmo],["138463975223",l.Yieldmo],["138464489752",l.Yieldmo],["138464489758",l.Yieldmo],["138464489761",l.Yieldmo],["138464490757",l.Yieldmo],["138464490775",l.Yieldmo]];this.settings={adserverTargeting:[{key:"hb_format",val:c=>this._creativeFormatMap.get(this.getCreativeFormatId(c.ad))||c.mediaType}]};this._creativeFormatMap=new Map([["44","banner"],["47","banner"],["49","banner"],["50","banner"],["43","banner"],["17","banner"],["23","banner"],["33",
"banner"],["40","outstream"],["51","outstream"],["48","outstream"],["34","outstream"],["14","miniscroller"],["16","miniscroller"],["37","miniscroller"],["15","miniscroller"],["18","native"],["36","native"],["46","native"],["10","native"],["6","native"]]);this._adOptionsMap=new Map([["100000",{id:"2626064683911553041",isOutstream:!1}],["110000",{id:"2626064684062547986",isOutstream:!0}],["111000",{id:"2626064684196765715",isOutstream:!0}],["110100",{id:"2626064684339372052",isOutstream:!0}],["110010",
{id:"2626064684498755605",isOutstream:!0}],["111100",{id:"2626064684632973334",isOutstream:!0}],["111010",{id:"2626064684775579671",isOutstream:!0}],["111110",{id:"2626064684934963224",isOutstream:!0}],["101000",{id:"2626064685069180953",isOutstream:!1}],["101100",{id:"2626064685203398682",isOutstream:!1}],["101010",{id:"2626064685337616411",isOutstream:!0}],["101110",{id:"2626064685471834140",isOutstream:!0}],["100100",{id:"2626064685606051869",isOutstream:!1}],["100110",{id:"2626064685740269598",
isOutstream:!0}],["100010",{id:"2626064685882875935",isOutstream:!0}],["110110",{id:"2626807131797397582",isOutstream:!0}],["110001",{id:"3154492104504189746",isOutstream:!0}]]);this._bannerMap="Below_Post Content Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9 Video_StickyOutstream_1".split(" ");this._videoMap=new Map([[M.Video_Collapse_Autoplay_SoundOff,
"3137192266624344610"],[M.Video_Coll_SOff_Smartphone,"3137192266808893988"],[M.Video_Individual_Autoplay_SOff,"3137192266716619299"]])}get enabled(){return this._config.partners.display.get(l.Yieldmo)}get videoEnabled(){return this._config.partners.video.get(l.Yieldmo)}isMiniScroller(a){return a.sequence&&this._config.adTypes.has("miniscroller")&&("Content"===a.location||"Recipe"===a.location||a.lazy&&"Below_Post"===a.location)}isNative(a){var b=new Map([["Content","nativeMobileContent"],["Recipe",
"nativeMobileRecipe"]]),c=new Map([["Content","nativeDesktopContent"],["Recipe","nativeDesktopRecipe"],["Sidebar","nativeDesktopSidebar"]]);b=ca()?b:c;return a.sequence&&b.has(a.location)&&this._config.adTypes.has(b.get(a.location))}isOutstream(a){return this._mediaType.outstreamEnabled(a).currentlyActive}isStickyOutstream(a){return"Video_StickyOutstream"===a.location}isMobileOutstreamSingleInstance(a){return ca()&&"Content_1"===a.placementMapName&&this._mediaType.outstreamEnabled(a).currentlyActive&&
this._config.adTypes.has("outstreamMobile")&&!this._config.video.mobileStickyPlayerOnPage}createBitStringAdOptions(a,b=!1){let c=this._bannerMap.includes(a.placementMapName)?"1":"0";c+=b&&this.isOutstream(a)?"1":"0";c+=this.isMiniScroller(a)?"1":"0";c+=this.isNative(a)?"1":"0";c+=b&&this.isMobileOutstreamSingleInstance(a)?"1":"0";return c+=b&&this.isStickyOutstream(a)?"1":"0"}getBannerSlotBidRequests(a){a=this.createBitStringAdOptions(a);if(this._adOptionsMap.has(a))return a=this._adOptionsMap.get(a),
[{bidder:this.name,params:{placementId:a.id}}]}getOutstreamSlotBidRequests(a){var b=this.createBitStringAdOptions(a,!0);if(this._adOptionsMap.has(b))return b=this._adOptionsMap.get(b),[{bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{outstreamActive:"Video_StickyOutstream"!==a.location}),params:{placementId:b.id,...("Video_StickyOutstream"===a.location&&{video:{placement:2}})}}]}getVideoSlotBidRequests(a){if(this._videoMap.has(a.name))return[{bidder:this.name,params:{placementId:this._videoMap.get(a.name)}}]}};
ok=q([v("YieldmoBidder"),H(),t("design:paramtypes",[N,gb])],ok);let pk=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Concert);this._map=new Map([["Content_1",[300,250]]]);this._desktopSizes=[[620,366]];this._mobileSizes=[[325,508],[325,204]]}get enabled(){return this._config.partners.display.get(l.Concert)}getPartnerIdFromDomain(){try{return th(window.location.hostname).split(".")[0].toLowerCase().replace("-","")}catch(a){return A.error("ConcertBidder",
"getPartnerIdFromDomain",a),""}}getBannerSlotBidRequests(a){if(this._map.has(a.placementMapName)&&a.hasSize(this._map.get(a.placementMapName))){let b=this.getPartnerIdFromDomain();if(0<b.length)return[{bidder:this.name,...this._addBidLabel(a.placementMapName,void 0,{refresh:!a.isHighlyViewable()}),params:{bidder:this.name,slot:a.id,partnerId:b,sizes:ca()?this._mobileSizes:this._desktopSizes}}]}}};pk=q([v("ConcertBidder"),H(),t("design:paramtypes",[N])],pk);var hb;(function(a){a.display="Raptive_Display_RON";
a.video="Raptive_Video_RON";a.outstream="Raptive_StickyOutstream_RON"})(hb||(hb={}));let vf={[hb.display]:{desktop:1819606,mobile:1819607},[hb.video]:{default:1819610},[hb.outstream]:{default:1819614}},qk=class extends ma{constructor(a){super(a);this.bidderConfig=this._config.partners.getBidderConfig(l.Adform);this.adapterName=l.Adform;this.gvlid=50;this._adxDomain="adx2.adform.net";this.videoCreativeIds=[["138446479256",l.Adform],["138446479406",l.Adform],["138446479442",l.Adform],["138446479445",
l.Adform],["138446479505",l.Adform],["138446479508",l.Adform],["138447155053",l.Adform],["138447155056",l.Adform]];this._displaySet=new Set("Below_Post Content_1 Content_2 Content_3 Content_4 Content_5 Content_6 Content_7 Content_8 Content_9 Footer_1 Header_1 Header_2 Recipe_1 Recipe_2 Recipe_3 Recipe_4 Recipe_5 Sidebar_1 Sidebar_2 Sidebar_3 Sidebar_4 Sidebar_5 Sidebar_9".split(" "));this._videoSet=new Set([M.Video_Coll_SOff_Smartphone,M.Video_Collapse_Autoplay_SoundOff,M.Video_In_Post_ClicktoPlay_SoundOn,
M.Video_Individual_Autoplay_SOff]);this._outstreamSet=new Set(["Video_StickyOutstream_1"])}get enabled(){return this._config.partners.display.get(l.Adform)}get videoEnabled(){return this._config.partners.video.get(l.Adform)}getBannerSlotBidRequests(a){if(this._displaySet.has(a.placementMapName))return[{bidder:this.name,params:{mname:hb.display,mid:ca()?vf[hb.display].mobile:vf[hb.display].desktop,...("US"===this._config.context.country&&{adxDomain:this._adxDomain})}}]}getOutstreamSlotBidRequests(a){if(this._outstreamSet.has(a.placementMapName))return[{bidder:this.name,
params:{mname:hb.outstream,mid:vf[hb.outstream].default,adxDomain:this._adxDomain}}]}getVideoSlotBidRequests(a){if(this._videoSet.has(a.name))return[{bidder:this.name,params:{mname:hb.video,mid:vf[hb.video].default,adxDomain:this._adxDomain}}]}};qk=q([v("AdformBidder"),H(),t("design:paramtypes",[N])],qk);let rk=class{constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B,E,C,I,F,O,R,J,aa,qa,za,Ea,Ib,Jb,Ba,Sa,Kb){this._config=a;this._biddersParams=new Map;this._debugBidderList=[];this._orderedDisplayBidders=
[r,c,p,Jb,J,x,aa,O,C,Ba,z,h,w,Ea,I,m,F,Ib,d,f,qa,R,b,g,E,B,Sa,n,Kb,e].filter(db=>this._bidderFilter(db));this._orderedVideoBidders=[r,p,x,c,aa,C,J,z,Jb,Ba,F,k,h,m,Ea,d,b,E,R,B,za,n,e].filter(db=>this._bidderFilter(db,!0));this._multiFormatBidders=this._orderedDisplayBidders.filter(db=>db.multiformatBidder);this._videoCreativeIdMapping=this._setVideoCreativeIdMap();this._appDataBidders=[l.Nativo,l.OpenX,l.Triplelift,l.TTD,l.YahooSSP]}get orderedDisplayBidders(){return this._orderedDisplayBidders}get multiFormatBidders(){return this._multiFormatBidders}get appDataBidders(){return this._appDataBidders}get orderedVideoBidders(){return this._orderedVideoBidders}get biddersParams(){return this._biddersParams}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}_setVideoCreativeIdMap(){return new Map(this._orderedVideoBidders.reduce((a,
b)=>a.concat(b.videoCreativeIds||[],b.videoServerCreativeIds||[]),[]))}_bidderFilter(a,b=!1){let c=this._config,d=a.name,e=a.adapterName,f=b?c.vbho.bidders:c.hbho.bidders,g=b||!a.updateBidParams;return a[b?"videoEnabled":"enabled"]&&this._holdoutValidation(f,d,e)&&this._ccpaValidation(c.ccpa,d,e)&&this._gdprValidation(c.gdpr,d,e)&&(g||this._biddersParams.set(d,a))}_holdoutValidation(a,b,c){return!a.length||!a.includes(c||b)}_ccpaValidation(a,b,c=""){return!a.enabled||!a.nonCompliantBidders.includes(c)&&
!a.nonCompliantBidders.includes(b)}_gdprValidation(a,b,c=""){return!a.enabled||!a.nonCompliantBidders.includes(c)&&!a.nonCompliantBidders.includes(b)}};rk=q([y(),t("design:paramtypes",[N,qk,Hj,Ij,Jj,Kj,pk,Lj,Tj,Mj,Nj,Qj,Rj,Sj,Vj,Xj,Yj,Zj,dk,Uj,ek,fk,Aj,hk,ik,jk,kk,lk,mk,nk,ok,bk,Wj])],rk);let sk=class extends W{init(){this._key="CreativeMonitoring";this._default=!1}};sk=q([v("CreativeMonitoringExperiment"),y()],sk);let tk=class{constructor(a,b,c,d,e){this._config=a;this._gam=b;this._prebidMethods=
c;this._slots=d;this._creativeMonitoringExperiment=e;this._auctionData=new Set;this._gamRenderedData=new Map}setupCreativeEventListeners(){this._prebidMethods.onEvent("auctionInit",this._storeAuctionData.bind(this));this._prebidMethods.onEvent("adRenderFailed",this._renderFailedHandler.bind(this));this._prebidMethods.onEvent("adRenderSucceeded",this._renderSucceededHandler.bind(this));this._prebidMethods.onEvent("staleRender",this._staleRenderHandler.bind(this));this._gam.slotRenderEnded.on(this._slotRenderEnded.bind(this));
this._gam.slotRequested.on(this._slotRequested.bind(this))}_slotRequested(a){a=a.slot.id;this._gamRenderedData.has(a)&&this._gamRenderedData.delete(a)}_slotRenderEnded(a){this._gamRenderedData.set(a.slot.id,a);this._creativeMonitoringExperiment.result&&this._checkSlotRender(a)}_storeAuctionData(a){a.adUnitCodes.forEach(b=>this._auctionData.add(`${a.auctionId}-${b}`))}_deleteStoredAuction(a,b){this._auctionData.delete(`${a}-${b}`)}_getSlotData(a){a=this._slots.get(a);return{...(a&&{slot:a.location,
sequence:a.sequence,nref:a.refreshCount})}}_getGAMCreativeData(a){return(a=this._gamRenderedData.get(a))?{lineItemId:a.event.lineItemId,creativeId:a.event.creativeId,campaignId:a.event.campaignId}:{}}_getBidData(a){return a?{...this._getPrebidBidDataFromBid(a),...this._getSlotData(a.adUnitCode),...this._getGAMCreativeData(a.adUnitCode)}:{}}_renderFailedHandler(a){setTimeout(()=>{let b=a.bid;b&&this._deleteStoredAuction(b.auctionId,b.adUnitCode);let c={message:a.message,reason:a.reason,...this._getBidData(b)};
b&&b.meta&&0<Object.keys(b.meta).length?c.buyerInformation=b.meta:c.markup=b&&b.ad;A.error("PrebidAuctionManager","init","adRenderFailed",c)},2E3)}_staleRenderHandler(a){a&&this._deleteStoredAuction(a.auctionId,a.adUnitCode);setTimeout(()=>{A.error("PrebidAuctionManager","init","staleRender",{...this._getBidData(a)})},2E3)}_renderSucceededHandler(a){(a=a.bid)&&this._deleteStoredAuction(a.auctionId,a.adUnitCode)}_isSafeFrame(a){a=a.element.querySelector("iframe");return!(!a||!a.src)}_checkSlotRender(a){let b=
a.event,c=this._config.prebid.advertiserId;this._isSafeFrame(a.slot)||b.advertiserId!==c||setTimeout(()=>{this._logUnknownFailure(a)},2E3)}_getHeightWidth(a){if(!a)return{};a=a.split("x").map(Number);return{...(Array.isArray(a)&&2===a.length&&{height:a[1],width:a[0]})}}_getPrebidCreativeWindowData(a){return{adId:a.bidderAdId,bidder:a.bidder,size:a.bidderSize,adserverTargeting:a.targeting}}_getPrebidBidDataFromBid(a){return{price:a.adserverTargeting.hb_pb,bidderSize:a.size||a.adserverTargeting.hb_size,
advertiserDomains:a.meta&&a.meta.advertiserDomains||a.adserverTargeting.hb_adomain,bidder:a.bidder}}_getPrebidBidderDataFromIframe(a){let b=a.element.querySelector("iframe").contentWindow;if(!b)return{};let {adId:c,adserverTargeting:d,bidder:e,size:f}=this._getPrebidCreativeWindowData(b),{height:g,width:h}=this._getHeightWidth(b&&b.bidderSize);return{adId:c,adserverTargeting:d,adUnitCode:a.id,bidder:e,height:g,size:f,width:h}}_logUnknownFailure(a){let b=this._config.context,c=a.slot;a=a.event;let {adId:d,
adserverTargeting:e,auctionId:f,adUnitCode:g,bidder:h,height:k,meta:m,size:n,width:p}=c.servedPrebidBidResponse||this._getPrebidBidderDataFromIframe(c);f&&g&&!this._auctionData.has(`${f}-${g}`)||(A.error("PrebidAuctionManager","init","prebidCreativeFailure",{adId:d,advertiserDomains:m&&m.advertiserDomains||e&&e.hb_adomain,bidderSize:n||e&&e.hb_size,bidder:h,branch:b.branch,bucket:b.bucket,campaignId:a.campaignId,creativeId:a.creativeId||a.sourceAgnosticCreativeId,lineItemId:a.lineItemId||a.sourceAgnosticLineItemId,
message:"An unknown error occurred rendering the Prebid creative",nref:c.refreshCount,price:e&&e.hb_pb,sequence:c.sequence,slotSizes:c.sizes,slot:c.location,...(p&&k&&{size:[p,k]}),...(m&&(m.dchain&&{dchain:m.dchain}||m.networkId&&{networkId:m.networkId})),...((!d||2>d.length)&&e&&{hbAdId:e.hb_adid})}),f&&g&&this._deleteStoredAuction(f,g))}};tk=q([y(),t("design:paramtypes",[N,V,ia,Qa,sk])],tk);let uk=class{constructor(a){this._prebidMethods=a}setOseq(a,b){let c=`${a.sequence}`,{id:d,bidPoolId:e}=
a,{hb_bidder:f,hb_adid:g}=b;({bids:b}=e?this._prebidMethods.getBidResponsesForBidPoolId(e):this._prebidMethods.getBidResponsesForAdUnitCode(d));if(b)for(let h=b.length-1;0<=h;h--)if(b[h].bidderCode===f&&b[h].adId===g){c=this.getSeqFromAdUnitCode(b[h].adUnitCode);break}a&&a.setSlotTargetingFlag("oseq",[c],!0)}getSeqFromAdUnitCode(a){return(a=(a||"").match(/AdThrive_.*?_(\d+)_\S+$/))&&a.length?a[1]:""}};uk=q([v("OSeq"),H(),t("design:paramtypes",[ia])],uk);let wf=class extends X{init(){this._key="DemandChain"}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],wf.prototype,"run",null);wf=q([v("DemandChainExperiment"),y()],wf);let vk=class extends W{init(){this._key="DisableAjaxTimeout";this._default=!1}};vk=q([v("DisableAjaxTimeoutExperiment"),y()],vk);let zu={buckets:[{precision:2,max:.1,increment:.01},{precision:2,max:5,increment:.05},{precision:2,max:20,increment:.1},{precision:2,max:100,increment:.5}]},wk=class{constructor(a){this._config=a;this._configuration=
{suppressEmptyKeys:!0,adserverTargeting:[{key:"hb_bidder",val:b=>b.bidderCode},{key:"hb_adid",val:b=>b.adId},{key:"hb_pb",val:b=>b.pbCg},{key:"hb_size",val:b=>this._config.video.instreamAdUnits.has(b.adUnitCode)?"":b.size},{key:"hb_deal",val:b=>b.dealId},{key:"hb_format",val:b=>b.mediaType},{key:"hb_adomain",val:b=>b.meta&&b.meta.advertiserDomains?b.meta.advertiserDomains[0]:b.meta&&b.meta.advertiserId},{key:"hb_dsp",val:b=>{var c,d;return null!==(d=null!==(c=b.meta&&b.meta.networkId)&&void 0!==c?
c:b.meta&&b.meta.networkName)&&void 0!==d?d:b.meta&&b.meta.dchain&&b.meta.dchain.nodes.reverse()[0].bsid}},{key:"hb_crid",val:b=>b.creativeId},{key:"hb_dur",val:b=>b.duration},{key:"hb_source",val:b=>{let c=this._config.prebid;return c.s2s.bidders.includes(b.bidderCode)?c.rubiconS2SBidders.includes(b.bidderCode)?"sm":"sr":"c"}}]}}get configuration(){return this._configuration}};wk=q([y(),t("design:paramtypes",[N])],wk);let xk=class extends W{init(){this._key="OpenPathLiveIntent";this._default=!1}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],xk.prototype,"run",null);var Au=xk=q([v("OpenPathLiveIntentExperiment"),y()],xk);let yk=class{_getUspConfig(){return this._config.ccpa.required?{cmpApi:"iab",timeout:0}:{cmpApi:"static",consentData:{getUSPData:{uspString:"1---"}}}}_isCCPAConsentDenied(){return!!this._config.ccpa.userOptedOut}_isAct25ConsentDenied(){return this._config.act25.required&&!this._config.act25.consented}_getAllowActivites(){let a=
{rules:[{condition:()=>this._isCCPAConsentDenied()||this._isAct25ConsentDenied(),allow:!1}]};return{reportAnalytics:{rules:[{condition:()=>this._isCCPAConsentDenied(),allow:!1}]},enrichUfpd:{...a},enrichEids:{...a},syncUser:{...a},transmitEids:{...a},transmitPreciseGeo:{...a},transmitUfpd:{...a}}}customPreAuction(a,b){if(a&&b){let c=b;a=a.code;let d=b.split("/"),e=Kh.includes(a),f={Content:"Content",Sidebar:this._isSideBarNineAvailable?"Sidebar_9":"Sidebar_1",Recipe:"Recipe_1"};for(let g in f)a.includes(g)&&
(c=`/${d[1]}/AdThrive_${f[g]}/${d[3]}`);return e?b:c}}constructor(a,b,c,d,e,f,g,h,k){this._config=a;this._prebidMethods=b;this._dcoExperiment=c;this._disableAjaxTimeoutExperiment=d;this._ortb2=e;this._standardPrebidBidderSetting=f;this._slotManager=g;this._openPathLiveIntentExperiment=h;this._eventHistoryTTLExperiment=k;this._uspConfig={usp:this._getUspConfig()};this._clientVendorExceptions=["appnexus"];this._serverVendorExceptions=this._config.prebid.s2s.bidders;this._isSideBarNineAvailable=!1;this._gdprConfig=
{gdpr:{cmpApi:"iab",timeout:25E3,defaultGdprScope:!0,rules:[{purpose:"storage",enforcePurpose:!0,enforceVendor:!0},{purpose:"basicAds",enforcePurpose:!0,enforceVendor:!0,vendorExceptions:this._clientVendorExceptions.concat(this._serverVendorExceptions)},{purpose:"personalizedAds",enforcePurpose:!0,enforceVendor:!0},{purpose:"measurement",enforcePurpose:!0,enforceVendor:!0}]}};this._defaultConfig={maxRequestsPerOrigin:6,allowActivities:{...this._getAllowActivites()},auctionOptions:{secondaryBidders:["unruly",
"undertone","33across","nativo"]},bidderSequence:"fixed",sendBidsControl:{bidLimit:3},useBidCache:!0,enableTIDs:!0,enableSendAllBids:!0,disableAjaxTimeout:this._disableAjaxTimeoutExperiment.result,userSync:{idPriority:{tdid:this._openPathLiveIntentExperiment.result?["liveIntentId","unifiedId"]:["unifiedId","liveIntentId"]},auctionDelay:this._config.prebid.auctionDelay,syncsPerBidder:1,aliasSyncEnabled:!0,enableOverride:!0,filterSettings:{iframe:{bidders:"*",filter:"include"}}},gptPreAuction:{mcmEnabled:!0,
enabled:!0,customPreAuction:this.customPreAuction.bind(this)},priceGranularity:zu,cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},consentManagement:{},targetingControls:{allowTargetingKeys:this._config.prebid.targetingKeys,allowSendAllBidsTargetingKeys:this._config.prebid.sendAllBidsTargetingKeys},dchain:{validation:this._dcoExperiment.result},schain:{validation:"strict",config:(new Sp).getSupplyChainConfig(this._config.site.id)},sizeConfig:[],ortb2:this._ortb2.data,eventHistoryTTL:this._eventHistoryTTLExperiment.result||
0};this._slotManager.added.on(m=>{this._setIsSidebarNineAvailable(m)})}setDefaultConfig(a){let b=this.addPrebidConsent();this._prebidMethods.setConfig({...this._defaultConfig,...(a&&{eventHistoryTTL:60}),consentManagement:b,...(this._config.fledge.enabled&&{fledgeForGpt:{enabled:!0}})})}applyClientAndServerBidderSettings(a){this._prebidMethods.setBidderSettings(a.reduce((b,c)=>this._setupBidderSettings(b,c),{standard:this._standardPrebidBidderSetting.configuration}))}aliasBidders(a){a=[...(new Set(a))].filter(b=>
"rubi_ss"!==b.serverBidderName&&"improve_ss"!==b.serverBidderName);a.forEach(b=>{if(b.adapterName&&(b.adapterName!==b.name||b.serverBidderName)){let c=b.serverBidderName||b.name,d=b.adapterName;b.gvlid?this._prebidMethods.setAliasBidder(d,c,{gvlid:b.gvlid}):this._prebidMethods.setAliasBidder(d,c)}})}_setupBidderSettings(a,b){a[b.name]=this.getBidderSettings(b,b.name);b.serverBidderName&&(a[b.serverBidderName]=this.getBidderSettings(b,b.serverBidderName));a.standard.adserverTargeting&&b.adServerTargeting&&
a.standard.adserverTargeting.push(...b.adServerTargeting);return a}_setIsSidebarNineAvailable(a){for(let b of a)if("Sidebar"===b.location&&9===b.sequence){this._isSideBarNineAvailable=!0;break}}addPrebidConsent(){return!0===this._config.gdpr.enabled?this._gdprConfig:this._uspConfig}getBidderSettings(a,b){return{bidCpmAdjustment:(c,d)=>lh(this._config,c,b,d),inverseBidAdjustment:(c,d)=>{let e={mediaType:Object.keys(d.mediaTypes)[0],adUnitCode:d.adUnitCode},f=this._config,g=f.video.instreamAdUnits.has(null===
e||void 0===e?void 0:e.adUnitCode)?f.video.minFloor:0;d=this._config.prebid.s2s.bidders.includes(d.bidder)?"server":d.bidder;return dp(f,d,e,c+g,!0)},...a.settings}}};yk=q([y(),t("design:paramtypes",[N,ia,wf,vk,Sb,wk,ja,Au,zj])],yk);let xf=class extends X{init(){this._key="PredictiveAnalysis"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],xf.prototype,"run",null);xf=q([v("PredictiveAnalysisExperiment"),y()],xf);let zk=class extends X{init(){this._key=
"PBSFloor1"}};zk=q([v("PBSFloor"),y()],zk);let yf=class extends X{init(){this._key="UserSyncLimit"}run(){try{let a=super.run();this._validateResult(a);return a}catch(a){return A.error("UserSyncLimitExperiment","run",a),-1}}_validateResult(a){if("number"!==typeof a)throw Error(`Result is not a number: ${a}`);if(!Number.isInteger(a))throw Error(`Result is not an integer: ${a}`);if(0>a||100<a)throw Error(`Result out of range: ${a}`);return a}};q([ea(),t("design:type",Function),t("design:paramtypes",
[]),t("design:returntype",void 0)],yf.prototype,"run",null);yf=q([v("UserSyncLimitExperiment"),y()],yf);let zf=class extends X{init(){this._key="RaptiveRegionalPrebidServerExperiment"}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],zf.prototype,"run",null);zf=q([v("RaptiveRegionalPrebidServerExperiment"),y()],zf);let Ak=class extends X{init(){this._key="S2STimeOutExperiment"}};Ak=q([v("S2STimeoutExperiment"),y()],Ak);let Bk=class extends X{init(){this._key=
"S2SRefreshTimeout"}};Bk=q([v("S2SRefreshTimeoutExperiment"),y()],Bk);let Ck=class extends X{init(){this._key="RaptivePBSMultistageAuctionExperiment"}};Ck=q([v("RaptivePBSMultistageAuctionExperiment"),y()],Ck);let Dk=class extends X{init(){this._key="RaptivePBSDoubleRequestExperiment"}};Dk=q([v("RaptivePBSDoubleRequestExperiment"),y()],Dk);let Ek=class extends W{init(){this._key="RaptivePrebidServerProxyExperiment";this._default=!1}};Ek=q([v("RaptivePrebidServerProxyExperiment"),y()],Ek);let Fk=class{constructor(a,
b,c,d,e,f,g){this._config=a;this._pbsFloorExperiment=b;this._prebidMethods=c;this._userSyncLimitExperiment=d;this._s2sTimeoutExperiment=e;this._ortb2=f;this._s2sRefreshTimeoutExperiment=g;this._useRaptivePBSMultistageAuction=this._useRaptivePBSProxy=this._useRaptivePBS=!1;this._s2sConfig=[];this._appData=rp(this._config.context.domain,this._ortb2.data.site);this._runRaptivePrebidServerExperiments()}_runRaptivePrebidServerExperiments(){var a,b;if(this._useRaptivePBS=["west","east"].includes(null!==
(a=S.resolve(zf).result)&&void 0!==a?a:""))if(this._useRaptivePBSProxy=S.resolve(Ek).result)if(this._useRaptivePBSMultistageAuction="20s"===S.resolve(Ck).result)this._multiStageAuctionDoubleRequestRate=null!==(b=S.resolve(Dk).result)&&void 0!==b?b:0}_generateAliases(a){return{...(a.includes(l.ImproveDigitalServer)&&{improve_ss:l.ImproveDigital}),...(a.includes(l.RubiconServer)&&{rubi_ss:l.Rubicon})}}_getRubiconServer2ServerConfig(a){return this._generateServer2ServerConfig(a,"9262",{sync:"https://prebid-server.rubiconproject.com/cookie_sync",
auction:"https://prebid-server.rubiconproject.com/openrtb2/auction"})}_getRaptiveServer2ServerConfig(a){var b=this._getRPBSHost();b={auction:this._getRPBSAuctionEndpoint(b),sync:`${b}/cookie_sync`};return this._generateServer2ServerConfig(a,"1234",b)}getServer2ServerConfigWithAppData(a,b,c){a=c?this._getRaptiveServer2ServerConfig(a):this._getRubiconServer2ServerConfig(a);c?a.accountId="6666":a.accountId="9262";if(b&&0!==Object.keys(b).length)return a.ignoreDuplicateBidders=!0,a.appData=b,a}_generateServer2ServerConfig(a,
b,c){var d,e;return{accountId:b,enabled:!0,...(this._config.prebid.ortbEnrich&&{secure:1}),bidders:a,extPrebid:{aliases:this._generateAliases(a),floors:{enabled:"on"===this._pbsFloorExperiment.result}},defaultTtl:300,timeout:null!==(d=this._s2sTimeoutExperiment.result)&&void 0!==d?d:750,refreshTimeout:null!==(e=this._s2sRefreshTimeoutExperiment.result)&&void 0!==e?e:1E3,adapter:"prebidServer",coopSync:!1,userSyncLimit:this._userSyncLimitExperiment.result,endpoint:{p1Consent:c.auction,noP1Consent:c.auction},
syncEndpoint:{p1Consent:c.sync,noP1Consent:c.sync}}}_buildS2SConfigs(){var a=this._config.prebid,b=a.s2s.bidders;let c=a.rubiconS2SBidders;a=this._config.context.country&&["US","CA"].includes(this._config.context.country.toUpperCase());this._useRaptivePBS&&a?(a=b.filter(d=>!c.includes(d)),b=b.filter(d=>c.includes(d)),this._s2sConfig.push(this._getRaptiveServer2ServerConfig(a)),this._s2sConfig.push(this._getRubiconServer2ServerConfig(b)),a=this._appData?this.getServer2ServerConfigWithAppData(a,this._appData,
!0):void 0,this._appData&&a&&this._s2sConfig.push(a),b=this._appData?this.getServer2ServerConfigWithAppData(b,this._appData,!1):void 0,this._appData&&b&&this._s2sConfig.push(b)):(this._s2sConfig.push(this._getRubiconServer2ServerConfig(b)),b=this._appData?this.getServer2ServerConfigWithAppData(b,this._appData,!1):void 0,this._appData&&b&&this._s2sConfig.push(b))}init(){this._buildS2SConfigs();this._prebidMethods.setConfig({s2sConfig:this._s2sConfig.filter(a=>a.bidders.length)})}_getRPBSHost(){return this._useRaptivePBSProxy?
"https://prebid-west.production.adthrive.com":"https://prebid.production.adthrive.com"}_getRPBSAuctionEndpoint(a){return this._useRaptivePBSProxy&&this._useRaptivePBSMultistageAuction&&"number"===typeof this._multiStageAuctionDoubleRequestRate?`${a}/openrtb2/multistage-auction?rpbsdr=${encodeURIComponent(this._multiStageAuctionDoubleRequestRate)}`:`${a}/openrtb2/auction`}};Fk=q([H(),t("design:paramtypes",[N,zk,ia,yf,Ak,Sb,Bk])],Fk);let Gk=class extends X{init(){this._key="UserSyncTrigger"}};Gk=q([v("UserSyncTriggerExperiment"),
y()],Gk);let Hk=class extends T{constructor(a,b){super();this._userSyncTriggerExperiment=a;this._prebidMethods=b;this._alreadyCalled=!1;this._userSyncTriggerMap=new Map([[1,"onPageLoad"],[2,"onConfigSet"],[3,"onBeforeRequestEvent"],[4,"onBidsBackHandler"]])}triggerUserSyncBasedOnExperiment(a){let b=this._userSyncTriggerExperiment.result;b&&this._userSyncTriggerMap.get(b)===a&&!this._alreadyCalled&&(this._prebidMethods.triggerUserSyncs(),this._alreadyCalled=!0)}};Hk=q([v("UserSyncTriggerComponent"),
y(),t("design:paramtypes",[Gk,ia])],Hk);let Ik=class extends W{init(){this._key="SspTakeRateMonitor";this._default=!1}};Ik=q([v("SspTakeRateMonitorExperiment"),y()],Ik);let Qc=class extends Rp{constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B,E,C,I,F){super();this._bootstrapConfig=b;this._config=c;this._gam=d;this._s2s=e;this._bidderSetup=f;this._mediaType=g;this._prebidMethods=h;this._prebidConfiguration=k;this._predictiveAnalysisExperiment=m;this._userSyncTriggerComponent=n;this._slots=p;this._creativeMonitoring=
r;this._ortb2=w;this._oseq=z;this._gdprEnforcement=x;this._slotEventBus=B;this._floors=E;this._sspTakeRateMonitorExperiment=C;this._userIdComponent=I;this._roxotAnalytics=F;this.videoAdUnits=[];this.bidsRequested=new L;this._isBeforeRequestEventLoaded=!1;this._excludedSlots=["Interstitial","Native_Recipe"];this._defaultVideoDuration=30;this._bidResponseForAdUnitCount=new Map;this._setAuctionFloors=O=>{var R=O&&O.auctionId&&!this._floors.auctionCaptured(O.auctionId),J=O.bids&&0<O.bids.length&&"function"===
typeof O.bids[0].getFloor;if(R&&J){let qa;J=O.bids[0];try{qa=(null===J||void 0===J?void 0:J.floorData)||{};var aa=J.getFloor()}catch(za){A.error("PrebidAuctionManager","_handleBidRequested","could not call getFloor",za)}aa&&"number"===typeof aa.floor&&(R=this._config.prebid.s2s.bidders.includes(J.bidder)?"server":J.bidder,aa=dp(this._config,R,{adUnitCode:J.adUnitCode,...(J.mediaTypes&&{mediaType:J.mediaTypes.banner?"banner":"video"})},aa.floor),this._floors.setAuctionFloors(O.auctionId,aa,qa,R))}this.bidsRequested.emit()};
this._orderedDisplayBidders=this._bidderSetup.orderedDisplayBidders;this._orderedVideoBidders=this._bidderSetup.orderedVideoBidders;this._videoCreativeIdMapping=this._bidderSetup.videoCreativeIdMapping;this._predictiveAnalysisResult=this._predictiveAnalysisExperiment.result||void 0;this._predictiveAnalysis=a.core.predictiveAnalysis;this._orderedMultiformatBidders=this._bidderSetup.multiFormatBidders;this._appDataBidders=this._bidderSetup.appDataBidders;this._analytics=[this._roxotAnalytics].filter(O=>
O.enabled)}init(){let a=this._prebidConfiguration,b=this._orderedDisplayBidders;var c=this._orderedVideoBidders;c=[...b,...c];let d=rp(this._config.context.domain,this._ortb2.data.site);this._prebidMethods.setConfig({appDataConfig:{appData:d,bidders:this._appDataBidders}});a.setDefaultConfig(this._roxotAnalytics.enabled);this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onConfigSet");a.aliasBidders(c);this._s2s.init();this._analytics.forEach(e=>void 0!==e.init&&e.init());b.forEach(e=>
void 0!==e.init&&e.init());a.applyClientAndServerBidderSettings(c);Bp().then(()=>{this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onPageLoad")}).then(()=>this._registerSignalSources()).catch(e=>{A.error("PrebidAuctionManager","init","pageLoaded",e)});this._setEvents();this._predictiveAnalysisResult&&this._setVideoBidsFilter()}get multiFormatBidders(){return this._orderedMultiformatBidders}_logAuctionDebug(){this._prebidMethods.onEvent("auctionDebug",a=>{a&&"ERROR"===a.type&&([...a.arguments].some(b=>
"string"===typeof b&&-1<b.indexOf("Error trying to write ad"))||A.error("PrebidAuctionManager","_logAuctionDebug","auctionDebug",a))})}async _registerSignalSources(){this._config.ccpa.userOptedOut||this._config.gdpr.enabled&&!await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1])||(this._prebidMethods.setConfig({userSync:{encryptedSignalSources:{sources:[{source:"esp.criteo.com id5-sync.com pubcid.org liveramp.com liveintent.com uidapi.com".split(" "),encrypt:!1}],
registerDelay:2E3}}}),this._prebidMethods.registerSignalSources())}_getNoBidReason(a,b){return Object.keys(a).length?"":b||"noBid"}_handleAuctionEnd(){this._prebidMethods.onEvent("auctionEnd",a=>{let b=a.bidsReceived.filter(c=>c.app);a.adUnits.forEach(c=>{let {code:d,noBidReason:e}=c;c=this._slots.get(d);let f=this._prebidMethods.getAdserverTargetingForAdUnitCode(c?c.id:d),g=this._getNoBidReason(f,e);c&&(null===c||void 0===c?void 0:c.setSlotAppBids(b,d));c&&g?c.googleTagSlot.setTargeting("hb_bidder",
g):this._slotEventBus.addPrebidSlotTargeting.emit({adUnitCode:d,slotTargeting:g?{noBid:g}:f})})})}_handleBidWon(){this._prebidMethods.onEvent("bidWon",a=>{let b=this._slots.get(a.adUnitCode);b&&(b.servedPrebidBidResponse=a,this._slots.bidServed.emit(b),95<=Math.floor(100*Math.random())&&this._sspTakeRateMonitorExperiment.result&&this._logBidResponseInfo(a.adUnitCode,b))})}_logBidResponseInfo(a,b){let c=this._prebidMethods.getBidResponsesForAdUnitCode(a).bids,d=this._bidResponseForAdUnitCount.get(a)||
0;c.slice(d).forEach(e=>{let {bidder:f,cpm:g,adUnitCode:h,dealId:k,originalCpm:m,responseCpm:n}=e,{hb_pb:p}=e.adserverTargeting,{bp:r,wp:w}=this._extractPriceInfoFromPixelUrl(e);f&&g&&p&&r&&w&&h&&A.event("PrebidAuctionManager","_logBidResponseInfo","Info from bid response",{bidder:f,cpm:g,originalCpm:m,responseCpm:n,hb_pb:p,bp:r,wp:w,adUnitCode:h,nref:b.refreshCount,dealId:k})});this._bidResponseForAdUnitCount.set(a,c.length)}_extractPriceInfoFromPixelUrl(a){let {ad:b,adUrl:c}=a;if(!b&&!c)return{bp:void 0,
wp:void 0};if(b){var d=b.match(/[?&]bp=([^&]*)/);var e=b.match(/[?&]wp=([^&]*)/);d=d&&d[1];e=e&&e[1]}if(c){a=c.match(/[?&]bp=([^&]*)/);let f=c.match(/[?&]wp=([^&]*)/);d=!d&&a&&a[1];e=!e&&f&&f[1]}return{bp:d,wp:e}}_handleSetTargeting(){this._prebidMethods.onEvent("setTargeting",a=>{for(let c in a){var b=this._slots.get(c);if(b){let {hb_adid:d,hb_bidder:e}=a[c];try{this._oseq.setOseq(b,{hb_adid:d,hb_bidder:e})}catch(f){b=this._prebidMethods.getVersion(),A.error("PrebidAuctionManager","setEvents",f,
b)}}}})}_handleBeforeRequestEvent(){this._prebidMethods.onEvent("beforeRequestBids",a=>{this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBeforeRequestEvent");!this._mediaType.additionalOutstreamUnitsExperiment&&this._mediaType.isOutstreamAllowed()||this._isBeforeRequestEventLoaded||this._updateHighImpactUnitTargeting();const b=this._userIdComponent.getUserIdTargeting();a.forEach(c=>{var d;const e=this._slots.get(c.code);c=null!==(d=c&&c.ortb2Imp&&c.ortb2Imp.ext&&c.ortb2Imp.ext.tid)&&
void 0!==d?d:"";e&&(e.setTransactionId(c),e.setSlotTargetingFlag("tid",[e.transactionId],!0),e.setSlotTargetingFlag("idp",b,!0))});this._isBeforeRequestEventLoaded=!0})}_handleGamOnLoad(){this._gam.slotOnload.on(({event:a,slot:b})=>{a=a.slot.getResponseInformation();(a=null===a||void 0===a?void 0:a.advertiserId)&&a===this._config.prebid.advertiserId||!b.bidPoolId||setTimeout(()=>{this._prebidMethods.clearTargetingForSharedBidPool(b.id)},2E3)})}_handleBidRequested(){this._prebidMethods.onEvent("bidRequested",
this._setAuctionFloors.bind(this))}_setEvents(){this._logAuctionDebug();this._handleAuctionEnd();this._handleBidWon();this._handleSetTargeting();this._handleBeforeRequestEvent();this._handleBidRequested();this._handleGamOnLoad();this._creativeMonitoring.setupCreativeEventListeners();this._predictiveAnalysisResult&&this._setVideoBidsFilter()}_setVideoBidsFilter(){if(this._predictiveAnalysis.length){var a=c=>{const d=this._config.context.device;return"1"===c?"phone"===d:"tablet"===d||"desktop"===d};
void 0===this._predictiveAnalysisResult&&A.error("PrebidAuctionManager","_setVideoBidsFilter","predictiveAnalysisExperiment result is undefined");var b={};this._predictiveAnalysis.filter(c=>parseFloat(c.error_rate)>(this._predictiveAnalysisResult||.9)&&"1"===c.chrome===ic()&&a(c.mobile)).forEach(c=>{b[`${c.adomain},${c.bidder}`]=!0});this._prebidMethods.setBidsReceivedFilter(c=>c.length&&this._config.video.instreamAdUnits.has(c[0].adUnitCode)?c.filter(d=>{let e=!0,f=d.meta&&d.meta.advertiserDomains;
if(!f||!Array.isArray(f))return e;f.forEach(g=>{b[g+","+d.bidder]&&(e=!1)});return e}):c)}}_updateSlotTargeting(a){if(this._mediaType.outstreamSlots.has(`${a.placementMapName}`)){var b=this._config.adTypes.enabledMinified.map(c=>c.toLowerCase()).filter(c=>"od"===c||"om"===c);b.length&&this._gam.setSlotTargeting({key:"hi_au",value:b},a.googleTagSlot)}}instlEnabled(a){return"Interstitial"===a&&this._config.adOptions.interstitial.prebid}get videoCreativeIdMapping(){return this._videoCreativeIdMapping}addSlots(a){this._applySlotFlags(a);
let {bannerEligibleSlots:b,outstreamEligibleSlots:c,nativeEligibleSlots:d}=this._getSlotsByMediaType(a),{bannerBidderBidRequests:e,outstreamBidderBidRequests:f,nativeBidderBidRequests:g,multiFormatBidderBidRequests:h}=this._getBidsForMediaTypes(b,c,d),k={bannerBidderBidRequests:e,outstreamBidderBidRequests:f,nativeBidderBidRequests:g,multiFormatBidderBidRequests:h},m=a.filter(n=>this._shouldIncludeSlot(n)).sort((n,p)=>n.auctionPriority-p.auctionPriority).reduce((n,p)=>{p=this._generateAdUnits(p,k);
return n.concat(p)},[]);this._prebidMethods.addAdUnits(m);this._setAdUnitOnSLot(a);return m}reset(){return this._prebidMethods.removeAllAdUnits()}_getSlotsByMediaType(a){let b=[],c=[],d=[];a.forEach(e=>{"Video_StickyOutstream"!==e.location&&b.push(e);this._mediaType.outstreamEnabled(e).outstreamCapable&&c.push(e);this._mediaType.nativeEnabled(e)&&d.push(e)});return{bannerEligibleSlots:b,outstreamEligibleSlots:c,nativeEligibleSlots:d}}_getBidsForMediaTypes(a,b,c){let d=this._orderedDisplayBidders.map(h=>
h.getBannerBidRequests(a)).filter(this._filterEmptyBids),e=this._orderedDisplayBidders.map(h=>h.getOutstreamBidRequests(b)).filter(this._filterEmptyBids),f=this._orderedDisplayBidders.map(h=>h.getNativeBidRequests(c)).filter(this._filterEmptyBids),g=this._orderedMultiformatBidders.map(h=>h.getMultiFormatBidRequests(a)).filter(this._filterEmptyBids);return{bannerBidderBidRequests:d,outstreamBidderBidRequests:e,nativeBidderBidRequests:f,multiFormatBidderBidRequests:g}}_filterEmptyBids(a){for(let [b,
c]of a.entries())c&&c.length||a.delete(b);return 0!==a.size}_applySlotFlags(a){a.forEach(b=>{this._mediaType.outstreamEnabled(b).outstreamCapable&&"Video_StickyOutstream"!==b.location&&(b.multiformat=!0);this._mediaType.nativeEnabled(b)&&(b.multiformat=!0,b.nativeEnabled=!0)})}_generateAdUnits(a,b){let c=[],d="Video_StickyOutstream"===a.location,e=this._mediaType.outstreamEnabled(a).outstreamCapable&&!d,f=this._mediaType.nativeEnabled(a);this._mediaType.additionalOutstreamUnitsExperiment&&this._updateSlotTargeting(a);
d?(a=this._getOutstreamUnit(a,b.outstreamBidderBidRequests),c.push(a)):this.getNonStickyAdUnitsFromRequests(a,c,e,f,b);return c}getNonStickyAdUnitsFromRequests(a,b,c,d,e){let {bannerBidderBidRequests:f,outstreamBidderBidRequests:g,nativeBidderBidRequests:h,multiFormatBidderBidRequests:k}=e;e=this._getBannerUnit(a,f);b.push(e);g.length&&g.some(m=>m.has(a.id))&&c&&b.push(this._getOutstreamUnit(a,g));h.length&&h.some(m=>m.has(a.id))&&d&&b.push(this._getNativeUnit(a,h));k.length&&k.some(m=>m.has(a.id))&&
a.multiformat&&(c=this._getMultiformatUnit(a,k),b.push(c))}_getMultiformatUnit(a,b){return this._getBannerUnit(a,b,!0)}_getBannerUnit(a,b,c=!1){let d=this.instlEnabled(a.location),e=this._ortb2.addOrtb2Imp({slot:a},d),f={banner:!0,native:this._mediaType.nativeEnabled(a)&&c,outstream:this._mediaType.outstreamEnabled(a).currentlyActive&&c};return{...(c&&{multiformat:c}),...(a.bidPoolId&&{bidPoolId:a.bidPoolId}),...(a.passiveBidPoolId&&{passiveBidPoolId:a.passiveBidPoolId}),code:d?this._config.prebid.interstitialAdUnitCode:
a.element.id,mediaTypes:this._mediaType.getMediaType({slot:a},f),...(e?{ortb2Imp:e}:{}),bids:b.map(g=>g.get(a.id)).filter(kc).reduce((g,h)=>g.concat(h),[])}}_getOutstreamUnit(a,b){let c=this.instlEnabled(a.location),d=this._ortb2.addOrtb2Imp({slot:a},c);return{...(a.bidPoolId&&{bidPoolId:a.bidPoolId}),...(a.passiveBidPoolId&&{passiveBidPoolId:a.passiveBidPoolId}),code:c?this._config.prebid.interstitialAdUnitCode:a.element.id,mediaTypes:this._mediaType.getMediaType({slot:a},{outstream:!0}),...(d?{ortb2Imp:d}:
{}),bids:b.map(e=>e.get(a.id)).filter(kc).reduce((e,f)=>e.concat(f),[])}}_getNativeUnit(a,b){let c=this.instlEnabled(a.location),d=this._ortb2.addOrtb2Imp({slot:a},c);return{...(a.bidPoolId&&{bidPoolId:a.bidPoolId}),...(a.passiveBidPoolId&&{passiveBidPoolId:a.passiveBidPoolId}),code:c?this._config.prebid.interstitialAdUnitCode:a.element.id,mediaTypes:this._mediaType.getMediaType({slot:a},{native:!0}),...(d?{ortb2Imp:d}:{}),bids:b.map(e=>e.get(a.id)).filter(kc).reduce((e,f)=>e.concat(f),[])}}_setAdUnitOnSLot(a){a.length&&
this._prebidMethods.addToQueue(()=>{let b=this._prebidMethods.getPrebidAdUnits();b&&a.forEach(c=>{let d=b.filter(e=>e.code===c.element.id);d.length&&(c.prebidAdUnit=d)})})}_updateSlots(a){a.forEach(b=>{this._updateAdUnitMediaType(b,b.prebidAdUnit);let c=b.prebidAdUnit||[];c.length&&(this._updateAdUnitOrtb2Imp(b,c),b.isHighlyViewable()&&this._updateBidderBidParams(b,c))})}_updateAdUnitOrtb2Imp(a,b){b.forEach(c=>{let d=this._ortb2.addOrtb2Imp({slot:a});c.ortb2Imp=d})}_updateBidderBidParams(a,b){b.forEach(c=>
{c.bids&&c.bids.length&&c.bids.forEach(d=>{let e=this._bidderSetup.biddersParams.get(d.bidder);e&&e.updateBidParams(d,a)})})}_updateAdUnitMediaType(a,b){b&&"Video_StickyOutstream"!==a.location&&b.forEach(c=>{if(c.multiformat){let d={banner:!0,native:this._mediaType.nativeEnabled(a),outstream:this._mediaType.outstreamEnabled(a).currentlyActive};c.mediaTypes=this._mediaType.getMediaType({slot:a},d)}})}_updateHighImpactUnitTargeting(){let a=this._gam;V.pushToQueue(()=>{let b=a.getTargetingValuesForKey("hi_au").filter(c=>
"od"!==c&&"om"!==c);b.length?a.setTargeting({key:"hi_au",value:b}):a.clearTargetingForKey("hi_au")})}_shouldIncludeSlot(a){return!this._excludedSlots.includes(a.location)||"Interstitial"===a.location&&this.instlEnabled(a.location)}_addOutstreamLabel(a,b){this._mediaType.isOutstreamAllowed()&&a.forEach(c=>{this._mediaType.outstreamEnabled(c).outstreamCapable&&b.push(`outstreamCapable_${c.placementMapName}`);this._mediaType.outstreamEnabled(c).currentlyActive&&b.push(`outstreamActive_${c.placementMapName}`)});
return b}_addHvpLabel(a,b){a.forEach(c=>{c.isHighlyViewable()&&b.push(`hvp_${c.placementMapName}`)})}_addRefreshLabel(a,b){a.forEach(c=>{0<c.refreshCount&&b.push("refresh")})}_addAuctionLabels(a,b,c){c=c?this._config.prebid.refreshStickyOutstreamAuctionCount:this._config.prebid.refreshAuctionCount;if(b)a.push(`auction-${b}`);else{b=Array.from({length:c});for(let [d]of b.entries())a.push(`auction-${d+1}`)}}_addLabels(a,b,c){let d=a.some(e=>"Video_StickyOutstream"===e.location);(d||1!==this._config.prebid.refreshAuctionCount)&&
this._addAuctionLabels(b,c,d);this._addRefreshLabel(a,b);this._addOutstreamLabel(a,b);this._addHvpLabel(a,b)}_setDiscountTargeting(a){var b;let c=(null===(b=null===a||void 0===a?void 0:a.googleTagSlot)||void 0===b?void 0:b.getTargeting("hb_adid"))||[];var d=(a.bidPoolId?this._prebidMethods.getBidResponsesForBidPoolId(a.bidPoolId):this._prebidMethods.getBidResponsesForAdUnitCode(a.id)).bids.filter(e=>e.adId===c[0])[0]||{};if(b=d.responseCpm)d=b-d.cpm,a.setSlotTargetingFlag("pbop",[b.toFixed(6).toString()]),
a.setSlotTargetingFlag("pbpd",[d.toFixed(6).toString()])}async _setRefreshOnVideoAdUnit(a){let b=this._prebidMethods;await b.waitForQueue();let c=b.getPrebidAdUnits();a.forEach(d=>{let e=null===c||void 0===c?void 0:c.filter(f=>f.code===d.name)[0];e&&(e.refresh=!0)})}requestBids(a,b=this._config.timeouts.initialBidsRequest,c=[],d=0,e=!0){a=a.filter(f=>this._shouldIncludeSlot(f));return new Promise(f=>{this.checkLibLoaded().then(g=>{if(g&&a.length){var h=a.map(k=>this.instlEnabled(k.location)?this._config.prebid.interstitialAdUnitCode:
k.element.id);this._addLabels(a,c,d);this._updateSlots(a);this._prebidMethods.requestBids({adUnitCodes:h,timeout:b,bidsBackHandler:()=>{this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBidsBackHandler");V.pushToQueue(()=>{let k=void 0,m=void 0;1<h.length||!this.isStickyOutstreamSlot(a[0])||(k=this.cpmByDurationReducer.bind(this),m=this.cpmByDurationSorter.bind(this));e&&(this._prebidMethods.setTargetingForGPTAsync(h,null,a[0].bidPoolId,1,k,m),this._setDiscountTargeting(a[0]),a.forEach(n=>
{n.addRequestTypeSlotFlag()}));this._prebidMethods.addToQueue(()=>f())})},labels:c})}else f()}).catch(g=>A.error("PrebidAuctionManager","requestBids",g))})}isStickyOutstreamSlot(a){return"Video_StickyOutstream"===(null===a||void 0===a?void 0:a.location)}addVideoSlots(a){let b=this._orderedVideoBidders.map(d=>d.getVideoBidRequests(a)),c=a.map(d=>{var e=this._ortb2.addOrtb2Imp({video:d});e={code:d.name,ortb2Imp:e,mediaTypes:this._mediaType.getMediaType({video:d}),bids:b.map(f=>f.get(d.name)).filter(kc).reduce((f,
g)=>f.concat(g),[])};return d.videoAdUnit=e});this._prebidMethods.addAdUnits(c)}requestVideoBids(a,b=this._config.timeouts.initialBidsRequest){let c=a.map(({name:d})=>d);return new Promise(d=>{this.checkLibLoaded().then(e=>{e||d();void this._setRefreshOnVideoAdUnit(a);this._prebidMethods.requestBids({adUnitCodes:c,timeout:b,bidsBackHandler:()=>{this._userSyncTriggerComponent.triggerUserSyncBasedOnExperiment("onBidsBackHandler");V.pushToQueue(()=>{this._prebidMethods.setTargetingForGPTAsync(c);d()})}})}).catch(e=>
A.error("PrebidAuctionManager","requestVideoBids",e))})}refreshBids(a,b=0,c=!0){a.forEach(d=>{var e;null===(e=d.prebidAdUnit)||void 0===e?void 0:e.forEach(f=>f.refresh=!0)});return this.requestBids(a,this._config.timeouts.refreshBidsRequest,[],b,c)}checkLibLoaded(){return new Promise(a=>{this._bootstrapConfig.bootstrapLoaders[Oa.Prebid].then(()=>a(!0)).catch(()=>a(!1))})}get enabled(){return!/Trident|MSIE/.test(Ca)}cpmByDurationReducer(a,b){return this.getBidCpmByDuration(a)<this.getBidCpmByDuration(b)?
b:a}cpmByDurationSorter(a,b){return this.getBidCpmByDuration(b)-this.getBidCpmByDuration(a)}getBidCpmByDuration(a){var b;let c=Math.max(1,null!==(b=a.duration)&&void 0!==b?b:this._defaultVideoDuration);return a.cpm/c}};Qc=q([v("PrebidAuctionManager"),y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object,Fa,N,V,Fk,rk,gb,ia,yk,xf,Hk,Qa,tk,Sb,uk,mc,cb,wb,Ik,Pc,yj])],Qc);let Rc=class{constructor(a,b,c,d){this._slotEventBus=c;this._videoEventBus=d;this._auctionManagers=[b,a];this._auctionManagers=this._auctionManagers.filter(e=>
e.enabled);this._setSlotEvents();this._setVideoEvents()}_setSlotEvents(){this._slotEventBus.addSlots.on(a=>this._addSlots(a));this._slotEventBus.requestingBids.on(a=>this._requestBids(a));this._slotEventBus.refreshingBids.on(a=>this._refreshBids(a.managedSlots,a.auctionCount,a.setTargeting))}_setVideoEvents(){this._videoEventBus.videoPlayerAdded.on(a=>this._addVideoSlots(a));this._videoEventBus.requestingVideoBids.on(({videos:a,timeout:b})=>this._requestVideoBids(a,b))}init(){this._auctionManagers.forEach(a=>
void 0!==a.init&&a.init())}async _requestBids(a){await kj();return Promise.all(this._auctionManagers.map(b=>b.requestBids(a)))}_refreshBids(a,b=0,c=!0){return Promise.all(this._auctionManagers.map(d=>d.refreshBids(a,b,c)))}_addSlots(a){this._auctionManagers.forEach(b=>{void 0!==b.addSlots&&b.addSlots(a)})}_addVideoSlots(a){this._auctionManagers.filter(b=>b.videoEnabled&&b.addVideoSlots).forEach(b=>b.addVideoSlots(a))}_requestVideoBids(a,b){return Promise.all(this._auctionManagers.filter(c=>c.videoEnabled).map(c=>
c.requestVideoBids(a,b)))}getPrebidAuctionManager(){for(let a of this._auctionManagers)if(a instanceof Qc)return a}getAmazonAuctionManager(){for(let a of this._auctionManagers)if(a instanceof pf)return a}};Rc=q([v("AuctionManagers"),y(),t("design:paramtypes",[Qc,pf,cb,Ua])],Rc);let Jk=class{constructor(a){this._commands=a.cmd||[]}init(){if(0<this._commands.length){for(let a of this._commands)this._isGamMethod(a.toString())?this._addToGamQueue(a):this._call(a);this._commands=[]}}push(a){0<this._commands.length?
this._commands.push(a):this._isGamMethod(a.toString())?this._addToGamQueue(a):this._call(a)}_call(a){try{a.call(void 0)}catch(b){A.error("CommandQueue","_call","Error calling command",b)}}_isGamMethod(a){return a&&(a.includes("setTargeting(")||a.includes("setTargetingFlag(")||a.includes("getTargeting(")||a.includes("getTargetingMap(")||a.includes("googletag")||a.includes("pubads"))}_addToGamQueue(a){V.pushToQueue(()=>{this._call(a)})}};Jk=q([y(),ha(0,fa("AdThrive")),t("design:paramtypes",[Object])],
Jk);let Af=class{constructor(){this.wasStarted=this.wasClosed=!1;this.totalTimeCollapsed=0}};Af=q([v("CollapsibleVideoLoggingStore"),y()],Af);let Kk=class extends W{init(){this._key="UserPageDataLogging";this._default=!1}};Kk=q([v("UserPageDataLoggingExperiment"),y()],Kk);let Lk=class extends W{init(){this._key="UserPageDataPrivacyLogging";this._default=!1}};Lk=q([v("UserPageDataPrivacyLoggingExperiment"),y()],Lk);let Mk=class{constructor(a){this._piiEventBus=a;this.knownCookieKeys="AMZN-Token ccuid ccsid usprivacy _pubcid _pubcid_exp connectId lidid TAPAD panaoramaId panaoramaId_expiry krg_crb krg_uid cto_bundle __li_idex_cache_e30".split(" ");
this.cookieEvents=[];this._piiEventBus.dataCaptured.on(()=>{setTimeout(()=>this.calculateCookieSizes("piiSubmitted"),2E3)})}init(){}calculateCookieSizes(a){let b=0,c=0;this.getCookies().forEach(d=>{let e=(new Blob([d.value])).size;this.knownCookieKeys.includes(d.name)?b+=e:c+=e});this.cookieEvents.push({e:a,knownSize:b,unknownSize:c})}getCookies(){let a=[];document.cookie.split(";").forEach(b=>{let [c,d]=b.split("=").map(e=>e.trim());a.push({name:c,value:d})});return a}};Mk=q([v("CookieDataStorage"),
y(),t("design:paramtypes",[Db])],Mk);let Nk=class extends T{constructor(a,b,c,d,e,f,g,h,k,m,n){super();this._bootstrapConfig=a;this._config=b;this._pageManager=c;this._spaEventBus=d;this._prebidMethods=e;this._slotManager=f;this._userPageDataLoggingExperiment=g;this._userPageDataPrivacyLoggingExperiment=h;this._userPageDataLogEvents=k;this._collapsibleVideoLoggingStore=m;this._cookieDataStorage=n;this._userPrivacyData={};this._performanceTimingData={};this._setupSlotManagerEventListeners=()=>{let {reasons:p}=
this._config.disableAds,r={requestingBids:null,requestedBids:null,displayed:null},w={...r,pageLoaded:!1},z=(x,B)=>{w[x]=B;"number"===typeof w.requestingBids&&"number"===typeof w.requestedBids&&"number"===typeof w.displayed&&w.pageLoaded&&(this._setTimingData(w.requestingBids,w.requestedBids,w.displayed),w={...w,...r})};0!==p.size?(w.requestedBids=0,w.requestingBids=0,w.displayed=0):(this._slotManager.requestingBids.once(()=>z("requestingBids",ra())),this._slotManager.requestedBids.once(()=>z("requestedBids",
ra())),this._slotManager.displayed.once(()=>z("displayed",ra())));Bp().then(()=>z("pageLoaded",!0))};this._setupUserPageDataLogEventCallbacks=()=>{ca()&&this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.visibilityChange],()=>{"hidden"===document.visibilityState&&this._logUserData()});this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload,this._pageManager.pageHide],()=>this._logUserData());this._spaEventBus.routeChanged.on(()=>this._logUserData())};this._getUserData=
()=>{let p=this._getBuildData();var r=this._config.context.device,w=googletag&&googletag.getVersion&&googletag.getVersion(),z=ra()-this._config.timing.started,x=this._config.timing.totalTimeOnPage,B=window.innerWidth,E=window.innerHeight,C={nonclose:!this._collapsibleVideoLoggingStore.wasClosed,playerName:this._collapsibleVideoLoggingStore.playerName,totalTimeCollapsed:this._collapsibleVideoLoggingStore.totalTimeCollapsed,wasStarted:this._collapsibleVideoLoggingStore.wasStarted},I=this._cookieDataStorage.cookieEvents,
F={...this._userPrivacyData},O;if(O=!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut){a:{if(this._prebidMethods.isPrebidLoaded())for(const R of window.pbjs.getUserIdsAsEids())if(R.source&&"adserver.org"===R.source&&R.uids&&0<R.uids.length&&R.uids[0].id){O=R.uids[0].id;break a}O=null}O={uid1:O}}return{...p,device:r,gptv:w,timePageOpen:z,timeOnPage:x,viewportWidth:B,viewportHeight:E,video:C,cookieEvents:I,...F,...O}}}init(){this._setupSlotManagerEventListeners();this._setupUserPageDataLogEventCallbacks();
this._logUserPrivacyData().catch(()=>{A.error("_logUserPrivacyData: ","Could not log user privacy.")});this._setLoadTimingProperties()}get enabled(){return this._userPageDataLoggingExperiment.result}_getBuildData(){var a=window.adthriveCLS;a=a&&a.buildDate;return{bundleBuildDate:window.adthrive.buildDate,...(a?{clsBuildDate:a}:{})}}_setTimingData(a,b,c){var d;if(window.performance&&window.performance.timing){var e=window.performance.timing;if(e&&0!==e.navigationStart){let f={pageLoad:e.loadEventStart-
e.navigationStart,domainLookup:e.domainLookupEnd-e.domainLookupStart,connect:e.connectEnd-e.connectStart,request:e.responseStart-e.requestStart,response:e.responseEnd-e.responseStart,navigation:e.fetchStart-e.navigationStart,domInteractive:e.domInteractive-e.navigationStart,domContentLoaded:e.domContentLoadedEventStart-e.navigationStart};Object.keys(f).map(g=>f[g]).every(g=>!isNaN(g)&&0<=g&&36E5>g)&&(this._setNonBlockingLibraryTimingData(),{reasons:e}=this._config.disableAds,this._timingData={...f,
...this._config.timing.timingData,disableAds:0<e.size?[...e].join():"none",cookieDeprecationLabel:null!==(d=this._config.fledge.cookieDeprecationLabel)&&void 0!==d?d:"none",auctionStarted:a,auctionFinished:b,displayed:c})}}}_setNonBlockingLibraryTimingData(){this._config.timing.setNonBlockingLibraryTimingData(this._bootstrapConfig.bootstrapResult)}_logUserData(){this._cookieDataStorage.calculateCookieSizes("userDataLogged");this._userPageDataLogEvents.loggingData.emit();this._userPageDataLogEvents.setUserPageData({...(this._timingData&&
{UserPageTimingData:this._timingData}),UserPageDataLoggingComponent:this._getUserData(),performanceTimingData:this._performanceTimingData})}async _logUserPrivacyData(){this._userPageDataPrivacyLoggingExperiment.result&&(this._userPrivacyData=await this._getUserPrivacyData())}async _getUserPrivacyData(){return{gpc:"navigator"in window&&"globalPrivacyControl"in window.navigator?window.navigator.globalPrivacyControl:null,dcp:await this._getDataConsent()}}async _getDataConsent(){if("dataConsentPreference"in
document)try{return await document.dataConsentPreference()}catch(a){}return null}_getEventTiming(a,b){var c;return null!==(c=performance.getEntriesByType(a).filter(b)[0])&&void 0!==c?c:{}}_getEventTimingProperties(a,b,c){let d={},e=this._getEventTiming(a,b);c.forEach(f=>{var g;d[f]=null!==(g=null===e||void 0===e?void 0:e[f])&&void 0!==g?g:null});return d}_getEventRegex(a){switch(a){case "adsmin":return/ads\.adthrive\.com\/sites\/.*\/ads\.min\.js\?.*/;case "marmalade":return/ads\.adthrive\.com\/api\/.*\/marmalade\?.*/;
case "floors":return/ads\.adthrive\.com\/api\/.*\/raptiveFloors\.*/}return RegExp("")}_setLoadTimingProperties(){let {duration:a}=this._getEventTimingProperties("resource",r=>r.name.includes("adthrive.min.js"),["duration"]),b=this._getEventRegex("adsmin"),{duration:c,startTime:d}=this._getEventTimingProperties("resource",r=>b.test(r.name),["duration","startTime"]),{duration:e,responseEnd:f}=this._getEventTimingProperties("resource",r=>r.name.includes("gpt.js"),["responseEnd","duration"]),g=this._getEventRegex("marmalade"),
{responseEnd:h}=this._getEventTimingProperties("resource",r=>g.test(r.name),["responseEnd"]),k=this._getEventRegex("floors"),{responseEnd:m}=this._getEventTimingProperties("resource",r=>k.test(r.name),["responseEnd"]),n=Math.max(...[h,f,m]),{domContentLoadedEventEnd:p}=this._getEventTimingProperties("navigation",r=>!!r,["domContentLoadedEventEnd"]);this._performanceTimingData={durations:{adsMinLoadDuration:c,adCodeLoadDuration:a,gptLoadDuration:e},endTimes:{marmaladeEndTime:h,gptEndTime:f,floorsEndTime:m,
domReadyEndTime:p},totalLoadTime:n-d}}};Nk=q([v("UserPageDataLoggingComponent"),H(),t("design:paramtypes",[Fa,N,Ra,Pa,ia,ja,Kk,Lk,Lc,Af,Mk])],Nk);class Bu{constructor(){this._map=[]}add(a,b,c,d=document){this._map.push({el:a,coords:b,dynamicAd:c,target:d})}get map(){return this._map}sort(){this._map.sort(({coords:a},{coords:b})=>a-b)}filterUsed(){this._map=this._map.filter(({dynamicAd:a})=>!a.used)}reset(){this._map=[]}}let nc=class extends Bu{};nc=q([y()],nc);let Ok=class extends W{init(){this._key=
"AdDensity";this._default=!1}};Ok=q([v("RealizedAdDensityExperiment"),y()],Ok);let Pk=a=>{a=(a=a.firstChild?a.firstChild:void 0)?getComputedStyle(a).height:"0px";return Number(a.slice(0,-2))},Qk=class extends T{constructor(a,b,c,d,e,f,g,h,k,m){super();this._gam=a;this._config=b;this._realizedAdDensityExperiment=c;this._parallaxExperiment=d;this._slots=e;this._slotManager=f;this._pageManager=g;this._userPageDataLogEvents=h;this._adInjectionMap=k;this._realizedAdDensityEventBus=m;this._initialSlotsTimeout=
1E4;this._addToMainContent=new Set(["Below_Post"]);this._slotsForAdDensity=new Set(["Content","Recipe","Footer"]);this._commentElem=this._mainContent=null;this._heightsRegistered=!1;this._slotsHeightVideo=this._slotsHeightEnd=this._endMainContentHeight=this._initMainContentHeight=null;this._slotsForMainContent=new Set;this._slotsForEnd=new Set}init(){this._realizedAdDensityEventBus.metricsRequested.on(b=>b(this._getAdDensity()));let [a]=tp(this._config.dynamicAds,this._adInjectionMap);this._mainContent=
a;null!==this._mainContent&&(this._initObserver(this._mainContent),this._gam.slotOnload.on(()=>{this._heightsRegistered||(setTimeout(()=>{this._getSlotHeights()},this._initialSlotsTimeout),this._heightsRegistered=!0)}),this._slotManager.added.on(b=>{b.some(c=>c.infinite)||this._addSlots(b)}),this._userPageDataLogEvents.addCallbackToQueue([this._pageManager.beforeUnload],()=>this._logAdDensity()))}_getAdDensity(){return{...(this._endMainContentHeight&&this._slotsHeightEnd&&{addensend:Math.round(this._slotsHeightEnd/
this._endMainContentHeight*100)})}}_logAdDensity(){let a=this._getAdDensity();0<Object.keys(a).length&&this._userPageDataLogEvents.setUserPageData({AdDensityComponent:a})}_addSlots(a){a.filter(b=>this._slotsForAdDensity.has(b.location)).filter(b=>!b.element.classList.contains("adthrive-slicksearch")).forEach(b=>{!b.lazy&&this._addToMainContent.has(b.location)&&this._slotsForMainContent.add(b.name);this._slotsForEnd.add(b.name)})}isSlotInMainContent(a){var b;return(null===(b=this._mainContent)||void 0===
b?0:b.querySelector(`#${a.id}`))&&!this.isSlotInComment(a)?!0:!1}isSlotInComment(a){return this._commentElem&&this._commentElem.querySelector(`#${a.id}`)?!0:!1}_getSlotHeights(){let a=0;this._slots.get().forEach(b=>{this._slotsForMainContent.has(b.name)&&(a+=b.element.offsetHeight)});this._mainContent&&(this._initMainContentHeight=sh(this._mainContent),this._initMainContentHeight+=a)}_initObserver(a){let b=a.querySelector("div #comments, section .comments");this._observer=this.getIntersectionObserver(b);
null!==b?(this._commentElem=b,this._observer.observe(this._commentElem)):this._observer.observe(a)}getIntersectionObserver(a){return new IntersectionObserver(b=>{var c,d;for(const e of b)null!==this._initMainContentHeight&&(null===a&&0>e.boundingClientRect.top&&(this._calculateSlotHeightsAtEnd(),null===(c=this._observer)||void 0===c?void 0:c.unobserve(this._mainContent)),null!==a&&0<e.boundingClientRect.top&&(this._calculateSlotHeightsAtEnd(),null===(d=this._observer)||void 0===d?void 0:d.unobserve(a)))},
{})}_calculateSlotHeightsAtEnd(){let a=0,b=0;this._slots.get().forEach(c=>{if(this._slotsForEnd.has(c.name)&&("Content"!==c.location||this.isSlotInMainContent(c))){let d=Pk(c.element);a=d&&1<d?this._parallaxExperiment.result&&600<=d&&750>=d?a+400:a+d:a+c.element.offsetHeight}this._slotsForMainContent.has(c.name)&&(b+=c.element.offsetHeight)});this._slotsHeightEnd=a;this._mainContent&&(this._endMainContentHeight=sh(this._mainContent),this._endMainContentHeight+=b);if(this._config.video.playlistPlayerAdded){let c=
document.querySelector(".adthrive-collapse-player");a+=c?c.offsetHeight:0}this._config.video.relatedPlayerAdded&&document.querySelectorAll(".adthrive-video-player").forEach(c=>{a+=c.offsetHeight});this._slotsHeightVideo=a}get enabled(){return this._realizedAdDensityExperiment.result&&"IntersectionObserver"in window&&!(null!==document.querySelector("body.home")||null!==document.querySelector("body.archive"))&&window.location.origin+"/"!==window.location.href.split("?")[0]}start(){this._realizedAdDensityEventBus.realizedAdDensityCompReady.emit()}};
Qk=q([v("RealizedAdDensityComponent"),H(),t("design:paramtypes",[V,N,Ok,Bd,Qa,ja,Ra,Lc,nc,Ge])],Qk);let Rk=class extends T{constructor(a,b){super();this._config=a;this._gam=b}init(){if(this._config.context.querystring.has("ad_test")){let a=this._config.context.querystring.get("ad_test");this._gam.setTargeting({key:"sec",value:a.split(",").map(b=>`test${b}`)})}}};Rk=q([v("AdTestComponent"),H(),t("design:paramtypes",[N,V])],Rk);let Sk=class extends W{init(){this._key="BrandMetrics";this._default=!0}};
Sk=q([v("BrandMetricsExperiment"),y()],Sk);let Tk=class extends T{constructor(a,b,c){super();this._brandMetricsExperiment=a;this._gam=b;this._prebidAuctionManager=c;this._url="https://cdn.brandmetrics.com/tag/aa466d868b2742ffa2cc31bb6341dc12/cafemedia.js"}init(){this._prebidAuctionManager.bidsRequested.once(()=>{this._load()})}get enabled(){return this._brandMetricsExperiment.result}_load(){nb(this._url).then(()=>this._monitorSurvey()).catch(()=>{})}_monitorSurvey(){window._brandmetrics=window._brandmetrics||
[];window._brandmetrics.push({cmd:"_querySurvey",val:{callback:(a,b)=>{a&&b&&b.measurementId&&this._gam.setTargeting({key:"bms",value:[b.measurementId.toString()]})}}})}};Tk=q([v("BrandMetrics"),H(),t("design:paramtypes",[Sk,V,Qc])],Tk);let Uk=class extends T{constructor(a){super();this._config=a}init(){var a=document.body;const b=`adthrive-device-${this._config.context.device}`;if(!a.classList.contains(b))try{a.classList.add(b)}catch(c){A.error("BodyDeviceClassComponent","init",{message:c.message}),
a="classList"in document.createElement("_"),A.error("BodyDeviceClassComponent","init.support",{support:a})}}};Uk=q([v("BodyDeviceClassComponent"),H(),t("design:paramtypes",[N])],Uk);Ab(".adthrive-ccpa-modal{background-color:#000;background-color:rgba(0,0,0,.4);display:none;height:100%;left:0;overflow:auto;position:fixed;top:0;width:100%;z-index:2147483647}.adthrive-ccpa-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.5);font-family:Verdana,Geneva,Tahoma,sans-serif;margin:0 auto;max-width:592px;padding:20px 24px 24px;position:relative;top:50%;transform:translateY(-50%);width:80%}#adthrive-ccpa-modal-title{color:rgba(0,0,0,.87);font-size:20px;line-height:26px}.adthrive-ccpa-modal-btn:focus,.adthrive-ccpa-modal-btn:hover{color:#000;cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-language{color:rgba(0,0,0,.87);display:block;font-size:14px;line-height:20px;margin:16px 0 32px}#adthrive-ccpa-modal-cancel-btn:focus,#adthrive-ccpa-modal-cancel-btn:hover,#adthrive-ccpa-modal-close-btn-container:focus,#adthrive-ccpa-modal-close-btn-container:hover{color:rgba(0,0,0,.8);cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-continue-btn:focus,#adthrive-ccpa-modal-continue-btn:hover{color:hsla(0,0%,100%,.8);cursor:pointer;text-decoration:none}#adthrive-ccpa-modal-close-btn-container{color:#000;font-size:20px;font-weight:700;line-height:20px;position:absolute;right:8px;top:8px}.adthrive-ccpa-lower-buttons-container{color:#000;font-size:18px}#adthrive-ccpa-modal-cancel-btn{display:inline-block;text-align:left;width:calc(100% - 150px)}#adthrive-ccpa-modal-continue-btn{background-color:#010044;border-radius:10px;color:#fff;display:inline-block;height:44px;line-height:44px;text-align:center;width:150px}@media screen and (max-width:896px){.adthrive-ccpa-modal-content{margin:0 auto;position:relative;width:calc(100% - 80px)}#adthrive-ccpa-modal-title{font-size:16px;line-height:24px}#adthrive-ccpa-modal-language{font-size:12px;line-height:16px;text-align:left}.adthrive-ccpa-lower-buttons-container{font-size:14px}#adthrive-ccpa-modal-close-btn-container{font-size:14px;line-height:14px}}@media screen and (max-width:350px){#adthrive-ccpa-modal-title{font-size:14px;line-height:24px}#adthrive-ccpa-modal-language{font-size:10px;line-height:14px;text-align:left}.adthrive-ccpa-lower-buttons-container{display:block;font-size:12px;text-align:center;width:100%}#adthrive-ccpa-modal-close-btn-container{display:block;font-size:12px;line-height:12px}#adthrive-ccpa-modal-cancel-btn,#adthrive-ccpa-modal-continue-btn{display:block;text-align:center;width:100%}#adthrive-ccpa-modal-cancel-btn{margin-bottom:10px}}");
class Cu extends T{constructor(a){super();this._config=a;this._deviceAccess=!1;this.ccpaRequired=this._config.ccpa.required;this.privacyString=this._config.ccpa.privacyString;this.ccpaNotApplicable=this._config.ccpa.ccpaNotApplicable;this.ccpaOptIn=this._config.ccpa.ccpaOptIn;this.ccpaOptOut=this._config.ccpa.ccpaOptOut;this.ccpaOptOutText=this._config.ccpa.optOutText;this.ccpaOptInText=this._config.ccpa.optInText;this.gpcEnabled=!!this._config.ccpa.gpcEnabled;this.gpcUpdated=!1;this.globalPrivacyControl=
window.navigator.globalPrivacyControl;this._deletionQueue=[];this.ccpaLinkText=""===this.privacyString||this.privacyString===this.ccpaOptIn?this.ccpaOptOutText:this.ccpaOptInText;this.modal=ub("div","adthrive-ccpa-modal","adthrive-ccpa-modal");this.modalContent=ub("div","adthrive-ccpa-modal-content","adthrive-ccpa-modal-content");this.ccpaATag=ub("a","ccpaTag",void 0,this.ccpaLinkText,"/");this.ccpaOptOutDivId="adthrive-ccpa-link"}init(){window.__uspapi=this.uspapi.bind(this);this.addLocatorFrame();
this.ccpaRequired?(window.__uspapi("registerDeletion",1,this.deleteData),this.setGpcString(),this.setPrivacyString(this.gpcEnabled||this._config.ccpa.privacyString===this.ccpaOptOut?this.ccpaOptOut:this.ccpaOptIn),this.setDeviceAccess()):this.setPrivacyString(this.ccpaNotApplicable)}setPrivacyString(a,b=!1){let c=this.ccpaRequired&&this.privacyString===this.ccpaNotApplicable,d=!this.ccpaRequired&&this.privacyString!==this.ccpaNotApplicable;if(a||!0===b||c||d||this.gpcUpdated)this.setPrivacyCookie(a),
this.privacyString=a}setPrivacyCookie(a){let b=(new Date(2147483647E3)).toUTCString();document.cookie=`usprivacy=${a};path=/;expires=${b}`}setGpcString(){null!==this.gpcEnabled&&!1!==this.gpcEnabled||!this.globalPrivacyControl?!0!==this.gpcEnabled||this.globalPrivacyControl||(U.removeLocalStorageValue("gpc"),this.gpcEnabled=this.globalPrivacyControl,this.gpcUpdated=!0):(U.setLocalStorageValue("gpc",`${this.globalPrivacyControl}`),this.gpcEnabled=!!`${this.globalPrivacyControl}`,this.gpcUpdated=!0)}uspapi(a,
b,c){switch(a){case "performDeletion":this._deletionQueue.forEach(d=>d());break;case "registerDeletion":this._deletionQueue.push(c);break;case "getUSPData":return a={command:a,version:b,uspString:Na("usprivacy")},c(a,!0);default:return null}}addLocatorFrame(){if(null===document.getElementById("__uspapiLocator")){let a=document.createElement("iframe");a.style.display="none";a.id="__uspapiLocator";a.name="__uspapiLocator";document.body.appendChild(a)}}setCCPAEventListener(a,b,c,d){c&&this.modal?c.addEventListener("click",
(()=>{a&&this.optUserInOrOut();b&&(this.modal.style.display="none")}).bind(this)):d&&this.modal&&d.addEventListener("click",(e=>{e.target==this.modal&&(this.modal.style.display="none")}).bind(this))}optUserInOrOut(){this.privacyString===this.ccpaOptIn?(this.setPrivacyString(this.ccpaOptOut,!0),window.__uspapi("performDeletion",1),this.modal.style.display="block",this.ccpaATag.textContent=this.ccpaOptInText,this._config.ccpa.userOptedOut=!0):(this.setPrivacyString(this.ccpaOptIn,!0),this.ccpaATag.textContent=
this.ccpaOptOutText,this._config.ccpa.userOptedOut=!1);this._config.ccpa.consentChange.emit(this.privacyString);this.setDeviceAccess()}createCCPAModal(){document.body.append(this.modal);this.modal.append(this.modalContent);this.setCCPAEventListener(!1,!0,void 0,window);var a=ub("div","adthrive-ccpa-modal-close-btn-container",void 0,"<span>&#10005;</span>");this.modalContent.append(a);this.setCCPAEventListener(!1,!0,a);a=ub("div","adthrive-ccpa-modal-title",void 0,this._config.ccpa.optOutText);this.modalContent.append(a);
a=ub("span","adthrive-ccpa-modal-language",void 0,'You have chosen to opt-out of the sale or sharing of your information from this site and any of its affiliates. To opt back in please click the "Customize my ad experience" link.<br>\n    <br>This site collects information through the use of cookies and other tracking tools. Cookies and these tools do not contain any information that personally identifies a user, but personal information that would be stored about you may be linked to the information stored in and obtained from them. This information would be used and shared for Analytics, Ad Serving, Interest Based Advertising, among other purposes.<br>\n    <br>For more information please visit this site\'s Privacy Policy.');
this.modalContent.append(a)}createModalLowerButtons(){let a=ub("div",void 0,"adthrive-ccpa-lower-buttons-container");this.modalContent.append(a);var b=ub("div","adthrive-ccpa-modal-cancel-btn","adthrive-ccpa-modal-btn","CANCEL");a.append(b);this.setCCPAEventListener(!0,!0,b);b=ub("div","adthrive-ccpa-modal-continue-btn","adthrive-ccpa-modal-btn","CONTINUE");a.append(b);this.setCCPAEventListener(!1,!0,b)}addOptOutElements(a=!0){this.ccpaOptOutDiv=ub("div",this.ccpaOptOutDivId,"adthrive-ccpa-link",
"Information from your device can be used to personalize your ad experience. <br><br>");this.ccpaOptOutDiv.style.display=a?"block":"none";this.ccpaOptOutDiv.appendChild(this.ccpaATag);this.setCCPAEventListener(!0,!1,this.ccpaATag);this.createCCPAModal();this.createModalLowerButtons()}deleteData(){}setDeviceAccess(){this._deviceAccess=this.privacyString===this.ccpaOptIn?!0:!1}}let Vk=class extends W{init(){let a=S.resolve(N);this._key="SinglePageAppSupport_"+String(a.site.id);this._default=!1}};Vk=
q([v("SpaMultiSiteExperiment"),y()],Vk);let Sc=class extends W{init(){var a=S.resolve(Vk).key;this._key=this._coreExperimentConfig.getCoreExperiment(a)?a:"SinglePageAppSupport";a=S.resolve(N);this.setABGroup(this.isEnabled()?!0:!1,"SinglePageAppSupport"===this._key?"spa":"spa_"+String(a.site.id));this._default=!1}isEnabled(){return!0===S.resolve(N).adOptions.spa&&super.isEnabled()}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",Object)],
Sc.prototype,"run",null);Sc=q([v("SinglePageAppManagerExperiment"),y()],Sc);let Bf=class extends Cu{constructor(a,b,c,d){super(a);this._gam=d;this._singlePageAppManagerExperimentResult=c.result;this._spaEventBus=b}init(){super.init();if(this.ccpaRequired){this._setupListeners();let a=document.querySelector(`#${this.ccpaOptOutDivId}`),b=this._isHomeOrFPV();a||this._config.act25.required||(this.addOptOutElements(b),this.injectFooter());vh(["America/Los_Angeles"],[480])&&this._gam.setTargetingFlag("hmt",
[Pe()?"1":"0"])}}uspapi(a,b,c){return super.uspapi(a,b,c)}createCCPAModal(){return super.createCCPAModal()}optUserInOrOut(){super.optUserInOrOut()}_isHomeOrFPV(){return"/"===window.location.pathname||this._config.context.isFirstPageview}_setupListeners(){if(this._singlePageAppManagerExperimentResult)this._spaEventBus.routeChanged.once(()=>{this.init();let a=document.querySelector(`#${this.ccpaOptOutDivId}`),b=this._isHomeOrFPV()?"block":"none";a&&(a.style.display=b)})}injectFooter(){this.ccpaOptOutDiv&&
this._config.footer.elements.push({order:1,element:this.ccpaOptOutDiv})}};Bf=q([v("CCPAComponent"),H(),t("design:paramtypes",[N,Pa,Sc,V])],Bf);let Cf=class extends W{init(){this._key="ConfiantRefresh";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Cf.prototype,"run",null);Cf=q([v("ConfiantPropertyExperiment"),y()],Cf);let Du=new Map([[1,{type:"manual",description:"Deprecated"}],[2,{type:"creative",description:"Creative-based detection"}],
[3,{type:"provider_security",description:"Domain-based detection for unsafe domains"}],[4,{type:"banned_domain",description:"Domain-based detection for bannded domains"}],[5,{type:"provider_ibv",description:"Domain-based detection for in-banner-video"}],[6,{type:"unsafejs",description:"JavaScript-based detection for unsafe ads"}],[7,{type:"hrap",description:"Domain-based detection for high risk ad platform domains"}]]),Wk=class extends T{constructor(a,b){super();this._config=a;this._confiantPropertyExperiment=
b;this._prodPropertyId="mOinGM9MTu5v-Lto835XLhlrSPY";this._expPropertyId="wyN88rwU6FImxcXgha7IWE-FzsE";this._trackerHoldoutKey="conf"}init(){let a=this._confiantPropertyExperiment.result?this._expPropertyId:this._prodPropertyId;window.confiant=window.confiant||{};window.confiant.callback=(b,c,d,e,f)=>{let g=Du.get(b);A.event("ConfiantComponent","adBlocked",{blockingTypeIntegerValue:b,blockingType:g?g.type:"unknown",description:g?g.description:"unknown",tagId:f,wrapperId:e,blockingId:c,isBlocked:d})};
return nb(`https://${"cdn.confiant-integrations.net"}/${a}/gpt_and_prebid/config.js`)}get enabled(){return this._config.tkho.tracker!==this._trackerHoldoutKey}};Wk=q([v("ConfiantComponent"),H(),t("design:paramtypes",[N,Cf])],Wk);let Xk=class extends T{constructor(a,b){super();this._config=a;this._gam=b;this.debug=!1;this.debug=this._config.context.debug}_getConfigTargeting(){let a=this._config,b=this._config.context,c=this.debug;return[...this._getConfigGoogleAdManagerTargeting(a.gam.targeting),{key:"abgroup",
value:a.abGroup.groups},{key:"pubab",value:a.pubAbGroup.groups},{key:"idho_p",value:a.idho.percentages},{key:"bucket",value:c?"unsupported":b.bucket},{key:"sens",value:a.site.sensitiveCategories},{key:"domain",value:b.domain},{key:"plugin",value:b.plugin},{key:"hi_au",value:a.adTypes.enabledMinified},{key:"vpwxvph",value:`${window.innerWidth}x${window.innerHeight}`},{key:"ri",value:b.ri},{key:"st",value:b.salesThrottle},{key:"rsi",value:b.rsi},{key:"pvk",value:b.pageviewKey},{key:"sess",value:b.sessionKey},
{key:"branch",value:b.branch},{key:"deployment",value:c||b.invalidTraffic?"unsupported":b.deployment},{key:"hbho",value:a.hbho.bidders},{key:"vbho",value:a.vbho.bidders},{key:"doba",value:a.displayOpenBidding.bidders},{key:"gptv",value:window.googletag.getVersion()},{key:"id_region",value:a.locale.targetingValue}]}_getConfigGoogleAdManagerTargeting(a){let b=[];a.forEach(c=>{"verticals"===c.key?b.push({key:"verticals",value:this._fixGamVerticalsValue(c.value)}):b.push({key:c.key,value:c.value})});
return b}_fixGamVerticalsValue(a){if(!Array.isArray(a))return this._fixGamVerticalsValue([a])[0];let b=new RegExp(/[";'\^=\(\)!<>\+\[\]#,\*~`]/,"g");return a.map(c=>c.replace(b,"").replace(/&/g,"and"))}getConditionalTargeting(){let a=[],b=this._config.context,c=this._config.site,d=this._config.ccpa;c.sensCategoriesOff.length&&a.push({key:"sens_off",value:c.sensCategoriesOff});b.connectionTargeting.length&&a.push({key:"connection",value:b.connectionTargeting});d.required&&a.push({key:"ccpaOptOut",
value:d.userOptedOut?"1":"0"});b.gpid&&a.push({key:"gpid",value:b.gpid});return a}setConditionalFlagTargeting(){var a;let b=this._config.context,c=fp();"cookieDeprecationLabel"in navigator&&this._gam.setTargetingFlag("cookdep",[null!==(a=this._config.fledge.cookieDeprecationLabel)&&void 0!==a?a:""]);b.invalidTraffic&&this._gam.setTargetingFlag("bot",b.invalidTraffic);b.adsMinLoadDuration&&this._gam.setTargetingFlag("adsmnche",b.adsMinLoadDuration);this._config.gdpr.enabled&&this._gam.setTargetingFlag("gdpr",
["1"]);null!==fp()&&this._gam.setTargetingFlag("brwsrv",[`${c}`]);this._config.adOptions.pmp&&this._gam.setTargetingFlag("pmp_elig",["1"]);Ta()&&this._config.adTypes.largeFormatsDesktop&&this._gam.setTargetingFlag("lf_elig",["1"]);!Ta()&&this._config.adTypes.largeFormatsMobile&&this._gam.setTargetingFlag("lf_elig",["1"]);this._config.clsOptions&&(this._gam.setTargetingFlag("clson",[String(!!this._config.clsOptions.injectedFromPlugin)]),this._gam.setTargetingFlag("clsBranch",[this._config.clsOptions.branch||
""]),this._gam.setTargetingFlag("clsBucket",[this._config.clsOptions.bucket||""]));b.integration&&this._gam.setTargetingFlag("integration",[b.integration]);b.deliveryVersion&&this._gam.setTargetingFlag("lmdv",[b.deliveryVersion]);b.isWordPressLogin&&this._gam.setTargetingFlag("wpadm",["1"])}init(){V.pushToQueue(()=>{this._gam.setTargeting([...this._getConfigTargeting(),...this.getConditionalTargeting()]);this.setConditionalFlagTargeting()})}};Xk=q([v("ConfigTargetingComponent"),H(),t("design:paramtypes",
[N,V])],Xk);let Yk=class extends T{constructor(a,b){super();this._gam=a;this._slots=b}init(){this._gam.slotRenderEnded.on(a=>this.confirmedClickOverlay(a))}confirmedClickOverlay({event:a,slot:b}){V.pushToQueue(()=>{let {id:c,location:d,sequence:e,nref:f}=b.getTargetingMap(),g=this.confirmedClickStatus(this._slots.get(a.slot.getSlotElementId()));yp({event:a,ignoreOtherCompanyIds:!0})&&g&&A.event("confirmedClickOverlay","status",{id:c,location:d,sequence:e,nref:f,confirmedClick:g})})}confirmedClickStatus(a){let b=
["common_15click_overlay","common_15click_anchor"];try{let c=null===a||void 0===a?void 0:a.element.querySelectorAll("iframe[id^=google_ads_iframe]"),d;c&&0<(null===c||void 0===c?void 0:c.length)&&(d=c[0]);return b.some(e=>{var f;return null!=(null===(f=null===d||void 0===d?void 0:d.contentDocument)||void 0===f?void 0:f.getElementById(e))})}catch(c){A.error("ConfirmedClickComponent","confirmedClickStatus",c)}return!1}};Yk=q([v("ConfirmedClicksComponent"),H(),t("design:paramtypes",[V,Qa])],Yk);let Zk=
class extends T{constructor(a,b,c){super();this._config=a;this._gam=b;this._slotManager=c;this._device=this._config.context.device}init(){let a=this._slotManager;this._gam.slotRenderEnded.on(({event:b,slot:c})=>{this.isDeclaredRefreshCompliantSlot(c)&&yp({event:b})&&a.updateRefreshTimeout(c.id,24E4)});a.added.on(b=>b.forEach(c=>{this.isDeclaredRefreshCompliantSlot(c)&&V.pushToQueue(()=>{c.setTargeting({key:"decref",value:"240"})})}))}isDeclaredRefreshCompliantSlot(a){return"Sidebar"===a.location&&
("phone"===this._device||"tablet"===this._device)||"Header"===a.location&&2===a.sequence&&("phone"===this._device||"tablet"===this._device)}};Zk=q([v("DeclaredRefreshComponent"),H(),t("design:paramtypes",[N,V,ja])],Zk);let Df=class extends fb{constructor(a){super();this._result=!1;this.abgroup="scae";this.key="StickyContainerAds";this._choices=[{choice:!0},{choice:!1}];this.weight=.99;this.shouldUseCoreOverride=!1;var b=window;this._result=(b=(b=b&&b.adthriveCLS)&&b.experiments)&&this.abgroup in b?
b[this.abgroup]:this.run();a.set(this.abgroup,this._result?"on":"off")}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};Df=q([v("StickyContainerAdsExperiment"),y(),t("design:paramtypes",[Ia])],Df);let Ef=class extends Ch{constructor(a,b,c,d){var e;super();this._siteExperiments=a;this._pubabgroup=b;this._clsOptions=c;this._choices=[];this._mappedChoices=[];this._result="control";this._resultValidator=f=>"number"===typeof f;this.abgroup=this.key=bb.AdDensity;(null===(e=d.siteAds)||
void 0===e?0:e.siteExperiments)?this.experimentConfig=(new Dh(d.siteAds)).getSiteExperimentByKey(this.key):this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);a=this._clsOptions.getWeightedChoiceExperiment(this.abgroup,!0);this.enabled&&this._isValidResult(a)?(this._result=a,this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){if(!this.enabled)return A.error("TargetAdDensitySiteExperiment",
"run","() => %o","No experiment config found. Defaulting to control."),"control";let a=(new Ec(this._mappedChoices)).get();if(this._isValidResult(a))return a;A.error("TargetAdDensitySiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to control.");return"control"}setExperimentTargeting(){if(this.enabled&&this._isValidResult(this._result)){var a=this.experimentConfig;a=`${a.key.toLowerCase()}-${a.id}`;this._pubabgroup.set(a,"control"===this._result?"control":`${Math.round(100*
this._result)}`)}else A.error("TargetAdDensitySiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result")}_mapChoices(){return this._choices.map(({weight:a,value:b})=>({weight:a,choice:"number"===typeof b?(b||0)/100:"control"}))}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Ef.prototype,"run",null);Ef=q([y(),ha(3,fa("AdthriveCLS")),t("design:paramtypes",[vb,pb,Kc,Object])],Ef);let Ff=(a,b,
c,d=[],e)=>{d=`<div id="${b}" class="adthrive-ad ${d.join(" ")}"></div>`;"Video_StickyOutstream"===e&&(d=`<div class="adthrive-sticky-outstream adthrive-sticky-outstream-${b.includes("phone")?"mobile":"desktop"}">`+d+"</div>");window.adthriveCLS&&window.adthriveCLS.injectedSlots&&window.adthriveCLS.injectedSlots.some(f=>f.element.id===b)||a.insertAdjacentHTML(c,d);return document.getElementById(b)},Hd=({location:a,sequence:b,sticky:c,lazy:d,stickyOverlapSelector:e,special:f,auctionPriority:g},h,k,
m)=>new Ip(a,b,k,h,c,d,g,e,f,!0,m),Gf=(a,b=document)=>b.querySelectorAll(a),Hf=a=>`adthrive-${a.location.replace("_","-").toLowerCase()}`,$k=a=>`${Hf(a)}-${a.sequence}`,al=class extends fb{constructor(a){super();this._result=!1;this._choices=[{choice:!0},{choice:!1}];this.shouldUseCoreExperimentsConfig=!1;this.key="RemoveRecipeCap";this.abgroup="rrc";var b=window.adthriveCLS;this._result=(b=b&&b.experiments)&&this.abgroup in b?b[this.abgroup]:this.run();a.set(this.abgroup,this._result?"on":"off")}get result(){return this._result}run(){return(new Ha(1)).get()}};
al=q([v("RemoveRecipeCapExperiment"),y(),t("design:paramtypes",[Ia])],al);class bl{constructor(a){this._adInjectionMap=a;this._mainContentHeight=this._recipeCount=0;this._mainContentDiv=null;this._totalAvailableElements=[];this._densityDevice=jd.Desktop;this._pubLog={onePerViewport:!1,targetDensity:0,targetDensityUnits:0,combinedMax:0};this._densityMax=.99;this._smallerIncrementAttempts=0;this._absoluteMinimumSpacingByDevice=250;this._usedAbsoluteMinimum=!1;this.locationMaxLazySequence=new Map([["Recipe",
5]]);this._stickyContainerAdsExperiment=S.resolve(Df);this._stickyContainerRecipeExperiment=S.resolve(Nc);this._removeRecipeCapExperiment=S.resolve(al)}inject(a,b=document){window.adthriveCLS&&window.adthriveCLS.targetDensityLog&&A.event("BaseDynamicAdsInjector","_logDensityInfo",window.adthriveCLS.targetDensityLog);this._densityDevice="desktop"===this._config.context.device?jd.Desktop:jd.Mobile;this._overrideDefaultAdDensitySettingsWithSiteExperiment();let c=this._config.targetDensity.enabled;var d=
a.filter(e=>c?"Content"!==e.location:e);a=a.filter(e=>c?"Content"===e.location:null);d=d.length?this._injectNonDensitySlots(d,b):[];b=a.length?this._injectDensitySlots(a,b):[];window.adthriveCLS&&window.adthriveCLS.targetDensityLog&&A.event("BaseDynamicAdsInjector","_logDensityInfo",window.adthriveCLS.targetDensityLog);return[...d,...b]}_injectNonDensitySlots(a,b=document){let c=[];for(let d of a)this._insertNonDensityAds(d,c,b);return c}_insertNonDensityAds(a,b,c=document){let d=0,e=0,f=0;0<a.spacing&&
(e=d=window.innerHeight*a.spacing);let g=this._repeatDynamicAds(a),h=Gf(a.elementSelector,c);for(let r=a.skip;r<h.length&&!(f+1>g.length);r+=a.every){var k=h[r];if(0<d){var {bottom:m}=ve(k);if(m<=e)continue;e=m+d}m=g[f];let w=`${m.location}_${m.sequence}`;if(b.some(x=>x.name===w)){f+=1;continue}var n=this.getDynamicElementId(m),p=Hf(a);let z=$k(a);p=["Sidebar"===a.location&&a.sticky&&a.sequence&&5>=a.sequence?"adthrive-sticky-sidebar":"",this._stickyContainerRecipeExperiment.result&&"Recipe"===a.location&&
a.sticky?"adthrive-recipe-sticky-container":"",p,z,...a.classNames];if(k=Ff(k,n,a.position,p,a.location))n=this._filterAdUnitSizes(m,k),n.length&&(b.push(Hd(m,k,n,c!==document)),"Recipe"===a.location&&++this._recipeCount,f+=1)}}_injectDensitySlots(a,b=document){try{this._calculateMainContentHeightAndAllElements(a,b)}catch(h){return[]}let {onePerViewport:c,targetAll:d,targetDensityUnits:e,combinedMax:f,numberOfUnits:g}=this._getDensitySettings(a,b);this._absoluteMinimumSpacingByDevice=c?window.innerHeight:
this._absoluteMinimumSpacingByDevice;if(!g)return[];this._adInjectionMap.filterUsed();this._findElementsForAds(g,c,d,f,e,b);return this._insertAds()}_overrideDefaultAdDensitySettingsWithSiteExperiment(){var a=S.resolve(Ef);a.enabled&&(a=a.result,"number"===typeof a&&(this._config.targetDensity.enabled=!0,this._config.targetDensity.settings[this._densityDevice].adDensity=a))}_getDensitySettings(a,b=document){var c=this._config.targetDensity.settings,d=this._determineOverrides(c.pageOverrides);d=d.length?
d[0]:c[this._densityDevice];c=this._config.getTargetDensity(d.adDensity);d=d.onePerViewport;let e=this._shouldTargetAllEligible(c),f=this._getTargetDensityUnits(c,e);a=this._getCombinedMax(a,b);b=Math.min(...[this._totalAvailableElements.length,f,...(0<a?[a]:[])]);this._pubLog={onePerViewport:d,targetDensity:c,targetDensityUnits:f,combinedMax:a};return{onePerViewport:d,targetAll:e,targetDensityUnits:f,combinedMax:a,numberOfUnits:b}}_determineOverrides(a){return a.filter(b=>{let c=Cc(b.pageSelector);
return""===b.pageSelector||c.elements&&c.elements.length}).map(b=>b[this._densityDevice])}_shouldTargetAllEligible(a){return a===this._densityMax}_getTargetDensityUnits(a,b){return b?this._totalAvailableElements.length:Math.floor(a*this._mainContentHeight/(1-a)/this._getMinDivHeight())-this._recipeCount}_getMinDivHeight(a="Content"){return this._config.clsOptimizedAds.getDivHeight(a,this._config.context.device)}_getCombinedMax(a,b=document){return Q(a.filter(c=>{let d;try{d=b.querySelector(c.elementSelector)}catch(e){}return d}).map(c=>
Number(c.max)+Number(c.lazyMaxDefaulted?0:c.lazyMax)).sort((c,d)=>d-c)[0],0)}_elementLargerThanMainContent(a){return a.offsetHeight>=this._mainContentHeight&&1<this._totalAvailableElements.length}_elementDisplayNone(a){let b=window.getComputedStyle(a,null).display;return b&&"none"===b||"none"===a.style.display}_isBelowMaxes(a,b){return this._adInjectionMap.map.length<a&&this._adInjectionMap.map.length<b}_findElementsForAds(a,b,c,d,e,f=document){A.event("BaseDynamicAdsInjector","_logDensityInfo",{onePerViewport:b,
combinedMax:d,targetDensityUnits:e,targetDensityPercentage:this._pubLog.targetDensity,mainContentHeight:this._mainContentHeight,recipeCount:this._recipeCount,numberOfEls:this._totalAvailableElements.length});let g=h=>{for(const {dynamicAd:k,element:m}of this._totalAvailableElements)if(this._logDensityInfo(m,k.elementSelector,h),!(!c&&this._elementLargerThanMainContent(m)||this._elementDisplayNone(m)))if(this._isBelowMaxes(d,e))this._checkElementSpacing({dynamicAd:k,element:m,insertEvery:h,targetAll:c,
target:f});else break;!this._usedAbsoluteMinimum&&5>this._smallerIncrementAttempts&&(++this._smallerIncrementAttempts,g(this._getSmallerIncrement(h)))};a=this._getInsertEvery(a,b,e);g(a)}_getSmallerIncrement(a){a*=.6;a<=this._absoluteMinimumSpacingByDevice&&(a=this._absoluteMinimumSpacingByDevice,this._usedAbsoluteMinimum=!0);return a}_insertAds(){let a=[];this._adInjectionMap.filterUsed();this._adInjectionMap.map.forEach(({el:b,dynamicAd:c,target:d},e)=>{e=Number(c.sequence)+e;var f=c.max;f=c.lazy&&
e>f;c.sequence=e;c.lazy=f;if(b=this._addContentAd(b,c,d))c.used=!0,a.push(b)});return a}_getInsertEvery(a,b,c){this._moreAvailableElementsThanUnitsToInject(c,a)?(this._usedAbsoluteMinimum=!1,a=this._useWiderSpacing(c,a)):(this._usedAbsoluteMinimum=!0,a=this._useSmallestSpacing(b));return b&&window.innerHeight>a?window.innerHeight:a}_useWiderSpacing(a,b){return this._mainContentHeight/Math.min(a,b)}_useSmallestSpacing(a){return a&&window.innerHeight>this._absoluteMinimumSpacingByDevice?window.innerHeight:
this._absoluteMinimumSpacingByDevice}_moreAvailableElementsThanUnitsToInject(a,b){return this._totalAvailableElements.length>a||this._totalAvailableElements.length>b}_logDensityInfo(a,b,c){}_checkElementSpacing({dynamicAd:a,element:b,insertEvery:c,targetAll:d,target:e=document}){(this._isFirstAdInjected()||this._hasProperSpacing(b,a,d,c))&&this._markSpotForContentAd(b,{...a},e)}_isFirstAdInjected(){return!this._adInjectionMap.map.length}_markSpotForContentAd(a,b,c=document){this._adInjectionMap.add(a,
this._getElementCoords(a,"beforebegin"===b.position||"afterbegin"===b.position),b,c);this._adInjectionMap.sort()}_hasProperSpacing(a,b,c,d){var e="beforebegin"===b.position||"afterbegin"===b.position;b="beforeend"===b.position||"afterbegin"===b.position;c=c||this._isElementFarEnoughFromOtherAdElements(a,d,e);e=b||this._isElementNotInRow(a,e);a=-1===a.id.indexOf("AdThrive_Below_Post");return c&&e&&a}_isElementFarEnoughFromOtherAdElements(a,b,c){a=this._getElementCoords(a,c);var d=!1;for(c=0;c<this._adInjectionMap.map.length&&
!(d=this._adInjectionMap.map[c+1]&&this._adInjectionMap.map[c+1].coords,d=a-b>this._adInjectionMap.map[c].coords&&(!d||a+b<d));c++);return d}_isElementNotInRow(a,b){let c=a.previousElementSibling,d=a.nextElementSibling;return(b=b?!c&&d||c&&a.tagName!==c.tagName?d:c:d)&&0===a.getBoundingClientRect().height?!0:b?a.getBoundingClientRect().top!==b.getBoundingClientRect().top:!0}_calculateMainContentHeightAndAllElements(a,b=document){let [c,d]=tp(a,this._adInjectionMap,b);this._mainContentDiv=c;this._totalAvailableElements=
d;this._mainContentHeight=sh(this._mainContentDiv)}_getElementCoords(a,b=!1){a=a.getBoundingClientRect();return(b?a.top:a.bottom)+window.scrollY}_addContentAd(a,b,c=document){let d=null;var e=Hf(b);let f=$k(b),g=this._config.adOptions.stickyContentEnabled&&this._stickyContainerAdsExperiment.result?"adthrive-sticky-container":"";if(a=Ff(a,this.getDynamicElementId(b),b.position,[g,e,f,...b.classNames],b.location))e=this._filterAdUnitSizes(b,a),e.length&&(d=Hd(b,a,e,c!==document));return d}_filterAdUnitSizes(a,
b){let c=lp(b),d=a.sticky&&"Sidebar"===a.location;return a.sizes.filter(e=>{let f=d?e[1]<=window.innerHeight-100:!0;return(a.autosize?e[0]<=c||320>=e[0]:!0)&&f})}_repeatDynamicAds(a){let b=[];var c=this._removeRecipeCapExperiment.result&&"Recipe"===a.location?99:this.locationMaxLazySequence.get(a.location),d=a.lazy?Q(c,0):0;c=a.max;var e=a.lazyMax;d=Math.max(c,0===d&&a.lazy?c+e:Math.min(Math.max(d-a.sequence+1,0),c+e));for(e=0;e<d;e++)b.push({...a,sequence:Number(a.sequence)+e,lazy:a.lazy&&e>=c});
return b}}let cl=class extends bl{constructor(a,b){super(b);this._config=a;this._adInjectionMap=b}getDynamicElementId(a){return`${this._config.gam.prefix}_${a.location}_${a.sequence}_${this._config.context.device}`}};cl=q([v("DynamicAdsInjector"),H(),t("design:paramtypes",[N,nc])],cl);let dl=(a=5)=>{Ab(`
      .adthrive-sticky-container > div {
        flex-basis: unset;
        position: sticky !important;
        display: block;
        flex-direction: column;
        top: ${5<a?a:5}px;
      }
    `)},el=(a=5)=>{Ab(`
      .adthrive-recipe-sticky-container > div {
        flex-basis: unset;
        position: sticky !important;
        display: block;
        flex-direction: column;
        top: ${5<a?a:5}px;
      }
    `)},fl=a=>{if(a&&a.length){let b=0;for(let c=0;c<a.length;c++){const d=Cc(a[c]);if(d.valid&&d.elements&&d.elements[0]){b=ve(d.elements[0]).height;break}}return b}},If=class extends T{constructor(a,b,c){super();this._config=a;this._injector=b;this._slotManager=c}hasClsInjectedContent(){if(window.adthriveCLS&&window.adthriveCLS.injectedSlots)for(let a of window.adthriveCLS.injectedSlots)if(a.name.includes("Content"))return!0;return!1}start(){let a=this.hasClsInjectedContent();var b=this._config.adOptions,
c=b.dynamicStickySidebarHeight;b=fl(b.dynamicStickySidebarHeaderSelectors);Ab(`
    .adthrive-ad.adthrive-sticky-sidebar {
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      min-height: ${null!==c&&void 0!==c?c:1800}px !important;
      padding-bottom: 0px;
      margin: 10px 0 10px 0;
    }
    .adthrive-ad.adthrive-sticky-sidebar > div {
      flex-basis: unset;
      position: sticky !important;
      top: ${null!==b&&void 0!==b?b:5}px;
    }
  `);c=this._config.dynamicAds.filter(e=>ue(this._config,e)).filter(e=>e.devices.includes(this._config.context.device)).filter(e=>!a||a&&"Content"!==e.location).filter(e=>"Interstitial"===e.location||"Video_StickyOutstream"===e.location?nt(e.pageSelector):0===e.pageSelector.length||null!==document.querySelector(e.pageSelector)).filter(e=>!this.pluginInjected(e)).filter(e=>"Video_StickyOutstream"!==e.location||!this.shouldFilterStickyOutstream());let d=this._injector.inject(c);if(this._config.clsOptions&&
this._config.clsOptions.enabled){let e=[];this._config.clsOptions.injectedSlots.forEach(f=>{let g=d.find(k=>k.name===f.name),h=e.find(k=>k.name===f.name);g||h||e.push(Hd(f.dynamicAd,f.element,f.sizes,f.infinite))});d=d.concat(e)}this._slotManager.add(d).catch(e=>{A.error("DynamicAdsComponent","start","add",e)})}get enabled(){return 0<this._config.dynamicAds.length}shouldFilterStickyOutstream(){if(this._config.video.preventStickyOutstream||this._config.disableAds.video||!this._config.video.stickyOutstreamSettings.allowOnHomepage&&
window.location.origin+"/"===window.location.href.split("?")[0])return!0;this._config.video.hasStickyOutstream=!0;return!1}pluginInjected(a){let b=JSON.stringify(a);return this._config.clsOptions&&this._config.clsOptions.injectedSlots.some(c=>JSON.stringify(c.clsDynamicAd)===b)}};If=q([v("DynamicAdsComponent"),H(),t("design:paramtypes",[N,cl,ja])],If);let gl=class extends T{constructor(a,b){super();this._config=a;this._gam=b}init(){try{this._gam.slotOnload.once(()=>this.refreshExternal())}catch(a){A.error("ExternalSlotsComponent",
"init",a)}}refreshExternal(){V.pushToQueue(()=>{let {account:a}=this._config.gam,b=window.googletag.pubads().getSlots().filter(c=>null===RegExp(`^\/?${a}\/`).exec(c.getAdUnitPath())).filter(c=>null!==document.getElementById(c.getSlotElementId()));b.length&&window.googletag.pubads().refresh(b)})}};gl=q([v("ExternalSlotsComponent"),H(),t("design:paramtypes",[N,V])],gl);let hl=class extends T{constructor(a,b,c,d,e){super();this._gam=a;this._gdprEvents=b;this._config=c;this._gdprEnforcement=d;this._spaEventBus=
e}init(){let a=this._config.context.isFirstPageview?"1":"0",b=[1];if(this._config.gdpr.enabled)this._gdprEvents.consentCaptured.on(()=>{this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,b).then(c=>{c&&this.setFPV(a)}).catch(()=>{})});else this.setFPV(a);this.handleSPARouteChange()}setFPV(a="0"){+a&&U.setLocalStorageValue("fpv",(new Date).toString());this._gam.setTargeting({key:"fpv",value:a})}handleSPARouteChange(){this._spaEventBus.routeChanged.on(()=>{this._config.context.isFirstPageview=
!1;this.setFPV("0");U.setSessionFpv()})}};hl=q([v("FirstPageviewComponent"),H(),t("design:paramtypes",[V,Tb,N,mc,Pa])],hl);let il=class extends T{constructor(a,b,c,d,e){super();this._slotManager=a;this._prebidMethods=b;this._floors=c;this._floorsExperiment=d;this._spaEventBus=e;this.floorsType=na.lazy;this._percentile=.6;this._enabledAdUnits=["Content","Recipe","Below_Post"];this._spaRouteChangeListenerSet=!1;this._offEvents=[()=>{}];this._adUnitCpms=[]}init(){this._offEvents.push(this._slotManager.requestingBids.on(a=>
{let b=this._floors.getDefaultFloorConfig();a.filter(c=>this._enabledAdUnits.includes(c.location)&&c.lazy).forEach(c=>{let d=ze(this._adUnitCpms,this._percentile);this._floors.setValues(b,c.id,d)});this._floors.prioritizeFloorsConfig(b,na.lazy)}));this._offEvents.push(this._slotManager.requestedBids.on(a=>{a.filter(b=>this._enabledAdUnits.includes(b.location)).forEach(b=>{this._prebidMethods.addToQueue(()=>{this._floors.saveBids(b,this._adUnitCpms)})})}));this._offEvents.push(this._slotManager.amazonBidResponseReceived.on(a=>
{a.forEach(({slot:b,cpm:c})=>{this._enabledAdUnits.includes(b.location)&&b.lazy&&0<c&&this._prebidMethods.addToQueue(()=>{this._saveAmazonSlotBid(c)})})}));this._spaRouteChangeListenerSet||this._setSpaRouteChangeListener()}_setSpaRouteChangeListener(){this._spaRouteChangeListenerSet=!0;this._spaEventBus.routeChanged.on(()=>{this._offEvents.forEach(a=>{a()});this._offEvents=[];this.init()})}_saveAmazonSlotBid(a){this._adUnitCpms.push(a)}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.legacy}};
il=q([v("FloorsLazyComponent"),H(),t("design:paramtypes",[ja,ia,wb,Qb,Pa])],il);let jl=class extends T{constructor(a,b,c){super();this._config=a;this._floors=b;this._floorsExperiment=c;this.floorsType=na.raptive}init(){let a=this._config.floors.floorsData;if(a)this._createFloorsMap(a);else this._config.floors.floorsDataReady.once(()=>this._createFloorsMap(a))}_createFloorsMap(a){var b,c;if(a&&Object.keys(a).length){let d=!this._floorsExperiment.result.fbrap,e=null===(b=null===a||void 0===a?void 0:
a.modelGroups)||void 0===b?void 0:b[0];b=(null===(c=null===e||void 0===e?void 0:e.schema)||void 0===c?void 0:c.fields)||[];this._config.floors.setAdditionalSchemaFields(b);this._floors.setRaptiveFloors(a,d)}else A.error("FloorsRaptiveComponent","init","Raptive floor data not found")}get active(){return this.enabled}get enabled(){return this._floorsExperiment.result.raptive}};jl=q([v("FloorsRaptiveComponent"),H(),t("design:paramtypes",[N,wb,Qb])],jl);let kl=class extends X{init(){this._key="FloorsStickyOutstreamRefresh"}};
kl=q([v("FloorsStickyOutstreamRefreshExperiment"),y()],kl);var Vb;(function(a){a.banner="banner";a.instream="instream";a.stickyOutstream="stickyOutstream"})(Vb||(Vb={}));let ll=class extends T{constructor(a,b,c,d,e,f,g){var h;super();this._config=a;this._slotManager=b;this._floors=c;this._prebidMethods=d;this._videoRequestManager=e;this._floorsExperiment=f;this._stickyOutstreamExperiment=g;this.floorsType=na.refresh;this._bannerMultiplierLowRefresh=1.3;this._instreamMultiplierLowRefresh=this._bannerMultiplierHighRefresh=
1.1;this._instreamMultiplierHighRefresh=1;this._multipliers=new Map([[Vb.banner,{low:this._bannerMultiplierLowRefresh,high:this._bannerMultiplierHighRefresh}],[Vb.instream,{low:this._instreamMultiplierLowRefresh,high:this._instreamMultiplierHighRefresh}],[Vb.stickyOutstream,{low:this._stickyOutstreamExperiment.result||this._bannerMultiplierLowRefresh,high:this._stickyOutstreamExperiment.result||this._bannerMultiplierHighRefresh}]]);this._raptiveMLSkipRate=null===(h=this._config.floors.raptiveMLRefreshFloors)||
void 0===h?void 0:h.skipRate}init(){this._slotManager.refreshing.on(a=>{this._prebidMethods.addToQueue(()=>{this._setRefreshFloors(a.map(b=>({adUnitCode:b.id,refreshCount:b.refreshCount,bidPoolId:b.bidPoolId,setSlotTargetingFlag:(c,d,e)=>{b.setSlotTargetingFlag(c,d,e)}})))})});this._videoRequestManager.refreshingVideoBids.on(a=>{this._prebidMethods.addToQueue(()=>{this._setRefreshFloors(a.map(b=>{var c;return{adUnitCode:null===(c=b.videoAdUnit)||void 0===c?void 0:c.code,refreshCount:b.prerollNum}}))})})}_getFloorData(a,
b,c,d,e){let f;e?{multiplier:b,weight:f}=this._getRefreshInflateMultiplierWithWeight(this._config.floors.raptiveMLRefreshFloors,d,b):(d=5>=d?"low":"high",b=this._multipliers.get(b?Vb.instream:c?Vb.stickyOutstream:Vb.banner)[d]);return{floor:a&&a*b,multiplier:b,weight:f}}_setRefreshFloors(a){let b=this._floors.getDefaultFloorConfig();for(let d of a){let {adUnitCode:e,bidPoolId:f,refreshCount:g,setSlotTargetingFlag:h}=d;a=Date.now();this._floors.updateBidTTL(e,a,f);[a]=f?this._prebidMethods.getHighestCpmBidsForPoolId(f):
this._prebidMethods.getHighestCpmBids(e);var c=this._config.floors.amazonSlotCpm.get(e)||0;a=Math.max((null===a||void 0===a?void 0:a.cpm)||0,c);c=this._config.video.instreamAdUnits.has(e);let k=e.includes("Video_StickyOutstream"),{canApplyRaptiveMLRefreshMultipliers:m,shouldUseRaptiveMultipliers:n,isRaptiveSkipApplied:p}=this._shouldApplyRaptiveMLRefreshFloors(k),{floor:r,multiplier:w,weight:z}=this._getFloorData(a,c,k,g,n);r&&(this._floors.setValues(b,e,r),this._floors.setOGRefreshValue(e,a),m&&
this._setTargetingFlagSlot(d,c,h,w,z,p))}this._floors.prioritizeFloorsConfig(b,na.refresh)}_setTargetingFlagSlot(a,b,c,d,e,f){d=`${d}@${null!==e&&void 0!==e?e:0}${f?"h":""}`;c?c("fmlri",[d],!0):b&&this._floors.setVideoFlagSlot(a.adUnitCode,{fmlri:d})}_shouldApplyRaptiveMLRefreshFloors(a){var b;a=this._floorsExperiment.result.fbrap&&void 0!==this._raptiveMLSkipRate&&!a;let c=Math.random()<=(null!==(b=this._raptiveMLSkipRate)&&void 0!==b?b:0)/100;return{canApplyRaptiveMLRefreshMultipliers:a,shouldUseRaptiveMultipliers:a&&
!c,isRaptiveSkipApplied:a&&c}}_getWeightedChoice(a){var b={index:-1,weight:-1};if(!a||0===a.length)return b;var c=a.reduce((e,f)=>e+f,0);if(0===c)return b;b=Math.random()*c;c=0;let d=a[c];for(;b>d;)d+=a[++c];return{index:c,weight:a[c]}}_getRefreshInflateMultiplierWithWeight(a,b,c){var d;let {inflator:e=[],defaultInflatorMultipliers:f,defaultInstreamInflatorMultipliers:g=[],inflatorWeights:h}=a,{index:k,weight:m}=this._getWeightedChoice(h);a=e.find(p=>b>=p.minRefresh&&b<=p.maxRefresh);var n=c?g:f;
if(-1===k)return{multiplier:1,weight:-1};a&&(n=null!==(d=a.instreamMultipliers)&&void 0!==d?d:[],n=c?n:a.multipliers);return{multiplier:n[k]||1,weight:m}}get active(){return this.enabled}get enabled(){return!0===this._floorsExperiment.result.legacy}};ll=q([v("FloorsRefreshComponent"),H(),t("design:paramtypes",[N,ja,wb,ia,lc,Qb,kl])],ll);let ml=class extends X{init(){this._key="SessionFloorStickyOutstreamPercentileExperiment"}get result(){return this._result}};ml=q([v("SessionFloorStickyOutstreamPercentileExperiment"),
y()],ml);let nl=class extends T{constructor(a,b,c,d,e,f,g){super();this._slotManager=a;this._videoRequestManager=b;this._floors=c;this._prebidMethods=d;this._floorsExperiment=e;this._spaEventBus=f;this._stickyOutstreamSessionPercentileExperiment=g;this.floorsType=na.session;this._percentile=.6;this._rdx=33;this._defaultSavedBids={Content:[],Recipe:[],Header:[],Below_Post:[],Sidebar:[],Footer:[],"Video_In-Post_ClicktoPlay_SoundOn":[],Video_Collapse_Autoplay_SoundOff:[],Video_Individual_Autoplay_SOff:[],
Video_Coll_SOff_Smartphone:[],Video_StickyOutstream_1:[],Video_StickyOutstream:[]};this._savedBidsRan=!1;this._offEvent=()=>{};this._sessionNonFPV=!1===U.getLocalStorageValue("session_fpv");a=U.getLocalStorageValue("bc");this._savedBids={...this._defaultSavedBids,...(a&&Dt(a,this._rdx))}}init(){if(this._sessionNonFPV){let a=this._floors.getDefaultFloorConfig();this._offEvent=this._slotManager.requestingBids.on(b=>{b.filter(c=>Object.keys(this._savedBids).includes(c.location)).forEach(c=>{var d=this._getPercentile(c.location);
d=ze(this._savedBids[c.location],d);this._floors.setValues(a,c.id,d)});this._floors.prioritizeFloorsConfig(a,na.session)});this._videoRequestManager.requestingVideoBids.on(b=>{b.filter(c=>Object.keys(this._savedBids).includes(c.name)).forEach(c=>{var d=this._getPercentile(c.name);d=ze(this._savedBids[c.name],d)||1E-5;this._floors.setValues(a,c.name,d)});this._floors.prioritizeFloorsConfig(a,na.session)})}this._savedBidsRan||this.saveBids()}saveBids(){this._savedBidsRan=!0;this._spaEventBus.routeChanged.on(()=>
{this._offEvent();this.init()});this._slotManager.requestedBids.on(a=>{a.filter(b=>Object.keys(this._savedBids).includes(b.location)).forEach(b=>{this._prebidMethods.addToQueue(()=>{this.saveSlotBids(b)})});U.setLocalStorageValue("bc",Ae(this._savedBids,this._rdx))});this._slotManager.amazonBidResponseReceived.on(a=>{a.forEach(({slot:b,cpm:c})=>{Object.keys(this._savedBids).includes(b.location)&&0<c&&this._prebidMethods.addToQueue(()=>{this._saveAmazonSlotBid(b,c)})});U.setLocalStorageValue("bc",
Ae(this._savedBids,this._rdx))});this._videoRequestManager.requestingVideoBids.on(a=>{a.filter(b=>Object.keys(this._savedBids).includes(b.name)).forEach(b=>{this._prebidMethods.addToQueue(()=>{this.saveVideoSlotBids(b)})});U.setLocalStorageValue("bc",Ae(this._savedBids,this._rdx))});this._videoRequestManager.amazonVideoBidResponseReceived.on(a=>{a.forEach(({video:b,cpm:c})=>{Object.keys(this._savedBids).includes(b.name)&&0<c&&this._prebidMethods.addToQueue(()=>{this._saveAmazonVideoSlotBid(b,c)})});
U.setLocalStorageValue("bc",Ae(this._savedBids,this._rdx))})}saveSlotBids(a){this._prebidMethods.getBidResponsesForAdUnitCode(a.id).bids.forEach(b=>{Be(this._savedBids[a.location],1E3);this._savedBids[a.location].push(b.cpm)})}_saveAmazonSlotBid(a,b){Be(this._savedBids[a.location],1E3);this._savedBids[a.location].push(b)}saveVideoSlotBids(a){this._prebidMethods.getBidResponsesForAdUnitCode(a.name).bids.forEach(b=>{Be(this._savedBids[a.name],1E3);this._savedBids[a.name].push(b.cpm)})}_saveAmazonVideoSlotBid(a,
b){Be(this._savedBids[a.name],1E3);this._savedBids[a.name].push(b)}_getPercentile(a){return a.includes("Video_StickyOutstream")?this._stickyOutstreamSessionPercentileExperiment.result||this.defaultPercentile:this.defaultPercentile}get defaultPercentile(){return this._percentile}get active(){return this.enabled&&this._sessionNonFPV}get enabled(){return!0===this._floorsExperiment.result.legacy}};nl=q([v("FloorsSessionComponent"),H(),t("design:paramtypes",[ja,lc,wb,ia,Qb,Pa,ml])],nl);let ol=class extends T{constructor(a,
b,c,d){super();this._slotManager=a;this._floors=b;this._prebidMethods=c;this._floorsExperiment=d;this.floorsType=na.lazyBidPool;this._enabledAdUnits=["Content","Recipe","Below_Post"]}init(){this._slotManager.requestingBids.on(a=>{this._prebidMethods.addToQueue(()=>{this._setLazyBidPoolFloors(a.filter(b=>this._enabledAdUnits.includes(b.location)&&!b.refreshCount&&b.lazy&&b.bidPoolId).map(b=>({adUnitCode:b.id,refreshCount:b.refreshCount,bidPoolId:b.bidPoolId})))})})}_setLazyBidPoolFloors(a){let b=this._floors.getDefaultFloorConfig();
for(let c of a){let {adUnitCode:d,bidPoolId:e}=c;a=Date.now();this._floors.updateBidTTL(d,a,e);[a]=e?this._prebidMethods.getHighestCpmBidsForPoolId(e):this._prebidMethods.getHighestCpmBids(d);(a=null===a||void 0===a?void 0:a.cpm)&&this._floors.setValues(b,d,a)}this._floors.prioritizeFloorsConfig(b,na.lazyBidPool)}get active(){return this.enabled}get enabled(){return!0===this._floorsExperiment.result.legacy}};ol=q([v("FloorsLazyBidPoolComponent"),H(),t("design:paramtypes",[ja,wb,ia,Qb])],ol);let pl=
class extends T{constructor(a,b,c,d,e,f){super();this._floorsConfig=f;this._floorsComponents=[a,b,c,d,e].filter(g=>g.enabled)}init(){this._floorsComponents.forEach(a=>{a.active&&this._floorsConfig.addActiveFloorsType(a.floorsType);void 0!==a.init&&a.init()})}};pl=q([H(),t("design:paramtypes",[ol,il,jl,ll,nl,Ad])],pl);let ql=class extends T{constructor(a,b,c){super();this._config=a;this._spaEventBus=b;this._footerConfigEventBus=c;this._footerClassNames=["adthrive-comscore","adthrive-footer-message"];
this._footer={};this._added()}start(){this._config.footer.elements.length&&(this._footer=document.createElement("div"),this._footer.classList.add(...this._footerClassNames),this._config.footer.elements.sort((a,b)=>a.order-b.order).forEach(({element:a})=>{a instanceof Element?this._footer.insertAdjacentElement("beforeend",a):this._footer.insertAdjacentHTML("beforeend",a)}),(document.querySelector(""===this._config.adOptions.footerSelector?".adthrive-mobile #page-wrapper":this._config.adOptions.footerSelector)||
document.body).insertAdjacentElement("beforeend",this._footer),this._setupListeners())}_setupListeners(){this._spaEventBus.routeChanged.once(()=>{document.querySelector(`.${this._footerClassNames.join(".")}`)||this.start()})}_added(){this._footerConfigEventBus.footerElementAdded.on(a=>{this._config.footer.elements.push(a)},{handleEventsAlreadyEmitted:!0})}};ql=q([v("FooterComponent"),H(),t("design:paramtypes",[N,Pa,nd])],ql);let Eu={"000000":"A","000001":"B","000010":"C","000011":"D","000100":"E",
"000101":"F","000110":"G","000111":"H","001000":"I","001001":"J","001010":"K","001011":"L","001100":"M","001101":"N","001110":"O","001111":"P","010000":"Q","010001":"R","010010":"S","010011":"T","010100":"U","010101":"V","010110":"W","010111":"X","011000":"Y","011001":"Z","011010":"a","011011":"b","011100":"c","011101":"d","011110":"e","011111":"f",1E5:"g",100001:"h",100010:"i",100011:"j",100100:"k",100101:"l",100110:"m",100111:"n",101E3:"o",101001:"p",101010:"q",101011:"r",101100:"s",101101:"t",
101110:"u",101111:"v",11E4:"w",110001:"x",110010:"y",110011:"z",110100:"0",110101:"1",110110:"2",110111:"3",111E3:"4",111001:"5",111010:"6",111011:"7",111100:"8",111101:"9",111110:"-",111111:"_"},Jf=class extends T{constructor(a,b,c,d){super();this._config=a;this._ccpaComponent=b;this._ortb2=c;this._spaEventBus=d;this.ccpaRequired=this._config.ccpa.required;this.ccpaNotApplicable=this._config.ccpa.ccpaNotApplicable;this.ccpaOptIn=this._config.ccpa.ccpaOptIn;this.ccpaOptOut=this._config.ccpa.ccpaOptOut;
this.gpcEnabled=this._config.gpc.gpcEnabled;this.gpcUpdated=!1;this.globalPrivacyControl=window.navigator.globalPrivacyControl;this._sectionList=[6,7];this._supportedAPIs=["6:uspv1","7:usnat"];this._usnatFieldOrder=[...Object.values(Da)];this._usnatFields=new Map([[Da.Version,{unencodedVal:1,fieldValLength:6}],[Da.SharingNotice,{unencodedVal:1,fieldValLength:2}],[Da.SaleOptOutNotice,{unencodedVal:1,fieldValLength:2}],[Da.SharingOptOutNotice,{unencodedVal:1,fieldValLength:2}],[Da.TargetedAdvertisingOptOutNotice,
{unencodedVal:1,fieldValLength:2}],[Da.SensitiveDataProcessingOptOutNotice,{unencodedVal:0,fieldValLength:2}],[Da.SensitiveDataLimitUseNotice,{unencodedVal:0,fieldValLength:2}],[Da.SaleOptOut,{fieldValLength:2,optIn:Nb.OptedIn,optOut:Nb.OptedOut}],[Da.SharingOptOut,{fieldValLength:2,optIn:Nb.OptedIn,optOut:Nb.OptedOut}],[Da.TargetedAdvertisingOptOut,{fieldValLength:2,optIn:Nb.OptedIn,optOut:Nb.OptedOut}],[Da.SensitiveDataProcessing,{unencodedVal:[0,0,0,0,0,0,0,0,0,0,0,0],fieldValLength:24}],[Da.KnownChildSensitiveDataConsents,
{unencodedVal:[0,0],fieldValLength:4}],[Da.PersonalDataConsents,{unencodedVal:0,fieldValLength:2}],[Da.MspaCoveredTransaction,{unencodedVal:2,fieldValLength:2}],[Da.MspaOptOutOptionMode,{unencodedVal:0,fieldValLength:2}],[Da.MspaServiceProviderMode,{unencodedVal:0,fieldValLength:2}],[Da.SubSectionType,{unencodedVal:0,fieldValLength:2}],[Da.Gpc,{unencodedVal:!!navigator.globalPrivacyControl,fieldValLength:1}]]);this._pingData={gppVersion:"1.1",cmpStatus:"loaded",cmpDisplayStatus:"visible",cmpId:3,
supportedAPIs:this._supportedAPIs,signalStatus:"ready",sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),parsedSections:{uspv1:this._config.ccpa.privacyString||null,usnat:this._getUSNatObj()}};this._sections={tcfeuv1:null,tcfeuv2:null,"":null,"--":null,tcfca:null,uspv1:this._config.ccpa.privacyString||null,usnat:this._getUSNatObj(),usca:null,usva:null,usco:null,usut:null,usct:null}}init(){window.__gpp=this._gpp.bind(this);this._addLocatorFrame();
this._enableEvents();this._refreshPrivacyStrings();this._setPrebidGPPString();this._spaEventBus.routeChanged.on(()=>{this._setPrebidGPPString()})}_refreshPrivacyStrings(){this._pingData.gppString=this._createGPPString();this._pingData.parsedSections&&this._pingData.parsedSections.uspv1&&(this._pingData.parsedSections.uspv1=this._callUSPAPI("getUSPData").uspString)}_triggerEventCallbacks(a){let b=window.__gpp.events;if(b&&b.length){this._refreshPrivacyStrings();let c=this._pingData;b.forEach(d=>{let e=
{eventName:a,listenerId:d.id,data:this._getEventData(a),pingData:c};d.callback(e)})}}_getEventData(a){if("sectionChange"===a)return this._supportedAPIs;if("signalStatus"===a)return"ready"}_enableEvents(){this._triggerEventCallbacks("signalStatus");this._config.ccpa.consentChange.on(()=>{this._triggerEventCallbacks("sectionChange");this._setPrebidGPPString();this._triggerEventCallbacks("signalStatus")})}_setPrebidGPPString(){let a=this._createGPPString();this._ortb2.addOrtb2Reg(a,this._sectionList)}_addEventListener(a,
b){window.__gpp.events=window.__gpp.events||[];"lastId"in window.__gpp||(window.__gpp.lastId=0);window.__gpp.lastId++;let c=window.__gpp.lastId;window.__gpp.events.push({id:c,callback:a,parameter:b});a({eventName:"listenerRegistered",listenerId:c,data:!0,pingData:this._pingData},!0)}_removeEventListener(a,b){let c=!1;window.__gpp.events=window.__gpp.events||[];for(let d=0;d<window.__gpp.events.length;d++)if(window.__gpp.events[d].id==b){window.__gpp.events.splice(d,1);c=!0;break}a({eventName:"listenerRemoved",
listenerId:b,data:c},!0)}_createUSNatString(){let a=this._usnatFieldOrder.reduce((b,c)=>`${b}${this._getUSNatData(c,!0)}`,"");if(66>a.length){let b=66-a.length;for(let c=0;c<b;c++)a=`${a}0`}return(a.match(/.{6}/g)||[]).map(b=>Eu[b]||"A").join("")}_padStart(a,b){return a.padStart?a.padStart(b,"0"):`${a}${Array(b).join("0")}`}_encodedUSNat(a,b){a=this._usnatFields.get(a)&&this._usnatFields.get(a).fieldValLength||0;b=(+b>>>0).toString(2);return this._padStart(b,a)}_getUSNatData(a,b=!1){var c=this._usnatFields.get(a);
if(!c)return"";if(void 0!==c.unencodedVal)return b?this._encodedUSNat(a,c.unencodedVal):c.unencodedVal;c=this._config.ccpa.privacyString===this.ccpaOptOut?c.optOut:c.optIn;return b?this._encodedUSNat(a,c||"0"):c}_getUSNatObj(){return this._usnatFieldOrder.map(a=>{let b=this._getUSNatData(a);return{[a]:b}}).reduce((a,b)=>({...a,...b}),{})}_getGPPData(){return{sectionId:3,gppVersion:1.1,sectionList:this._sectionList,applicableSections:this._sectionList,gppString:this._createGPPString(),pingData:this._pingData}}_hasSection(a){return this._sections[a]?
!0:!1}_getSection(a){return this._sections[a]?this._sections[a]:null}_callUSPAPI(a){return this._ccpaComponent.uspapi(a,1,(b,c)=>{if(c)return b})}_getField(a){var b=a.split(".");a=b[0];b=b[1];if(this._hasSection(a)){if("uspv1"===a)return this._callUSPAPI(b);if("usnat"===a)return this._getUSNatData(b)}else return null}_addLocatorFrame(){if(null===document.getElementById("__gppLocator")){let a=document.createElement("iframe");a.style.display="none";a.id="__gppLocator";a.name="__gppLocator";document.body.appendChild(a);
window.__gpp_msghandler=b=>{let c="string"===typeof b.data,d;try{d=c?JSON.parse(b.data):b.data}catch(e){d=null}if("object"===typeof d&&null!==d&&"__gppCall"in d){let e=d.__gppCall;window.__gpp(e.command,(f,g)=>{f={__gppReturn:{returnValue:f,success:g,callId:e.callId}};b.source.postMessage(c?JSON.stringify(f):f,"*")},e.parameter)}}}"__gpp"in window&&"function"===typeof window.__gpp||(window.__gpp=window.__gpp_stub,window.addEventListener("message",window.__gpp_msghandler,!1),window.__gpp_addFrame("__gppLocator"))}_createGPPString(){let a=
this._callUSPAPI("getUSPData").uspString,b=this._createUSNatString();return`${"DBABzw"}~${a}~${b}`}_gpp(a,b,c){let d="function"===typeof b;switch(a){case "ping":return this._refreshPrivacyStrings(),d?b(this._pingData,!0):this._pingData;case "addEventListener":return d?this._addEventListener(b,c):null;case "removeEventListener":return d?this._removeEventListener(b,c):null;case "hasSection":if(c)return a=this._hasSection(c),d?b(a,!0):a;case "getSection":if(c)return a=this._getSection(c),d?b(a,!0):a;
case "getField":if(c)return a=this._getField(c),d?b(a,!0):a;case "getGPPData":return d?b(this._getGPPData()):this._getGPPData()}}get enabled(){return"US"===this._config.context.country}};Jf=q([v("GPPComponent"),H(),t("design:paramtypes",[N,Bf,Sb,Pa])],Jf);let rl=class extends T{constructor(a,b){super();this._slotManager=a;this._slots=b}init(){let a=!1;this._slots.bidServed.on(b=>{b.servedPrebidBidResponse&&"gumgum"===b.servedPrebidBidResponse.bidder&&"Footer"===b.location&&(a=!0)});this._slotManager.refreshing.on(b=>
{b.filter(c=>"Footer"===c.location)&&a&&(a=!1,window.GUMGUM.removeISAd())})}};rl=q([v("GumGumInScreenComponent"),H(),t("design:paramtypes",[ja,Qa])],rl);let sl=class extends T{constructor(a,b,c){super();this._emailCaptureHandler=a;this._config=b;this._gdprEnforcement=c;this._hasRun=!1}init(){this._config.identityApi.optIn.on(({data:a,cb:b})=>this.identityOptIn(a,b).catch(()=>{}));window.addEventListener("message",a=>{if(window===window.top&&a&&a.origin===window.origin&&a.data&&"adthriveIdentityAPI"===
a.data.message&&a.data.info){let b={message:"adthriveIdentityFinished",response:{}};this.identityOptIn(a.data.info,c=>{var d;a.source instanceof MessagePort||a.source instanceof ServiceWorker||(b.response=c,null===(d=a.source)||void 0===d?void 0:d.postMessage(b,a.origin))}).catch(()=>{})}},!1)}start(){this._config.identityApi.apiReady.emit()}validateData(a){if(!a.source||"string"!==typeof a.source||20<a.source.length)throw Error("source required with 20 characters or less");if(!a.plainText&&!a.sha256&&
!a.sha1)throw Error("plainText, sha256 or sha1 required");if(a.plainText&&("string"!==typeof a.plainText||!op(a.plainText.toLowerCase().replace(/\s/g,""))))throw Error(`plainText not string or not valid email: ${a.plainText}`);if(a.sha256&&("string"!==typeof a.sha256||64!==a.sha256.length))throw Error(`sha256 not string or not encoded properly: ${a.sha256}`);if(a.sha1&&("string"!==typeof a.sha1||40!==a.sha1.length))throw Error(`sha256 not string or not encoded properly: ${a.sha1}`);}categorizeSource(a){var b;
let c=a.source;"slickstream"===a.source||null!==(b=a.source)&&void 0!==b&&b.startsWith("ss_")||(A.event("IdentityAPI","optIn",`source:${c}`),a.source="api")}buildPII(a){let b={source:`${this._emailCaptureHandler.checkSources(a.source)}_c`};a.plainText&&(b.email=a.plainText);a.sha256&&(b.sha256Hash=a.sha256);a.sha1&&(b.sha1Hash=a.sha1);return b}async identityOptIn(a,b){try{if(!this._config.identityApi.enabled)throw Error("Identity API not enabled");if(this._hasRun)throw Error("Identity API Already Successfully Called");
if(this._config.ccpa.userOptedOut)throw Error("User has opted out of CCPA");if(this._config.gdpr.enabled&&!await this._gdprEnforcement.checkConsentForVendor(this._config.gdpr.cafeMediaVendorId,[1]))throw Error("CafeMedia not given Purpose 1 consent to process identity data.");this.validateData(a);this.categorizeSource(a);let c=this.buildPII(a);this._emailCaptureHandler.emailCaptured.emit({pii:c});b({success:!0,data:{message:"OK"}});this._hasRun=!0}catch(c){b({success:!1,data:{message:c.message}})}}};
sl=q([v("IdentityAPIComponent"),H(),t("design:paramtypes",[Ic,N,mc])],sl);let tl=class extends W{init(){this._key="JumpToTracker";this._default=!1}};tl=q([y()],tl);var Kf;(function(a){a.Recipe="Recipe";a.Video="Video"})(Kf||(Kf={}));class tq{constructor(){this._elements=[];this._hasFired=!1;this._buttonClicked=this._processButtonClicked.bind(this)}init(){this._addElementListeners()}_processButtonClicked(a){this._hasFired||this._logEvent(a.target.classList);this._cleanup()}_logEvent(a){A.event("JumpToTracker",
"_logEvent",this.trackerType.toLowerCase(),a)}_cleanup(){for(let a of this._elements)a.removeEventListener("click",this._buttonClicked)}_addElementListeners(){this.setElements()}setElements(){this._elements=Array.prototype.slice.call(document.querySelectorAll(this.selectors.join()));for(let a of this._elements)a.addEventListener("click",this._buttonClicked)}}let ul=class extends tq{constructor(){super();this.trackerType=Kf.Recipe;this.selectors=".wprm-recipe-jump #jump-to-recipe #wprm-jump .wprm-jump .tasty-recipes-jump-link .mv-create-jtr .jump-to-recipe".split(" ");
this.init()}};ul=q([H(),t("design:paramtypes",[])],ul);let vl=class extends tq{constructor(){super();this.trackerType=Kf.Video;this.selectors=[".wprm-recipe-jump-video"];this.init()}};vl=q([H(),t("design:paramtypes",[])],vl);let wl=class extends T{constructor(a){super();this._jumpToTrackerExperiment=a}start(){S.resolve(ul);S.resolve(vl)}get enabled(){return this._jumpToTrackerExperiment.result}};wl=q([H(),v("JumpToTrackerComponent"),t("design:paramtypes",[tl])],wl);let xl=class extends T{constructor(a,
b,c){super();this._config=a;this._gam=b;this._videoEventProxy=c;this._renderedSlotKey=new Map;this._filterKeys=new Set("abgroup pvk bucket branch deployment siteName siteId site_code mcmp".split(" "));this._enabled=this._config.impressionLog.enabled}init(){this._gam.slotRenderEnded.on(a=>this._bannerSlotRenderEnded(a));this._videoEventProxy.videoSlotRendered.on(this._videoSlotRenderEnded.bind(this))}get enabled(){return this._enabled}_getDecodedURI(a){try{return decodeURIComponent(a)}catch(b){return""}}_getTargetingData(a){a=
jc(a.split("?")[1]);return{custParams:this._getDecodedURI(a.get("cust_params")||""),iu:a.get("iu")||"",sz:this._sizeStringToArray(a.get("sz"))||[1,1]}}_sizeStringToArray(a){if(a)return a.split("x").map(b=>parseInt(b))}_bannerSlotRenderEnded({event:a,slot:b}){let c=a.slot.getAdUnitPath(),d=Dc();this._renderedSlotKey.set(c,d);a={adUnitPath:c,advertiserId:a.advertiserId,agnosticCreativeId:a.sourceAgnosticCreativeId,agnosticLineItemId:a.sourceAgnosticLineItemId,campaignId:a.campaignId,companyIds:a.companyIds,
creativeId:a.creativeId,isEmpty:a.isEmpty,lineItemId:a.lineItemId,serviceName:a.serviceName,siteTargeting:this._filterTargeting(this._gam.getTargetingMap()),size:a.size,slotElementId:b.id,slotKey:d,slotTargeting:this._filterTargeting(b.getTargetingMap()),yieldGroupIds:a.yieldGroupIds,transactionId:b.transactionId};this._logImpressionEvent(a)}_videoSlotRenderEnded(a){let b=this._getTargetingData(a.tag);a={adUnitPath:b.iu,creativeId:a.gamCreativeId,isEmpty:a.isEmpty,lineItemId:a.gamLineItemId,size:b.sz,
slotElementId:a.adUnitName,slotKey:Dc(),slotTargeting:this._filterTargeting(ph(b.custParams))};this._logImpressionEvent(a)}_filterTargeting(a){return Object.keys(a).filter(b=>!this._filterKeys.has(b)&&a[b].length).reduce((b,c)=>{b[c]=a[c];return b},{})}_logImpressionEvent(a){A.event("SlotRenderEnded","adImpression",a)}};xl=q([v("ImpressionLogComponent"),H(),t("design:paramtypes",[N,V,Ub])],xl);let yl=class extends X{init(){this._key="FooterCloseButtonLocation"}isEnabled(){let a=!(S.resolve(wd).isRolloutEnabled("mobile-footer-close-button-css-conflict")&&
ca());return super.isEnabled()&&a}};yl=q([v("FooterCloseButtonExperiment"),y()],yl);let zl=class extends T{constructor(a,b,c,d){super();this._googleAdManager=a;this._config=b;this._slotManager=c;this._footerCloseLocationExperiment=d;this._locations=["Footer"]}init(){this._googleAdManager.slotRenderEnded.on(({slot:a,event:b})=>{this.slotRenderEnded(a,b)})}slotRenderEnded(a,b){var c;!b.isEmpty&&2===(null===(c=b.size)||void 0===c?void 0:c.length)&&a.element&&this._locations.includes(a.location)&&a.sticky&&
(a.element.setAttribute("closable","true"),this._addCloseButton(a))}_addCloseButton(a){let {element:b,location:c,refreshCount:d}=a;b.hasAttribute("closable")&&(a=b.querySelector(".adthrive-close")||this._createButton(b,c,d),this._changeCloseButtonLocation(b,a),b.appendChild(a))}_createButton(a,b,c){let d=document.createElement("span");d.innerHTML="&times;";d.className="adthrive-close";d.addEventListener("click",()=>{let e=document.createEvent("Event");"Footer"===b&&sessionStorage.setItem("adthrive_footer_closed",
"true");e.initEvent(`adthrive${location}Close`,!0,!0);let f=a.parentElement;f&&(window.dispatchEvent(e),f.removeChild(a),A.event("CloseButtonComponent","logCloseFooter","User clicked footer close button",{nref:c}),this._slotManager.destroy(a.id))});return d}_changeCloseButtonLocation(a,b){var c;let d=this._footerCloseLocationExperiment.result;d&&d.includes("topLeft")&&(b.style.right="initial",b.style.left=Ta()?"10px":"5px","topLeftAboveAd"===d&&(a=(null===(c=a.firstChild)||void 0===c?void 0:c.firstChild).getBoundingClientRect(),
b.style.left=(a.left-26).toString()+"px",b.style.top="5px"))}get enabled(){return this._config.adOptions.footerCloseButtonMigrated?"phone"===this._config.context.device?this._config.adOptions.footerCloseButtonMobile:this._config.adOptions.footerCloseButtonDesktop:this._config.adOptions.footerCloseButton}};zl=q([v("CloseButtonComponent"),H(),t("design:paramtypes",[V,N,ja,yl])],zl);class Al{constructor(a,b,c){this._overlap=null;this._stuck=!1;this._cutoff=this._start=0;this._cutoffBuffer=20;this._stickyClass=
"adthrive-stuck";this._stickyOutstreamStyleBottom=51;this._onScrollEvent=()=>{};this._onThrottledScrollEvent=()=>{};this._onThrottledResizeEvent=()=>{};this._closed=!1;let d="Video_StickyOutstream"===a.location;this._isMobile="phone"===c.context.device;this._element=a.element;c=d?c.video.footerSelector:"";b&&(this._overlap=a.stickyOverlapSelector?document.querySelector(a.stickyOverlapSelector):c.length?document.querySelector(c):this._findOverlap(this._element),d&&this._stick(d));this._setupEventListeners(a,
d)}_setupEventListeners(a,b){this._onScrollEvent=()=>{!this._element||a.closed?this._removeEventListeners():this._check(b)};this._onThrottledScrollEvent=Zc(()=>this._update(),500);this._onThrottledResizeEvent=Zc(()=>{!this._element||a.closed?this._removeEventListeners():(this._unstick(),this._update(),this._check(b))},500);window.addEventListener("scroll",this._onThrottledScrollEvent);window.addEventListener("resize",this._onThrottledResizeEvent);window.addEventListener("scroll",this._onScrollEvent)}_removeEventListeners(){window.removeEventListener("scroll",
this._onScrollEvent);window.removeEventListener("resize",this._onThrottledScrollEvent);window.removeEventListener("resize",this._onThrottledResizeEvent);this._closed=!0}_update(){this._element&&(this._stuck||(this._start=this._getTop(this._element)),this._overlap&&(this._cutoff=this._getTop(this._overlap)))}_updateStickyOutstreamPosition(a){window.pageYOffset+window.innerHeight-this._stickyOutstreamStyleBottom>=a?(a=`${window.innerHeight+window.pageYOffset-a}px`,this._element.style.bottom=a,this._element.parentElement.style.bottom=
a):(a=zc(),this._element.parentElement.style.bottom=`${a}px`)}_check(a){if(!this._closed){if(0!==this._start){let c=window.pageYOffset;var b=this._element.offsetHeight+this._cutoffBuffer;b=0!==this._cutoff&&c+b>this._cutoff;this._start<c&&!b?this._stick(a):a||this._unstick()}a&&this._overlap&&(a=this._getTop(this._overlap),this._updateStickyOutstreamPosition(a))}}_stick(a){if(!this._stuck){let b=getComputedStyle(this._element,null),c=this._element.parentElement;if(c){let d=getComputedStyle(c,null);
c.style.minHeight=d.getPropertyValue("height");a&&c.classList.add(this._stickyClass)}this._element.style.width||(this._element.style.width=b.getPropertyValue("width"));a||this._element.classList.add(this._stickyClass);this._stuck=!0}}_unstick(){this._stuck&&(this._element.classList.remove(this._stickyClass),this._stuck=!1)}_getTop(a){return a.getBoundingClientRect().top+window.pageYOffset}_findOverlap(a){let b=null;for(;a.parentElement;){a=a.parentElement;let c=a.nextElementSibling;for(;c&&!gd(c);)c=
c.nextElementSibling;c&&0<c.offsetTop&&(!b||c.offsetTop<b.offsetTop)&&(b=c)}return b}}let Lf=class{constructor(){this._headerVisibleEvents=[];this._headerHiddenEvents=[];this._header=null;this._isHeaderVisible=!0;this.handleUncollapse=()=>{};this.handleCollapse=a=>{if(a.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(a,a.mobileHeaderSelector);let b=this.siteHeader(a.mobileHeaderSelector);b&&(b.onclick=a.siteHeaderOnClick)}};this.collapsiblePersistentHeaderObserver=new IntersectionObserver(a=>
{for(let b of a)(this._isHeaderVisible=b.isIntersecting)?this._headerVisibleEvents.forEach(c=>c()):this._headerHiddenEvents.forEach(c=>c())},{threshold:.95})}applyTransitionToElement(a){a.style.transition="all 0.2s ease-in-out"}pushElementBelowHeader(a,b){b=this.getHeaderHeight(b);null!==b&&a.style.setProperty("top",`${b}px`,"important")}anchorVideoPlayerBelowNavbar(a,b){let {playerPosition:c,topBackgroundElement:d}=a;a=()=>{if(null!==this.getHeaderHeight(b)){this.applyTransitionToElement(d);this.applyTransitionToElement(c);
this.pushElementBelowHeader(d,b);this.pushElementBelowHeader(c,b);const f=c.querySelector(".adthrive-top-collapse-wrapper-bar");f&&this.pushElementBelowHeader(f,b)}};let e=()=>{d.style.top="0";c.style.top="0"};this._isHeaderVisible?a():e();this._headerVisibleEvents.push(a);this._headerHiddenEvents.push(e)}getHeaderHeight(a){return(a=this.siteHeader(a))?this.getElementHeight(a):null}getElementHeight(a){return a.getBoundingClientRect().height}siteHeader(a){if(this._header)return this._header;a=document.querySelector(a);
if(!a)return null;this._header=a;this.collapsiblePersistentHeaderObserver.observe(this._header);return this._header}};Lf=q([y(),v("TopCenterVideoPlayerForPersistentHeadersUtils"),t("design:paramtypes",[])],Lf);var Wb;let uq=ua.getScrollTop(),vq=void 0,pa=Wb=class{static changeState(a,b){let c=this._shouldCollapse(a);if(!a.playerState||4!==a.playerState&&3!==a.playerState||1!==b)switch(a.playerState){case 0:this._handleUnstarted(b,c,a);break;case 1:this._handleUncollapsedPlay(b,c,a);break;case 2:this._handleCollapsedPlay(b,
c,a);break;case 3:this._handleUserPauseUncollapsed(b,c,a);break;case 4:this._handleUserPauseCollapsed(b,c,a);break;case 5:this._handlePausedNotVisible(b,a);break;case 6:this._handleOverlapped(b,c,a)}return a.playerState}static _handleUnstarted(a,b,c){let {programmaticPlay:d}=c;4===a&&(d(),c.collapseTimer.firstInView||(c.collapseTimer.firstInView=new Date),Wb.startEvent.emit(),b?(this.collapse(c),c.playerState=2):c.playerState=1)}static _setPlayerClosed(a){a.playerState=7;this._isTopCollapse(a)&&S.resolve(Ua).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(a,
b){let {programmaticPause:c}=b;return 7===a?(this.uncollapse(b),c(),this._setPlayerClosed(b),!0):!1}static _handleUncollapsedPlay(a,b,c){let {programmaticPause:d,programmaticPlay:e}=c;4===a?b&&(this.collapse(c),c.playerState=2):3===a?b?(e(),this.collapse(c),c.playerState=2):3!==c.playerState&&(d(),c.playerState=5):1===a&&(c.playerState=3)}static _handleVideoHeight(a){let {playerElement:b,topBackgroundElement:c}=a;c&&b.offsetHeight>=c.offsetHeight&&(c.style.height=a.playerSizeExperiment?"145px":"163px")}static _handleCollapsedPlay(a,
b,c){let {programmaticPause:d,playerPosition:e}=c;4===a?b||(this.uncollapse(c),c.playerState=1):3===a?b||(this.uncollapse(c),d(),c.playerState=5):1===a?c.playerState=4:6===a?(c.lastCollapsedClasses=e.className,this.uncollapse(c),d(),c.playerState=6):5===a&&(this.uncollapse(c),d(),this._setPlayerClosed(c))}static _handleUserPauseCollapsed(a,b,c){let {programmaticPause:d}=c;4!==a||b?1===a?c.playerState=2:5===a&&(this.uncollapse(c),d(),this._setPlayerClosed(c)):(this.uncollapse(c),c.playerState=3)}static _handleUserPauseUncollapsed(a,
b,c){let {programmaticPlay:d}=c;4===a&&b?b?(this.collapse(c),c.playerState=4):d():1===a&&(c.playerState=1)}static _handlePausedNotVisible(a,b){let {programmaticPlay:c}=b;4===a&&3!==b.playerState&&(c(),b.playerState=1)}static _handleOverlapped(a,b,c){({programmaticPlay:a}=c);b&&!this.playerWouldOverlapFooter(c)?(this.collapse(c),a(),c.playerState=2):c.playerState=6}static handleResize(a){this._isCollapsed(a.playerState)&&("adthrive-collapse-mobile"===a.collapseType&&"adthrive-collapse-top-center"===
a.collapseMobileSubType&&a.topBackgroundElement&&(a.topBackgroundElement.style.height=`${a.playerElement.offsetHeight}px`,a.topBackgroundElement.style.width=`${window.innerWidth}px`),a.forceMobile||"adthrive-collapse-sticky"!==a.collapseType||this._stickToSidebar(a))}static handleScroll(a){let {playerState:b,playerElement:c,mediaStarted:d,mobileCollapseOnScrollUp:e}=a;var f=ua.getScrollTop();let g=f>uq;uq=f;f=this.playerWouldOverlapFooter(a);var h=this._shouldCollapseOnScrollUp(a);let k=!ua.playerViewable(c)&&
(h?!d:!0);h=this._isWarmupComplete(a);let m=k?3:f?6:4;"off"!==e&&(f=mp(c)&&5===b&&!h,this._isTopOfPage()?(m=3,this.stopCollapseWarmupTimer(a)):g&&f?(this.startCollapseWarmupTimer(a),m=3,"1"===e&&(clearTimeout(vq),vq=setTimeout(()=>{this._isWarmupComplete(a)&&(this.stopCollapseWarmupTimer(a),a.playerState=1,this.changeState(a,m))},1E3))):h&&this.stopCollapseWarmupTimer(a));this.changeState(a,m);2===a.playerState||4===a.playerState?Wb.startCollapseTimer(a):Wb.stopCollapseTimer(a)}static handleOtherVideoPlaying(a){this.changeState(a,
7)}static handlePageVisibilityChange(a,b){let {programmaticPause:c,programmaticPlay:d}=b;7!==b.playerState&&0!==b.playerState&&3!==b.playerState&&4!==b.playerState&&5!==b.playerState&&6!==b.playerState&&(a?c():1!=b.mediaStarted&&d())}static handleWidthBreak(a,b){7!==b.playerState&&0!==b.playerState&&(a.matches?(this._isCollapsed(b.playerState)&&(this.toggleCollapsedPlayerClasses(!1,b),"adthrive-collapse-sticky"===b.collapseType&&this._unstickFromSidebar(b.playerPosition),b.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,
b)),b.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,b),b.forceMobile=!1,this._isCollapsed(b.playerState)&&(this.toggleCollapsedPlayerClasses(!0,b),"adthrive-collapse-sticky"===b.collapseType&&this._stickToSidebar(b))))}static handleClose(a){Wb.closeEvent.emit();this.changeState(a,5);Wb.stopCollapseTimer(a);A.event("JwPlayer","handleClose",{timeElapsed:a.collapseTimer.timeCollapsed,device:Ta()?"desktop":"mobile",playerType:a.playerType})}static handleUserClick(a){this.changeState(a,1)}static collapse(a){let {playerPosition:b,
topBackgroundElement:c}=a;this.disableCollapse||(a.playerCollapsed=!0,this.toggleCollapsedPlayerClasses(!0,a),a.hasPreviouslyCollapsed=!0,this.collapseEvent.emit(),a.forceMobile||"adthrive-collapse-sticky"!==a.collapseType||this._stickToSidebar(a),c&&(this._handleVideoHeight(a),S.resolve(Lf).handleCollapse({playerPosition:b,topBackgroundElement:c,siteHeaderOnClick:()=>this.uncollapse(a),mobileHeaderSelector:a.mobileHeaderSelector})),setTimeout(d=>{this.displayCloseButton(d)},0,a),S.resolve(Ua).topCenterVideoCollapsed.emit(a))}static displayCloseButton(a){this._isCollapsed(a.playerState)&&
(a.closeButton.style.display="inline-flex")}static uncollapse(a){this.toggleCollapsedPlayerClasses(!1,a);this._unstickFromSidebar(a.playerPosition);a.playerCollapsed=!1;Wb.uncollapseEvent.emit();a.closeButton.style.display="none";S.resolve(Lf).handleUncollapse();S.resolve(Ua).topCenterVideoUnCollapsed.emit()}static _shouldCollapse(a){let {mediaStarted:b,playerContainer:c,mobileCollapseOnScrollUp:d}=a,e=this._shouldCollapseOnScrollUp(a);if(ua.isMobileLandscape())return!1;let f=this._isTopCollapse(a);
if("off"!==d&&f){var g=!!a.collapseTimer.warmupStartTime;a=this._isWarmupComplete(a);if(this._isTopOfPage()||g&&!a)return!1}g=ua.getScrollTop();a=ua.getScrollBottom();let h=c.offsetHeight,k=ve(c).top,m=k+h;return f?b&&(g>=k||e&&a<=m):b&&(g>=k+h/2||e&&a<=m-h/2)}static _shouldCollapseOnScrollUp(a){let {desktopCollapseOnScrollUp:b,hasPreviouslyCollapsed:c,mobileCollapseOnScrollUp:d}=a;return c&&(b||"off"!==d)}static _isCollapsed(a){return 2===a||4===a}static _isWarmupComplete(a){let {collapseTimer:b,
mobileCollapseOnScrollUp:c,playerContainer:d}=a;if(!b.warmupStartTime)return!1;if("1"===c)return 1E3<Date.now()-b.warmupStartTime.getTime();if("2"===c)return np(d)}static _isTopOfPage(){return 1>window.scrollY}static _isTopCollapse(a){return a.collapseMobileSubType&&"adthrive-collapse-top-center"===a.collapseMobileSubType}static _stickToSidebar(a){a.stickyElement&&(a.playerPosition.style.left=`${a.stickyElement.getBoundingClientRect().left}px`,a.playerPosition.style.width=`${a.stickyElement.clientWidth}px`);
a.playerPosition.style.top=`${a.topMargin}px`}static _unstickFromSidebar(a){a.style.bottom=""}static playerWouldOverlapFooter(a){if(!a.footerElement)return!1;if(a.playerPosition.className.includes("adthrive-collapse-bottom")||a.lastCollapsedClasses&&a.lastCollapsedClasses.includes("adthrive-collapse-bottom")){let b=zc();return!(window.innerHeight-b<a.footerElement.getBoundingClientRect().top)}return!((a.topMargin||0)+a.playerPosition.getBoundingClientRect().height<a.footerElement.getBoundingClientRect().top)}static _castArray(a){return Array.isArray(a)?
a:[a]}static toggleClass(a,b,c){b=this._castArray(b);b.forEach(d=>{c?(a.playerPosition.classList.add(d),a.adContainer.classList.add(d)):(a.playerPosition.classList.remove(d),a.adContainer.classList.remove(d))})}static toggleCollapsedPlayerClasses(a,b){b.forceMobile?(this.toggleClass(b,"adthrive-collapse-mobile",a),this.toggleClass(b,b.collapseMobileSizeType,a),this.toggleClass(b,b.collapseMobileSubType,a),b.playerSizeExperiment&&this.toggleClass(b,"rvps-experiment",a),this.repositionCollapseMobile(b,
a)):(this.toggleClass(b,b.collapseType,a),b.collapseSubType&&this.toggleClass(b,b.collapseSubType,a),b.collapseMobileSizeType&&(this.toggleClass(b,b.collapseMobileSizeType,a),b.playerSizeExperiment&&this.toggleClass(b,"rvps-experiment",a)),"adthrive-collapse-mobile"===b.collapseType&&(this.toggleClass(b,b.collapseMobileSubType,a),this.repositionCollapseMobile(b,a)));this.classesToggled.emit()}static repositionCollapseMobile(a,b){"adthrive-collapse-bottom-left"===a.collapseMobileSubType||"adthrive-collapse-bottom-right"===
a.collapseMobileSubType?this.repositionCollapseMobileBottom(a):"adthrive-collapse-top-center"===a.collapseMobileSubType&&this.repositionCollapseMobileTop(a,b)}static repositionCollapseMobileTop(a,b){a.topBackgroundElement&&(b?a.topBackgroundElement.style.height=`${a.playerElement.offsetHeight}px`:(a.topBackgroundElement.style.height="0",a.topBackgroundElement.classList.remove("extra-height")))}static repositionCollapseMobileBottom(a){if(a.playerPosition.className.includes("adthrive-collapse-bottom")||
a.collapseMobileSubType&&-1<a.collapseMobileSubType.indexOf("bottom")){let b=zc();a.playerPosition.style.setProperty("top","auto","important");a.playerPosition.style.setProperty("bottom",`${b}px`,"important")}}static resizeContainer(a){a.playerContainer.style.height=`${a.playerElement.offsetHeight+30}px`}static startCollapseTimer(a){a.collapseTimer.isRunning||(a.collapseTimer.startTime?a.collapseTimer.lastCollapsedTime=new Date:(a.collapseTimer.startTime=new Date,a.collapseTimer.lastCollapsedTime=
a.collapseTimer.startTime),a.collapseTimer.isRunning=!0)}static stopCollapseTimer(a){a.collapseTimer.isRunning&&(a.collapseTimer.lastCollapsedTime&&(a.collapseTimer.timeCollapsed+=Date.now()-a.collapseTimer.lastCollapsedTime.getTime()),a.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(a){a.collapseTimer.warmupStartTime||(a.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(a){a.collapseTimer.warmupStartTime&&(a.collapseTimer.warmupStartTime=void 0)}};pa.collapseEvent=
new L;pa.uncollapseEvent=new L;pa.classesToggled=new L;pa.closeEvent=new L;pa.startEvent=new L;pa.disableCollapse=!1;pa=Wb=q([v("CollapseUtils")],pa);let Mf=class{constructor(){this._headerVisibleEvents=[];this._headerHiddenEvents=[];this._header=null;this._isHeaderVisible=!0;this.handleUncollapse=()=>{};this.handleCollapse=a=>{if(a.mobileHeaderSelector){this.anchorVideoPlayerBelowNavbar(a,a.mobileHeaderSelector);let b=this.siteHeader(a.mobileHeaderSelector);b&&(b.onclick=a.siteHeaderOnClick)}};this.collapsiblePersistentHeaderObserver=
new IntersectionObserver(a=>{for(let b of a)(this._isHeaderVisible=b.isIntersecting)?this._headerVisibleEvents.forEach(c=>c()):this._headerHiddenEvents.forEach(c=>c())},{threshold:.95})}applyTransitionToElement(a){a.style.transition="all 0.2s ease-in-out"}pushElementBelowHeader(a,b){b=this.getHeaderHeight(b);null!==b&&(a.style.top=`${b}px`)}anchorVideoPlayerBelowNavbar(a,b){let {playerElement:c,topBackgroundElement:d}=a;a=()=>{if(null!==this.getHeaderHeight(b)){this.applyTransitionToElement(d);this.applyTransitionToElement(c);
this.pushElementBelowHeader(d,b);this.pushElementBelowHeader(c,b);const f=c.querySelector(".adthrive-top-collapse-wrapper-bar");f&&this.pushElementBelowHeader(f,b)}};let e=()=>{d.style.top="0";c.style.top="0"};this._isHeaderVisible?a():e();this._headerVisibleEvents.push(a);this._headerHiddenEvents.push(e)}getHeaderHeight(a){return(a=this.siteHeader(a))?this.getElementHeight(a):null}getElementHeight(a){return a.getBoundingClientRect().height}siteHeader(a){if(this._header)return this._header;a=document.querySelector(a);
if(!a)return null;this._header=a;this.collapsiblePersistentHeaderObserver.observe(this._header);return this._header}};Mf=q([y(),v("TopCenterVideoPlayerForPersistentHeadersLegacyUtils"),t("design:paramtypes",[])],Mf);var Xb;let wq=ua.getScrollTop(),xq=void 0,xa=Xb=class{static changeState(a,b){let c=this._shouldCollapse(a);if(!this._handleOtherVideoPlaying(b,a))switch(a.playerState){case 0:this._handleUnstarted(b,c,a);break;case 1:this._handleUncollapsedPlay(b,c,a);break;case 2:this._handleCollapsedPlay(b,
c,a);break;case 8:this._handleNonLinearAdPlay(b,c,a);break;case 4:this._handleUserPauseCollapsed(b,c,a);break;case 3:this._handleUserPauseUncollapsed(b,c,a);break;case 5:this._handlePausedNotVisible(b,a);break;case 9:this._handleNonLinearAdPaused(b,a);break;case 6:this._handleOverlapped(b,c,a);break;case 10:this._handleNonLinearAdOverlapped(b,c,a)}return a.playerState}static _handleUnstarted(a,b,c){let d=c.playerInstance;4===a&&(c.collapseTimer.firstInView||(c.collapseTimer.firstInView=new Date),
Xb.startEvent.emit(),b?(this.collapse(c),d.getViewable()&&d.play(!0),c.playerState=d._nonLinearAd?8:2):c.playerState=d._nonLinearAd?8:1)}static _setPlayerClosed(a){a.playerState=7;this._isTopCollapse(a)&&S.resolve(Ua).topCenterVideoClosed.emit()}static _handleOtherVideoPlaying(a,b){return 7===a?(this.uncollapse(b),b.playerInstance.pause(!0),this._setPlayerClosed(b),!0):!1}static _handleUncollapsedPlay(a,b,c){let {playerInstance:d}=c;4===a?b?(this.collapse(c),d.play(!0),c.playerState=2):d.play(!0):
3===a?b?(d.play(!0),this.collapse(c),c.playerState=2):(d.pause(!0),c.playerState=5):1===a&&(c.playerState=3)}static _handleVideoHeight(a){let {playerElement:b,topBackgroundElement:c}=a;c&&b.offsetHeight>=c.offsetHeight&&(c.style.height="163px")}static _handleCollapsedPlay(a,b,c){let {playerInstance:d,playerElement:e}=c;4===a?b?d.play(!0):(this.uncollapse(c),d.play(!0),c.playerState=1):3===a?b||(this.uncollapse(c),d.pause(!0),c.playerState=5):1===a?c.playerState=4:6===a?(c.lastCollapsedClasses=e.className,
this.uncollapse(c),d.pause(!0),c.playerState=6):5===a&&(this.uncollapse(c),d.pause(!0),this._setPlayerClosed(c))}static _handleNonLinearAdPlay(a,b,c){let {playerInstance:d}=c;4===a?b&&this.collapse(c):3===a?(d.pauseAd(!0),c.playerState=9):6===a&&(this.uncollapse(c),d.pauseAd(!0),c.playerState=10)}static _handleUserPauseCollapsed(a,b,c){let {playerInstance:d}=c;4!==a||b?1===a?c.playerState=2:5===a&&(this.uncollapse(c),d.pause(!0),this._setPlayerClosed(c)):(this.uncollapse(c),c.playerState=3)}static _handleUserPauseUncollapsed(a,
b,c){4===a&&b?(this.collapse(c),c.playerState=4):1===a&&(c.playerState=1)}static _handlePausedNotVisible(a,b){let {playerInstance:c}=b;4===a&&(c.play(!0),b.playerState=1)}static _handleNonLinearAdPaused(a,b){let {playerInstance:c}=b;4===a?(c.pauseAd(!1),b.playerState=8):this.playerWouldOverlapFooter(b)&&(b.playerState=10)}static _handleOverlapped(a,b,c){({playerInstance:a}=c);b&&!this.playerWouldOverlapFooter(c)?(this.collapse(c),a.play(!0),c.playerState=2):c.playerState=6}static _handleNonLinearAdOverlapped(a,
b,c){({playerInstance:a}=c);b&&!this.playerWouldOverlapFooter(c)?(this.collapse(c),a.pauseAd(!1),c.playerState=8):(a.pauseAd(!0),c.playerState=10)}static handleResize(a){this.isCollapsed(a.playerState)?("adthrive-collapse-mobile"===a.collapseType&&"adthrive-collapse-top-center"===a.collapseMobileSubType&&a.topBackgroundElement&&(a.topBackgroundElement.style.height=`${a.playerElement.offsetHeight}px`,a.topBackgroundElement.style.width=`${window.innerWidth}px`),a.forceMobile||"adthrive-collapse-sticky"!==
a.collapseType||this._stickToSidebar(a)):this.resizeContainer(a)}static handleScroll(a){let {playerState:b,playerElement:c,playerContainer:d,mediaStarted:e,mobileCollapseOnScrollUp:f}=a;var g=ua.getScrollTop();let h=g>wq;wq=g;g=this.playerWouldOverlapFooter(a);var k=this._shouldCollapseOnScrollUp(a);let m=!ua.playerViewable(c)&&(k?!e:!0);k=this._isWarmupComplete(a);let n=m?3:g?6:4;"off"!==f&&(g=mp(d)&&5===b&&!k,this._isTopOfPage()?(n=3,this.stopCollapseWarmupTimer(a)):h&&g?(this.startCollapseWarmupTimer(a),
n=3,"1"===f&&(clearTimeout(xq),xq=setTimeout(()=>{this._isWarmupComplete(a)&&(this.stopCollapseWarmupTimer(a),a.playerState=1,this.changeState(a,n))},1E3))):k&&this.stopCollapseWarmupTimer(a));this.changeState(a,n);2===a.playerState||4===a.playerState?Xb.startCollapseTimer(a):Xb.stopCollapseTimer(a)}static handleOtherVideoPlaying(a){this.changeState(a,7)}static handlePageVisibilityChange(a,b){7!==b.playerState&&0!==b.playerState&&3!==b.playerState&&4!==b.playerState&&5!==b.playerState&&6!==b.playerState&&
(a?b.playerInstance.pause(!0):b.playerInstance.play(!0))}static handleWidthBreak(a,b){7!==b.playerState&&0!==b.playerState&&(a.matches?(this.isCollapsed(b.playerState)&&(this.toggleCollapsedPlayerClasses(!1,b),"adthrive-collapse-sticky"===b.collapseType&&this._unstickFromSidebar(b.playerElement),b.forceMobile=!0,this.toggleCollapsedPlayerClasses(!0,b)),b.forceMobile=!0):(this.toggleCollapsedPlayerClasses(!1,b),b.forceMobile=!1,this.isCollapsed(b.playerState)&&(this.toggleCollapsedPlayerClasses(!0,
b),"adthrive-collapse-sticky"===b.collapseType&&this._stickToSidebar(b))))}static handleClose(a){Xb.closeEvent.emit();this.changeState(a,5);Xb.stopCollapseTimer(a);A.event("JwPlayer","handleClose",{timeElapsed:a.collapseTimer.timeCollapsed,device:Ta()?"desktop":"mobile",playerType:a.playerType})}static handleUserClick(a){this.changeState(a,1)}static collapse(a){let {playerElement:b,topBackgroundElement:c}=a;this.disableCollapse||(this.collapseEvent.emit(),this.toggleCollapsedPlayerClasses(!0,a),a.hasPreviouslyCollapsed=
!0,a.forceMobile||"adthrive-collapse-sticky"!==a.collapseType||this._stickToSidebar(a),c&&(this._handleVideoHeight(a),S.resolve(Mf).handleCollapse({playerElement:b,topBackgroundElement:c,siteHeaderOnClick:()=>this.uncollapse(a),mobileHeaderSelector:a.mobileHeaderSelector})),a.playerInstance.resize(),setTimeout(d=>{this.displayCloseButton(d)},0,a),S.resolve(Ua).topCenterVideoCollapsed.emit(a))}static displayCloseButton(a){this.isCollapsed(a.playerState)&&(a.closeButton.style.display="inline-flex")}static hideCloseButton(a){a.closeButton.style.display=
"none"}static uncollapse(a){Xb.uncollapseEvent.emit();this.toggleCollapsedPlayerClasses(!1,a);this._unstickFromSidebar(a.playerElement);this.hideCloseButton(a);this.resizeContainer(a);S.resolve(Mf).handleUncollapse();S.resolve(Ua).topCenterVideoUnCollapsed.emit()}static _shouldCollapse(a){let {mediaStarted:b,playerContainer:c,mobileCollapseOnScrollUp:d}=a,e=this._shouldCollapseOnScrollUp(a);if(ua.isMobileLandscape())return!1;let f=this._isTopCollapse(a);if("off"!==d&&f){var g=!!a.collapseTimer.warmupStartTime;
a=this._isWarmupComplete(a);if(this._isTopOfPage()||g&&!a)return!1}g=ua.getScrollTop();a=ua.getScrollBottom();let h=c.offsetHeight,k=ve(c).top,m=k+h;return f?b&&(g>=k||e&&a<=m):b&&(g>=k+h/2||e&&a<=m-h/2)}static _shouldCollapseOnScrollUp(a){let {desktopCollapseOnScrollUp:b,hasPreviouslyCollapsed:c,mobileCollapseOnScrollUp:d}=a;return c&&(b||"off"!==d)}static isCollapsed(a){return 2===a||4===a}static _isWarmupComplete(a){let {collapseTimer:b,mobileCollapseOnScrollUp:c,playerContainer:d}=a;if(!b.warmupStartTime)return!1;
if("1"===c)return 1E3<Date.now()-b.warmupStartTime.getTime();if("2"===c)return np(d)}static _isTopOfPage(){return 1>window.scrollY}static _isTopCollapse(a){return a.collapseMobileSubType&&"adthrive-collapse-top-center"===a.collapseMobileSubType}static _stickToSidebar(a){a.stickyElement&&(a.playerElement.style.left=`${a.stickyElement.getBoundingClientRect().left}px`,a.playerElement.style.width=`${a.stickyElement.clientWidth}px`);a.playerElement.style.top=`${a.topMargin}px`}static _unstickFromSidebar(a){a.style.cssText=
""}static playerWouldOverlapFooter(a){if(!a.footerElement)return!1;if(a.playerElement.className.includes("adthrive-collapse-bottom")||a.lastCollapsedClasses&&a.lastCollapsedClasses.includes("adthrive-collapse-bottom")){let b=zc();return!(window.innerHeight-b<a.footerElement.getBoundingClientRect().top)}return!((a.topMargin||0)+a.playerElement.getBoundingClientRect().height<a.footerElement.getBoundingClientRect().top)}static toggleCollapsedPlayerClasses(a,b){var c=b.playerInstance.utils;c=Cb(c,"toggleClass")&&
"function"===typeof c.toggleClass?c.toggleClass:()=>{};b.forceMobile?(c(b.playerElement,"adthrive-collapse-mobile",a),c(b.playerElement,b.collapseMobileSizeType,a),c(b.playerElement,b.collapseMobileSubType,a),this.repositionCollapseMobile(b,a)):(c(b.playerElement,b.collapseType,a),b.collapseSubType&&c(b.playerElement,b.collapseSubType,a),b.collapseMobileSizeType&&c(b.playerElement,b.collapseMobileSizeType,a),"adthrive-collapse-mobile"===b.collapseType&&(c(b.playerElement,b.collapseMobileSubType,a),
this.repositionCollapseMobile(b,a)))}static repositionCollapseMobile(a,b){"adthrive-collapse-bottom-left"===a.collapseMobileSubType||"adthrive-collapse-bottom-right"===a.collapseMobileSubType?this.repositionCollapseMobileBottom(a):"adthrive-collapse-top-center"===a.collapseMobileSubType&&this.repositionCollapseMobileTop(a,b)}static repositionCollapseMobileTop(a,b){a.topBackgroundElement&&(a.topBackgroundElement.style.height=b?`${a.playerElement.offsetHeight}px`:"0")}static repositionCollapseMobileBottom(a){if(a.playerElement.className.includes("adthrive-collapse-bottom")||
a.collapseMobileSubType&&-1<a.collapseMobileSubType.indexOf("bottom")){let b=zc();a.playerElement.style.setProperty("top","auto","important");a.playerElement.style.setProperty("bottom",`${b}px`,"important")}}static resizeContainer(a){a.playerContainer.style.height=`${a.playerElement.offsetHeight+30}px`}static startCollapseTimer(a){a.collapseTimer.isRunning||(a.collapseTimer.startTime?a.collapseTimer.lastCollapsedTime=new Date:(a.collapseTimer.startTime=new Date,a.collapseTimer.lastCollapsedTime=a.collapseTimer.startTime),
a.collapseTimer.isRunning=!0)}static stopCollapseTimer(a){a.collapseTimer.isRunning&&(a.collapseTimer.lastCollapsedTime&&(a.collapseTimer.timeCollapsed+=Date.now()-a.collapseTimer.lastCollapsedTime.getTime()),a.collapseTimer.isRunning=!1)}static startCollapseWarmupTimer(a){a.collapseTimer.warmupStartTime||(a.collapseTimer.warmupStartTime=new Date)}static stopCollapseWarmupTimer(a){a.collapseTimer.warmupStartTime&&(a.collapseTimer.warmupStartTime=void 0)}};xa.collapseEvent=new L;xa.uncollapseEvent=
new L;xa.closeEvent=new L;xa.startEvent=new L;xa.disableCollapse=!1;xa=Xb=q([v("LegacyCollapseUtils")],xa);var ya;(function(a){a.firstOnload="so-fo";a.onload="so-o";a.closeBtnVisible="so-cbv";a.closeClicked="so-cc";a.closeSinceFirstImp="so-csfi";a.closeSinceOnload="so-cso";a.closeSinceBtnVisible="so-csbv"})(ya||(ya={}));class Bl{constructor(a,b,c,d,e,f){this._config=a;this._slotManager=b;this._slot=c;this._eventProxy=d;this._videoCloseButton=e;this._gam=f;this._isClosed=this._isRendered=!1;this._elementClassNamePrefix=
"adthrive-sticky-outstream";this._isMobile="phone"===this._config.context.device;this._hiddenClassName="adthrive-player-hidden";this._markNames=[ya.firstOnload,ya.onload,ya.closeClicked,ya.closeBtnVisible];this._measureNames=[ya.closeSinceFirstImp,ya.closeSinceOnload,ya.closeSinceBtnVisible];this._scrollEventHandler=()=>{};this._prebidAmazonAdvertiserIds=[a.prebid.advertiserId,a.amazon.advertiserId];let {mobileHeaderSelector:g,mobileLocation:h}=this._config.video.stickyOutstreamSettings;this._mobileHeaderSelector=
g;this._mobileLocation=Q(h,"bottom-right");this._addSlickDialogListeners()}setup(){this._isRendered||(this._isRendered=!0,this._appendCloseButton(),this._activate());this._slot.setSlotTargetingFlag("fref",[`${this._slot.noAdRefreshCount}`],!0);xa.collapseEvent.on(()=>{this._closeOnRelatedCollapse()});pa.collapseEvent.on(()=>{this._closeOnRelatedCollapse()})}get renderState(){return this._isRendered}_activate(){this._handleWidthBreak();let a=this._slot.element.parentElement;a&&(a.classList.add(`${this._elementClassNamePrefix}-idle`),
this._isMobile&&this._setElementStyle(a),this._gam.slotRequested.on(this._handleSlotRequested.bind(this)),this._gam.slotRenderEnded.on(this._handleSlotRenderEnded.bind(this)),this._gam.slotOnload.on(this._handleSlotOnload.bind(this)))}_setElementStyle(a){if("top-center"===this._mobileLocation)this._setTopCenterStyle(a);else{let b=this._mobileLocation?this._mobileLocation.split("-")[1]:"right";a.classList.add(`${this._elementClassNamePrefix}-mobile-${b}`)}}_setScrollListener(a,b,c){this._scrollEventHandler=
Zc(()=>{const d=b.getBoundingClientRect().bottom,e=c&&c.getBoundingClientRect().bottom;a.style.setProperty("top",`${d>e?d:e}px`)},20);window.addEventListener("scroll",this._scrollEventHandler)}_setTopCenterStyle(a){var b=this._mobileHeaderSelector?Cc(this._mobileHeaderSelector):null;b=b&&b.valid&&b.elements&&b.elements[0]||null;let c=0;if(b){let d=document.querySelector(".slick-film-strip");c=d?d.getBoundingClientRect().bottom:b.getBoundingClientRect().bottom;this._setScrollListener(a,b,d)}a.classList.add(`${this._elementClassNamePrefix}-top-center`);
a.style.setProperty("top",`${c}px`)}_handleSlotOnload({slot:a}){"Video_StickyOutstream"===a.location&&(performance.mark(ya.onload),performance.getEntriesByName(ya.firstOnload).length||performance.mark(ya.firstOnload))}_handleSlotRenderEnded({event:a,slot:b}){"Video_StickyOutstream"!==b.location||a.isEmpty||a.advertiserId&&this._prebidAmazonAdvertiserIds.includes(a.advertiserId)||!(a=this._slot.element.parentElement)||(a.classList.add(`${this._elementClassNamePrefix}-active`),a.classList.remove(`${this._elementClassNamePrefix}-idle`))}_handleSlotRequested({slot:a}){"Video_StickyOutstream"===
a.location&&(a=this._slot.element.parentElement)&&!a.classList.contains(`${this._elementClassNamePrefix}-idle`)&&(a.classList.remove(`${this._elementClassNamePrefix}-active`),a.classList.add(`${this._elementClassNamePrefix}-idle`))}_createObserver(a){this._observer=new MutationObserver(b=>{b.forEach(c=>{c.target.classList.contains(`${this._elementClassNamePrefix}-active`)&&performance.mark(ya.closeBtnVisible)})});this._observer.observe(a.parentElement||a,{attributes:!0,attributeFilter:["class"]})}_appendCloseButton(){var a;
let b=this._slot.element,c=this._videoCloseButton.createPlayerCloseButton(this._handleCloseClick.bind(this),"sticky outstream",`${this._elementClassNamePrefix}-close`,!1,this._isMobile&&"top-center"===this._mobileLocation);null===(a=b.parentNode)||void 0===a?void 0:a.insertBefore(c,b);this._createObserver(b);c.style.display="none";setTimeout(()=>{c.style.display="inline-flex"},this._config.video.closeButtonTimeout)}_addSlickDialogListeners(){document.addEventListener("slick-auth-dialog-opened",()=>
{this._slot.element.classList.add(this._hiddenClassName)});document.addEventListener("slick-auth-dialog-closed",()=>{this._slot.element.classList.remove(this._hiddenClassName)})}_getMeasure(a,b,c){try{return(performance.measure(a,b,c).duration/1E3).toFixed(2)}catch(d){return-1}}_getDurations(){let a=this._getMeasure(ya.closeSinceOnload,ya.onload,ya.closeClicked),b=this._getMeasure(ya.closeSinceBtnVisible,ya.closeBtnVisible,ya.closeClicked),c=this._getMeasure(ya.closeSinceFirstImp,ya.firstOnload,ya.closeClicked),
d=(performance.now()/1E3).toFixed(2);return{slotTime:a,btnTime:b,firstImp:c,pageLoad:d,refresh:this._slot.refreshCount}}_cleanUpLogging(){var a;null===(a=this._observer)||void 0===a?void 0:a.disconnect();this._markNames.forEach(b=>performance.clearMarks&&performance.clearMarks(b));this._measureNames.forEach(b=>performance.clearMeasures&&performance.clearMeasures(b))}_logPlayerClose(a){Bl.closeEvent.emit();A.event("StickyOutstream","handleClose",{device:Ta()?"desktop":"mobile",closeReason:a,...this._getDurations()});
this._cleanUpLogging();window.removeEventListener("scroll",this._scrollEventHandler)}_closeOnRelatedCollapse(){this._handleClose("relatedCollapse")}_handleCloseClick(){performance.mark(ya.closeClicked);this._handleClose("closeClick")}_handleClose(a){if(!this._isClosed){this._isClosed=!0;var b=this._slot.element,c=b.parentElement;this._logPlayerClose(a);c&&(c.removeChild(b),c.classList.remove(`${this._elementClassNamePrefix}-active`),this._slotManager.destroy(b.id),this._removeListener())}}_handleWidthBreak(){this._removeListener=
this._eventProxy.footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this));this._repositionCollapseBottom()}_handleFooterRefreshedEvent(){this._repositionCollapseBottom()}_repositionCollapseBottom(){if(this._isMobile&&"top-center"!==this._mobileLocation){let a=zc();this._slot.element.parentElement.style.setProperty("top","auto","important");this._slot.element.parentElement.style.setProperty("bottom",`${a}px`,"important")}}}Bl.closeEvent=new L;let Tc=class extends X{constructor(){super(...arguments);
this.colorMap={b:{background:"#000000",highlight:"#ffffff"},w:{background:"#ffffff",highlight:"#000000"},g25:{background:"#f7f7f7",highlight:"#080808"},g50:{background:"#3f3f3f",highlight:"#ffffff"}}}init(){this._key="TopCenterMobileBackground"}isEnabled(){return super.isEnabled()&&ca()}color(){if(this.result){if(this.colorMap[this.result])return this.colorMap[this.result];A.error("InstreamPlayer","get topBackgroundColor","invalid result:",this.result)}return null}get backgroundColor(){let a=this.color();
return a?a.background:null}get buttonTitleColor(){let a=this.color();return a?a.highlight:null}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Tc.prototype,"run",null);Tc=q([v("TopCenterMobileBackgroundCoreExperiment"),y()],Tc);let Id=class extends T{constructor(a){super();this._topCenterMobileBackgroundCoreExperiment=a;this._isTopCollapse=this._isInstreamExperiment=this._isButtonOutsideContainerTop=this._isButtonInsideContainer=
this._hasTitleBar=!1}createDefaultButton(a){let b=document.createElement("div");b.innerHTML="<span>&times;</span>";b.className="adthrive-wrapper-close";b.style.display="none";b.id="adthrive-collapse-close";b.onclick=a;return b}createPlayerCloseButton(a,b,c,d=!1,e=!1){this._hasTitleBar=d;this._isTopCollapse=e;this._isInstreamExperiment="instream"===b||e;this._isButtonOutsideContainerTop="instream"===b;this._isButtonInsideContainer="sticky outstream"===b&&!e;d=this._getButtonClasses();b=this._getSvgOptions(this._isTopCollapse&&
"instream"===b?this._topCenterMobileBackgroundCoreExperiment.buttonTitleColor:null);c=this._createCloseButton(d,c,b);c.onclick=a;return this._isButtonInsideContainer?this.applyCloseButtonWrapper(c):c}_getButtonClasses(){let a=[];this._isButtonOutsideContainerTop&&a.push("adthrive-wrapper-float-close");this._isInstreamExperiment&&(a=[...a,...this._getInstreamClasses()]);return a}_getInstreamClasses(){let a=["adthrive-instream-close"];this._isTopCollapse?a.push("adthrive-top-collapse-close"):this._isButtonOutsideContainerTop&&
a.push("adthrive-top-left-outer","adthrive-float-left");return a}_getSvgOptions(a){let b="white",c="black";if(this._isButtonInsideContainer||this._isTopCollapse)b="transparent",c="white";a&&(c=a);return{fillColor:b,strokeColor:c}}_buildNewCloseButton(a,b){a.appendChild(this._createCloseButtonX(b));a.appendChild(this._createCloseButtonCircleThatGoesAroundTheX(b))}_createCloseButton(a,b,c){let {fillColor:d,strokeColor:e}=null!==c&&void 0!==c?c:{fillColor:"white",strokeColor:"black"};a=this._createButtonHtml(a,
b);b=this._createSvg(d);this._isTopCollapse?this._buildNewCloseButton(b,e):(c=this._createPath(e),b.appendChild(c));a.appendChild(b);return a}_createButtonHtml(a,b){let c=document.createElement("div");c.className=a.join(" ");c.id=b;return c}_createSvg(a){let b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width","18");b.setAttribute("height","18");b.setAttribute("text-anchor","middle");b.setAttribute("dominant-baseline","central");b.setAttribute("fill",a);b.setAttribute("text-anchor",
"middle");b.setAttribute("dominant-baseline","central");return b}_createPath(a){let b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d","M 0.5 9 A 5 5 0 0 0 17.5 9 A 5 5 0 0 0 0.5 9 M 9 9 L 7 7 L 11 11 M 9 9 L 7 11 L 11 7");b.setAttribute("stroke",a);b.setAttribute("stroke-width","1");return b}_createCloseButtonCircleThatGoesAroundTheX(a){let b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttribute("cx","9");b.setAttribute("cy","9");b.setAttribute("r",
"8");b.setAttribute("stroke",a);b.setAttribute("stroke-width","2");b.setAttribute("fill","none");return b}_createCloseButtonX(a){let b=document.createElementNS("http://www.w3.org/2000/svg","text");b.setAttribute("x","9");b.setAttribute("y","9");b.setAttribute("text-anchor","middle");b.setAttribute("stroke",a);b.setAttribute("fill",a);b.setAttribute("stroke-width","1px");b.setAttribute("font-size","13px");b.setAttribute("alignment-baseline","middle");b.textContent="x";return b}applyCloseButtonWrapper(a){let b=
document.createElement("div"),c=["adthrive-wrapper-float-close","adthrive-wrapper-close-bkgd-50"];this._hasTitleBar?c.push("adthrive-top-left-inner-wrapper"):c.push("adthrive-top-left-inner");b.classList.add(...c);b.appendChild(a);return b}};Id=q([v("VideoCloseButtonComponent"),H(),t("design:paramtypes",[Tc])],Id);let Cl=class extends W{init(){this._key="StickySidebarFeatureFlag";this._default=!1}};Cl=q([v("StickySidebarExperiment"),y()],Cl);let Nf=class extends W{init(){this._key="EnhancedStickySidebarAds";
this._default=!1}};Nf=q([v("EnhancedStickySidebarAdsExperiment"),y()],Nf);let Of=class extends T{constructor(a,b,c,d,e,f,g,h,k,m,n){super();this._slots=a;this._config=b;this._slotManager=c;this._eventProxy=d;this._videoCloseButton=e;this._gam=f;this._outstream=g;this._amazonMethods=h;this._sticky=[];this._slots.added.on(p=>{if((!m.result||"Recipe"!==(null===p||void 0===p?void 0:p.location))&&p&&p.sticky){p.element.classList.add("adthrive-sticky");if("Sidebar"===p.location){let r=this._config.adOptions.dynamicStickySidebarEnabled&&
n.result&&p.sequence&&9<=p.sequence;k.result&&p.sequence&&5>=p.sequence?se(p.element):r?p.element.classList.contains("adthrive-sticky-sidebar")?se(p.element):this._sticky.push(new Al(p,!0,this._config)):this._sticky.push(new Al(p,!0,this._config))}"Video_StickyOutstream"===p.location&&(this._stickyOutstream=new Bl(this._config,this._slotManager,p,this._eventProxy,this._videoCloseButton,this._gam),this._sticky.push(new Al(p,!0,this._config)))}});if(this._amazonMethods.isAmazonLoaded()&&this._config.amazon.enabled)this._gam.slotOnload.on(({slot:p})=>
{let r=window.apsBidObject?window.apsBidObject.VAST:null;"Video_StickyOutstream"===p.location&&r&&(this._outstream.callRendererWithUrl(r,p.id,!0),delete window.apsBidObject)})}stickyOutstreamReady(){this._stickyOutstream&&!this._stickyOutstream.renderState&&this._stickyOutstream.setup()}};Of=q([v("StickyComponent"),y(),t("design:paramtypes",[Qa,N,ja,Ub,Id,V,uf,ij,Cl,Nc,Nf])],Of);let Dl=class extends T{constructor(a,b,c,d){super();this._config=a;this._slotManager=b;this._sticky=c;this._intersectionObserverManager=
d}init(){let a=this._slotManager;a.added.on(b=>{for(let c of b)c.lazy?(V.pushToQueue(()=>{c.googleTagSlot.setTargeting("lazy","true")}),this._intersectionObserverManager.observe(this._config.lazyLoad.googleLazyLoadSettings.hbMarginPercent,c)):"Video_StickyOutstream"===c.location?(this._sticky.stickyOutstreamReady(),a.display([c]).catch(d=>{A.error("GoogleLazyLoadComponent","init","display stickyOutstream slot",d)})):(V.pushToQueue(()=>{c.googleTagSlot.setTargeting("lazy","false")}),a.display(c).catch(d=>
{A.error("GoogleLazyLoadComponent","init","display non lazy slot",d)}))})}};Dl=q([v("GoogleLazyLoadComponent"),H(),t("design:paramtypes",[N,ja,Of,vd])],Dl);let El=class extends T{constructor(a){super();this._slotManager=a}init(){this._slotManager.added.on(a=>{V.pushToQueue(()=>{for(let b of a){let c=qh(b)||0;b.hvp=c;50<=c&&b.setTargeting({key:"hvp",value:c.toString()})}})});this._slotManager.refreshing.on(a=>{V.pushToQueue(()=>{for(let b of a)if(2>=b.refreshCount&&(!b.hvp||80>b.hvp)){let c=sp(b)||
0;b.hvp=c;60<=c&&b.setTargeting({key:"hvp",value:`${c}`})}})})}};El=q([v("HvpComponent"),H(),t("design:paramtypes",[ja])],El);let Fl=class{constructor(a,b){this._config=a;this._gam=b;this._config.marmalade.selectorMatches=this.filterBasedOnSettings()}inject(){try{return this._config.marmalade.selectorMatches.reduce(this.processMatch.bind(this),[])}catch(a){A.error("MarmaladeInjector","inject",a)}return[]}filterBasedOnSettings(){let a=this._config.adTypes,b=ca()?a.inRecipeRecommendationMobile:a.inRecipeRecommendationDesktop,
c=ca()?a.sponsorTileMobile:a.sponsorTileDesktop;return this._config.marmalade.selectorMatches.filter(({adUnit:d})=>"Native_Recipe"===d.location?(b&&this._gam.setTargetingFlag("irrEligible",["true"],!0),b):"Sponsor_Tile"===d.location?(c&&this._gam.setTargetingFlag("stEligible",["true"],!0),c):!0)}processMatch(a,b){let {adUnit:c,match:d}=b;b=this.getElementId(c.location,c.sequence);!a.some(e=>e.location===c.location&&e.sequence===c.sequence)&&(b=this.addAd(d,b,c.position,c.classNames))&&(b=new Ip(c.location,
c.sequence,c.size,b,!1,c.lazy),a.push(b));return a}getElementId(a,b){return[this._config.gam.prefix,a,b].filter(kc).join("_")}addAd(a,b,c,d=[]){d=`<div id="${b}" class="adthrive-ad ${d.join(" ")}"></div>`;a.insertAdjacentHTML(c,d);return document.getElementById(b)}};Fl=q([v("MarmaladeInjector"),H(),t("design:paramtypes",[N,V])],Fl);let Gl=class extends T{constructor(a,b,c,d,e,f){super();this._config=a;this._marmaladeInjector=b;this._slotManager=c;this._gam=d;this._prebidMethods=e;this._eventBus=f;
this._siteCodeObject={};a=this._config.marmalade;this._mcmp=a.mcmp.filter(Lb);this._siteCodes=a.siteCodes;this._filteredSiteCodes=a.filteredSiteCodes;this._siteCodeObject=this._filteredSiteCodes.reduce((g,h)=>{g[h]="True";return g},{})}init(){this._eventBus.marmaladeResponseLoaded.on(()=>{this._initializeMarmalade()});this._addDynamicSlots();this._addFlpMessaging();this._setPageLevelTargeting();this._setIXTargeting();let a=()=>{this._setMcmpTargeting();this._setIXTargeting()};this._config.marmalade.rfDataProcessed.emitted?
a():this._config.marmalade.rfDataProcessed.on(()=>a())}_initializeMarmalade(){this._mcmp=this._config.marmalade.mcmp.filter(Lb);this._siteCodes=this._config.marmalade.siteCodes;this._filteredSiteCodes=this._config.marmalade.filteredSiteCodes;this._siteCodeObject=this._filteredSiteCodes.reduce((a,b)=>{a[b]="True";return a},{});this.init()}_getRfCodes(a){let b=[];if(a){let c=this._config.marmalade;[...c.rfMcmpCodes,...c.rfIabCodes].forEach(d=>{let e=d[0];d[1].includes(a)&&b.push(e)})}return b}_setMcmpTargeting(){let a=
this._getRfCodes("gam");this._gam.setTargeting({key:"mcmp",value:[...this._mcmp,...a]})}_setIXTargeting(){let a=this._getRfCodes("ix");var b=this._config.trackScroll.getTargetingValue();b=b?[b]:[];fd({MCMP:[...a,...this._mcmp,...b].join("#MCMP:"),...this._siteCodeObject},this._prebidMethods)}_setPageLevelTargeting(){this._slotManager.requestingBids.once(()=>{this._gam.setTargetingFlag("rf",[String(this._eventBus.recencyFrequencyDataSet.emitted)])});this._setMcmpTargeting();this._gam.setTargeting({key:"site_code",
value:this._siteCodes});this._gam.setTargeting({key:"marmalade",value:this._config.marmalade.loaded?"true":"false"})}_addDynamicSlots(){let a=this._marmaladeInjector.inject();a.forEach(b=>b.refreshInterval=0);if(0<a.length)this._gam.started.on(()=>this._slotManager.add(a).catch(b=>{A.error("MarmaladeComponent","init",b)}))}_addFlpMessaging(){let a=this._config.marmalade.flpProdIds.filter(Lb);a&&Ct(/https:\/\/\S*\.safeframe.googlesyndication.com/i,{message:"adthriveFlippData",flippData:a})}get enabled(){return!this._config.disableAds.all}};
Gl=q([v("MarmaladeComponent"),H(),t("design:paramtypes",[N,Fl,ja,V,ia,ob])],Gl);let Pf=class extends W{init(){this._key="MagniteCarbon";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Pf.prototype,"run",null);Pf=q([v("MagniteCarbonExperiment"),y()],Pf);let Hl=class extends T{constructor(a,b,c){super();this._magniteCarbonExperiment=a;this._prebidMethods=b;this._config=c;this.ANALYTICS_VERSION="v1.0";this.PROFILE_ID_KEY=
"carbon_ccuid";this.PROFILE_ID_COOKIE="ccuid";this.SESSION_ID_COOKIE="ccsid";this.DAY_MS=864E5;this.MINUTE_MS=6E4;this.PARENT_ID="8fea659f19";this.ANALYTICS_HOST="https://pb-ing.ccgateway.net";this.sessionId=this.profileId=this.pageViewId="";this._pageEngagement={ttl:60,count:0,id:0,startTime:0,timeLastEngage:0};this.auctionEndEventCount=0}async init(){this._pageEngagement.id=this._generateUUID();this._pageEngagement.startTime=Date.now();this._pageEngagement.timeLastEngage=Date.now();this.pageViewId=
this._generateUUID().toString();this.profileId=this._getProfileId();this.sessionId=this._getSessionId();let a=await this._createBaseEngagementEvent();this._sendEngagementEvent(a,"page_load");this._prebidMethods.onEvent("auctionEnd",()=>{void this._auctionEndEvent()});this._prebidMethods.onEvent("tcf2Enforcement",b=>{void this.tcf2EnforcementEvent(b)})}async tcf2EnforcementEvent(a){var b,c,d;if(0<(null===(b=a.storageBlocked)||void 0===b?void 0:b.length)||0<(null===(c=a.biddersBlocked)||void 0===c?
void 0:c.length)||0<(null===(d=a.analyticsBlocked)||void 0===d?void 0:d.length))this._registerEngagement(),b=await this._createBaseEngagementEvent(),b.tcf_events=a,this._sendEngagementEvent(b,"tcf_enforcement")}async _auctionEndEvent(){this.auctionEndEventCount++;if(1===this.auctionEndEventCount){this._registerEngagement();let a=await this._createBaseEngagementEvent();this._sendEngagementEvent(a,"auction_end")}this._prebidMethods.offEvent("auctionEnd",this._auctionEndEvent.bind(this))}async _createBaseEngagementEvent(){let a=
{profile_id:this.profileId,session_id:this.sessionId,pageview_id:this.pageViewId,engagement_id:this._pageEngagement.id,engagement_count:this._pageEngagement.count,engagement_ttl:this._pageEngagement.ttl,start_time:this._pageEngagement.startTime,end_time:Date.now(),script_id:window.location.host,url:window.location.href,referrer:document.referrer,consent:this._getConsentData()},b=await this.getExternalIds();a.external_ids=b;return a}_registerEngagement(){let a=Date.now(),b=(a-this._pageEngagement.timeLastEngage)/
1E3;this._pageEngagement.timeLastEngage=a;b<this._pageEngagement.ttl||(this._pageEngagement.count++,this._pageEngagement.startTime=a,this._pageEngagement.id=this._generateUUID())}handleGdprConsent(){"function"===typeof window.__tcfapi&&window.__tcfapi("getFullTCData",2,a=>{if(a&&a.tcString&&a.tcString.length)return a.tcString});return""}_getConsentData(){var a;let b=null!==(a=this._config.ccpa.privacyString)&&void 0!==a?a:"";return{gdpr_consent:this._config.gdpr.enabled?this.handleGdprConsent():"",
ccpa_consent:this._config.ccpa.required?b:""}}async getExternalIds(){let a={},b=[];await this._prebidMethods.waitForQueue().then(c=>{!0===c&&(b=this._prebidMethods.getUserIdsAsEids());b.forEach(d=>{d.source&&(null===d||void 0===d?0:d.uids.length)&&(a[d.source]=d.uids.map(e=>e.id))})});return a}_sendEngagementEvent(a,b){fetch(`${this.ANALYTICS_HOST}/${this.ANALYTICS_VERSION}/parent/${this.PARENT_ID}/engagement/trigger/${b}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",
body:JSON.stringify(a)}).then(c=>c.json()).then(c=>{try{this._updateProfileId(c)}catch(d){A.error("MagniteCarbonComponent","importScript","unable to parse API response")}}).catch(c=>A.error("MagniteCarbonComponent","importScript",c))}_updateProfileId(a){(null===a||void 0===a?0:a.update)&&""!=(null===a||void 0===a?void 0:a.id)&&(this.setCookie(this.PROFILE_ID_COOKIE,a.id,(new Date(Date.now()+89*this.DAY_MS)).toString(),"Lax"),U.setLocalStorageValue(this.PROFILE_ID_KEY,a.id,!1))}setCookie(a,b,c,d){document.cookie=
`${a}=${b}; SameSite=${d}; Secure; path=/; expires=${c}`}getCookie(a){return Na(a)}_getProfileId(){let a=(new Date(Date.now()+89*this.DAY_MS)).toUTCString();var b=U.getLocalStorageValue(this.PROFILE_ID_KEY);let c=this.getCookie(this.PROFILE_ID_COOKIE);if(b)return this.setCookie(this.PROFILE_ID_COOKIE,b,a,"Lax"),b;if(c)return U.setLocalStorageValue(this.PROFILE_ID_KEY,c,!1),c;b=this._generateUUID();U.setLocalStorageValue(this.PROFILE_ID_KEY,b,!1);this.setCookie(this.PROFILE_ID_COOKIE,b,a,"Lax");return b.toString()}_getSessionId(){let a=
(new Date(Date.now()+5*this.MINUTE_MS)).toUTCString();var b=this.getCookie(this.SESSION_ID_COOKIE);if(b&&""!=b)return this.setCookie(this.SESSION_ID_COOKIE,b,a,"Lax"),b;b=this._generateUUID();this.setCookie(this.SESSION_ID_COOKIE,b,a,"Lax");return b.toString()}_generateUUID(a){let b;b=window&&window.crypto&&void 0!==window.crypto.getRandomValues?crypto.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random();return a?(a^b>>a/4).toString(16):"10000000-1000-4000-8000-100000000000".replace(/[018]/g,
this._generateUUID)}get enabled(){return this._magniteCarbonExperiment.result}};Hl=q([v("MagniteCarbonComponent"),y(),t("design:paramtypes",[Pf,ia,N])],Hl);let Il=class extends W{init(){this._key="TopicsAPI";this._default=!1}isEnabled(){return super.isEnabled()&&gp()}};Il=q([v("TopicsAPIExperiment"),y()],Il);let Jl=class extends T{constructor(a,b,c,d){super();this._config=a;this._gam=b;this._browsingTopicsAPIExperiment=c;this._browsingTopicsAPIEventBus=d;this._topics=[];this._storageKey="browsing_topics";
this._topicsUrl=`https://${this._config.context.host}/api/v2/topics`}get enabled(){return!this._config.gdpr.enabled&&!this._config.ccpa.userOptedOut&&this._config.context.browsingTopicsSupported&&this._browsingTopicsAPIExperiment.result}get topics(){return this._topics}async start(){let a=await this.fetchTopics(),b=a.map(c=>`${c.id}`);0<b.length&&this._gam.setTargetingFlag("topicapi",b);this._topics=a;this._config.context.browsingTopics=a;this._browsingTopicsAPIEventBus.topicsReceived.emit(a)}async fetchTopics(){var a;
try{return null!==(a=(await (await window.fetch(`${this._topicsUrl}?ts=${Date.now()}`,{browsingTopics:!0})).json()).topics)&&void 0!==a?a:[]}catch(b){return[]}}async pollForTopics(){let a=await this.fetchTopics();return 0===a.length?(await Ce(15E3),this.pollForTopics()):a}};Jl=q([v("BrowsingTopicsAPIComponent"),H(),t("design:paramtypes",[N,V,Il,ld])],Jl);let Kl=class extends T{constructor(a,b,c){super();this._config=a;this._gam=b;this._prebidMethods=c;this._ownerUrl=`https://${this._config.context.host}`;
this._sellerUrl=`https://${this._config.context.privacySandboxHost}`;this._decisionLogicUrl=`https://${this._config.context.privacySandboxHost}/decision-logic.js`;this.bidderCodeList=[l.Rtbhouse,l.Triplelift,l.Pubmatic,l.OpenX,l.Criteo,l.IndexExchange]}get enabled(){return this._config.fledge.enabled}init(){this.enabled&&(this._gam.setTargeting({key:"fledge",value:"true"}),this._setPrebidFledgeBidderConfig())}_setPrebidFledgeBidderConfig(){this.bidderCodeList.forEach(a=>{let b={fledgeEnabled:!0,fledgeConfig:{}};
a===l.Rtbhouse&&(b.fledgeConfig={seller:this._sellerUrl,decisionLogicUrl:this._decisionLogicUrl,interestGroupBuyers:[this._ownerUrl,"https://grid-mercury.criteo.com","https://ads.optable.co"]});this._prebidMethods.setBidderConfig({bidders:[a],config:b},!0)})}};Kl=q([v("FledgeComponent"),y(),t("design:paramtypes",[N,V,ia])],Kl);let Ll=class{constructor(a,b,c,d,e,f,g){this._emailCaptureHandler=a;this._gdprEvents=b;this._config=c;this._gam=d;this._piiEventBus=e;this._hemSourceAllowlist=f;this._optableConfig=
g;this._consent=this._email="";this._hashObj={sha256Hash:"",sha1Hash:""};this._source="";this._shareWithPartners=!0;this._emailCounted=this._consentReceived=!1;this.piiCaptured=new L}init(){this._emailCaptureHandler.emailCaptured.on(a=>this._handleEmailCapture(a),{handleEventsAlreadyEmitted:!0});this._emailCaptureHandler.piiManagerReady.emit();this._gdprEvents.consentCaptured.on(a=>this._handleConsentCapture(a));this._config.ccpa.consentChange.on(a=>{this._handleCCPAConsentChange(a||"")})}_atLeastOneHashProvided(a){return Object.values(a).some(b=>
0<b.length)}async _handleEmailCapture(a){let {pii:{email:b,sha256Hash:c,sha1Hash:d,source:e},shareWithPartners:f}=a;c||d?this._hashObj={sha256Hash:c||"",sha1Hash:d||""}:b&&await this._hashEmail(b);this._email=b;this._source=e;this._shareWithPartners=f?f:this._shareBasedOnSource(e);this._config.gdpr.enabled&&!this._consentReceived||this._processPii()}_shareBasedOnSource(a){let b=this._hemSourceAllowlist.checkSource(a);return Bc(a)&&this._optableConfig.enabled?b&&this._optableConfig.useOptableHem:b}_handleConsentCapture(a){this._consentReceived=
!0;this._consent=a;(this._email||this._atLeastOneHashProvided(this._hashObj))&&this._processPii()}_processPii(){U.setLocalStorageValue("adt_emsrc",this._source,!1);U.setLocalStorageValue("adt_ei",this._hashObj,!1);this._gam.setTargetingFlag("emsrc",[this._source],!0);this._gam.setTargetingFlag("hem",["1"],!0);this._shareWithPartners&&(this._piiEventBus.dataCaptured.emit({email:this._email,...this._hashObj,consent:this._consent,source:this._source}),this._gam.setTargetingFlag("hem_shared",["1"],!0))}async _hashEmail(a){if(!("msCrypto"in
window)&&"https:"===location.protocol&&"crypto"in window&&"TextEncoder"in window){a=(new TextEncoder).encode(a);let [b,c]=await Promise.all([this._convertToSpecificHashType("SHA-256",a),this._convertToSpecificHashType("SHA-1",a)]);this._hashObj.sha256Hash=b;this._hashObj.sha1Hash=c}}async _convertToSpecificHashType(a,b){a=await crypto.subtle.digest(a,b);return Array.from(new Uint8Array(a)).map(c=>("00"+c.toString(16)).slice(-2)).join("")}_handleCCPAConsentChange(a=""){let b=U.getLocalStorageValue("adt_ei",
!1),c=U.getLocalStorageValue("adt_emsrc",!1);a=a===this._config.ccpa.ccpaOptOut;if(/Chrom|Applechromium/.test(Ca)){let d=ip("adt_ei"),e=ip("adt_emsrc");(d||e)&&a&&(jp("adt_ei"),jp("adt_emsrc"))}(b||c)&&a&&(U.removeLocalStorageValue("adt_ei",!1),U.removeLocalStorageValue("adt_emsrc",!1))}};Ll=q([v("PiiManager"),y(),t("design:paramtypes",[Ic,Tb,N,V,Db,zd,Pb])],Ll);let Ml=class extends Fb{constructor(a,b){super();this._prebidMethods=a;this._userIds=b;this._name="connectId";this._userId=this._userIds.get(this._name)}get enabled(){var a;
return null!==(a=this._userId&&this._userId.enabled)&&void 0!==a?a:!1}updateUserIds(){var a;return(null!==(a=this._prebidMethods.getConfig("userSync.userIds"))&&void 0!==a?a:[]).map(b=>{this._userId&&b.name===this._userId.id.name&&(b=this._userId.id);return b})}processPii(a){this._prebidMethods.addToQueue(()=>{this.run(a)})}run(a){this._userId&&a.sha256Hash&&this._userId.id.params&&(this._userId.id.params.he=a.sha256Hash,a=this.updateUserIds(),this._prebidMethods.setConfig({userSync:{userIds:a}}),
this._prebidMethods.refreshUserIds({submoduleNames:[this._userId.id.name]},()=>{}))}};Ml=q([v("YahooPiiPartner"),H(),t("design:paramtypes",[ia,xb])],Ml);let Nl=class extends Fb{constructor(a,b){super();this._prebidMethods=a;this._userIds=b;this._name="id5Id";this._userId=this._userIds.get(this._name)}get enabled(){var a;return null!==(a=this._userId&&this._userId.enabled)&&void 0!==a?a:!1}processPii(a){this._prebidMethods.addToQueue(()=>{this.run(a)})}updateUserIds(){var a;return(null!==(a=this._prebidMethods.getConfig("userSync.userIds"))&&
void 0!==a?a:[]).map(b=>{this._userId&&b.name===this._userId.id.name&&(b=this._userId.id);return b})}run(a){if(a.sha256Hash&&this._userId&&this._userId.id.params){let b=this.updateUserIds();Bc(a.source)||(a.sha256Hash&&this._userIds.sharedIdValue&&(a=btoa(`1=${a.sha256Hash}&5=${this._userIds.sharedIdValue}&12=${Ca}`),this._userId.id.params.pd=a),this._prebidMethods.setConfig({userSync:{userIds:b}}),this._prebidMethods.refreshUserIds({submoduleNames:[this._userId.id.name]},()=>{}))}}};Nl=q([H(),v("Id5PiiPartner"),
t("design:paramtypes",[ia,xb])],Nl);let Ol=class extends Fb{constructor(a,b){super();this._config=a;this._prebidMethods=b}get enabled(){let a=this._config.partners;return!(!a.display.get(l.Criteo)&&!a.video.get(l.Criteo))}processPii(a){this._prebidMethods.addToQueue(()=>{this.run(a)})}run(a){a&&a.sha256Hash&&this._prebidMethods.setBidderConfig({bidders:[l.Criteo],config:{ortb2:{user:{ext:{data:{eids:[{source:"cafemedia.com",uids:[{id:a.sha256Hash,atype:3,ext:{stype:"hemsha256"}}]}]}}}}}})}};Ol=q([H(),
v("CriteoBidderPiiPartner"),t("design:paramtypes",[N,ia])],Ol);let Pl=class extends Fb{constructor(a,b){super();this._prebidMethods=a;this._userIds=b;this._name="fabrickId";this._userId=this._userIds.get(this._name)}get enabled(){var a;return null!==(a=this._userId&&this._userId.enabled)&&void 0!==a?a:!1}processPii(a){this._prebidMethods.addToQueue(()=>{this._run(a)})}_run(a){var b,c=null!==(b=this._prebidMethods.getConfig("userSync.userIds"))&&void 0!==b?b:[];b=c.find(f=>f.name===this._name);c=c.filter(f=>
f.name!==this._name);let d=!!b,e=this._userId&&this._userId.id.params&&this._userId.id.params.hasOwnProperty("e");d&&!e&&(this._prebidMethods.setConfig({userSync:{userIds:[...c,{...b,params:{...(null===b||void 0===b?void 0:b.params),e:a.sha256Hash}}]}}),this._prebidMethods.refreshUserIds({submoduleNames:[this._name]},()=>{}))}};Pl=q([H(),v("FabrickPiiPartner"),t("design:paramtypes",[ia,xb])],Pl);let Ql=class extends Fb{constructor(a,b,c){super();this._optableConfig=a;this._optableSdkWrapper=b;this._userIds=
c;this._gpid=null}get enabled(){return this._optableConfig.enabled&&this._optableConfig.useOptableHem}processPii(a){var b;null!==(b=window.optable)&&void 0!==b&&b.auth&&a&&(this._isTrueDataSource(a.source)||this._populateDirectGraph(a))}_populateDirectGraph(a){a.sha256Hash&&void 0!==a.sha256Hash&&this._callIdentify(a.sha256Hash,this._retrieveGpid())}_callIdentify(a,b){this._optableSdkWrapper.identify("EMAIL",a,b).then(()=>{}).catch(c=>{})}_retrieveGpid(){var a,b,c,d=this._userIds.get("id5Id");if(d&&
(d=window.localStorage.getItem(null!==(c=null===(b=null===(a=d.id)||void 0===a?void 0:a.storage)||void 0===b?void 0:b.name)&&void 0!==c?c:"")))try{let e=JSON.parse(decodeURIComponent(d));if("gp"in e&&"string"===typeof e.gp)return e.gp}catch(e){}}_isTrueDataSource(a){return a&&a.includes("g_td")}};Ql=q([v("OptablePiiPartner"),H(),t("design:paramtypes",[Pb,Mp,xb])],Ql);let Rl=class extends Fb{constructor(a,b,c,d){super();this._config=a;this._events=b;this._prebidMethods=c;this._userIds=d;this._name=
"liveIntentId";this._userId=d.get(this._name);this._config.gdpr.enabled?this._events.consentCaptured.on(()=>this._pixelSync(!0)):this._pixelSync()}get enabled(){return this._userId&&this._userId.enabled||!1}_getGdprConsent(){let a="tcunavailable",b=0;"function"===typeof window.__tcfapi&&window.__tcfapi("getFullTCData",2,c=>{c&&c.tcString&&c.tcString.length&&(a=c.tcString,b=1)});return`&gdpr=${b}&gdpr_consent=${a}`}_pixelSync(a=!1){a=`https://pixel.rubiconproject.com/token?pid=49096${a?this._getGdprConsent():
""}${this._config.ccpa.required?`&us_privacy=${this._config.ccpa.privacyString}`:""}`;let b=new Image;b.src=a;b.style.display="none";b.alt="";document.body.appendChild(b)}processPii(a){this._prebidMethods.addToQueue(()=>{this.run(a)})}run(a){var b,c;let d=null===(b=window.liQ_instances)||void 0===b?void 0:b[0];b=!(null===d||void 0===d||!d.ready);let e=Bc(a.source);b&&!e&&a.sha256Hash&&this._userId&&this._userId.id.params&&(this._userId.id.params.emailHash=a.sha256Hash,b=this.updateUserIds(),this._prebidMethods.setConfig({userSync:{userIds:b}}),
this._prebidMethods.refreshUserIds({submoduleNames:[this._userId.id.name]},()=>{}),d.push({hash:null!==(c=a.sha256Hash)&&void 0!==c?c:""}))}updateUserIds(){var a;return(null!==(a=this._prebidMethods.getConfig("userSync.userIds"))&&void 0!==a?a:[]).map(b=>{this._userId&&b.name===this._userId.id.name&&(b=this._userId.id);return b})}};Rl=q([H(),v("LiveIntentPiiPartner"),t("design:paramtypes",[N,Tb,ia,xb])],Rl);let Qf=class extends W{init(){this._key="IdGraphUid2";this._default=!1}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Qf.prototype,"run",null);Qf=q([v("IdGraphUid2Experiment"),y()],Qf);let Sl=class extends Fb{constructor(a,b,c,d,e){super();this._config=a;this._storageHandler=b;this._prebidMethods=c;this._userIds=d;this._userIdEventBus=e;this._name="uid2";this._blocklist=["l_i"];this._userId=this._userIds.get(this._name);this._userIdEventBus.ttdServerTokenGenerated.on(f=>this.setUid2WithUpdatedToken(f))}get enabled(){var a;
return null!==(a=this._userId&&this._userId.enabled)&&void 0!==a?a:!1}setUid2WithUpdatedToken(a){if(a){var b=this._prebidMethods.getConfig("userSync.userIds");this.setUserIdsWithPrebid({userIds:b.map(c=>{c.name===this._name&&c.params&&(c.params.uid2Token=a);return c})});this._prebidMethods.refreshUserIds({submoduleNames:[this._name]},()=>{})}}setUserIdsWithPrebid(a){this._prebidMethods.setConfig({userSync:a})}processPii(a){this._prebidMethods.addToQueue(()=>{this.run(a)})}run(a){var b;let c=Bc(a.source),
d=!1;c&&(d=S.resolve(Qf).result);this._blocklist.some(e=>a.source.includes(e))||this._config.gdpr.enabled||!a.sha256Hash||c&&!d||this._config.uid2TokenCleanup.active||(null===(b=this._setTTDUId2ServerToken(a))||void 0===b?void 0:b.catch(()=>{}))}updateUserIds(){var a;return(null!==(a=this._prebidMethods.getConfig("userSync.userIds"))&&void 0!==a?a:[]).map(b=>{this._userId&&b.name===this._name&&(b=this._userId.id);return b})}async _setTTDUId2ServerToken(a){let b=this._storageHandler.getLocalStorageValue("__uid2_server_token",
!1),c=`https://ads.adthrive.com/api/v2/uid?format=email_hash&value=${a.sha256Hash}`;b||await new Promise((d,e)=>{fetch(c).then(f=>f.json().then(({body:g})=>{let h=JSON.stringify(g);this._storageHandler.getOrSetLocalStorageValue({key:"__uid2_server_token",adthriveKey:!1,rolling:!0,lowercase:!0},()=>h);this._userIdEventBus.ttdServerTokenGenerated.emit(g);d(g)})).catch(f=>{A.error("Uid2PiiPartner","_setTTDUId2ServerToken","Error",f);e()})})}};Sl=q([H(),v("Uid2PiiPartner"),t("design:paramtypes",[N,me,
ia,xb,Bh])],Sl);let Tl=class extends Fb{constructor(a,b,c){super();this._config=a;this._amazonMethods=b;this._bootstrapConfig=c;this._trackerHoldoutKey="amz";this._tokenKey="AMZN-Token";this._gdprEnabled=this._config.gdpr.enabled;this._userOptedOut=this._config.ccpa.userOptedOut}init(){this._regulatoryValidation()}get enabled(){return this._config.tkho.tracker!==this._trackerHoldoutKey}processPii(a){let b={...this._getHashedRecords(a.sha256Hash),...this._getGDPRConfig(a.consent),...this._getOptOut()};
oh().then(async()=>{await this._bootstrapConfig.bootstrapLoaders[Oa.Amazon];this._amazonMethods.rpa(b)})}_getHashedRecords(a=""){return{hashedRecords:[{type:"email",record:a}]}}_getGDPRConfig(a){let b=this._gdprEnabled;return{gdpr:{enabled:b,...(b&&{consent:a})}}}_getOptOut(){return{optOut:this._userOptedOut}}_regulatoryValidation(){Na(this._tokenKey)&&this._userOptedOut&&this._optOut()}_optOut(){this._amazonMethods.upa({hashedRecords:[],optOut:!0})}};Tl=q([v("AmazonPublisherAudiencesPiiPartner"),
H(),t("design:paramtypes",[N,ij,Fa])],Tl);let Ul=class extends T{constructor(a,b,c,d,e,f,g,h,k,m,n,p){super();this._config=a;this._piiManager=b;this._piiEventBus=c;this._partners=[d,e,f,g,h,k,m,n,p].filter(r=>r.enabled&&!this._config.context.isWordPressLogin);this._piiEventBus.dataCaptured.on(r=>{this._partners.forEach(w=>{w.processPii(r)})})}start(){this._partners.forEach(a=>a.init&&a.init());this._piiManager.init()}};Ul=q([v("PiiCaptureComponent"),H(),t("design:paramtypes",[N,Ll,Db,Tl,Ol,Pl,Nl,
Rl,rf,Ql,Ml,Sl])],Ul);let Vl=class extends T{constructor(a){super();this._slotManager=a;this._maxSlotRefreshCount=4}init(){this._slotManager.displaying.on(a=>{V.pushToQueue(()=>{a.forEach(b=>b.setTargeting({key:"refresh",value:"00"}));a.forEach(b=>b.setTargeting({key:"nref",value:"0"}))})});this._slotManager.refreshing.on(a=>{V.pushToQueue(()=>{for(let b of a){let c=`0${Math.min(b.refreshCount,this._maxSlotRefreshCount)}`.slice(-2);b.setTargeting({key:"refresh",value:c});b.setTargeting({key:"nref",
value:b.refreshCount.toString()})}})})}};Vl=q([v("RefreshCountComponent"),H(),t("design:paramtypes",[ja])],Vl);let Rf=class extends W{init(){this._key="RefreshRebuild";this._default=!0}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Rf.prototype,"run",null);Rf=q([v("RefreshRebuildExperiment"),y()],Rf);let Wl=class extends T{constructor(a,b){super();this._slotManager=a;this._refreshRebuildExperiment=b}init(){this._slotManager.refreshing.on(a=>
{a.filter(this.slotHasHighRefreshCountIncrement).forEach(b=>this._slotManager.rebuild(b))})}slotHasHighRefreshCountIncrement(a){return 0===a.refreshCount%100}get enabled(){return this._refreshRebuildExperiment.result}};Wl=q([v("RefreshRebuildComponent"),H(),t("design:paramtypes",[ja,Rf])],Wl);let Xl=class extends T{constructor(a,b,c){super();this._config=a;this._prebidMethods=b;this._googleAdManager=c;this._ids="adserver.org flashtalking.com neustar.biz pubmatic.com media.net rubiconproject.com liveintent.indexexchange.com openx.net liveintent.triplelift.com".split(" ")}init(){V.pushToQueue(()=>
{try{Object.keys(localStorage).filter(a=>a.startsWith("_GESPSK-")).forEach(a=>{if(a=localStorage.getItem(a))a=JSON.parse(a)[1],this._googleAdManager.setTargetingFlag("ssp_len",[a.length.toString()])})}catch(a){}this._prebidMethods.waitForQueue().then(a=>{if(!0===a){let b=this._mapIdsToEids();window.googletag.secureSignalProviders&&window.googletag.secureSignalProviders.push({networkCode:this._config.gam.networkCode,collectorFunction:async()=>{let c=(await this.fetchAsyncSignals(b)).obfuscate();this._googleAdManager.setTargetingFlag("ssp_len",
[c.length.toString()]);return c}})}})})}_mapIdsToEids(){return this._prebidMethods.getUserIdsAsEids().filter(a=>this._ids.includes(a.source)).map(a=>({source:a.source,data:a.uids[0].id,isPubCreated:!0}))}fetchAsyncSignals(a){return Promise.resolve({obfuscate:()=>btoa(JSON.stringify({signals:[...a,{source:"mcmp",data:this._config.marmalade.mcmp,isPubCreated:!0},{source:"sens",data:this._config.site.sensitiveCategories,isPubCreated:!0}]}))})}};Xl=q([v("SecureSignalsComponent"),H(),t("design:paramtypes",
[N,ia,V])],Xl);let Yl=class extends T{constructor(a,b,c,d,e,f,g,h,k,m,n){super();this._config=a;this._spaEventBus=b;this._slotManager=c;this._prebidActionManager=d;this._prebidMethods=e;this._singlePageAppManagerExperiment=f;this._dynamicAdsComponent=g;this._intersectionObserverManager=h;this._gam=k;this._adInjectionMap=m;this._bootstrapConfig=n;this._observerDebounceDuration=this._routeChangeBufferDuration=500;this._observerSettledDuration=1E3;this._lastContentMutationTimestamp=Infinity;this._lastHref=
document.location.href.split("#")[0];this._isTransitioning=!1}start(){this._addRouteChangeObserver();this._setupRouteChangeListener()}get enabled(){return this._singlePageAppManagerExperiment.result}_setupRouteChangeListener(){this._spaEventBus.routeChanged.on(a=>{this._handleRouteChange().catch(b=>{A.error("SinglePageAppManagerComponent","routeChanged",b);this._isTransitioning=!1})})}_resetStatefulEmitters(){gh.forEach(a=>{a.resetEmitted();a.resetOnces()})}async _handleRouteChange(){var a,b;let c=
()=>{const d=document.location.href.split("#")[0];return d&&d!==this._lastHref};this._isTransitioning=!0;this._config.disableAds.clear();this._intersectionObserverManager.unobserveAll(!1);this._adInjectionMap.reset();await Ce(this._routeChangeBufferDuration);if(c())throw Error("Handler canceled after route change buffer.");this._slotManager.removeAllElements();this._prebidActionManager.reset();this._prebidMethods.clearAllAuctions();this._slotManager.destroyAll();this._refreshPageviewKey();kd.resetTimeOrigin();
this._config.disableAds.init();this._config.context.sessionKey=this._config.context.setSessionKey();this._config.context.isFirstPageview=this._bootstrapConfig.checkIsFirstPageview();this._config.context.pageUrl=window.location.href;await this._waitForPageMutations();if(c())throw Error("Handler canceled after page settled.");this._resetStatefulEmitters();this._config.resetDynamicAds();null===(a=this._config.clsOptions)||void 0===a?void 0:a.injectedSlots.splice(0,this._config.clsOptions.injectedSlots.length);
null===(b=this._config.clsOptions)||void 0===b?void 0:b.injectedVideoSlots.splice(0,this._config.clsOptions.injectedVideoSlots.length);this._dynamicAdsComponent.start();this._spaEventBus.resetCompleted.emit();this._gam.setTargetingFlag("spa_rc",["1"]);this._isTransitioning=!1}_refreshPageviewKey(){let a=this._config.context.pageviewKey,b=Dc();this._config.context.pageviewKey=b;this._gam.setTargeting({key:"pvk",value:b});return a}_addRouteChangeObserver(){document.body?(new MutationObserver(In(a=>
{const b=document.location.href.split("#")[0];if(b&&this._lastHref!==b){try{this._spaEventBus.routeChanged.emit({to:b,from:this._lastHref})}catch(c){A.error.call(A,"SinglePageAppManagerComponent","_addRouteChangeObserver",'Error while emitting "routeChanged" event',c instanceof Error?c.message:String(c))}this._lastHref=b}else this._isTransitioning&&this._hasPageContentMutated(a)&&(this._lastContentMutationTimestamp=Date.now())},this._observerDebounceDuration,{leading:!0}))).observe(document.body,
{childList:!0,subtree:!0,attributes:!0}):A.error("SinglePageAppManagerComponent","_addRouteChangeObserver","DOM is not ready")}async _waitForPageMutations(){try{return await xh({condition:()=>Date.now()-this._lastContentMutationTimestamp>this._observerSettledDuration})}catch(a){}}_hasPageContentMutated(a){return a.some(b=>{let c="childList"===b.type,d=0<b.addedNodes.length||0<b.removedNodes.length;b=b.target;b=(null===b||void 0===b?void 0:b.id.includes("AdThrive_"))||(null===b||void 0===b?void 0:
b.id.includes("google_ad"));return c&&d&&!b})}};Yl=q([v("SinglePageAppManagerComponent"),H(),t("design:paramtypes",[N,Pa,ja,Qc,ia,Sc,If,vd,V,nc,Fa])],Yl);let Zl=class extends T{constructor(a){super();this._singlePageAppManagerExperiment=a}start(){window.camAddRouteObserver&&window.camAddRouteObserver()}get enabled(){return!this._singlePageAppManagerExperiment.result}};Zl=q([v("CamSinglePageAppManagerComponent"),H(),t("design:paramtypes",[Sc])],Zl);let $l=class extends T{constructor(a){super();this._config=
a}start(){if(this._config.site.style&&0<this._config.site.style.length)Ab(this._config.site.style);else if(this._config.context.styleUrl){var a=this._config.context.styleUrl;const b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=a;document.head.appendChild(b)}}};$l=q([v("SiteStyleComponent"),H(),t("design:paramtypes",[N])],$l);let am=class extends T{constructor(a,b){super();this._gam=a;this._config=b}init(){let a=this.getReferrer();null!==a&&this._gam.setTargeting({key:"doc_ref",
value:a})}getReferrer(){let a=xe(this._config.context.savedReferrer);a&&a.length&&U.setLocalStorageValue("referrer",a);return a}};am=q([v("TrafficSourceComponent"),H(),t("design:paramtypes",[V,N])],am);let bm=class extends T{constructor(a,b){super();this._config=a;this._gam=b}init(){let a=Q(U.getLocalStorageValue("utm",!0,!0,18E5),{});["utm_medium","utm_campaign","utm_session","utm_source"].forEach(b=>{var c=this._config.context.querystring.get(b);c=Q(c,a[b]);this._gam.setTargeting({key:b,value:c});
c&&(a[b]=c)});U.setLocalStorageValue("utm",a)}};bm=q([v("UTMComponent"),H(),t("design:paramtypes",[N,V])],bm);class Fu{constructor(){}init(a){this.setup(a)}}let cm=class extends X{init(){this._key="TearDownPlayer"}};cm=q([v("TearDownPlayerExperiment"),y()],cm);let Jd=class extends Ch{constructor(a,b){super();this._siteExperiments=a;this._pubabgroup=b;this._positions="bottom-left bottom-right bottom-center top-left top-right top-center".split(" ");this._choices=[];this._mappedChoices=[];this._resultValidator=
c=>this._positions.includes(c);this._result="control";this.key=bb.MobileStickyPlayerPosition;this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){return super.run()}setExperimentTargeting(){if(this.enabled&&this.experimentConfig&&this._isValidResult(this._result)){var a=`${this.experimentConfig.key.toLowerCase()}-${this.experimentConfig.id}`;
this._pubabgroup.set(a,`${this._result}`)}else A.error("MobileStickyPlayerPositionSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result")}_mapChoices(){return this._choices.map(({weight:a,value:b})=>({weight:a,choice:String(b)}))}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Jd.prototype,"run",null);Jd=q([y(),t("design:paramtypes",[vb,pb])],Jd);let dm=class extends W{init(){this._key=
"MidrollBugFixExperiment";this._default=!1}};dm=q([v("MidrollBugFixExperiment"),y()],dm);let em=class{logEvents(a,b){this._logPlayerPlayEvents(a,b);this._logPlayerPauseEvents(a,b);this._logPlayerMuteEvents(a,b);this._logPlayerVolumeEvents(a,b);this._logPlayerSeekEvents(a,b)}_logPlayerPlayEvents(a,b){a.on("play",c=>this._onPlayerPlayEvent(c,b))}_logPlayerPauseEvents(a,b){a.on("pause",c=>this._onPlayerPauseEvent(c,b))}_logPlayerMuteEvents(a,b){a.on("mute",c=>this._onPlayerMuteEvent(c,b))}_logPlayerVolumeEvents(a,
b){a.on("volume",c=>this._onPlayerVolumeEvent(c,b))}_logPlayerSeekEvents(a,b){a.on("seek",c=>this._onPlayerSeekEvent(c,b))}_onPlayerPlayEvent(a,b){"interaction"===a.playReason&&A.event("JwPlayer","play",b)}_onPlayerPauseEvent(a,b){"interaction"===a.pauseReason&&A.event("JwPlayer","pause",b)}_onPlayerMuteEvent(a,b){A.event("JwPlayer","mute",{mute:a.mute,...b})}_onPlayerVolumeEvent(a,b){}_onPlayerSeekEvent(a,b){}};em=q([y()],em);let fm=class extends X{init(){this._key="InstreamRerequestOnError_2"}};
fm=q([v("InstreamRerequestOnError_2"),y()],fm);let Sf=class extends W{init(){this._key="ReducedVideoPlayerSize";this._default=!1}};Sf=q([v("ReducedVideoPlayerSizeExperiment"),y()],Sf);class yq extends Fu{constructor(a,b=1,c,d,e,f,g,h,k="adthrive-collapse-float",m,n,p,r,w,z,x,B,E){var C;super();this._playerId=a;this._mediaIdCount=b;this._playlistId=c;this._name=d;this._size=e;this._pageElement=f;this._eventProxy=g;this._config=h;this._collapseType=k;this._collapseMobileSizeType=m;this._prebidMethods=
n;this._auctionManagers=p;this._playerType=r;this._isCollapsible=w;this._desktopCollapseOnScrollUp=z;this._mobileCollapseOnScrollUp=x;this._saveVideoCloseState=B;this._mobileLocation=E;this.initialAuctionPlayer=!1;this.prerollNum=0;this.imaVersion=this.jwVersion="";this._lastAdSuccessful=!0;this._retryAttempts=0;this._playlistMaxRetries=4;this._relatedPlayerMaxRetries=2;this._erroredOutAdIds=new Set;this.requestVideoBids=()=>{throw Error("Request video bids not set");};this.buildVideoUrl=()=>{throw Error("Build video url not set");
};this.setPlayerInstance=()=>{throw Error("Reset player not set");};this.waitForConsent=()=>{throw Error("Wait for consent not set");};this.collapseCollection=null;this._defaults={};this._state=0;this._adDurationLogged=this._nextAdFetched=!1;this._isFirstPlay=!0;this._wasClicked=this._calledNextVideo=this._createdSkipContainer=!1;this._canSkip=!0;this._isAdvancePlaylist=!1;this._additionalAdFields=this._adDetails=null;this._tearDownAfterNextAd=this._canTearDown=!1;this._tearDownTimer=null;this._tearDownPlayerTimeout=
0;this._stalePlayerTimer=null;this._currentAdDurationWithBuffer=this._currentAdTime=0;this._adTimingBuffer=10;this._defaultAdDuration=30;this._autoplayBehaviorConfig={mute:!0};this._topBackgroundElement=null;this._bidMarkedOnCurrentAd=this._hasPreviouslyCollapsed=!1;this._baseConfig={advertising:{adscheduleid:"DmULPHgQ",client:"googima",maxRedirects:this._config.video.maxRedirect,requestTimeout:this._config.video.jwRequestTimeout,vastLoadTimeout:this._config.video.vastTimeoutISV,vpaidmode:"insecure",
vpaidcontrols:!0},generateSEOMetadata:!0,preload:"metadata"};this._spaListeners=[];this._transactionId="";this._userIdTargetingData=[];this._pendingBidRequests=[];this._adPlayMap=new Map;this._mediaOrPlaylistId="nf";this._adHasPlayed=!1;this._hiddenClassName="adthrive-player-hidden";this._shouldPlayAd=()=>!this._adPlayMap.get(this.prerollNum)&&(!this._midrollBugFixExperiment.result||!this._adHasPlayed);this._runAdPlay=(I=!0)=>{let F=this.buildVideoUrl(this);this.playerInstance._nonLinearAd=!1;this.playerInstance.playAd(F);
this._adPlayMap.set(this.prerollNum,!0);I&&this._resetAdVars();this._adHasPlayed=!0};this._instreamRerequestOnErrorResult=S.resolve(fm).result;S.resolve(Pa).routeChanged.on(()=>{this._spaListeners.forEach(I=>I());this._spaListeners.length=0});this._maxRetries="playlist"===this._playerType?this._playlistMaxRetries:this._relatedPlayerMaxRetries;this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager();this._topCenterMobileBackgroundCoreExperiment=S.resolve(Tc);this._reducedVideoPlayerSizeExperiment=
S.resolve(Sf);this._mobileStickyPlayerPositionSiteExperiment=S.resolve(Jd);this._midrollBugFixExperiment=S.resolve(dm);this._videoCloseButtonComponent=S.resolve(Id);window.matchMedia&&(a=window.matchMedia(`only screen and (max-width: ${this._config.site.breakpoints.desktop-1}px)`),a.addListener(this._handleWidthBreak.bind(this)),this._handleWidthBreak(a));a=this._config.video.advancePlaylist;this._isAdvancePlaylist="playlist"===this._playerType?a.playlistPlayer.enabled:a.relatedPlayer.enabled;if("related"!==
this._playerType||this._isCollapsible&&a)this._tearDownPlayerTimeout=null!==(C=S.resolve(cm).result)&&void 0!==C?C:0,this._canTearDown=0!==this._tearDownPlayerTimeout&&-1!==this._tearDownPlayerTimeout;this._userIdComponent=S.resolve(Pc)}get name(){return`${this._name}`}get collapsible(){return this._isCollapsible}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}get playerContainer(){return this._playerContainer}get playerContainerId(){return`${this._playlistId}_${this._mediaIdCount}`}get playerElement(){return this._playerElement}get size(){return this._size}set videoAdUnit(a){this._videoAdUnit=
a}get videoAdUnit(){return this._videoAdUnit}getJwBoostTargeting(){return{playerID:this._playlistId,...((this.name===M.Video_In_Post_ClicktoPlay_SoundOn||this.name===M.Video_Individual_Autoplay_SOff)&&{mediaID:this._playlistId})}}get transactionId(){return this._transactionId}set transactionId(a){this._transactionId=a}set userIdTargetingData(a){this._userIdTargetingData=a}get userIdTargetingData(){return this._userIdTargetingData}get vp(){return 1>=this.prerollNum?this.prerollNum:9>=this.prerollNum?
2:3}get isPlayerType(){return this._playerType}init(){this.setup()}getDefaults(){return this._defaults}setDefaults(a){this._defaults=a}_createCollapsibleCollection(a){let {playerElement:b,playerContainer:c,footerElement:d,stickyElement:e,mobileHeaderSelector:f}=a;this.collapseCollection={playerInstance:this.playerInstance,playerType:this._playerType,playerState:this._state,playerContainer:c,playerElement:b,playerSizeExperiment:this._reducedVideoPlayerSizeExperiment.result,topBackgroundElement:this._topBackgroundElement,
footerElement:d,stickyElement:e,closeButton:this._closeButton,forceMobile:"desktop"!==this._config.context.device,collapseType:this._collapseType,collapseMobileSizeType:this._collapseMobileSizeType,collapseSubType:"adthrive-collapse-bottom-right",collapseMobileSubType:this._getCollapseMobileSubType(),mobileHeaderSelector:f,collapseTimer:{timeCollapsed:0,isRunning:!1},mediaStarted:!1,desktopCollapseOnScrollUp:this._desktopCollapseOnScrollUp,mobileCollapseOnScrollUp:this._mobileCollapseOnScrollUp,hasPreviouslyCollapsed:this._hasPreviouslyCollapsed}}_resetAdVars(){this._bidMarkedOnCurrentAd=
!1;this._adDetails=null;this._adDurationLogged=this._nextAdFetched=!1;this._currentAdDurationWithBuffer=this._currentAdTime=0;this._pendingBidRequests.length=0;this._clearStaleTimers();this._lastAdSuccessful=!0;this._retryAttempts=0}async _handleNextAdFetch(){this._nextAdFetched||(this._nextAdFetched=!0,this.prerollNum++,await this._fetchBids(),0<this._pendingBidRequests.length&&this._pendingBidRequests[0].then(()=>{void this._fetchBids()}).catch(()=>{}))}async _inViewPlay(){let a=this._config.gdpr;
!a.consentCaptured&&a.enabled&&await this.waitForConsent();await this._fetchBids();void this._triggerAdPlay()}_setPlayerVersions(){let a=this.playerInstance,b=/^[0-9]+.[0-9]+.[0-9]+/.exec(a.version);this.jwVersion=b&&b[0];this.imaVersion=a.plugins&&a.plugins.googima&&a.plugins.googima.version}_getPlayerVersions(){return{imaSDKVersion:this.imaVersion,jwVersion:this.jwVersion}}async _fetchBids(){if(2>this._pendingBidRequests.length){let a=this.requestVideoBids([this]);a&&(this._pendingBidRequests.push(a),
await a)}}_playerReady(a){this._startTearDownTimer();this._configureQuality();this._setPlayerVersions()}_jwSetup(a){a={...this._defaults,...this._baseConfig,...a};if(this.playerInstance.setup)try{this.playerInstance.setup(a),this._handleNonLinearAd(),this._setupEventListeners()}catch(b){A.error("InstreamPlayer","jwSetup","Unexpected issue while setting up JWPlayer",{playerId:this._playerId,err:b})}else A.error("InstreamPlayer","jwSetup","Unexpected issue while setting up JWPlayer",{playerId:this._playerId})}_handleNonLinearAd(){this.playerInstance.on("adImpression",
a=>{var b=Cb(a.ima,"ad")?a.ima.ad:null;if((b=this._getAdDetailsFromAd(b))&&Cb(b,"linear")&&!1===b.linear||"nonlinear"===a.linear){this.playerInstance._nonLinearAd=!0;this.playerInstance.pause();a=document.getElementById(`${this._playlistId}`);let c=a.querySelector("div > div.jw-overlays.jw-reset");c.style.backgroundColor="black";let d=a.querySelector("div.jw-wrapper.jw-reset > div.jw-controls.jw-reset");d.style.zIndex="-1";this.playerInstance.once("adComplete",()=>{this.playerInstance._nonLinearAd=
!1;c.style.backgroundColor="transparent";d.style.zIndex="";this.playerInstance.play()})}})}async _handleScroll(){let a=this._config.gdpr;!a.consentCaptured&&a.enabled&&await this.waitForConsent();this.collapseCollection&&(this._isFirstPlay&&await this._fetchBids(),xa.handleScroll(this.collapseCollection))}_handleResize(){this.collapseCollection&&xa.handleResize(this.collapseCollection)}_handlePageVisibilityChange(a){this.collapseCollection&&xa.handlePageVisibilityChange(a,this.collapseCollection)}_displayCloseButton(){this.collapseCollection&&
xa.displayCloseButton(this.collapseCollection)}_onCloseClick(){this.collapseCollection&&(this._saveVideoCloseState&&U.setLocalStorageValue("video_closed",!0),xa.handleClose(this.collapseCollection))}_handleUserClick(){this.collapseCollection&&xa.handleUserClick(this.collapseCollection)}_handleWidthBreak(a){this.collapseCollection&&xa.handleWidthBreak(a,this.collapseCollection)}_handleVideoPlayingEvent({playerId:a,mediaIdCount:b}){if(a!==this._playlistId||b!==this._mediaIdCount)this.collapseCollection?
xa.handleOtherVideoPlaying(this.collapseCollection):this.playerInstance.pause(!0)}_handleTitleClick(a){this.collapseCollection.collapseTimer.firstInView&&A.event("jw-player","handleTitleClick",{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:a.currentTarget.getAttribute("href")})}_handleFooterRefreshedEvent(){this.collapseCollection&&xa.repositionCollapseMobileBottom(this.collapseCollection)}_configureQuality(){if(!Ta())this.playerInstance.on("levels",a=>{this.playerInstance.setCurrentQuality(a.levels.length-
1)})}_createPlayerCloseButton(){let a=this._wrapperTitleWrapperElement||this._videoTitleElement;return this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._onCloseClick.bind(this),"instream","adthrive-collapse-close",!!a,this._isTopCollapse)}_createPlayerCollapseBackgroundElement(){let a=document.createElement("div");a.classList.add("adthrive-collapse-mobile-background");a.style.width=`${window.innerWidth}px`;a.style.display="inline";a.style.height="0";return a}_createLinkIcon(a){let b=
document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width","24");b.setAttribute("height","24");b.setAttribute("style","vertical-align: top;");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5");c.setAttribute("stroke","white");c.setAttribute("stroke-width","2");c.setAttribute("stroke-linejoin","round");b.appendChild(c);
b.id=`${a}-svg-link`;return b}_createLearnMoreLink(a){let b=document.createElement("a");b.classList.add("adthrive-learn-more-link");b.innerText="Tap here to learn more.";b.id=`${a}-learn-more-link`;return b}_createPlayerWrapper(a){a?(this._wrapperTitleWrapperElement=document.createElement("a"),a=this._createLinkIcon(this._playlistId),this._wrapperTitleWrapperElement.appendChild(a)):this._wrapperTitleWrapperElement=document.createElement("div");this._videoTitleElement=document.createElement("span");
a=document.createElement("div");let b=document.createElement("div");b.className="adthrive-wrapper-title-wrapper";this._videoTitleElement.classList.add("adthrive-video-text-cutoff");this._videoTitleElement.classList.add("adthrive-video-title");this._wrapperTitleWrapperElement.className="adthrive-video-text-cutoff";this._wrapperTitleWrapperElement.appendChild(this._videoTitleElement);this._wrapperTitleWrapperElement.target="_blank";this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this);
this._closeButton=this._createPlayerCloseButton();b.appendChild(this._wrapperTitleWrapperElement);a.className="adthrive-wrapper-bar";a.appendChild(b);a.appendChild(this._closeButton);return a}_createTopCollapseWrapper(a=!0){let b=document.createElement("div");b.className="adthrive-top-collapse-wrapper-bar";this._closeButton=this._createPlayerCloseButton();var c=document.createElement("div");c.style.minHeight="33px";c.appendChild(this._closeButton);b.appendChild(c);c=document.createElement("a");this._topCollapseVideoTitleElement=
document.createElement("span");this._topCollapseVideoTitleElement.classList.add("adthrive-top-collapse-wrapper-video-title");let d=this._topCenterMobileBackgroundCoreExperiment.buttonTitleColor;d&&(this._topCollapseVideoTitleElement.style.color=d);c.appendChild(this._topCollapseVideoTitleElement);a&&(a=this._createLearnMoreLink(this._playlistId),c.appendChild(a),c.onclick=this._handleTitleClick.bind(this));b.appendChild(c);this._wrapperText=c;return b}_trimEventData(a){var b,c;a={...a};let d=a.ima&&
a.ima.ad&&this._getAdDetailsFromAd(a.ima.ad);(null===a||void 0===a?0:a.tag)&&delete a.tag;d&&d.traffickingParameters&&delete d.traffickingParameters;(null===(c=null===(b=null===a||void 0===a?void 0:a.ima)||void 0===b?void 0:b.userRequestContext)||void 0===c?0:c.adTagUrl)&&delete a.ima.userRequestContext.adTagUrl;(null===a||void 0===a?0:a.mediaFile)&&delete a.mediaFile;return a}_handleNextButton(){this._calledNextVideo=!0;this._removeSkipContainer();this._isAdvancePlaylist&&1===this.playerInstance.getPlaylist().length?
(this.playerInstance.pause(),this.playerInstance.seek(0),this._adHasPlayed=!1,this.playerInstance.once("firstFrame",()=>{void this._triggerAdPlay()}),this.playerInstance.trigger("firstFrame",{loadTime:0,viewable:1})):this.playerInstance.next()}_createNavButton(a){let b=document.createElement("div");b.id=`${a}-video`;b.textContent=a.charAt(0).toUpperCase()+a.slice(1);we(15)||we(16)||qp()||b.classList.add("video-box-shadow");return b}_createSkipContainer(){let a=document.createElement("div");a.id="next-stay-container";
let b=this._createNavButton("next");b.onclick=this._handleNextButton.bind(this);a.appendChild(b);a.appendChild(this._createNavButton("stay"));return a}_initSkipContainer(){this.playerInstance.on("time",({position:a,duration:b})=>{if(!(!this._canSkip||this.playerInstance._nonLinearAd||this._wasClicked||5>b)){var c=40>b,d=c?a>=b-5:25<=a,e=c?a>=b:30<=a;!this._createdSkipContainer&&(c?a>=b:20<=a)&&void this._handleNextAdFetch();!this._createdSkipContainer&&d?(this._createdSkipContainer=!0,this._skipContainer=
this._createSkipContainer(),this.playerInstance.getContainer().appendChild(this._skipContainer),getComputedStyle(this._skipContainer).backgroundColor&&this._skipContainer.classList.add("loaded")):this._createdSkipContainer&&!this._calledNextVideo&&e&&this._handleNextButton()}})}_handleVideoPlayerClicked(){this._wasClicked=!0;this._removeSkipContainer()}_removeSkipContainer(){var a,b;null===(b=null===(a=this._skipContainer)||void 0===a?void 0:a.parentNode)||void 0===b?void 0:b.removeChild(this._skipContainer);
this._skipContainer=void 0}_handleFirstFrame(){this._wasClicked=this._createdSkipContainer=this._calledNextVideo=!1}_getCollapseMobileSubType(){return this._mobileStickyPlayerPositionSiteExperiment.enabled&&"control"!==this._mobileStickyPlayerPositionSiteExperiment.result?ua.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._mobileLocation}get _isTopCollapse(){return"adthrive-collapse-top-center"===this._getCollapseMobileSubType()}isTopCenterCollapse(){return"adthrive-collapse-mobile"===
this._collapseType&&this._isTopCollapse}_createTopCenterBackground(a){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement();let b=this._topCenterMobileBackgroundCoreExperiment.backgroundColor;b&&(this._topBackgroundElement.style.backgroundColor=b);a.appendChild(this._topBackgroundElement)}_clearStaleTimers(){this._stalePlayerTimer&&(clearTimeout(this._stalePlayerTimer),this._stalePlayerTimer=null)}_listenForLargeVastError(){this._prebidMethods.onEvent("vastExceededLimit",a=>{A.error("JwPlayer",
"listenForLargeVastError",{meta:a.bids[0].meta,bidder:a.bids[0].bidder,adId:a.bids[0].adId,creativeId:a.bids[0].creativeId,responseSize:a.responseSize,maxSizeAllowed:a.maxSizeAllowed})})}_getErrorLogAdDetails(){return(({wrapperIds:a,wrapperCreativeIds:b,wrapperSystems:c,vastCreativeId:d,mediaFileURL:e,adId:f,adUnitName:g,adomain:h,hb_bidder:k,amznp:m,hb_pb:n,hb_crid:p,amznbid:r,hb_deal:w})=>({wrapperIds:a,wrapperCreativeIds:b,wrapperSystems:c,vastCreativeId:d,mediaFileURL:e,adId:f,adUnitName:g,adomain:h&&
encodeURIComponent(h),hb_bidder:k,amznp:m,hb_pb:n,hb_crid:p,amznbid:r,hb_deal:w}))(this._adDetails||{})}_setStaleAdDetection(){let a=this._currentAdDurationWithBuffer-this._currentAdTime;this._stalePlayerTimer||(this._stalePlayerTimer=window.setTimeout(()=>{-1===this._tearDownPlayerTimeout?(this._enableTearDown(),this._tearDownPlayer()):this.playerInstance.playlistItem(this.playerInstance.getPlaylistIndex())},1E3*a))}_getJwEventLog(a){return{playerName:this._name,rawData:this._trimEventData(a)}}_tearDownPlayer(){this._tearDownAfterNextAd&&
(this._tearDownAfterNextAd=!1,this._tearDownTimer&&clearTimeout(this._tearDownTimer),this.playerInstance.remove(),this.setPlayerInstance(this),void this._handleScroll(),this._adPlayMap=new Map,this._adHasPlayed=!1)}_enableTearDown(){this._tearDownAfterNextAd=!0}_startTearDownTimer(){let a=this._tearDownPlayerTimeout;this._canTearDown&&(this._tearDownTimer=window.setTimeout(this._enableTearDown.bind(this),a))}_excludedErroredOutAdIdsFromGamAuction(){this.name&&this._prebidMethods.getBidResponsesForAdUnitCode(this.name).bids.forEach(a=>
{this._erroredOutAdIds.has(a.adId)&&this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:a.adId})})}_handleErrors(){["adError","setupError","error"].forEach(a=>{this._bidMarkedOnCurrentAd=!1;let b="adError"===a;this.playerInstance.on(a,c=>{this._clearStaleTimers();if(!this._adDetails){let d="tag"in c&&c.tag||"";this._addAdDetailFields(d);this._adDetails={...this._additionalAdFields,adUnitName:this._name,tag:d,isEmpty:!0}}900===c.code&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails);
"setupError"===a&&this._preventCollapse();A.error("JwPlayer",a,{code:c.code,...(b&&{message:c.message,adErrorCode:c.adErrorCode}),...this._getJwEventLog(c)});"adError"===a&&(this._checkRenderedAdDetails(),this._adDetails.adId&&this._erroredOutAdIds.add(this._adDetails.adId),this._lastAdSuccessful=!1,c={message:c.message,code:c.code,adErrorCode:c.adErrorCode,...this._getPlayerVersions(),...this._getErrorLogAdDetails()},A.error("JwPlayer","vastError",c),void this._adFailedLogic())})})}_handleTimeEvents(){this.playerInstance.on("beforeComplete",
()=>{this._resetAdVars();this.playerInstance._nonLinearAd=!1});this.playerInstance.on("time",({position:a,duration:b})=>{10>b-a&&void this._handleNextAdFetch()});this.playerInstance.on("adTime",a=>{this._currentAdTime=a.position;this._config.video.logAdDuration&&!this._adDurationLogged&&(A.event("VideoManager","VideoAdDuration",{adDuration:a.duration,roundedAdDuration:Math.round(a.duration)}),this._adDurationLogged=!0)});this.playerInstance.on("adComplete",()=>{this._tearDownPlayer()})}async _triggerAdPlay(){let a=
this._config.gdpr;!a.consentCaptured&&a.enabled&&await this.waitForConsent();this._shouldPlayAd()&&(void this._playLinearAd(),this._isFirstPlay=!1)}_handleVideoEvents(){this.playerInstance.on("playlistItem",({item:a})=>{var b;this._mediaOrPlaylistId=null!==(b=a.mediaid)&&void 0!==b?b:"nf";this._adHasPlayed=!1});["play","adPlay","pause","adSkipped","adPause"].forEach(a=>{let b="play"===a,c="adPlay"===a,d="pause"===a,e="adPause"===a,f="adSkipped"===a;this.playerInstance.on(a,g=>{if(b||e||f)if(this._clearStaleTimers(),
e)this.playerInstance.once("adPlay",()=>{0!==this._currentAdTime&&this._setStaleAdDetection()});if(b||c)this._eventProxy.emitVideoPlayingEvent(this._playlistId,this._mediaIdCount),c&&this._checkRenderedAdDetails();(b||d)&&(g="pauseReason"in g&&g.pauseReason||"playReason"in g&&g.playReason&&!this._calledNextVideo)&&"interaction"===g&&this._handleUserClick()});if((b||c)&&this.collapseCollection)this.playerInstance.once(a,()=>{this.collapseCollection.mediaStarted=!0;void this._handleScroll()})});this.playerInstance.on("beforePlay",
()=>{this._shouldPlayAd()&&this.playerInstance.pause();void this._triggerAdPlay()});document.addEventListener("slick-auth-dialog-opened",()=>{this._playerElement.classList.add(this._hiddenClassName);this.collapseCollection&&this.playerInstance.pause()});document.addEventListener("slick-auth-dialog-closed",()=>{var a;this._playerElement.classList.remove(this._hiddenClassName);let b=4!==(null===(a=this.collapseCollection)||void 0===a?void 0:a.playerState);this.collapseCollection&&b&&this.playerInstance.play(!0)})}_checkRenderedAdDetails(){let a=
this._prebidAuctionManager,b=this._adDetails;a&&b&&!this._bidMarkedOnCurrentAd&&this._markPrebidBidAsUsed(b.gamCreativeId,a,b.wrapperSystems)}_markPrebidBidAsUsed(a="",b,c=[]){b=a&&b.videoCreativeIdMapping.get(a);let d=!1,e=!1,f=!1;c.forEach(g=>{g=g.toLowerCase();"gdfp"===g&&(e=!0);"prebid.org wrapper"===g?d=!0:"amazon"===g&&(f=!0)});if(b){if(a=this._adDetails,a=(a&&a.tag&&this._getCustParamsFromQueryString(a.tag)||{})[`hb_adid_${b}`.substring(0,20)])this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,
adId:a}),this._bidMarkedOnCurrentAd=!0}else a||!(d||e&&!f)&&c.length||(this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name}))}_getCustParamsFromQueryString(a){return(a=(a=a&&jc(a.split("?")[1]))&&a.get("cust_params"))&&ph(this._getDecodedURI(a))}_getDecodedURI(a){try{return decodeURIComponent(a)}catch(b){return""}}_getAdDetailsFromAd(a){return a&&0<Object.keys(a).length?a[Object.keys(a)[0]]:null}_handleAdTrackingEvents(){this.playerInstance.on("adLoaded",a=>
{let b=a.ima&&a.ima.ad&&this._getAdDetailsFromAd(a.ima.ad);this._currentAdDurationWithBuffer=(b&&b.duration||a.duration||this._defaultAdDuration)+this._adTimingBuffer;let c=a.tag;b&&(this._addAdDetailFields(c),this._adDetails={...this._additionalAdFields,wrapperIds:b.adWrapperIds,gamCreativeId:b.adWrapperCreativeIds[b.adWrapperCreativeIds.length-1],gamLineItemId:b.adWrapperIds[b.adWrapperIds.length-1],wrapperCreativeIds:b.adWrapperCreativeIds,vastCreativeId:b.creativeId,mediaFileURL:b.mediaUrl,adUnitName:this._name,
tag:a.tag,isEmpty:!1,wrapperSystems:b.adWrapperSystems});this._setStaleAdDetection()});this.playerInstance.on("adImpression",()=>{this._lastAdSuccessful=!0;this._retryAttempts=0;this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails||{})});this._config.video.logAdLifeCycle&&["adRequest","adImpression","adStarted","adViewableImpression"].forEach(a=>{this.playerInstance.on(a,b=>{"adImpression"===a&&A.event("JwPlayer","adImpression",this._getJwEventLog(b))})})}async _adFailedLogic(){let a="vpr"===
this._instreamRerequestOnErrorResult&&5<this.prerollNum;this._retryAttempts+=1;a||"off"===this._instreamRerequestOnErrorResult||this._lastAdSuccessful||this._retryAttempts>=this._maxRetries||!this._midrollBugFixExperiment.result||(this.playerInstance.pause(!0),this.playerInstance.seek(0),this._prebidMethods.getHighestCpmBids(this.name).length||await this._fetchBids(),"dbc"===this._instreamRerequestOnErrorResult&&this._excludedErroredOutAdIdsFromGamAuction(),this._runAdPlay(!1))}_addAdDetailFields(a){if(a=
a&&this._getCustParamsFromQueryString(a))this._additionalAdFields={adId:String(a.hb_adid),adomain:String(a.hb_adomain),hb_bidder:String(a.hb_bidder),amznp:String(a.amznp),hb_pb:String(a.hb_pb),hb_crid:String(a.hb_crid),amznbid:String(a.amznbid),hb_deal:String(a.hb_deal)}}_setupEventProxies(){if("adthrive-collapse-mobile"===this._collapseType)this._eventProxy.footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this));this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this)));
this._spaListeners.push(this._eventProxy.resize.on(this._handleResize.bind(this)));this._spaListeners.push(this._eventProxy.pageVisibility.on(this._handlePageVisibilityChange.bind(this)));this._spaListeners.push(this._eventProxy.videoPlaying.on(this._handleVideoPlayingEvent.bind(this)))}_onBeforeRequestBids(){this._prebidMethods.onEvent("beforeRequestBids",a=>{a.forEach(b=>{var c;let d=b.code===this.name,e=this._userIdComponent.getUserIdTargeting();d&&e&&(this.userIdTargetingData=e);b=null!==(c=b.ortb2Imp&&
b.ortb2Imp.ext&&b.ortb2Imp.ext.tid)&&void 0!==c?c:"";d&&b&&(this.transactionId=b)})})}_setupEventListeners(){this._onBeforeRequestBids();this._handleErrors();this._listenForLargeVastError();this._handleTimeEvents();this._handleVideoEvents();this._handleAdTrackingEvents();this._setupEventProxies();this._listenForPlayerEventsToLog();this.playerInstance.on("ready",this._playerReady.bind(this))}_listenForPlayerEventsToLog(){S.resolve(em).logEvents(this.playerInstance,{mediaId:this._playlistId,siteId:this._config.site.id,
playerId:this._playerId,mediaIdCount:`${this._mediaIdCount||0}`})}_preventCollapse(){xa.disableCollapse=!0;this.collapseCollection&&xa.uncollapse(this.collapseCollection)}async _playLinearAd(){await this._fetchBids();if(0<this._pendingBidRequests.length){let a=this._pendingBidRequests.pop();a&&a.then(()=>{this._runAdPlay()}).catch(()=>{this._adHasPlayed=!1})}}}let Tf=class extends yq{constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B){super(a,b,c,d,e,f,g,h,m,n,p,r,"related",k,w,z,void 0,x);this._mobileHeaderSelector=
B;this._topBackgroundElement=null;this._playerConfig={repeat:!0,nextupoffset:-.01,playlist:`https://cdn.jwplayer.com/v2/media/${this._playlistId}`,height:"auto"};this._wrapperBarRemoved=!1;this._hasContentSpecificPlaylist=!(!h.video.contentSpecificPlaylists||!gf(h.video.contentSpecificPlaylists));this._playerElement=document.createElement("div");this._canSkip=!1;this._autoplayStationaryPlayer=this._shouldStationaryAutoplay();if(k||this._autoplayStationaryPlayer)this._playerConfig={...this._playerConfig,
...this._autoplayBehaviorConfig},this.initialAuctionPlayer=!0,this._stickyElement=null,this._playerContainer=this._pageElement}_appendPlayer(){let a=document.createElement("div");a.id=this.playerContainerId;a.className="adthrive-jw-static-player";this._isCollapsible?(this._pageElement.id="adthrive-contextual-container",this._playerElement.className="adthrive-player-position",this._playerElement.id="adthrive-contextual-position",this.isTopCenterCollapse()&&this._createTopCenterBackground(this._pageElement),
this._config.video.removeVideoTitleWrapper?this._addCloseWithoutWrapper():this.isTopCenterCollapse()?this._addTopCenterWrapper():this._addPlayerWithoutWrapper(),this._playerElement.appendChild(a),this._pageElement.appendChild(this._playerElement)):this._pageElement.appendChild(a)}setup(){this._isFirstPlay&&this._appendPlayer();this.playerInstance=window.jwplayer(this.playerContainerId);if(this._isCollapsible){let a={playerElement:this._playerElement,playerContainer:this._pageElement,footerElement:this._config.video.footerSelector?
document.querySelector(this._config.video.footerSelector):null,stickyElement:this._stickyElement,mobileHeaderSelector:this._mobileHeaderSelector||null};this._createCollapsibleCollection(a);this._playerConfig.playlist=ua.addMaxResolutionQueryParam(this._playerConfig.playlist)}this._jwSetup(this._playerConfig);this._config.video.relatedPlayerAdded=!0}_handleNextButton(){this._hideWrapperBar();super._handleNextButton()}_playerReady(a){super._playerReady(a);this._initRelatedPlaylist();let b=this._autoplayStationaryPlayer;
if(b||this.collapseCollection)a.viewable&&void this._inViewPlay(),b&&this._logStationaryAutoplay();this._isCollapsible&&this._setupCollapsible()}_logStationaryAutoplay(){this._config.video.logAdLifeCycle&&A.event("JwPlayer","StaticPlayer",{message:`Static Player set to autoplay for playlist id ${this._playlistId}`,...this._getPlayerVersions()})}_loadPlaylistPlayerVideos(){this._config.video.jwPlaylist.then(a=>{a.playlist&&a.playlist.length&&(a=this._hasContentSpecificPlaylist?a.playlist:ua.shufflePlaylist(a.playlist),
a=this.playerInstance.getPlaylist().concat(a),this.playerInstance.once("userInactive",()=>{var b;(null===(b=this.collapseCollection)||void 0===b?0:b.mediaStarted)||this._handleScroll().catch(()=>{})}),this.playerInstance.load(a),this._handleScroll().catch(()=>!1))}).catch(()=>!1)}_setupAllowSkip(){this._config.video.advancePlaylist.relatedPlayer.applyToFirst&&(this._canSkip=!0);this.playerInstance.once("complete",()=>{this._hideWrapperBar();this._canSkip=!0})}_shouldStationaryAutoplay(){return!this._config.video.playlistPlayerAdded&&
!!document.querySelector("body.adthrive-video-autoplay")}_setWrapperBar(){this._wrapperBar=this._playerElement.querySelector(".adthrive-wrapper-bar")}_hideWrapperBar(){let a=this._wrapperBar,b=this._playerElement;!this._wrapperBarRemoved&&a&&(this._wrapperBarRemoved=!0,a.parentNode&&a.parentNode.removeChild(a),this._wrapperBar=null,b.insertBefore(this._createPlayerCloseButton(),b.firstChild),this.collapseCollection&&(this.collapseCollection.closeButton=this._closeButton,this._displayCloseButton()))}_addCloseWithoutWrapper(){this._playerElement.appendChild(this._createPlayerCloseButton());
this._playerElement.classList.add("adthrive-player-without-wrapper-text")}_addTopCenterWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1));this._playerElement.appendChild(this._createTopCollapseWrapper(!1));this._playerElement.classList.add("adthrive-player-with-wrapper-text")}_addPlayerWithoutWrapper(){this._playerElement.appendChild(this._createPlayerWrapper(!1));this._playerElement.classList.add("adthrive-player-without-wrapper-text")}_initRelatedPlaylist(){this._config.video.advancePlaylist.relatedPlayer.shouldRun.then(a=>
{a&&(this._loadPlaylistPlayerVideos(),this._setupAllowSkip(),this.playerInstance.on("firstFrame",()=>this._handleFirstFrame()),this.playerInstance.getContainer().addEventListener("click",()=>this._handleVideoPlayerClicked()),this._initSkipContainer())}).catch(()=>!1)}_setTitleTextForVideoTitleElement(a){var b=this.playerInstance.getPlaylistItem(0);b=Cb(b,"title")?b.title:null;a.innerText="string"===typeof b?b:""}_setupCollapsible(){this._setWrapperBar();this._wrapperBar&&this._wrapperBar.style.setProperty("display",
"flex");this._videoTitleElement&&this._setTitleTextForVideoTitleElement(this._videoTitleElement);this._topCollapseVideoTitleElement&&this._setTitleTextForVideoTitleElement(this._topCollapseVideoTitleElement);this._handleResize()}};Tf=q([v("RelatedPlayer"),t("design:paramtypes",[Object,Number,String,String,Array,HTMLElement,Ub,N,Boolean,String,String,ia,Rc,Boolean,String,String,Object])],Tf);class Gu extends T{constructor(a,b){super();this._videoConfig=a;this._component=b;this._stickyRelatedOnPage=
!1;this._relatedMediaIds=[];this._device=Ta()?"desktop":"mobile";this._potentialPlayerMap=this.setPotentialPlayersMap()}setPotentialPlayersMap(){var a=this._videoConfig.players||[];let b=this._filterPlayerMap();a=a.filter(c=>"stationaryRelated"===c.type&&c.enabled);b.stationaryRelated=a;return this._potentialPlayerMap=b}_filterPlayerMap(){let a=this._videoConfig.players,b={stickyRelated:[],stickyPlaylist:[],stationaryRelated:[]};return a&&a.length?a.filter(c=>{var d;return null===(d=c.devices)||void 0===
d?void 0:d.includes(this._device)}).reduce((c,d)=>{c[d.type]||(A.event(this._component,"constructor","Unknown Video Player Type detected",d.type),c[d.type]=[]);d.enabled&&c[d.type].push(d);return c},b):b}_checkPlayerSelectorOnPage(a){a=this._potentialPlayerMap[a].map(b=>({player:b,playerElement:this._getPlacementElement(b)}));return a.length?a[0]:{player:null,playerElement:null}}_getOverrideElement(a,b,c){if(a&&b)c=document.createElement("div"),b.insertAdjacentElement(a.position,c);else{let {player:d,
playerElement:e}=this._checkPlayerSelectorOnPage("stickyPlaylist");d&&e&&(a=document.createElement("div"),e.insertAdjacentElement(d.position,a),c=a)}return c}_shouldOverrideElement(a){a=a.getAttribute("override-embed");return"true"===a||"false"===a?"true"===a:this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.overrideEmbedLocation:!1}_checkPageSelector(a,b,c=[]){return a&&b&&0===c.length?("/"!==window.location.pathname&&A.event("VideoUtils","getPlacementElement",Error(`PSNF: ${a} does not exist on the page`)),
!1):!0}_getElementSelector(a,b,c){if(b&&b.length>c)return b[c];A.event("VideoUtils","getPlacementElement",Error(`ESNF: ${a} does not exist on the page`));return null}_getPlacementElement(a){let {pageSelector:b,elementSelector:c,skip:d}=a,{valid:e,elements:f,...g}=Cc(b),{valid:h,elements:k,...m}=Cp(c);return""===b||e?h?this._checkPageSelector(b,e,f)?this._getElementSelector(c,k,d)||null:null:(A.error("VideoUtils","getPlacementElement",Error(`${c} is not a valid selector`),m),null):(A.error("VideoUtils",
"getPlacementElement",Error(`${b} is not a valid selector`),g),null)}_getEmbeddedPlayerType(a){(a=a.getAttribute("data-player-type"))&&"default"!==a||(a=this._videoConfig.relatedSettings?this._videoConfig.relatedSettings.defaultPlayerType:"static");this._stickyRelatedOnPage&&(a="static");return a}_getMediaId(a){return(a=a.getAttribute("data-video-id"))?(this._relatedMediaIds.push(a),a):!1}_createRelatedPlayer(a,b,c,d){"collapse"===b?this._createCollapsePlayer(a,c):"static"===b&&this._createStaticPlayer(a,
c,d)}_createCollapsePlayer(a,b){let {player:c,playerElement:d}=this._checkPlayerSelectorOnPage("stickyRelated"),e=c?c:this._potentialPlayerMap.stationaryRelated[0];e&&e.playerId?(this._shouldOverrideElement(b)&&(b=this._getOverrideElement(c,d,b)),b=document.querySelector(`#cls-video-container-${a} > div`)||b,this._createStickyRelatedPlayer({...e,mediaId:a},b)):A.error(this._component,"_createCollapsePlayer","No video player found")}_createStaticPlayer(a,b,c){this._potentialPlayerMap.stationaryRelated.length&&
this._potentialPlayerMap.stationaryRelated[0].playerId?this._createStationaryRelatedPlayer({...this._potentialPlayerMap.stationaryRelated[0],mediaOrPlaylistId:a},b,c):A.error(this._component,"_createStaticPlayer","No video player found")}_shouldRunAutoplayPlayers(){return this._isVideoAllowedOnPage()&&(this._potentialPlayerMap.stickyRelated.length||this._potentialPlayerMap.stickyPlaylist.length)?!0:!1}_determineAutoplayPlayers(){let a=this._component,b="VideoManagerComponent"===a,c=this._config;if(this._stickyRelatedOnPage)A.event(a,
"stickyRelatedOnPage",b&&{device:c&&c.context.device,isDesktop:this._device}||{});else{var {player:d,playerElement:e}=this._checkPlayerSelectorOnPage("stickyPlaylist");d&&d.playerId&&d.playlistId&&e?this._createPlaylistPlayer(d,e):A.event(a,"noStickyPlaylist",b&&{vendor:"none",device:c&&c.context.device,isDesktop:this._device}||{})}}_initializeRelatedPlayers(a){let b=new Map;for(let d=0;d<a.length;d++){let e=a[d];var c=e.offsetParent;let f=this._getEmbeddedPlayerType(e),g=this._getMediaId(e);c&&g&&
(c=(b.get(g)||0)+1,b.set(g,c),this._createRelatedPlayer(g,f,e,c))}}}let gm=class{constructor(a,b,c,d,e,f,g,h){this._abgroup=a;this._config=b;this._gam=c;this._irisTv=d;this._floors=e;this._videoEventBus=f;this._slotEventBus=g;this._prebidMethods=h;this._apstagSlotBids=new Map;this._prebidSlotTargetingMap=new Map;this.shouldPrebidRun=!1;this._videoEventBus.addAPStagSlotBidResponse.on(({playlistId:k,bid:m,discounts:n})=>this._addAPStagSlotBidResponse(k,m,n));this._slotEventBus.addPrebidSlotTargeting.on(({adUnitCode:k,
slotTargeting:m})=>this._addPrebidSlotTargeting(k,m))}_addAPStagSlotBidResponse(a,b,c){this._apstagSlotBids.set(a,{bid:b,discounts:c})}_addPrebidSlotTargeting(a,b){this._prebidSlotTargetingMap.set(a,b)}getVideoTargeting(a,b){let c=this._irisTv.irisContextualData,d={};Object.keys(b).forEach(e=>{let f=b[e];var g=this._abgroup.get("rvadv_ab1");"abgroup"===e&&g&&f.push(`${"rvadv_ab1"}:${g}`);"mcmp"===e&&this._config.trackScroll.trackScrollEnabled&&(g=this._getTrackScrollTargeting())&&f.push(g);d[e]=encodeURIComponent(f.toString())});
d.vprenum=String(a.prerollNum);void 0!==a.getJwBoostTargeting&&(d.jwv=a.jwVersion||"");d.imav=a.imaVersion||"";d.voba=this._config.videoOpenBidding.bidders.toString();c&&(d.iris_context=c.toString());return d}_getTrackScrollTargeting(){let a=this._config.trackScroll.getTargetingValue();if(a)return a}_getVideoBid(a){var b=this._apstagSlotBids.get(a);let c=null===b||void 0===b?void 0:b.bid;b=null===b||void 0===b?void 0:b.discounts;return c?(this._apstagSlotBids.delete(a),{bid:c,discounts:b}):{}}getPrebidNoBidTargeting(a){if(a=
this.getPrebidSlotTargeting(a).noBid)return{hb_bidder:a}}getPrebidSlotTargeting(a){return this._prebidSlotTargetingMap.get(a)||{}}_convertFlagSlotValues(a){let b=[];Object.keys(a).forEach(c=>{let d=a[c];"string"===typeof d?b.push(`${c}%3A${d}`):Array.isArray(d)&&0<d.length&&b.push(d.map(e=>`${c}%3A${e}`).join(","))});return b.join(",")}_addAmazonDiscountTargeting(a,b){let {standard:c,pmp:d}=a;a=(e,f)=>{this._floors.setVideoFlagSlot(b,{[e]:[f.toFixed(6).toString()]})};c.originalCpm&&a("aop",c.originalCpm);
c.discount&&a("apd",c.discount);d.originalCpm&&a("aopp",d.originalCpm);d.discount&&a("appd",d.discount)}_getAmazonBidTargeting(a,b){let {bid:c,discounts:d}=this._getVideoBid(a);if(c){a={};for(let e in c)"targeting"===e?a={...a,...c[e]}:this._config.amazon.amznTargetingKeys.includes(e)&&(a[e]=c[e]);d&&this._addAmazonDiscountTargeting(d,b);return a}return{}}_setPrebidDiscountTargeting(a){let {cpm:b,responseCpm:c}=this._prebidMethods.getHighestCpmBids(a)[0]||{},d=(c||0)-(b||0);c&&d&&this._floors.setVideoFlagSlot(a,
{pbop:[b.toFixed(6).toString()],pbpd:[d.toFixed(6).toString()]})}_getFloorsTargeting(a){let b=this._floors.getVideoFlagSlot(a);b&&this._floors.clearVideoFlagSlot(a);return b}_getCustParams(a){let b=this._gam.getTargetingMap(),c=this._getAmazonBidTargeting(a._playlistId,a.name),d={...(("playlist"===a.isPlayerType||"auto-injected"===a.isPlayerType)&&{plid:a._playlistId}),jwmid:a.mediaOrPlaylistId,...this._getFloorsTargeting(a.name),idp:"userIdTargetingData"in a?a.userIdTargetingData:"",tid:"transactionId"in
a?a.transactionId:""};return{...(d&&{flag_slot:this._convertFlagSlotValues(d)}),...this.getVideoTargeting(a,b),...this.getPrebidNoBidTargeting(a.name),...c}}handleGdprConsent(){let a={gdpr:1,gdpr_consent:"tcunavailable"};"function"===typeof window.__tcfapi&&window.__tcfapi("getFullTCData",2,b=>{b&&b.tcString&&b.tcString.length&&(a.gdpr_consent=b.tcString);b&&b.addtlConsent&&b.addtlConsent.length&&(a.addtl_consent=b.addtl_consent)});return a}getConsentParams(){if(this._config.gdpr.enabled)this.handleGdprConsent();
else if(this._config.ccpa.privacyString)return{us_privacy:this._config.ccpa.privacyString}}getDefaultVideoUrlParams(a){var b;let c=window.location.origin;return{iu:`/${this._config.gam.account}/${this._config.gam.prefix}_${a.name}/${this._config.site.id}`,sz:a.size.join("x"),hl:"en",output:"vast",url:"__page-url__",vad_type:"linear",description_url:`${encodeURIComponent(encodeURIComponent(c))}`,pp:"10_VAST%20redirects_video%2Fmp4_VPAID%20JavaScript",vpos:"preroll",vpmute:this._getVpmute(a.name),wta:1,
tfcd:yd()?1:0,...((null===(b=this._config.video.plcmtUnits)||void 0===b?void 0:b.get(a.name))&&{plcmt:this._config.video.plcmtUnits.get(a.name)})}}buildGAMVideoUrl(a){var b=this.getConsentParams(),c=ua.createQueryString(this._getCustParams(a));c=ua.createEncodedQueryString({cust_params:c});a=this.getDefaultVideoUrlParams(a);b={env:"vp",gdfp_req:"1",unviewed_position_start:"1",correlator:Date.now(),...a,...b};return`${"https://securepubads.g.doubleclick.net/gampad/ads"}?${ua.createQueryString(b)}&${c}`}buildGAMVideoUrlPrebid(a){let b=
a.videoAdUnit||{};this._setPrebidDiscountTargeting(a.name);let c=this._getCustParams(a);a=this.getDefaultVideoUrlParams(a);return window.pbjs.adServers.dfp.buildVideoUrl({adUnit:b,params:{...a,cust_params:c}})}buildVideoUrl(a){return this.shouldPrebidRun?this.buildGAMVideoUrlPrebid(a):this.buildGAMVideoUrl(a)}_getVpmute(a){return a===M.Video_In_Post_ClicktoPlay_SoundOn?0:1}};gm=q([v("VideoUrlBuilder"),y(),t("design:paramtypes",[Ia,N,V,Oc,wb,Ua,cb,ia])],gm);let Hu=(a=>{let b=!1;return async()=>{if(!b){try{await xh(a)}catch(c){}b=
!0}}})({condition:()=>!1,delay:500,maxAttempts:8}),Uf=class extends W{init(){this._key="VideoCollapseScrollUp";this._default=!1}isEnabled(){return super.isEnabled()&&!ca()}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Uf.prototype,"run",null);Uf=q([v("VideoCollapseScrollUpExperiment"),y()],Uf);let Vf=class extends X{init(){this._key="VideoCollapseScrollUpTopCenter"}isEnabled(){return super.isEnabled()&&ca()}run(){return super.run()}};
q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],Vf.prototype,"run",null);Vf=q([v("VideoCollapseScrollUpTopCenterExperiment"),y()],Vf);var zq={exports:{}};(function(a,b){(function(c){var d=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,e=/^(?=([^\/?#]*))\1([^]*)$/,f=/(?:\/|^)\.(?=\/)/g,g=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,h={buildAbsoluteURL:function(k,m,n){n=n||{};k=k.trim();
m=m.trim();if(!m){if(!n.alwaysNormalize)return k;n=h.parseURL(k);if(!n)throw Error("Error trying to parse base URL.");n.path=h.normalizePath(n.path);return h.buildURLFromParts(n)}var p=h.parseURL(m);if(!p)throw Error("Error trying to parse relative URL.");if(p.scheme){if(!n.alwaysNormalize)return m;p.path=h.normalizePath(p.path);return h.buildURLFromParts(p)}m=h.parseURL(k);if(!m)throw Error("Error trying to parse base URL.");!m.netLoc&&m.path&&"/"!==m.path[0]&&(k=e.exec(m.path),m.netLoc=k[1],m.path=
k[2]);m.netLoc&&!m.path&&(m.path="/");k={scheme:m.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};p.netLoc||(k.netLoc=m.netLoc,"/"!==p.path[0]&&(p.path?(m=m.path,m=m.substring(0,m.lastIndexOf("/")+1)+p.path,k.path=h.normalizePath(m)):(k.path=m.path,p.params||(k.params=m.params,p.query||(k.query=m.query)))));null===k.path&&(k.path=n.alwaysNormalize?h.normalizePath(p.path):p.path);return h.buildURLFromParts(k)},parseURL:function(k){return(k=d.exec(k))?{scheme:k[1]||
"",netLoc:k[2]||"",path:k[3]||"",params:k[4]||"",query:k[5]||"",fragment:k[6]||""}:null},normalizePath:function(k){for(k=k.split("").reverse().join("").replace(f,"");k.length!==(k=k.replace(g,"")).length;);return k.split("").reverse().join("")},buildURLFromParts:function(k){return k.scheme+k.netLoc+k.path+k.params+k.query+k.fragment}};a.exports=h})()})(zq);var hm=zq.exports;let Y=Number.isFinite||function(a){return"number"===typeof a&&isFinite(a)},u=function(a){a.MEDIA_ATTACHING="hlsMediaAttaching";
a.MEDIA_ATTACHED="hlsMediaAttached";a.MEDIA_DETACHING="hlsMediaDetaching";a.MEDIA_DETACHED="hlsMediaDetached";a.BUFFER_RESET="hlsBufferReset";a.BUFFER_CODECS="hlsBufferCodecs";a.BUFFER_CREATED="hlsBufferCreated";a.BUFFER_APPENDING="hlsBufferAppending";a.BUFFER_APPENDED="hlsBufferAppended";a.BUFFER_EOS="hlsBufferEos";a.BUFFER_FLUSHING="hlsBufferFlushing";a.BUFFER_FLUSHED="hlsBufferFlushed";a.MANIFEST_LOADING="hlsManifestLoading";a.MANIFEST_LOADED="hlsManifestLoaded";a.MANIFEST_PARSED="hlsManifestParsed";
a.LEVEL_SWITCHING="hlsLevelSwitching";a.LEVEL_SWITCHED="hlsLevelSwitched";a.LEVEL_LOADING="hlsLevelLoading";a.LEVEL_LOADED="hlsLevelLoaded";a.LEVEL_UPDATED="hlsLevelUpdated";a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated";a.LEVELS_UPDATED="hlsLevelsUpdated";a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated";a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching";a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched";a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading";a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded";a.SUBTITLE_TRACKS_UPDATED=
"hlsSubtitleTracksUpdated";a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared";a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch";a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading";a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded";a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed";a.CUES_PARSED="hlsCuesParsed";a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound";a.INIT_PTS_FOUND="hlsInitPtsFound";a.FRAG_LOADING="hlsFragLoading";a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted";a.FRAG_LOADED=
"hlsFragLoaded";a.FRAG_DECRYPTED="hlsFragDecrypted";a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment";a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata";a.FRAG_PARSING_METADATA="hlsFragParsingMetadata";a.FRAG_PARSED="hlsFragParsed";a.FRAG_BUFFERED="hlsFragBuffered";a.FRAG_CHANGED="hlsFragChanged";a.FPS_DROP="hlsFpsDrop";a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping";a.ERROR="hlsError";a.DESTROYING="hlsDestroying";a.KEY_LOADING="hlsKeyLoading";a.KEY_LOADED="hlsKeyLoaded";a.LIVE_BACK_BUFFER_REACHED=
"hlsLiveBackBufferReached";a.BACK_BUFFER_REACHED="hlsBackBufferReached";return a}({}),Z=function(a){a.NETWORK_ERROR="networkError";a.MEDIA_ERROR="mediaError";a.KEY_SYSTEM_ERROR="keySystemError";a.MUX_ERROR="muxError";a.OTHER_ERROR="otherError";return a}({}),K=function(a){a.KEY_SYSTEM_NO_KEYS="keySystemNoKeys";a.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess";a.KEY_SYSTEM_NO_SESSION="keySystemNoSession";a.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense";a.KEY_SYSTEM_LICENSE_REQUEST_FAILED=
"keySystemLicenseRequestFailed";a.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed";a.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed";a.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed";a.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted";a.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError";a.MANIFEST_LOAD_ERROR="manifestLoadError";a.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut";a.MANIFEST_PARSING_ERROR=
"manifestParsingError";a.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError";a.LEVEL_EMPTY_ERROR="levelEmptyError";a.LEVEL_LOAD_ERROR="levelLoadError";a.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut";a.LEVEL_PARSING_ERROR="levelParsingError";a.LEVEL_SWITCH_ERROR="levelSwitchError";a.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError";a.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut";a.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError";a.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut";a.FRAG_LOAD_ERROR=
"fragLoadError";a.FRAG_LOAD_TIMEOUT="fragLoadTimeOut";a.FRAG_DECRYPT_ERROR="fragDecryptError";a.FRAG_PARSING_ERROR="fragParsingError";a.FRAG_GAP="fragGap";a.REMUX_ALLOC_ERROR="remuxAllocError";a.KEY_LOAD_ERROR="keyLoadError";a.KEY_LOAD_TIMEOUT="keyLoadTimeOut";a.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError";a.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError";a.BUFFER_APPEND_ERROR="bufferAppendError";a.BUFFER_APPENDING_ERROR="bufferAppendingError";a.BUFFER_STALLED_ERROR="bufferStalledError";
a.BUFFER_FULL_ERROR="bufferFullError";a.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole";a.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall";a.INTERNAL_EXCEPTION="internalException";a.INTERNAL_ABORTED="aborted";a.UNKNOWN="unknown";return a}({}),cc=function(){},im={trace:cc,debug:cc,log:cc,warn:cc,info:cc,error:cc},$c=im,D=$c,Iu=/^(\d+)x(\d+)$/,Aq=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Aa{constructor(a){"string"===typeof a&&(a=Aa.parseAttrList(a));for(let b in a)a.hasOwnProperty(b)&&("X-"===b.substring(0,2)&&(this.clientAttrs=
this.clientAttrs||[],this.clientAttrs.push(b)),this[b]=a[b])}decimalInteger(a){a=parseInt(this[a],10);return a>Number.MAX_SAFE_INTEGER?Infinity:a}hexadecimalInteger(a){if(this[a]){a=(this[a]||"0x").slice(2);a=(a.length&1?"0":"")+a;let b=new Uint8Array(a.length/2);for(let c=0;c<a.length/2;c++)b[c]=parseInt(a.slice(2*c,2*c+2),16);return b}return null}hexadecimalIntegerAsNumber(a){a=parseInt(this[a],16);return a>Number.MAX_SAFE_INTEGER?Infinity:a}decimalFloatingPoint(a){return parseFloat(this[a])}optionalFloat(a,
b){return(a=this[a])?parseFloat(a):b}enumeratedString(a){return this[a]}bool(a){return"YES"===this[a]}decimalResolution(a){a=Iu.exec(this[a]);if(null!==a)return{width:parseInt(a[1],10),height:parseInt(a[2],10)}}static parseAttrList(a){var b;let c={};for(Aq.lastIndex=0;null!==(b=Aq.exec(a));){let d=b[2];0===d.indexOf('"')&&d.lastIndexOf('"')===d.length-1&&(d=d.slice(1,-1));b=b[1].trim();c[b]=d}return c}}class uo{constructor(a,b){this._badValueForSameId=this._endDate=this._startDate=this.attr=void 0;
if(b){b=b.attr;for(let c in b)if(Object.prototype.hasOwnProperty.call(a,c)&&a[c]!==b[c]){D.warn(`DATERANGE tag attribute: "${c}" does not match for tags with ID: "${a.ID}"`);this._badValueForSameId=c;break}a=Ga(new Aa({}),b,a)}this.attr=a;this._startDate=new Date(a["START-DATE"]);"END-DATE"in this.attr&&(a=new Date(this.attr["END-DATE"]),Y(a.getTime())&&(this._endDate=a))}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;
let a=this.duration;return null!==a?new Date(this._startDate.getTime()+1E3*a):null}get duration(){if("DURATION"in this.attr){let a=this.attr.decimalFloatingPoint("DURATION");if(Y(a))return a}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1E3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&
Y(this.startDate.getTime())&&(null===this.duration||0<=this.duration)&&(!this.endOnNext||!!this.class)}}class Wf{constructor(){this.aborted=!1;this.bwEstimate=this.chunkCount=this.total=this.retry=this.loaded=0;this.loading={start:0,first:0,end:0};this.parsing={start:0,end:0};this.buffering={start:0,first:0,end:0}}}var oa={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Bq{constructor(a){this._url=this._byteRange=null;this.relurl=this.baseurl=void 0;this.elementaryStreams={[oa.AUDIO]:null,
[oa.VIDEO]:null,[oa.AUDIOVIDEO]:null};this.baseurl=a}setByteRange(a,b){a=a.split("@",2);let c=[];c[0]=1===a.length?b?b.byteRangeEndOffset:0:parseInt(a[1]);c[1]=parseInt(a[0])+c[0];this._byteRange=c}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){!this._url&&this.baseurl&&this.relurl&&(this._url=hm.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0}));return this._url||
""}set url(a){this._url=a}}class jm extends Bq{constructor(a,b){super(b);this.programDateTime=this.rawProgramDateTime=this._decryptdata=null;this.tagList=[];this.sn=this.duration=0;this.type=this.levelkeys=void 0;this.keyLoader=this.loader=null;this.level=-1;this.cc=0;this.endDTS=this.startDTS=this.endPTS=this.startPTS=void 0;this.start=0;this.minEndPTS=this.maxStartPTS=this.deltaPTS=void 0;this.stats=new Wf;this.urlId=0;this.data=void 0;this.bitrateTest=!1;this.initSegment=this.title=null;this.gap=
this.endList=void 0;this.type=a}get decryptdata(){var {levelkeys:a}=this;if(!a&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE)if(a=this.levelkeys.identity)this._decryptdata=a.getDecryptData(this.sn);else if(a=Object.keys(this.levelkeys),1===a.length)return this._decryptdata=this.levelkeys[a[0]].getDecryptData(this.sn);return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime||!Y(this.programDateTime))return null;
let a=Y(this.duration)?this.duration:0;return this.programDateTime+1E3*a}get encrypted(){var a;if(null!=(a=this._decryptdata)&&a.encrypted)return!0;if(this.levelkeys){a=Object.keys(this.levelkeys);let b=a.length;if(1<b||1===b&&this.levelkeys[a[0]].encrypted)return!0}return!1}setKeyFormat(a){this.levelkeys&&(a=this.levelkeys[a])&&!this._decryptdata&&(this._decryptdata=a.getDecryptData(this.sn))}abortRequests(){var a,b;null==(a=this.loader)?void 0:a.abort();null==(b=this.keyLoader)?void 0:b.abort()}setElementaryStreamInfo(a,
b,c,d,e,f=!1){let {elementaryStreams:g}=this,h=g[a];h?(h.startPTS=Math.min(h.startPTS,b),h.endPTS=Math.max(h.endPTS,c),h.startDTS=Math.min(h.startDTS,d),h.endDTS=Math.max(h.endDTS,e)):g[a]={startPTS:b,endPTS:c,startDTS:d,endDTS:e,partial:f}}clearElementaryStreamInfo(){let {elementaryStreams:a}=this;a[oa.AUDIO]=null;a[oa.VIDEO]=null;a[oa.AUDIOVIDEO]=null}}class Ju extends Bq{constructor(a,b,c,d,e){super(c);this.duration=this.fragOffset=0;this.independent=this.gap=!1;this.index=this.fragment=this.relurl=
void 0;this.stats=new Wf;this.duration=a.decimalFloatingPoint("DURATION");this.gap=a.bool("GAP");this.independent=a.bool("INDEPENDENT");this.relurl=a.enumeratedString("URI");this.fragment=b;this.index=d;(a=a.enumeratedString("BYTERANGE"))&&this.setByteRange(a,e);e&&(this.fragOffset=e.fragOffset+e.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let {elementaryStreams:a}=this;return!!(a.audio||a.video||a.audiovideo)}}class Ku{constructor(a){this.alignedSliding=
this.PTSKnown=!1;this.averagetargetduration=void 0;this.endSN=this.endCC=0;this.fragmentHint=this.fragments=void 0;this.partList=null;this.dateRanges=void 0;this.live=!0;this.ageHeader=0;this.advancedDateTime=void 0;this.advanced=this.updated=!0;this.availabilityDelay=void 0;this.startSN=this.startCC=this.misses=0;this.startTimeOffset=null;this.totalduration=this.targetduration=0;this.type=null;this.url=void 0;this.m3u8="";this.version=null;this.canBlockReload=!1;this.canSkipUntil=0;this.canSkipDateRanges=
!1;this.skippedSegments=0;this.recentlyRemovedDateranges=void 0;this.partTarget=this.holdBack=this.partHoldBack=0;this.renditionReports=this.preloadHint=void 0;this.tuneInGoal=0;this.deltaUpdateFailed=void 0;this.driftEnd=this.driftStart=this.driftEndTime=this.driftStartTime=0;this.variableList=this.playlistParsingError=null;this.hasVariableRefs=!1;this.fragments=[];this.encryptedFragments=[];this.dateRanges={};this.url=a}reloaded(a){if(a){var b=this.lastPartSn-a.lastPartSn,c=this.lastPartIndex-a.lastPartIndex;
this.updated=this.endSN!==a.endSN||!!c||!!b||!this.live;this.advanced=this.endSN>a.endSN||0<b||0===b&&0<c;this.misses=this.updated||this.advanced?Math.floor(.6*a.misses):a.misses+1;this.availabilityDelay=a.availabilityDelay}else this.updated=this.advanced=!0}get hasProgramDateTime(){return this.fragments.length?Y(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){let a=this.driftEndTime-this.driftStartTime;
return 0<a?1E3*(this.driftEnd-this.driftStart)/a:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var a;return null!=(a=this.partList)&&a.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var a;return null!=(a=this.fragments)&&a.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1E3:0}get lastPartIndex(){var a;return null!=(a=this.partList)&&a.length?this.partList[this.partList.length-
1].index:-1}get lastPartSn(){var a;return null!=(a=this.partList)&&a.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}var wa={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ya={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};var Cq="undefined"!==typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?
self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;let km=(a,b)=>b+10<=a.length&&73===a[b]&&68===a[b+1]&&51===a[b+2]&&255>a[b+3]&&255>a[b+4]&&128>a[b+6]&&128>a[b+7]&&128>a[b+8]&&128>a[b+9]?!0:!1,Dq=(a,b)=>b+10<=a.length&&51===a[b]&&68===a[b+1]&&73===a[b+2]&&255>a[b+3]&&255>a[b+4]&&128>a[b+6]&&128>a[b+7]&&128>a[b+8]&&128>a[b+9]?!0:!1,Yf=(a,b)=>{const c=b;let d=0;for(;km(a,b);){d+=10;const e=Xf(a,b+6);d+=e;Dq(a,b+10)&&(d+=10);b+=d}if(0<d)return a.subarray(c,c+d)},Xf=(a,b)=>{let c;
c=(a[b]&127)<<21;c|=(a[b+1]&127)<<14;c|=(a[b+2]&127)<<7;return c|=a[b+3]&127},Eq=a=>a&&"PRIV"===a.key&&"com.apple.streaming.transportStreamTimestamp"===a.info,Fq=a=>{let b=0;const c=[];for(;km(a,b);){var d=Xf(a,b+6);b+=10;for(d=b+d;b+8<d;){var e=a.subarray(b),f=String.fromCharCode(e[0],e[1],e[2],e[3]),g=Xf(e,4);e={type:f,size:g,data:e.subarray(10,10+g)};f=e;if("PRIV"===f.type)if(2>f.size)f=void 0;else{g=rb(f.data,!0);var h=new Uint8Array(f.data.subarray(g.length+1));f={key:f.type,info:g,data:h.buffer}}else"W"===
f.type[0]?"WXXX"===f.type?2>f.size?f=void 0:(h=1,g=rb(f.data.subarray(h),!0),h+=g.length+1,h=rb(f.data.subarray(h)),f={key:f.type,info:g,data:h}):(g=rb(f.data),f={key:f.type,data:g}):2>f.size?f=void 0:"TXXX"===f.type?(h=1,g=rb(f.data.subarray(h),!0),h+=g.length+1,h=rb(f.data.subarray(h)),f={key:f.type,info:g,data:h}):(g=rb(f.data.subarray(1)),f={key:f.type,data:g});f&&c.push(f);b+=e.size+10}Dq(a,b)&&(b+=10)}return c},rb=(a,b=!1)=>{var c;lm||"undefined"===typeof self.TextDecoder||(lm=new self.TextDecoder("utf-8"));
if(c=lm)return a=c.decode(a),b?(b=a.indexOf("\x00"),-1!==b?a.substring(0,b):a):a.replace(/\0/g,"");c=a.length;let d,e,f,g="",h=0;for(;h<c;){d=a[h++];if(0===d&&b)break;else if(0===d||3===d)continue;switch(d>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:g+=String.fromCharCode(d);break;case 12:case 13:e=a[h++];g+=String.fromCharCode((d&31)<<6|e&63);break;case 14:e=a[h++],f=a[h++],g+=String.fromCharCode((d&15)<<12|(e&63)<<6|(f&63)<<0)}}return g},lm,qb={hexDump:function(a){let b="";for(let c=
0;c<a.length;c++){let d=a[c].toString(16);2>d.length&&(d="0"+d);b+=d}return b}},$d=Math.pow(2,32)-1,ks=[].push,Gq={video:1,audio:2,id3:3,text:4},Zf={};class be{static clearKeyUriToKeyIdMap(){Zf={}}constructor(a,b,c,d=[1],e=null){this.isCommonEncryption=this.encrypted=this.keyFormatVersions=this.keyFormat=this.method=this.uri=void 0;this.pssh=this.keyId=this.key=this.iv=null;this.method=a;this.uri=b;this.keyFormat=c;this.keyFormatVersions=d;this.iv=e;this.isCommonEncryption=(this.encrypted=a?"NONE"!==
a:!1)&&"AES-128"!==a}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Ya.FAIRPLAY:case Ya.WIDEVINE:case Ya.PLAYREADY:case Ya.CLEARKEY:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(a){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!==typeof a&&("AES-128"!==
this.method||this.iv||D.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),a=0);var b=new Uint8Array(16);for(var c=12;16>c;c++)b[c]=a>>8*(15-c)&255;return new be(this.method,this.uri,"identity",this.keyFormatVersions,b)}b=this.uri.split(":");a=null;"data"===b[0]&&2===b.length&&(b=b[1].split(";"),c=b[b.length-1].split(","),2===c.length&&(a=c[1],"base64"===c[0]?(b.splice(-1,1),a=Dg(a)):(a=Yn(a).subarray(0,16),b=new Uint8Array(16),b.set(a,16-a.length),a=b)));
if(a)switch(this.keyFormat){case Ya.WIDEVINE:this.pssh=a;22<=a.length&&(this.keyId=a.subarray(a.length-22,a.length-6));break;case Ya.PLAYREADY:b=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);if(16!==b.byteLength)throw new RangeError("Invalid system id");c=new Uint8Array;var d=new Uint8Array;var e=new Uint8Array(4);a&&0<a.byteLength&&(new DataView(e.buffer)).setUint32(0,a.byteLength,!1);b=[new Uint8Array([0,0,0,0]),b,d,c,e,a||new Uint8Array];c=b.length;d=8;for(e=c;e--;)d+=
b[e].byteLength;let f=new Uint8Array(d);f[0]=d>>24&255;f[1]=d>>16&255;f[2]=d>>8&255;f[3]=d&255;f.set([112,115,115,104],4);e=0;for(d=8;e<c;e++)f.set(b[e],d),d+=b[e].byteLength;this.pssh=f;a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);a=String.fromCharCode.apply(null,Array.from(a));a=a.substring(a.indexOf("<"),a.length);if(a=(new DOMParser).parseFromString(a,"text/xml").getElementsByTagName("KID")[0])if(a=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE"))a=Dg(a).subarray(0,
16),hs(a),this.keyId=a;break;default:a=a.subarray(0,16),16!==a.length&&(b=new Uint8Array(16),b.set(a,16-a.length),a=b),this.keyId=a}this.keyId&&16===this.keyId.byteLength||(a=Zf[this.uri],a||(b=Object.keys(Zf).length%Number.MAX_SAFE_INTEGER,a=new Uint8Array(16),(new DataView(a.buffer,12,4)).setUint32(0,b),Zf[this.uri]=a),this.keyId=a);return this}}let Hg=/\{\$([a-zA-Z0-9-_]+)\}/g,us={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,
g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},io=ae(),Hq=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,
Iq=/#EXT-X-MEDIA:(.*)/g,Lu=/^#EXT(?:INF|-X-TARGETDURATION):/m,Jq=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),Mu=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,
/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class sb{static findGroup(a,b){for(let c=0;c<a.length;c++){let d=a[c];if(d.id===b)return d}}static convertAVC1ToAVCOTI(a){let b=a.split(".");return 2<b.length?(a=b.shift()+".",a+=parseInt(b.shift()).toString(16),a+=("000"+parseInt(b.shift()).toString(16)).slice(-4)):a}static resolve(a,b){return hm.buildAbsoluteURL(b,a,{alwaysNormalize:!0})}static isMediaPlaylist(a){return Lu.test(a)}static parseMasterPlaylist(a,
b){let c={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Hg.test(a)},d=[];Hq.lastIndex=0;for(var e;null!=(e=Hq.exec(a));)if(e[1]){var f,g=new Aa(e[1]);Za(c,g,"CODECS SUPPLEMENTAL-CODECS ALLOWED-CPC PATHWAY-ID STABLE-VARIANT-ID AUDIO VIDEO SUBTITLES CLOSED-CAPTIONS NAME".split(" "));e=Gg(c,e[2]);e={attrs:g,bitrate:g.decimalInteger("AVERAGE-BANDWIDTH")||g.decimalInteger("BANDWIDTH"),name:g.NAME,url:sb.resolve(e,
b)};let h=g.decimalResolution("RESOLUTION");h&&(e.width=h.width,e.height=h.height);ts((g.CODECS||"").split(/[ ,]+/).filter(k=>k),e);e.videoCodec&&-1!==e.videoCodec.indexOf("avc1")&&(e.videoCodec=sb.convertAVC1ToAVCOTI(e.videoCodec));null!=(f=e.unknownCodecs)&&f.length||d.push(e);c.levels.push(e)}else if(e[3])switch(g=e[4],e[3]){case "SESSION-DATA":g=new Aa(g);Za(c,g,["DATA-ID","LANGUAGE","VALUE","URI"]);if(e=g["DATA-ID"])null===c.sessionData&&(c.sessionData={}),c.sessionData[e]=g;break;case "SESSION-KEY":e=
jo(g,b,c);e.encrypted&&e.isSupported()?(null===c.sessionKeys&&(c.sessionKeys=[]),c.sessionKeys.push(e)):D.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${g}"`);break;case "DEFINE":g=new Aa(g);Za(c,g,["NAME","VALUE","QUERYPARAM"]);ho(c,g,b);break;case "CONTENT-STEERING":g=new Aa(g);Za(c,g,["SERVER-URI","PATHWAY-ID"]);c.contentSteering={uri:sb.resolve(g["SERVER-URI"],b),pathwayId:g["PATHWAY-ID"]||"."};break;case "START":c.startTimeOffset=ko(g)}c.levels=0<d.length&&d.length<c.levels.length?d:
c.levels;0===c.levels.length&&(c.playlistParsingError=Error("no levels found in manifest"));return c}static parseMasterPlaylistMedia(a,b,c){var d;let e={};var f=c.levels;f={AUDIO:f.map(m=>({id:m.attrs.AUDIO,audioCodec:m.audioCodec})),SUBTITLES:f.map(m=>({id:m.attrs.SUBTITLES,textCodec:m.textCodec})),"CLOSED-CAPTIONS":[]};let g=0;for(Iq.lastIndex=0;null!==(d=Iq.exec(a));){var h=new Aa(d[1]);let m=h.TYPE;if(m){var k=f[m];d=e[m]||[];e[m]=d;Za(c,h,"URI GROUP-ID LANGUAGE ASSOC-LANGUAGE STABLE-RENDITION-ID NAME INSTREAM-ID CHARACTERISTICS CHANNELS".split(" "));
h={attrs:h,bitrate:0,id:g++,groupId:h["GROUP-ID"]||"",instreamId:h["INSTREAM-ID"],name:h.NAME||h.LANGUAGE||"",type:m,default:h.bool("DEFAULT"),autoselect:h.bool("AUTOSELECT"),forced:h.bool("FORCED"),lang:h.LANGUAGE,url:h.URI?sb.resolve(h.URI,b):""};null!=k&&k.length&&(k=sb.findGroup(k,h.groupId)||k[0],lo(h,k,"audioCodec"),lo(h,k,"textCodec"));d.push(h)}}return e}static parseLevelPlaylist(a,b,c,d,e,f){let g=new Ku(b),h=g.fragments;var k=null;let m=0;var n=0,p=0,r=0;let w=null,z=new jm(d,b);var x,B;
let E;var C=-1;let I=!1;Jq.lastIndex=0;g.m3u8=a;for(g.hasVariableRefs=Hg.test(a);null!==(x=Jq.exec(a));){I&&(I=!1,z=new jm(d,b),z.start=p,z.sn=m,z.cc=r,z.level=c,k&&(z.initSegment=k,z.rawProgramDateTime=k.rawProgramDateTime,k.rawProgramDateTime=null));var F=x[1];if(F)z.duration=parseFloat(F),x=(" "+x[2]).slice(1),z.title=x||null,z.tagList.push(x?["INF",F,x]:["INF",F]);else if(x[3])Y(z.duration)&&(z.start=p,E&&oo(z,E,g),z.sn=m,z.level=c,z.cc=r,z.urlId=e,h.push(z),n=(" "+x[3]).slice(1),z.relurl=Gg(g,
n),mo(z,w),w=z,p+=z.duration,m++,n=0,I=!0);else if(x[4])F=(" "+x[4]).slice(1),w?z.setByteRange(F,w):z.setByteRange(F);else if(x[5])z.rawProgramDateTime=(" "+x[5]).slice(1),z.tagList.push(["PROGRAM-DATE-TIME",z.rawProgramDateTime]),-1===C&&(C=h.length);else if(x=x[0].match(Mu)){for(B=1;B<x.length&&"undefined"===typeof x[B];B++);var O=(" "+x[B]).slice(1);F=(" "+x[B+1]).slice(1);B=x[B+2]?(" "+x[B+2]).slice(1):"";switch(O){case "PLAYLIST-TYPE":g.type=F.toUpperCase();break;case "MEDIA-SEQUENCE":m=g.startSN=
parseInt(F);break;case "SKIP":F=new Aa(F);Za(g,F,["RECENTLY-REMOVED-DATERANGES"]);x=F.decimalInteger("SKIPPED-SEGMENTS");if(Y(x)){g.skippedSegments=x;for(O=x;O--;)h.unshift(null);m+=x}if(F=F.enumeratedString("RECENTLY-REMOVED-DATERANGES"))g.recentlyRemovedDateranges=F.split("\t");break;case "TARGETDURATION":g.targetduration=Math.max(parseInt(F),1);break;case "VERSION":g.version=parseInt(F);break;case "EXTM3U":break;case "ENDLIST":g.live=!1;break;case "#":(F||B)&&z.tagList.push(B?[F,B]:[F]);break;
case "DISCONTINUITY":r++;z.tagList.push(["DIS"]);break;case "GAP":z.gap=!0;z.tagList.push([O]);break;case "BITRATE":z.tagList.push([O,F]);break;case "DATERANGE":x=new Aa(F);Za(g,x,"ID CLASS START-DATE END-DATE SCTE35-CMD SCTE35-OUT SCTE35-IN".split(" "));Za(g,x,x.clientAttrs);x=new uo(x,g.dateRanges[x.ID]);x.isValid||g.skippedSegments?g.dateRanges[x.id]=x:D.warn(`Ignoring invalid DATERANGE tag: "${F}"`);z.tagList.push(["EXT-X-DATERANGE",F]);break;case "DEFINE":O=new Aa(F);Za(g,O,["NAME","VALUE","IMPORT",
"QUERYPARAM"]);"IMPORT"in O?(F=g,x=f,O=O.IMPORT,x&&O in x?(B=F.variableList,B||(F.variableList=B={}),B[O]=x[O]):F.playlistParsingError||(F.playlistParsingError=Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${O}"`))):ho(g,O,b);break;case "DISCONTINUITY-SEQUENCE":r=parseInt(F);break;case "KEY":x=jo(F,b,g);x.isSupported()?"NONE"===x.method?E=void 0:(E||(E={}),E[x.keyFormat]&&(E=Ga({},E)),E[x.keyFormat]=x):D.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${F}"`);break;case "START":g.startTimeOffset=
ko(F);break;case "MAP":k=new Aa(F);Za(g,k,["BYTERANGE","URI"]);z.duration?(F=new jm(d,b),no(F,k,c,E),k=F,z.initSegment=k,k.rawProgramDateTime&&!z.rawProgramDateTime&&(z.rawProgramDateTime=k.rawProgramDateTime)):(no(z,k,c,E),k=z,I=!0);break;case "SERVER-CONTROL":F=new Aa(F);g.canBlockReload=F.bool("CAN-BLOCK-RELOAD");g.canSkipUntil=F.optionalFloat("CAN-SKIP-UNTIL",0);g.canSkipDateRanges=0<g.canSkipUntil&&F.bool("CAN-SKIP-DATERANGES");g.partHoldBack=F.optionalFloat("PART-HOLD-BACK",0);g.holdBack=F.optionalFloat("HOLD-BACK",
0);break;case "PART-INF":F=new Aa(F);g.partTarget=F.decimalFloatingPoint("PART-TARGET");break;case "PART":x=g.partList;x||(x=g.partList=[]);O=0<n?x[x.length-1]:void 0;B=n++;F=new Aa(F);Za(g,F,["BYTERANGE","URI"]);F=new Ju(F,z,b,B,O);x.push(F);z.duration+=F.duration;break;case "PRELOAD-HINT":F=new Aa(F);Za(g,F,["URI"]);g.preloadHint=F;break;case "RENDITION-REPORT":F=new Aa(F);Za(g,F,["URI"]);g.renditionReports=g.renditionReports||[];g.renditionReports.push(F);break;default:D.warn(`line parsed but not handled: ${x}`)}}else D.warn("No matches on slow regex match for level playlist!")}w&&
!w.relurl?(h.pop(),p-=w.duration,g.partList&&(g.fragmentHint=w)):g.partList&&(mo(z,w),z.cc=r,g.fragmentHint=z,E&&oo(z,E,g));c=h.length;a=h[0];b=h[c-1];p+=g.skippedSegments*g.targetduration;0<p&&c&&b?(g.averagetargetduration=p/c,c=b.sn,g.endSN="initSegment"!==c?c:0,g.live||(b.endList=!0),a&&(g.startCC=a.cc)):(g.endSN=0,g.startCC=0);g.fragmentHint&&(p+=g.fragmentHint.duration);g.totalduration=p;g.endCC=r;if(0<C)a:for(r=C,p=h[r];r--;){C=h[r];if(!C)break a;C.programDateTime=p.programDateTime-1E3*C.duration;
p=C}return g}}var la={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ba={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Nu{constructor(a){this.hls=void 0;this.loaders=Object.create(null);this.variableList=null;this.hls=a;this.registerListeners()}startLoad(a){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let {hls:a}=this;a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.LEVEL_LOADING,this.onLevelLoading,this);a.on(u.AUDIO_TRACK_LOADING,
this.onAudioTrackLoading,this);a.on(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){let {hls:a}=this;a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.LEVEL_LOADING,this.onLevelLoading,this);a.off(u.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this);a.off(u.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(a){var b=this.hls.config;let c=b.loader;b=new (b.pLoader||c)(b);return this.loaders[a.type]=b}getInternalLoader(a){return this.loaders[a.type]}resetInternalLoader(a){this.loaders[a]&&
delete this.loaders[a]}destroyInternalLoaders(){for(let a in this.loaders){let b=this.loaders[a];b&&b.destroy();this.resetInternalLoader(a)}}destroy(){this.variableList=null;this.unregisterListeners();this.destroyInternalLoaders()}onManifestLoading(a,b){({url:a}=b);this.variableList=null;this.load({id:null,level:0,responseType:"text",type:la.MANIFEST,url:a,deliveryDirectives:null})}onLevelLoading(a,b){let {id:c,level:d,url:e,deliveryDirectives:f}=b;this.load({id:c,level:d,responseType:"text",type:la.LEVEL,
url:e,deliveryDirectives:f})}onAudioTrackLoading(a,b){let {id:c,groupId:d,url:e,deliveryDirectives:f}=b;this.load({id:c,groupId:d,level:null,responseType:"text",type:la.AUDIO_TRACK,url:e,deliveryDirectives:f})}onSubtitleTrackLoading(a,b){let {id:c,groupId:d,url:e,deliveryDirectives:f}=b;this.load({id:c,groupId:d,level:null,responseType:"text",type:la.SUBTITLE_TRACK,url:e,deliveryDirectives:f})}load(a){var b,c=this.hls.config;let d=this.getInternalLoader(a);if(d){let f=d.context;if(f&&f.url===a.url){D.trace("[playlist-loader]: playlist request ongoing");
return}D.log(`[playlist-loader]: aborting previous loader for type: ${a.type}`);d.abort()}c=a.type===la.MANIFEST?c.manifestLoadPolicy.default:Ga({},c.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null});d=this.createInternalLoader(a);if(null!=(b=a.deliveryDirectives)&&b.part){if(a.type===la.LEVEL&&null!==a.level)var e=this.hls.levels[a.level].details;else a.type===la.AUDIO_TRACK&&null!==a.id?e=this.hls.audioTracks[a.id].details:a.type===la.SUBTITLE_TRACK&&null!==a.id&&(e=this.hls.subtitleTracks[a.id].details);
e&&(b=e.partTarget,e=e.targetduration,b&&e&&(e=1E3*Math.max(3*b,.8*e),c=Ga({},c,{maxTimeToFirstByteMs:Math.min(e,c.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(e,c.maxTimeToFirstByteMs)})))}e=c.errorRetry||c.timeoutRetry||{};d.load(a,{loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:e.maxNumRetry||0,retryDelay:e.retryDelayMs||0,maxRetryDelay:e.maxRetryDelayMs||0},{onSuccess:(f,g,h,k)=>{const m=this.getInternalLoader(h);this.resetInternalLoader(h.type);const n=f.data;0!==n.indexOf("#EXTM3U")?this.handleManifestParsingError(f,
h,Error("no EXTM3U delimiter"),k||null,g):(g.parsing.start=performance.now(),sb.isMediaPlaylist(n)?this.handleTrackOrLevelPlaylist(f,g,h,k||null,m):this.handleMasterPlaylist(f,g,h,k))},onError:(f,g,h,k)=>{this.handleNetworkError(g,h,!1,f,k)},onTimeout:(f,g,h)=>{this.handleNetworkError(g,h,!0,void 0,f)}})}handleMasterPlaylist(a,b,c,d){let e=this.hls,f=a.data,g=Jg(a,c),h=sb.parseMasterPlaylist(f,g);if(h.playlistParsingError)this.handleManifestParsingError(a,c,h.playlistParsingError,d,b);else{var {contentSteering:k,
levels:m,sessionData:n,sessionKeys:p,startTimeOffset:r,variableList:w}=h;this.variableList=w;var {AUDIO:z=[],SUBTITLES:x,"CLOSED-CAPTIONS":B}=sb.parseMasterPlaylistMedia(f,g,h);z.length&&!z.some(E=>!E.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(D.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),z.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Aa({}),bitrate:0,url:""}));e.trigger(u.MANIFEST_LOADED,
{levels:m,audioTracks:z,subtitles:x,captions:B,contentSteering:k,url:g,stats:b,networkDetails:d,sessionData:n,sessionKeys:p,startTimeOffset:r,variableList:w})}}handleTrackOrLevelPlaylist(a,b,c,d,e){let f=this.hls,{id:g,level:h,type:k}=c,m=Jg(a,c);var n=Y(g)?g:0,p=Y(h)?h:n;let r=po(c);n=sb.parseLevelPlaylist(a.data,m,p,r,n,this.variableList);k===la.MANIFEST&&(p={attrs:new Aa({}),bitrate:0,details:n,name:"",url:m},f.trigger(u.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:m,stats:b,networkDetails:d,
sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null}));b.parsing.end=performance.now();c.levelDetails=n;this.handlePlaylistLoaded(n,a,b,c,d,e)}handleManifestParsingError(a,b,c,d,e){this.hls.trigger(u.ERROR,{type:Z.NETWORK_ERROR,details:K.MANIFEST_PARSING_ERROR,fatal:b.type===la.MANIFEST,url:a.url,err:c,error:c,reason:c.message,response:a,context:b,networkDetails:d,stats:e})}handleNetworkError(a,b,c=!1,d,e){var f=`A network ${c?"timeout":"error"+(d?" (status "+
d.code+")":"")} occurred while loading ${a.type}`;if(a.type===la.LEVEL)f+=`: ${a.level} id: ${a.id}`;else if(a.type===la.AUDIO_TRACK||a.type===la.SUBTITLE_TRACK)f+=` id: ${a.id} group-id: "${a.groupId}"`;let g=Error(f);D.warn(`[playlist-loader]: ${f}`);f=K.UNKNOWN;let h=!1,k=this.getInternalLoader(a);switch(a.type){case la.MANIFEST:f=c?K.MANIFEST_LOAD_TIMEOUT:K.MANIFEST_LOAD_ERROR;h=!0;break;case la.LEVEL:f=c?K.LEVEL_LOAD_TIMEOUT:K.LEVEL_LOAD_ERROR;h=!1;break;case la.AUDIO_TRACK:f=c?K.AUDIO_TRACK_LOAD_TIMEOUT:
K.AUDIO_TRACK_LOAD_ERROR;h=!1;break;case la.SUBTITLE_TRACK:f=c?K.SUBTITLE_TRACK_LOAD_TIMEOUT:K.SUBTITLE_LOAD_ERROR,h=!1}k&&this.resetInternalLoader(a.type);c={type:Z.NETWORK_ERROR,details:f,fatal:h,url:a.url,loader:k,context:a,error:g,networkDetails:b,stats:e};d&&(c.response=Xa({url:(null==b?void 0:b.url)||a.url,data:void 0},d));this.hls.trigger(u.ERROR,c)}handlePlaylistLoaded(a,b,c,d,e,f){let g=this.hls,{type:h,level:k,id:m,groupId:n,deliveryDirectives:p}=d,r=Jg(b,d),w=po(d),z="number"===typeof d.level&&
w===ba.MAIN?k:void 0;if(a.fragments.length){a.targetduration||(a.playlistParsingError=Error("Missing Target Duration"));var x=a.playlistParsingError;if(x)g.trigger(u.ERROR,{type:Z.NETWORK_ERROR,details:K.LEVEL_PARSING_ERROR,fatal:!1,url:r,error:x,reason:x.message,response:b,context:d,level:z,parent:w,networkDetails:e,stats:c});else switch(a.live&&f&&(f.getCacheAge&&(a.ageHeader=f.getCacheAge()||0),!f.getCacheAge||isNaN(a.ageHeader))&&(a.ageHeader=0),h){case la.MANIFEST:case la.LEVEL:g.trigger(u.LEVEL_LOADED,
{details:a,level:z||0,id:m||0,stats:c,networkDetails:e,deliveryDirectives:p});break;case la.AUDIO_TRACK:g.trigger(u.AUDIO_TRACK_LOADED,{details:a,id:m||0,groupId:n||"",stats:c,networkDetails:e,deliveryDirectives:p});break;case la.SUBTITLE_TRACK:g.trigger(u.SUBTITLE_TRACK_LOADED,{details:a,id:m||0,groupId:n||"",stats:c,networkDetails:e,deliveryDirectives:p})}}else a=Error("No Segments found in Playlist"),g.trigger(u.ERROR,{type:Z.NETWORK_ERROR,details:K.LEVEL_EMPTY_ERROR,fatal:!1,url:r,error:a,reason:a.message,
response:b,context:d,level:z,parent:w,networkDetails:e,stats:c})}}let $f=(()=>{const a=Lg();try{new a(0,Number.POSITIVE_INFINITY,"")}catch(b){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class Ou{constructor(a){this.hls=void 0;this.media=this.id3Track=null;this.dateRangeCuesAppended={};this.hls=a;this._registerListeners()}destroy(){this._unregisterListeners();this.media=this.id3Track=null;this.dateRangeCuesAppended={};this.hls=null}_registerListeners(){let {hls:a}=this;a.on(u.MEDIA_ATTACHED,
this.onMediaAttached,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this);a.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this);a.on(u.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){let {hls:a}=this;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.FRAG_PARSING_METADATA,
this.onFragParsingMetadata,this);a.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this);a.off(u.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(a,b){this.media=b.media}onMediaDetaching(){this.id3Track&&(wc(this.id3Track),this.media=this.id3Track=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(a){a=this.getID3Track(a.textTracks);a.mode="hidden";return a}getID3Track(a){if(this.media){for(let b=0;b<a.length;b++){let c=a[b];if("metadata"===c.kind&&
"id3"===c.label)return qo(c,this.media),c}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(a,b){if(this.media){var {hls:{config:{enableEmsgMetadataCues:c,enableID3MetadataCues:d}}}=this;if(c||d){({samples:a}=b);this.id3Track||(this.id3Track=this.createTrack(this.media));b=Lg();for(let e=0;e<a.length;e++){let f=a[e].type;if("https://aomedia.org/emsg/ID3"===f&&!c||!d)continue;let g=Fq(a[e].data);if(g){let h=a[e].pts,k=h+a[e].duration;k>$f&&(k=$f);0>=k-h&&(k=h+.25);for(let m=0;m<
g.length;m++){let n=g[m];if(!Eq(n)){this.updateId3CueEnds(h,f);let p=new b(h,k,"");p.value=n;f&&(p.type=f);this.id3Track.addCue(p)}}}}}}}updateId3CueEnds(a,b){var c;let d=null==(c=this.id3Track)?void 0:c.cues;if(d)for(c=d.length;c--;){let e=d[c];e.type===b&&e.startTime<a&&e.endTime===$f&&(e.endTime=a)}}onBufferFlushing(a,{startOffset:b,endOffset:c,type:d}){let {id3Track:e,hls:f}=this;if(f){var {config:{enableEmsgMetadataCues:g,enableID3MetadataCues:h}}=f;e&&(g||h)&&Kg(e,b,c,"audio"===d?k=>"org.id3"===
k.type&&h:"video"===d?k=>"https://aomedia.org/emsg/ID3"===k.type&&g:k=>"org.id3"===k.type&&h||"https://aomedia.org/emsg/ID3"===k.type&&g)}}onLevelUpdated(a,{details:b}){if(this.media&&b.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var {dateRangeCuesAppended:c,id3Track:d}=this,{dateRanges:e}=b,f=Object.keys(e);if(d){a=Object.keys(c).filter(k=>!f.includes(k));for(var g=a.length;g--;){let k=a[g];Object.keys(c[k].cues).forEach(m=>{d.removeCue(c[k].cues[m])});delete c[k]}}b=b.fragments[b.fragments.length-
1];if(0!==f.length&&Y(null==b?void 0:b.programDateTime))for(this.id3Track||(this.id3Track=this.createTrack(this.media)),b=b.programDateTime/1E3-b.start,a=Lg(),g=0;g<f.length;g++){let k=f[g],m=e[k],n=c[k],p=(null==n?void 0:n.cues)||{},r=(null==n?void 0:n.durationKnown)||!1,w=Mg(m.startDate,b),z=$f;var h=m.endDate;h?(z=Mg(h,b),r=!0):m.endOnNext&&!r&&(h=f.reduce((x,B)=>{const E=e[B];E.class===m.class&&E.id!==B&&E.startDate>m.startDate&&x.push(E);return x},[]).sort((x,B)=>x.startDate.getTime()-B.startDate.getTime())[0])&&
(z=Mg(h.startDate,b),r=!0);h=Object.keys(m.attr);for(let x=0;x<h.length;x++){let B=h[x];if("ID"===B||"CLASS"===B||"START-DATE"===B||"DURATION"===B||"END-DATE"===B||"END-ON-NEXT"===B)continue;let E=p[B];if(E)r&&!n.durationKnown&&(E.endTime=z);else{let C=m.attr[B];E=new a(w,z,"");if("SCTE35-OUT"===B||"SCTE35-IN"===B)C=Uint8Array.from(C.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer;E.value={key:B,data:C};E.type="com.apple.quicktime.HLS";E.id=k;this.id3Track.addCue(E);
p[B]=E}}c[k]={cues:p,dateRange:m,durationKnown:r}}}}}class Pu{constructor(a){this.config=this.hls=void 0;this.levelDetails=this.media=null;this.stallCount=this.currentTime=0;this._latency=null;this.timeupdateHandler=()=>this.timeupdate();this.hls=a;this.config=a.config;this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){let {config:a,levelDetails:b}=this;return void 0!==a.liveMaxLatencyDuration?a.liveMaxLatencyDuration:b?a.liveMaxLatencyDurationCount*b.targetduration:0}get targetLatency(){var {levelDetails:a}=
this;if(null===a)return null;let {holdBack:b,partHoldBack:c,targetduration:d}=a,{liveSyncDuration:e,liveSyncDurationCount:f,lowLatencyMode:g}=this.config;a=this.hls.userConfig;let h=g?c||b:b;if(a.liveSyncDuration||a.liveSyncDurationCount||0===h)h=void 0!==e?e:f*d;return h+Math.min(1*this.stallCount,d)}get liveSyncPosition(){let a=this.estimateLiveEdge(),b=this.targetLatency,c=this.levelDetails;if(null===a||null===b||null===c)return null;let d=c.edge;return Math.min(Math.max(d-c.totalduration,a-b-
this.edgeStalled),d-(this.config.lowLatencyMode&&c.partTarget||c.targetduration))}get drift(){let {levelDetails:a}=this;return null===a?1:a.drift}get edgeStalled(){let {levelDetails:a}=this;return null===a?0:Math.max(a.age-3*(this.config.lowLatencyMode&&a.partTarget||a.targetduration),0)}get forwardBufferLength(){let {media:a,levelDetails:b}=this;if(!a||!b)return 0;let c=a.buffered.length;return(c?a.buffered.end(c-1):b.edge)-this.currentTime}destroy(){this.unregisterListeners();this.onMediaDetaching();
this.hls=this.timeupdateHandler=this.levelDetails=null}registerListeners(){this.hls.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);this.hls.on(u.MANIFEST_LOADING,this.onManifestLoading,this);this.hls.on(u.LEVEL_UPDATED,this.onLevelUpdated,this);this.hls.on(u.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);this.hls.off(u.MANIFEST_LOADING,
this.onManifestLoading,this);this.hls.off(u.LEVEL_UPDATED,this.onLevelUpdated,this);this.hls.off(u.ERROR,this.onError,this)}onMediaAttached(a,b){this.media=b.media;this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this._latency=this.levelDetails=null;this.stallCount=0}onLevelUpdated(a,{details:b}){this.levelDetails=b;b.advanced&&this.timeupdate();
!b.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(a,b){var c;b.details===K.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(c=this.levelDetails)&&c.live&&D.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){let {media:a,levelDetails:b}=this;if(a&&b){this.currentTime=a.currentTime;var c=this.computeLatency();if(null!==c){this._latency=c;var {lowLatencyMode:d,maxLiveSyncPlaybackRate:e}=this.config;if(d&&1!==e){var f=
this.targetLatency;null!==f&&(c-=f,f=Math.min(this.maxLatency,f+b.targetduration),b.live&&c<f&&.05<c&&1<this.forwardBufferLength?a.playbackRate=Math.min(Math.min(2,Math.max(1,e)),Math.max(1,Math.round(2/(1+Math.exp(-.75*c-this.edgeStalled))*20)/20)):1!==a.playbackRate&&0!==a.playbackRate&&(a.playbackRate=1))}}}}estimateLiveEdge(){let {levelDetails:a}=this;return null===a?null:a.edge+a.age}computeLatency(){let a=this.estimateLiveEdge();return null===a?null:a-this.currentTime}}let mm=["NONE","TYPE-0",
"TYPE-1",null];class Kq{constructor(a,b,c){this.msn=a;this.part=b;this.skip=c}addDirectives(a){a=new self.URL(a);void 0!==this.msn&&a.searchParams.set("_HLS_msn",this.msn.toString());void 0!==this.part&&a.searchParams.set("_HLS_part",this.part.toString());this.skip&&a.searchParams.set("_HLS_skip",this.skip);return a.href}}class Kd{constructor(a){this.details=this.audioGroupIds=this.unknownCodecs=this.width=this.videoCodec=this.name=this.id=this.height=this.codecSet=this.bitrate=this.audioCodec=this._attrs=
void 0;this.loadError=this.fragmentError=0;this.loaded=void 0;this.realBitrate=0;this.url=this.textGroupIds=void 0;this._urlId=0;this.url=[a.url];this._attrs=[a.attrs];this.bitrate=a.bitrate;a.details&&(this.details=a.details);this.id=a.id||0;this.name=a.name;this.width=a.width||0;this.height=a.height||0;this.audioCodec=a.audioCodec;this.videoCodec=a.videoCodec;this.unknownCodecs=a.unknownCodecs;this.codecSet=[a.videoCodec,a.audioCodec].filter(b=>b).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,
this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(a){a%=this.url.length;this._urlId!==a&&(this.loadError=this.fragmentError=0,this.details=void 0,this._urlId=a)}get audioGroupId(){var a;return null==(a=this.audioGroupIds)?void 0:a[this.urlId]}get textGroupId(){var a;return null==(a=this.textGroupIds)?void 0:a[this.urlId]}addFallback(a){this.url.push(a.url);
this._attrs.push(a.attrs)}}let zo={search:function(a,b){let c=0,d=a.length-1,e,f;for(;c<=d;){e=(c+d)/2|0;f=a[e];const g=b(f);if(0<g)c=e+1;else if(0>g)d=e-1;else return f}return null}};class Qu{constructor(a){this.hls=void 0;this.playlistError=0;this.penalizedRenditions={};this.error=this.warn=this.log=void 0;this.hls=a;this.log=D.log.bind(D,"[info]:");this.warn=D.warn.bind(D,"[warning]:");this.error=D.error.bind(D,"[error]:");this.registerListeners()}registerListeners(){let a=this.hls;a.on(u.ERROR,
this.onError,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let a=this.hls;a&&(a.off(u.ERROR,this.onError,this),a.off(u.ERROR,this.onErrorOut,this),a.off(u.MANIFEST_LOADING,this.onManifestLoading,this),a.off(u.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners();this.hls=null;this.penalizedRenditions={}}startLoad(a){this.playlistError=0}stopLoad(){}getVariantLevelIndex(a){return(null==a?void 0:
a.type)===ba.MAIN?a.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0;this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(a,b){var c,d;if(!b.fatal){a=this.hls;var e=b.context;switch(b.details){case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:b.errorAction=this.getFragRetryOrSwitchAction(b);return;case K.FRAG_PARSING_ERROR:if(null!=(c=b.frag)&&c.gap){b.errorAction={action:0,flags:0};return}case K.FRAG_GAP:case K.FRAG_DECRYPT_ERROR:b.errorAction=
this.getFragRetryOrSwitchAction(b);b.errorAction.action=2;return;case K.LEVEL_EMPTY_ERROR:case K.LEVEL_PARSING_ERROR:var f,g;c=b.parent===ba.MAIN?b.level:a.loadLevel;b.details===K.LEVEL_EMPTY_ERROR&&null!=(f=b.context)&&null!=(g=f.levelDetails)&&g.live?b.errorAction=this.getPlaylistRetryOrSwitchAction(b,c):(b.levelRetry=!1,b.errorAction=this.getLevelSwitchAction(b,c));return;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:"number"===typeof(null==e?void 0:e.level)&&(b.errorAction=this.getPlaylistRetryOrSwitchAction(b,
e.level));return;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.SUBTITLE_LOAD_ERROR:case K.SUBTITLE_TRACK_LOAD_TIMEOUT:e&&(f=a.levels[a.loadLevel])&&(e.type===la.AUDIO_TRACK&&e.groupId===f.audioGroupId||e.type===la.SUBTITLE_TRACK&&e.groupId===f.textGroupId)&&(b.errorAction=this.getPlaylistRetryOrSwitchAction(b,a.loadLevel),b.errorAction.action=2,b.errorAction.flags=1);return;case K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:f=a.levels[a.loadLevel];if(f=null==f?void 0:f.attrs["HDCP-LEVEL"])b.errorAction=
{action:2,flags:2,hdcpLevel:f};return;case K.BUFFER_ADD_CODEC_ERROR:case K.REMUX_ALLOC_ERROR:b.errorAction=this.getLevelSwitchAction(b,null!=(d=b.level)?d:a.loadLevel);return;case K.INTERNAL_EXCEPTION:case K.BUFFER_APPENDING_ERROR:case K.BUFFER_APPEND_ERROR:case K.BUFFER_FULL_ERROR:case K.LEVEL_SWITCH_ERROR:case K.BUFFER_STALLED_ERROR:case K.BUFFER_SEEK_OVER_HOLE:case K.BUFFER_NUDGE_ON_STALL:b.errorAction={action:0,flags:0};return}b.type===Z.KEY_SYSTEM_ERROR&&(f=this.getVariantLevelIndex(b.frag),
b.levelRetry=!1,b.errorAction=this.getLevelSwitchAction(b,f))}}getPlaylistRetryOrSwitchAction(a,b){var c;let d=xo(this.hls.config.playlistLoadPolicy,a),e=this.playlistError++,f=null==(c=a.response)?void 0:c.code;if(de(d,e,ce(a),f))return{action:5,flags:0,retryConfig:d,retryCount:e};a=this.getLevelSwitchAction(a,b);d&&(a.retryConfig=d,a.retryCount=e);return a}getFragRetryOrSwitchAction(a){var b=this.hls;let c=this.getVariantLevelIndex(a.frag);var d=b.levels[c];let {fragLoadPolicy:e,keyLoadPolicy:f}=
b.config,g=xo(a.details.startsWith("key")?f:e,a);b=b.levels.reduce((k,m)=>k+m.fragmentError,0);if(d){var h;a.details!==K.FRAG_GAP&&d.fragmentError++;d=null==(h=a.response)?void 0:h.code;if(de(g,b,ce(a),d))return{action:5,flags:0,retryConfig:g,retryCount:b}}a=this.getLevelSwitchAction(a,c);g&&(a.retryConfig=g,a.retryCount=b);return a}getLevelSwitchAction(a,b){let c=this.hls;if(null===b||void 0===b)b=c.loadLevel;if(b=this.hls.levels[b])if(b.loadError++,c.autoLevelEnabled){var d,e;let g=-1,{levels:h,
loadLevel:k,minAutoLevel:m,maxAutoLevel:n}=c,p=null==(d=a.frag)?void 0:d.type,{type:r,groupId:w}=null!=(e=a.context)?e:{};for(d=h.length;d--;)if(e=(d+k)%h.length,e!==k&&e>=m&&e<=n&&0===h[e].loadError){var f=h[e];if(a.details===K.FRAG_GAP&&a.frag){if(f=h[e].details)if(f=ad(a.frag,f.fragments,a.frag.start),null!=f&&f.gap)continue}else if(r===la.AUDIO_TRACK&&w===f.audioGroupId||r===la.SUBTITLE_TRACK&&w===f.textGroupId)continue;else if(p===ba.AUDIO&&b.audioGroupId===f.audioGroupId||p===ba.SUBTITLE&&b.textGroupId===
f.textGroupId)continue;g=e;break}if(-1<g&&c.loadLevel!==g)return a.levelRetry=!0,this.playlistError=0,{action:2,flags:0,nextAutoLevel:g}}return{action:2,flags:1}}onErrorOut(a,b){var c;switch(null==(c=b.errorAction)?void 0:c.action){case 2:this.sendAlternateToPenaltyBox(b),b.errorAction.resolved||b.details===K.FRAG_GAP||(b.fatal=!0)}b.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(a){let b=this.hls,c=a.errorAction;if(c){var {flags:d,hdcpLevel:e,nextAutoLevel:f}=c;switch(d){case 0:this.switchLevel(a,
f);break;case 1:c.resolved||(c.resolved=this.redundantFailover(a));break;case 2:e&&(b.maxHdcpLevel=mm[mm.indexOf(e)-1],c.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${b.maxHdcpLevel}" or lower`)}c.resolved||this.switchLevel(a,f)}}switchLevel(a,b){void 0!==b&&a.errorAction&&(this.warn(`switching to level ${b} after ${a.details}`),this.hls.nextAutoLevel=b,a.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(a){let {hls:b,penalizedRenditions:c}=
this,d=a.parent===ba.MAIN?a.level:b.loadLevel,e=b.levels[d],f=e.url.length,g=a.frag?a.frag.urlId:e.urlId;e.urlId!==g||a.frag&&!e.details||this.penalizeRendition(e,a);for(let h=1;h<f;h++){let k=(g+h)%f,m=c[k];if(!m||Cs(m,a,c[g]))return this.warn(`Switching to Redundant Stream ${k+1}/${f}: "${e.url[k]}" after ${a.details}`),this.playlistError=0,b.levels.forEach(n=>{n.urlId=k}),b.nextLoadLevel=d,!0}return!1}penalizeRendition(a,b){let {penalizedRenditions:c}=this,d=c[a.urlId]||{lastErrorPerfMs:0,errors:[],
details:void 0};d.lastErrorPerfMs=performance.now();d.errors.push(b);d.details=a.details;c[a.urlId]=d}}class nm{constructor(a,b){this.hls=void 0;this.requestScheduled=this.timer=-1;this.canLoad=!1;this.warn=this.log=void 0;this.log=D.log.bind(D,`${b}:`);this.warn=D.warn.bind(D,`${b}:`);this.hls=a}destroy(){this.clearTimer();this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer);this.timer=-1}startLoad(){this.canLoad=!0;this.requestScheduled=-1;this.loadPlaylist()}stopLoad(){this.canLoad=
!1;this.clearTimer()}switchParams(a,b){var c=null==b?void 0:b.renditionReports;if(c){var d=-1;for(let e=0;e<c.length;e++){let f=c[e],g;try{g=(new self.URL(f.URI,b.url)).href}catch(h){D.warn(`Could not construct new URL for Rendition Report: ${h}`),g=f.URI||""}if(g===a){d=e;break}else g===a.substring(0,g.length)&&(d=e)}if(-1!==d)return c=c[d],a=parseInt(c["LAST-MSN"])||(null==b?void 0:b.lastPartSn),c=parseInt(c["LAST-PART"])||(null==b?void 0:b.lastPartIndex),this.hls.config.lowLatencyMode&&(d=Math.min(b.age-
b.partTarget,b.targetduration),0<=c&&d>b.partTarget&&(c+=1)),new Kq(a,0<=c?c:void 0,"")}}loadPlaylist(a){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(a){return this.canLoad&&!!a&&!!a.url&&(!a.details||a.details.live)}shouldReloadPlaylist(a){return-1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(a)}playlistLoaded(a,b,c){let {details:d,stats:e}=b;var f=self.performance.now(),g=e.loading.first?Math.max(0,f-e.loading.first):0;d.advancedDateTime=
Date.now()-g;if(d.live||null!=c&&c.live){if(d.reloaded(c),c&&this.log(`live playlist ${a} ${d.advanced?"REFRESHED "+d.lastPartSn+"-"+d.lastPartIndex:d.updated?"UPDATED":"MISSED"}`),c&&0<d.fragments.length&&ws(c,d),this.canLoad&&d.live){var h=g=void 0;if(d.canBlockReload&&d.endSN&&d.advanced){let p=this.hls.config.lowLatencyMode;g=d.lastPartSn;let r=d.endSN;var k=d.lastPartIndex;let w=g===r;var m=p?0:k;-1!==k?(g=w?r+1:g,h=w?m:k+1):g=r+1;k=d.age;m=Math.min(k+d.ageHeader-d.partTarget,1.5*d.targetduration);
0<m&&(c&&m>c.tuneInGoal?(this.warn(`CDN Tune-in goal increased from: ${c.tuneInGoal} to: ${m} with playlist age: ${d.age}`),m=0):(c=Math.floor(m/d.targetduration),g+=c,void 0!==h&&(h+=Math.round(m%d.targetduration/d.partTarget)),this.log(`CDN Tune-in age: ${d.ageHeader}s last advanced ${k.toFixed(2)}s goal: ${m} skip sn ${c} to part ${h}`)),d.tuneInGoal=m);var n=this.getDeliveryDirectives(d,b.deliveryDirectives,g,h);if(p||!w){this.loadPlaylist(n);return}}else if(d.canBlockReload||d.canSkipUntil)n=
this.getDeliveryDirectives(d,b.deliveryDirectives,g,h);b=this.hls.mainForwardBufferInfo;b=As(d,1E3*(d.edge-(b?b.end-b.len:0)));d.updated&&f>this.requestScheduled+b&&(this.requestScheduled=e.loading.start);void 0!==g&&d.canBlockReload?this.requestScheduled=e.loading.first+b-(1E3*d.partTarget||1E3):-1===this.requestScheduled||this.requestScheduled+b<f?this.requestScheduled=f:0>=this.requestScheduled-f&&(this.requestScheduled+=b);f=this.requestScheduled-f;f=Math.max(0,f);this.log(`reload live playlist ${a} in ${Math.round(f)} ms`);
this.timer=self.setTimeout(()=>this.loadPlaylist(n),f)}}else this.clearTimer()}getDeliveryDirectives(a,b,c,d){{let {canSkipUntil:f,canSkipDateRanges:g,endSN:h}=a;var e=void 0!==c?c-h:0;e=f&&e<f?g?"v2":"YES":""}null!=b&&b.skip&&a.deltaUpdateFailed&&(c=b.msn,d=b.part,e="");return new Kq(c,d,e)}checkRetry(a){let b=a.details;var c=ce(a);let d=a.errorAction,{action:e,retryCount:f=0,retryConfig:g}=d||{},h=!!d&&!!g&&(5===e||!d.resolved&&2===e);if(h){var k;this.requestScheduled=-1;if(f>=g.maxNumRetry)return!1;
c&&null!=(k=a.context)&&k.deliveryDirectives?(this.warn(`Retrying playlist loading ${f+1}/${g.maxNumRetry} after "${b}" without delivery-directives`),this.loadPlaylist()):(c=Pg(g,f),this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${f+1}/${g.maxNumRetry} after "${b}" in ${c}ms`));a.levelRetry=!0;d.resolved=!0}return h}}let om;class Ru extends nm{constructor(a,b){super(a,"[level-controller]");this._levels=[];this._firstLevel=-1;this._startLevel=void 0;this.currentLevel=
null;this.manualLevelIndex=this.currentLevelIndex=-1;this.onParsedComplete=void 0;this.steering=b;this._registerListeners()}_registerListeners(){let {hls:a}=this;a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.MANIFEST_LOADED,this.onManifestLoaded,this);a.on(u.LEVEL_LOADED,this.onLevelLoaded,this);a.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this);a.on(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.on(u.FRAG_LOADED,this.onFragLoaded,this);a.on(u.ERROR,this.onError,this)}_unregisterListeners(){let {hls:a}=
this;a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_LOADED,this.onManifestLoaded,this);a.off(u.LEVEL_LOADED,this.onLevelLoaded,this);a.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this);a.off(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.off(u.FRAG_LOADED,this.onFragLoaded,this);a.off(u.ERROR,this.onError,this)}destroy(){this._unregisterListeners();this.steering=null;this.resetLevels();super.destroy()}startLoad(){this._levels.forEach(a=>{a.loadError=0;a.fragmentError=
0});super.startLoad()}resetLevels(){this._startLevel=void 0;this.currentLevelIndex=this.manualLevelIndex=-1;this.currentLevel=null;this._levels=[]}onManifestLoading(a,b){this.resetLevels()}onManifestLoaded(a,b){let c=[],d={},e;b.levels.forEach(f=>{var g;let h=f.attrs;-1!==(null==(g=f.audioCodec)?void 0:g.indexOf("mp4a.40.34"))&&(om||(om=/chrome|firefox/i.test(navigator.userAgent)),om&&(f.audioCodec=void 0));let {AUDIO:k,CODECS:m,"FRAME-RATE":n,"PATHWAY-ID":p,RESOLUTION:r,SUBTITLES:w}=h;g=`${`${p||
"."}-`}${f.bitrate}-${r}-${n}-${m}`;(e=d[g])?e.addFallback(f):(e=new Kd(f),d[g]=e,c.push(e));ee(e,"audio",k);ee(e,"text",w)});this.filterAndSortMediaOptions(c,b)}filterAndSortMediaOptions(a,b){var c=[];let d=[],e=!1,f=!1,g=!1;a=a.filter(({audioCodec:m,videoCodec:n,width:p,height:r,unknownCodecs:w})=>{e||(e=!(!p||!r));f||(f=!!n);g||(g=!!m);return!(null!=w&&w.length)&&(!m||Ig(m,"audio"))&&(!n||Ig(n,"video"))});(e||f)&&g&&(a=a.filter(({videoCodec:m,width:n,height:p})=>!!m||!(!n||!p)));if(0===a.length)Promise.resolve().then(()=>
{if(this.hls){let m=Error("no level with compatible codecs found in manifest");this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:b.url,error:m,reason:m.message})}});else{b.audioTracks&&(c=b.audioTracks.filter(m=>!m.audioCodec||Ig(m.audioCodec,"audio")),Ao(c));b.subtitles&&(d=b.subtitles,Ao(d));var h=a.slice(0);a.sort((m,n)=>m.attrs["HDCP-LEVEL"]!==n.attrs["HDCP-LEVEL"]?(m.attrs["HDCP-LEVEL"]||"")>(n.attrs["HDCP-LEVEL"]||"")?1:-1:m.bitrate!==n.bitrate?
m.bitrate-n.bitrate:m.attrs["FRAME-RATE"]!==n.attrs["FRAME-RATE"]?m.attrs.decimalFloatingPoint("FRAME-RATE")-n.attrs.decimalFloatingPoint("FRAME-RATE"):m.attrs.SCORE!==n.attrs.SCORE?m.attrs.decimalFloatingPoint("SCORE")-n.attrs.decimalFloatingPoint("SCORE"):e&&m.height!==n.height?m.height-n.height:0);var k=h[0];if(this.steering&&(a=this.steering.filterParsedLevels(a),a.length!==h.length))for(let m=0;m<h.length;m++)if(h[m].pathwayId===a[0].pathwayId){k=h[m];break}this._levels=a;for(h=0;h<a.length;h++)if(a[h]===
k){this._firstLevel=h;this.log(`manifest loaded, ${a.length} level(s) found, first bitrate: ${k.bitrate}`);break}c={levels:a,audioTracks:c,subtitleTracks:d,sessionData:b.sessionData,sessionKeys:b.sessionKeys,firstLevel:this._firstLevel,stats:b.stats,audio:g,video:f,altAudio:!(g&&!f)&&c.some(m=>!!m.url)};this.hls.trigger(u.MANIFEST_PARSED,c);(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}}get levels(){return 0===this._levels.length?null:
this._levels}get level(){return this.currentLevelIndex}set level(a){var b=this._levels;if(0!==b.length){if(0>a||a>=b.length){var c=Error("invalid level idx"),d=0>a;this.hls.trigger(u.ERROR,{type:Z.OTHER_ERROR,details:K.LEVEL_SWITCH_ERROR,level:a,fatal:d,error:c,reason:c.message});if(d)return;a=Math.min(a,b.length-1)}d=this.currentLevelIndex;var e=(c=this.currentLevel)?c.attrs["PATHWAY-ID"]:void 0;b=b[a];var f=b.attrs["PATHWAY-ID"];this.currentLevelIndex=a;this.currentLevel=b;if(d!==a||!b.details||
!c||e!==f)if(this.log(`Switching to level ${a}${f?" with Pathway "+f:""} from level ${d}${e?" with Pathway "+e:""}`),a=Ga({},b,{level:a,maxBitrate:b.maxBitrate,attrs:b.attrs,uri:b.uri,urlId:b.urlId}),delete a._attrs,delete a._urlId,this.hls.trigger(u.LEVEL_SWITCHING,a),a=b.details,!a||a.live)a=this.switchParams(b.uri,null==c?void 0:c.details),this.loadPlaylist(a)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(a){this.manualLevelIndex=a;void 0===this._startLevel&&(this._startLevel=
a);-1!==a&&(this.level=a)}get firstLevel(){return this._firstLevel}set firstLevel(a){this._firstLevel=a}get startLevel(){if(void 0===this._startLevel){let a=this.hls.config.startLevel;return void 0!==a?a:this._firstLevel}return this._startLevel}set startLevel(a){this._startLevel=a}onError(a,b){!b.fatal&&b.context&&b.context.type===la.LEVEL&&b.context.level===this.level&&this.checkRetry(b)}onFragLoaded(a,{frag:b}){void 0!==b&&b.type===ba.MAIN&&(a=this._levels[b.level],void 0!==a&&(a.loadError=0))}onLevelLoaded(a,
b){var c;let {level:d,details:e}=b;a=this._levels[d];if(a)d===this.currentLevelIndex?(0===a.fragmentError&&(a.loadError=0),this.playlistLoaded(d,b,a.details)):null!=(c=b.deliveryDirectives)&&c.skip&&(e.deltaUpdateFailed=!0);else{var f;this.warn(`Invalid level index ${d}`);null!=(f=b.deliveryDirectives)&&f.skip&&(e.deltaUpdateFailed=!0)}}onAudioTrackSwitched(a,b){if(a=this.currentLevel)if(b=this.hls.audioTracks[b.id].groupId,a.audioGroupIds&&a.audioGroupId!==b){let c=-1;for(let d=0;d<a.audioGroupIds.length;d++)if(a.audioGroupIds[d]===
b){c=d;break}-1!==c&&c!==a.urlId&&(a.urlId=c,this.canLoad&&this.startLoad())}}loadPlaylist(a){super.loadPlaylist();let b=this.currentLevelIndex,c=this.currentLevel;if(c&&this.shouldLoadPlaylist(c)){let d=c.urlId,e=c.uri;if(a)try{e=a.addDirectives(e)}catch(g){this.warn(`Could not construct new URL with HLS Delivery Directives: ${g}`)}let f=c.attrs["PATHWAY-ID"];this.log(`Loading level index ${b}${void 0!==(null==a?void 0:a.msn)?" at sn "+a.msn+" part "+a.part:""} with${f?" Pathway "+f:""} URI ${d+
1}/${c.url.length} ${e}`);this.clearTimer();this.hls.trigger(u.LEVEL_LOADING,{url:e,level:b,id:d,deliveryDirectives:a||null})}}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(a){this.level=a;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=a)}removeLevel(a,b){let c=(e,f)=>f!==b,d=this._levels.filter((e,f)=>{if(f!==a)return!0;if(1<e.url.length&&void 0!==b)return e.url=e.url.filter(c),e.audioGroupIds&&(e.audioGroupIds=e.audioGroupIds.filter(c)),
e.textGroupIds&&(e.textGroupIds=e.textGroupIds.filter(c)),e.urlId=0,!0;this.steering&&this.steering.removeLevel(e);return!1});this.hls.trigger(u.LEVELS_UPDATED,{levels:d})}onLevelsUpdated(a,{levels:b}){b.forEach((c,d)=>{({details:c}=c);null!=c&&c.fragments&&c.fragments.forEach(e=>{e.level=d})});this._levels=b}}class Su{constructor(a){this.activePartLists=Object.create(null);this.endListFragments=Object.create(null);this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.bufferPadding=
.2;this.hasGaps=!1;this.hls=a;this._registerListeners()}_registerListeners(){let {hls:a}=this;a.on(u.BUFFER_APPENDED,this.onBufferAppended,this);a.on(u.FRAG_BUFFERED,this.onFragBuffered,this);a.on(u.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let {hls:a}=this;a.off(u.BUFFER_APPENDED,this.onBufferAppended,this);a.off(u.FRAG_BUFFERED,this.onFragBuffered,this);a.off(u.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners();this.fragments=this.activePartLists=this.endListFragments=
this.timeRanges=null}getAppendedFrag(a,b){let c=this.activePartLists[b];if(c)for(let d=c.length;d--;){let e=c[d];if(!e)break;let f=e.end;if(e.start<=a&&null!==f&&a<=f)return e}return this.getBufferedFrag(a,b)}getBufferedFrag(a,b){let {fragments:c}=this,d=Object.keys(c);for(let f=d.length;f--;){var e=c[d[f]];if((null==e?void 0:e.body.type)===b&&e.buffered&&(e=e.body,e.start<=a&&a<=e.end))return e}return null}detectEvictedFragments(a,b,c,d){this.timeRanges&&(this.timeRanges[a]=b);let e=(null==d?void 0:
d.fragment.sn)||-1;Object.keys(this.fragments).forEach(f=>{let g=this.fragments[f];!g||e>=g.body.sn||(g.buffered||g.loaded?(f=g.range[a])&&f.time.some(h=>{(h=!this.isTimeBuffered(h.startPTS,h.endPTS,b))&&this.removeFragment(g.body);return h}):g.body.type===c&&this.removeFragment(g.body))})}detectPartialFragments(a){let b=this.timeRanges,{frag:c,part:d}=a;if(b&&"initSegment"!==c.sn){a=xc(c);var e=this.fragments[a];if(!(!e||e.buffered&&c.gap)){var f=!c.relurl;Object.keys(b).forEach(g=>{let h=c.elementaryStreams[g];
h&&(e.range[g]=this.getBufferedTimes(c,d,f||!0===h.partial,b[g]))});e.loaded=null;if(Object.keys(e.range).length){e.buffered=!0;if(e.body.endList=c.endList||e.body.endList)this.endListFragments[e.body.type]=e;fe(e)||this.removeParts(c.sn-1,c.type)}else this.removeFragment(e.body)}}}removeParts(a,b){let c=this.activePartLists[b];c&&(this.activePartLists[b]=c.filter(d=>d.fragment.sn>=a))}fragBuffered(a,b){let c=xc(a),d=this.fragments[c];!d&&b&&(d=this.fragments[c]={body:a,appendedPTS:null,loaded:null,
buffered:!1,range:Object.create(null)},a.gap&&(this.hasGaps=!0));d&&(d.loaded=null,d.buffered=!0)}getBufferedTimes(a,b,c,d){b={time:[],partial:c};c=a.start;let e=a.end,f=a.minEndPTS||e;a=a.maxStartPTS||c;for(let g=0;g<d.length;g++){let h=d.start(g)-this.bufferPadding,k=d.end(g)+this.bufferPadding;if(a>=h&&f<=k){b.time.push({startPTS:Math.max(c,d.start(g)),endPTS:Math.min(e,d.end(g))});break}else if(c<k&&e>h)b.partial=!0,b.time.push({startPTS:Math.max(c,d.start(g)),endPTS:Math.min(e,d.end(g))});else if(e<=
h)break}return b}getPartialFragment(a){let b=null,c,d,e,f=0,{bufferPadding:g,fragments:h}=this;Object.keys(h).forEach(k=>{(k=h[k])&&fe(k)&&(d=k.body.start-g,e=k.body.end+g,a>=d&&a<=e&&(c=Math.min(a-d,e-a),f<=c&&(b=k.body,f=c)))});return b}isEndListAppended(a){a=this.endListFragments[a];return void 0!==a&&(a.buffered||fe(a))}getState(a){a=xc(a);return(a=this.fragments[a])?a.buffered?fe(a)?"PARTIAL":"OK":"APPENDING":"NOT_LOADED"}isTimeBuffered(a,b,c){let d,e;for(let f=0;f<c.length;f++){d=c.start(f)-
this.bufferPadding;e=c.end(f)+this.bufferPadding;if(a>=d&&b<=e)return!0;if(b<=d)break}return!1}onFragLoaded(a,b){let {frag:c,part:d}=b;"initSegment"===c.sn||c.bitrateTest||(a=d?null:b,b=xc(c),this.fragments[b]={body:c,appendedPTS:null,loaded:a,buffered:!1,range:Object.create(null)})}onBufferAppended(a,b){let {frag:c,part:d,timeRanges:e}=b;if("initSegment"!==c.sn){var f=c.type;d&&((a=this.activePartLists[f])||(this.activePartLists[f]=a=[]),a.push(d));this.timeRanges=e;Object.keys(e).forEach(g=>{this.detectEvictedFragments(g,
e[g],f,d)})}}onFragBuffered(a,b){this.detectPartialFragments(b)}hasFragment(a){a=xc(a);return!!this.fragments[a]}hasParts(a){var b;return!(null==(b=this.activePartLists[a])||!b.length)}removeFragmentsInRange(a,b,c,d,e){d&&!this.hasGaps||Object.keys(this.fragments).forEach(f=>{if(f=this.fragments[f]){var g=f.body;g.type!==c||d&&!g.gap||g.start<b&&g.end>a&&(f.buffered||e)&&this.removeFragment(g)}})}removeFragment(a){let b=xc(a);a.stats.loaded=0;a.clearElementaryStreamInfo();let c=this.activePartLists[a.type];
if(c){let d=a.sn;this.activePartLists[a.type]=c.filter(e=>e.fragment.sn!==d)}delete this.fragments[b];a.endList&&delete this.endListFragments[a.type]}removeAllFragments(){this.fragments=Object.create(null);this.endListFragments=Object.create(null);this.activePartLists=Object.create(null);this.hasGaps=!1}}let Lq=Math.pow(2,17);class Tu{constructor(a){this.loader=null;this.partLoadTimeout=-1;this.config=a}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(a,
b){let c=a.url;if(!c)return Promise.reject(new Bb({type:Z.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:a,error:Error(`Fragment does not have a ${c?"part list":"url"}`),networkDetails:null}));this.abort();let d=this.config,e=d.fLoader,f=d.loader;return new Promise((g,h)=>{this.loader&&this.loader.destroy();if(a.gap){if(a.tagList.some(r=>"GAP"===r[0])){h(Co(a));return}a.gap=!1}let k=this.loader=a.loader=e?new e(d):new f(d),m=Bo(a),n=yo(d.fragLoadPolicy.default),p={loadPolicy:n,timeout:n.maxLoadTimeMs,
maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===a.sn?Infinity:Lq};a.stats=k.stats;k.load(m,p,{onSuccess:(r,w,z,x)=>{this.resetLoader(a,k);r=r.data;z.resetIV&&a.decryptdata&&(a.decryptdata.iv=new Uint8Array(r.slice(0,16)),r=r.slice(16));g({frag:a,part:null,payload:r,networkDetails:x})},onError:(r,w,z,x)=>{this.resetLoader(a,k);h(new Bb({type:Z.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:a,response:Xa({url:c,data:void 0},r),error:Error(`HTTP Error ${r.code} ${r.text}`),
networkDetails:z,stats:x}))},onAbort:(r,w,z)=>{this.resetLoader(a,k);h(new Bb({type:Z.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:a,error:Error("Aborted"),networkDetails:z,stats:r}))},onTimeout:(r,w,z)=>{this.resetLoader(a,k);h(new Bb({type:Z.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,fatal:!1,frag:a,error:Error(`Timeout after ${p.timeout}ms`),networkDetails:z,stats:r}))},onProgress:(r,w,z,x)=>{b&&b({frag:a,part:null,payload:z,networkDetails:x})}})})}loadPart(a,b,c){this.abort();let d=this.config,
e=d.fLoader,f=d.loader;return new Promise((g,h)=>{this.loader&&this.loader.destroy();if(a.gap||b.gap)h(Co(a,b));else{var k=this.loader=a.loader=e?new e(d):new f(d),m=Bo(a,b),n=yo(d.fragLoadPolicy.default),p={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Lq};b.stats=k.stats;k.load(m,p,{onSuccess:(r,w,z,x)=>{this.resetLoader(a,k);this.updateStatsFromPart(a,b);r={frag:a,part:b,payload:r.data,networkDetails:x};c(r);g(r)},onError:(r,w,z,x)=>{this.resetLoader(a,
k);h(new Bb({type:Z.NETWORK_ERROR,details:K.FRAG_LOAD_ERROR,fatal:!1,frag:a,part:b,response:Xa({url:m.url,data:void 0},r),error:Error(`HTTP Error ${r.code} ${r.text}`),networkDetails:z,stats:x}))},onAbort:(r,w,z)=>{a.stats.aborted=b.stats.aborted;this.resetLoader(a,k);h(new Bb({type:Z.NETWORK_ERROR,details:K.INTERNAL_ABORTED,fatal:!1,frag:a,part:b,error:Error("Aborted"),networkDetails:z,stats:r}))},onTimeout:(r,w,z)=>{this.resetLoader(a,k);h(new Bb({type:Z.NETWORK_ERROR,details:K.FRAG_LOAD_TIMEOUT,
fatal:!1,frag:a,part:b,error:Error(`Timeout after ${p.timeout}ms`),networkDetails:z,stats:r}))}})}})}updateStatsFromPart(a,b){var c=a.stats,d=b.stats,e=d.total;c.loaded+=d.loaded;e?(a=Math.round(a.duration/b.duration),e=Math.min(Math.round(c.loaded/e),a),c.total=c.loaded+(a-e)*Math.round(c.loaded/e)):c.total=Math.max(c.loaded,c.total);c=c.loading;d=d.loading;c.start?c.first+=d.first-d.start:(c.start=d.start,c.first=d.first);c.end=d.end}resetLoader(a,b){a.loader=null;this.loader===b&&(self.clearTimeout(this.partLoadTimeout),
this.loader=null);b.destroy()}}class Bb extends Error{constructor(a){super(a.error.message);this.data=void 0;this.data=a}}class Uu{constructor(a){this.keyUriToKeyInfo={};this.emeController=null;this.config=a}abort(a){for(let b in this.keyUriToKeyInfo){let c=this.keyUriToKeyInfo[b].loader;if(c){if(a&&a!==c.context.frag.type)break;c.abort()}}}detach(){for(let a in this.keyUriToKeyInfo){let b=this.keyUriToKeyInfo[a];(b.mediaKeySessionContext||b.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[a]}}destroy(){this.detach();
for(let a in this.keyUriToKeyInfo){let b=this.keyUriToKeyInfo[a].loader;b&&b.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(a,b=K.KEY_LOAD_ERROR,c,d,e){return new Bb({type:Z.NETWORK_ERROR,details:b,fatal:!1,frag:a,response:e,error:c,networkDetails:d})}loadClear(a,b){if(this.emeController&&this.config.emeEnabled){let {sn:c,cc:d}=a;for(a=0;a<b.length;a++){let e=b[a];if(d<=e.cc&&("initSegment"===c||"initSegment"===e.sn||c<e.sn)){this.emeController.selectKeySystemFormat(e).then(f=>{e.setKeyFormat(f)});
break}}}}load(a){return!a.decryptdata&&a.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(a).then(b=>this.loadInternal(a,b)):this.loadInternal(a)}loadInternal(a,b){var c,d;b&&a.setKeyFormat(b);let e=a.decryptdata;if(!e)return Promise.reject(this.createKeyLoadError(a,K.KEY_LOAD_ERROR,Error(b?`Expected frag.decryptdata to be defined after setting format ${b}`:"Missing decryption data on fragment in onKeyLoading")));b=e.uri;if(!b)return Promise.reject(this.createKeyLoadError(a,
K.KEY_LOAD_ERROR,Error(`Invalid key URI: "${b}"`)));let f=this.keyUriToKeyInfo[b];if(null!=(c=f)&&c.decryptdata.key)return e.key=f.decryptdata.key,Promise.resolve({frag:a,keyInfo:f});if(null!=(d=f)&&d.keyLoadPromise){var g;switch(null==(g=f.mediaKeySessionContext)?void 0:g.keyStatus){case void 0:case "status-pending":case "usable":case "usable-in-future":return f.keyLoadPromise.then(h=>{e.key=h.keyInfo.decryptdata.key;return{frag:a,keyInfo:f}})}}f=this.keyUriToKeyInfo[b]={decryptdata:e,keyLoadPromise:null,
loader:null,mediaKeySessionContext:null};switch(e.method){case "ISO-23001-7":case "SAMPLE-AES":case "SAMPLE-AES-CENC":case "SAMPLE-AES-CTR":return"identity"===e.keyFormat?this.loadKeyHTTP(f,a):this.loadKeyEME(f,a);case "AES-128":return this.loadKeyHTTP(f,a);default:return Promise.reject(this.createKeyLoadError(a,K.KEY_LOAD_ERROR,Error(`Key supplied with unsupported METHOD: "${e.method}"`)))}}loadKeyEME(a,b){let c={frag:b,keyInfo:a};return this.emeController&&this.config.emeEnabled&&(b=this.emeController.loadKey(c))?
(a.keyLoadPromise=b.then(d=>{a.mediaKeySessionContext=d;return c})).catch(d=>{a.keyLoadPromise=null;throw d;}):Promise.resolve(c)}loadKeyHTTP(a,b){let c=this.config,d=new c.loader(c);b.keyLoader=a.loader=d;return a.keyLoadPromise=new Promise((e,f)=>{let g={keyInfo:a,frag:b,responseType:"arraybuffer",url:a.decryptdata.uri},h=c.keyLoadPolicy.default;d.load(g,{loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(k,m,n,p)=>{const {frag:r,keyInfo:w,url:z}=n;if(!r.decryptdata||
w!==this.keyUriToKeyInfo[z])return f(this.createKeyLoadError(r,K.KEY_LOAD_ERROR,Error("after key load, decryptdata unset or changed"),p));w.decryptdata.key=r.decryptdata.key=new Uint8Array(k.data);r.keyLoader=null;w.loader=null;e({frag:r,keyInfo:w})},onError:(k,m,n,p)=>{this.resetLoader(m);f(this.createKeyLoadError(b,K.KEY_LOAD_ERROR,Error(`HTTP Error ${k.code} loading key ${k.text}`),n,Xa({url:g.url,data:void 0},k)))},onTimeout:(k,m,n)=>{this.resetLoader(m);f(this.createKeyLoadError(b,K.KEY_LOAD_TIMEOUT,
Error("key loading timed out"),n))},onAbort:(k,m,n)=>{this.resetLoader(m);f(this.createKeyLoadError(b,K.INTERNAL_ABORTED,Error("key loading aborted"),n))}})})}resetLoader(a){let {frag:b,keyInfo:c,url:d}=a;a=c.loader;b.keyLoader===a&&(b.keyLoader=null,c.loader=null);delete this.keyUriToKeyInfo[d];a&&a.destroy()}}class Vu{constructor(){this._boundTick=void 0;this._tickInterval=this._tickTimer=null;this._tickCallCount=0;this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying();this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick();
this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(a){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,a),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++;1===this._tickCallCount&&
(this.doTick(),1<this._tickCallCount&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick();this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}let Wu={length:0,start:()=>0,end:()=>0};class va{static isBuffered(a,b){try{if(a){let c=va.getBuffered(a);for(a=0;a<c.length;a++)if(b>=c.start(a)&&b<=c.end(a))return!0}}catch(c){}return!1}static bufferInfo(a,b,c){try{if(a){let d=va.getBuffered(a);a=[];let e;for(e=0;e<d.length;e++)a.push({start:d.start(e),end:d.end(e)});
return this.bufferedInfo(a,b,c)}}catch(d){}return{len:0,start:b,end:b,nextStart:void 0}}static bufferedInfo(a,b,c){b=Math.max(0,b);a.sort(function(k,m){let n=k.start-m.start;return n?n:m.end-k.end});let d=[];if(c)for(var e=0;e<a.length;e++){var f=d.length;if(f){var g=d[f-1].end;a[e].start-g<c?a[e].end>g&&(d[f-1].end=a[e].end):d.push(a[e])}else d.push(a[e])}else d=a;a=0;let h;f=e=b;for(g=0;g<d.length;g++){let k=d[g].start,m=d[g].end;if(b+c>=k&&b<m)e=k,f=m,a=f-b;else if(b+c<k){h=k;break}}return{len:a,
start:e||0,end:f||0,nextStart:h}}static getBuffered(a){try{return a.buffered}catch(b){return D.log("failed to get media.buffered",b),Wu}}}class pm{constructor(a,b,c,d=0,e=-1,f=!1){this.partial=this.size=this.id=this.part=this.sn=this.level=void 0;this.transmuxing=ge();this.buffering={audio:ge(),video:ge(),audiovideo:ge()};this.level=a;this.sn=b;this.id=c;this.size=d;this.part=e;this.partial=f}}class Xu{constructor(a,b){this.aesIV=this.subtle=void 0;this.subtle=a;this.aesIV=b}decrypt(a,b){return this.subtle.decrypt({name:"AES-CBC",
iv:this.aesIV},b,a)}}class Yu{constructor(a,b){this.key=this.subtle=void 0;this.subtle=a;this.key=b}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class Zu{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=
new Uint32Array(256);this.key=new Uint32Array(0);this.keySize=this.ksRows=0;this.invKeySchedule=this.keySchedule=void 0;this.initTable()}uint8ArrayToUint32Array_(a){a=new DataView(a);let b=new Uint32Array(4);for(let c=0;4>c;c++)b[c]=a.getUint32(4*c);return b}initTable(){let a=this.sBox,b=this.invSBox;var c=this.subMix;let d=c[0],e=c[1],f=c[2];c=c[3];var g=this.invSubMix;let h=g[0],k=g[1],m=g[2];g=g[3];let n=new Uint32Array(256),p=0,r=0,w;for(w=0;256>w;w++)n[w]=128>w?w<<1:w<<1^283;for(w=0;256>w;w++){let z=
r^r<<1^r<<2^r<<3^r<<4;z=z>>>8^z&255^99;a[p]=z;b[z]=p;let x=n[p],B=n[x],E=n[B],C=257*n[z]^16843008*z;d[p]=C<<24|C>>>8;e[p]=C<<16|C>>>16;f[p]=C<<8|C>>>24;c[p]=C;C=16843009*E^65537*B^257*x^16843008*p;h[z]=C<<24|C>>>8;k[z]=C<<16|C>>>16;m[z]=C<<8|C>>>24;g[z]=C;p?(p=x^n[n[n[E^x]]],r^=n[n[r]]):p=r=1}}expandKey(a){a=this.uint8ArrayToUint32Array_(a);for(var b=!0,c=0;c<a.length&&b;)b=a[c]===this.key[c],c++;if(!b){this.key=a;var d=this.keySize=a.length;if(4!==d&&6!==d&&8!==d)throw Error("Invalid aes key size="+
d);b=this.ksRows=4*(d+6+1);c=this.keySchedule=new Uint32Array(b);var e=this.invKeySchedule=new Uint32Array(b),f=this.sBox,g=this.rcon;var h=this.invSubMix;var k=h[0],m=h[1],n=h[2],p=h[3];for(h=0;h<b;h++)if(h<d)var r=c[h]=a[h];else 0===h%d?(r=r<<8|r>>>24,r=f[r>>>24]<<24|f[r>>>16&255]<<16|f[r>>>8&255]<<8|f[r&255],r^=g[h/d|0]<<24):6<d&&4===h%d&&(r=f[r>>>24]<<24|f[r>>>16&255]<<16|f[r>>>8&255]<<8|f[r&255]),c[h]=r=(c[h-d]^r)>>>0;for(a=0;a<b;a++)h=b-a,r=a&3?c[h]:c[h-4],e[a]=4>a||4>=h?r:k[f[r>>>24]]^m[f[r>>>
16&255]]^n[f[r>>>8&255]]^p[f[r&255]],e[a]>>>=0}}networkToHostOrderSwap(a){return a<<24|(a&65280)<<8|(a&16711680)>>8|a>>>24}decrypt(a,b,c){let d=this.keySize+6,e=this.invKeySchedule,f=this.invSBox;var g=this.invSubMix;let h=g[0],k=g[1],m=g[2];g=g[3];var n=this.uint8ArrayToUint32Array_(c);c=n[0];let p=n[1],r=n[2];n=n[3];a=new Int32Array(a);let w=new Int32Array(a.length),z,x,B;let E,C,I,F,O,R,J,aa,qa,za=this.networkToHostOrderSwap;for(;b<a.length;){F=za(a[b]);O=za(a[b+1]);R=za(a[b+2]);J=za(a[b+3]);E=
F^e[0];C=J^e[1];I=R^e[2];var Ea=O^e[3];aa=4;for(qa=1;qa<d;qa++)z=h[E>>>24]^k[C>>16&255]^m[I>>8&255]^g[Ea&255]^e[aa],x=h[C>>>24]^k[I>>16&255]^m[Ea>>8&255]^g[E&255]^e[aa+1],B=h[I>>>24]^k[Ea>>16&255]^m[E>>8&255]^g[C&255]^e[aa+2],Ea=h[Ea>>>24]^k[E>>16&255]^m[C>>8&255]^g[I&255]^e[aa+3],E=z,C=x,I=B,aa+=4;z=f[E>>>24]<<24^f[C>>16&255]<<16^f[I>>8&255]<<8^f[Ea&255]^e[aa];x=f[C>>>24]<<24^f[I>>16&255]<<16^f[Ea>>8&255]<<8^f[E&255]^e[aa+1];B=f[I>>>24]<<24^f[Ea>>16&255]<<16^f[E>>8&255]<<8^f[C&255]^e[aa+2];Ea=f[Ea>>>
24]<<24^f[E>>16&255]<<16^f[C>>8&255]<<8^f[I&255]^e[aa+3];w[b]=za(z^c);w[b+1]=za(Ea^p);w[b+2]=za(B^r);w[b+3]=za(x^n);c=F;p=O;r=R;n=J;b+=4}return w.buffer}}class qm{constructor(a,{removePKCS7Padding:b=!0}={}){this.logEnabled=!0;this.removePKCS7Padding=void 0;this.currentResult=this.currentIV=this.remainderData=this.fastAesKey=this.key=this.softwareDecrypter=this.subtle=null;this.useSoftware=a.enableSoftwareAES;if(this.removePKCS7Padding=b)try{let c=self.crypto;c&&(this.subtle=c.subtle||c.webkitSubtle)}catch(c){}null===
this.subtle&&(this.useSoftware=!0)}destroy(){this.currentResult=this.currentIV=this.remainderData=this.fastAesKey=this.key=this.softwareDecrypter=this.subtle=null}isSync(){return this.useSoftware}flush(){let {currentResult:a,remainderData:b}=this;if(!a||b)return this.reset(),null;var c=new Uint8Array(a);this.reset();if(this.removePKCS7Padding){{let d=c.byteLength,e=d&&(new DataView(c.buffer)).getUint8(d-1);c=e?dc(c,0,d-e):c}return c}return c}reset(){this.remainderData=this.currentIV=this.currentResult=
null;this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(a,b,c){return this.useSoftware?new Promise((d,e)=>{this.softwareDecrypt(new Uint8Array(a),b,c);let f=this.flush();f?d(f.buffer):e(Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(a),b,c)}softwareDecrypt(a,b,c){let {currentIV:d,currentResult:e,remainderData:f}=this;this.logOnce("JS AES decrypt");f&&(a=ec(f,a),this.remainderData=null);a=this.getValidChunk(a);if(!a.length)return null;d&&(c=d);
let g=this.softwareDecrypter;g||(g=this.softwareDecrypter=new Zu);g.expandKey(b);this.currentResult=g.decrypt(a.buffer,0,c);this.currentIV=dc(a,-16).buffer;return e?e:null}webCryptoDecrypt(a,b,c){let d=this.subtle;this.key===b&&this.fastAesKey||(this.key=b,this.fastAesKey=new Yu(d,b));return this.fastAesKey.expandKey().then(e=>{if(!d)return Promise.reject(Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return(new Xu(d,new Uint8Array(c))).decrypt(a.buffer,e)}).catch(e=>{D.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${e.name}: ${e.message}`);
return this.onWebCryptoError(a,b,c)})}onWebCryptoError(a,b,c){this.logEnabled=this.useSoftware=!0;this.softwareDecrypt(a,b,c);if(a=this.flush())return a.buffer;throw Error("WebCrypto and softwareDecrypt: failed to decrypt data");}getValidChunk(a){let b=a,c=a.length-a.length%16;c!==a.length&&(b=dc(a,0,c),this.remainderData=dc(a,c));return b}logOnce(a){this.logEnabled&&(D.log(`[decrypter]: ${a}`),this.logEnabled=!1)}}let $u={toString:function(a){let b="";const c=a.length;for(let d=0;d<c;d++)b+=`[${a.start(d).toFixed(3)}-${a.end(d).toFixed(3)}]`;
return b}};class rm extends Vu{constructor(a,b,c,d,e){super();this.hls=void 0;this.fragCurrent=this.fragPrevious=null;this.fragmentTracker=void 0;this.transmuxer=null;this._state="STOPPED";this.playlistType=void 0;this.mediaBuffer=this.media=null;this.config=void 0;this.bitrateTest=!1;this.startPosition=this.nextLoadPosition=this.lastCurrentTime=0;this.startTimeOffset=null;this.loadedmetadata=!1;this.retryDate=0;this.levels=null;this.keyLoader=this.fragmentLoader=void 0;this.levelLastLoaded=null;
this.startFragRequested=!1;this.decrypter=void 0;this.initPTS=[];this.onvended=this.onvseeking=null;this.logPrefix="";this.warn=this.log=void 0;this.playlistType=e;this.logPrefix=d;this.log=D.log.bind(D,`${d}:`);this.warn=D.warn.bind(D,`${d}:`);this.hls=a;this.fragmentLoader=new Tu(a.config);this.keyLoader=c;this.fragmentTracker=b;this.config=a.config;this.decrypter=new qm(a.config);a.on(u.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(a){}stopLoad(){this.fragmentLoader.abort();
this.keyLoader.abort(this.playlistType);let a=this.fragCurrent;null!=a&&a.loader&&(a.abortRequests(),this.fragmentTracker.removeFragment(a));this.resetTransmuxer();this.fragPrevious=this.fragCurrent=null;this.clearInterval();this.clearNextTick();this.state="STOPPED"}_streamEnded(a,b){if(b.live||a.nextStart||!a.end||!this.media)return!1;a=b.partList;return null!=a&&a.length?(b=a[a.length-1],va.isBuffered(this.media,b.start+b.duration/2)):this.fragmentTracker.isEndListAppended(b.fragments[b.fragments.length-
1].type)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded){var a;return null==(a=this.levels[this.levelLastLoaded])?void 0:a.details}}onMediaAttached(a,b){a=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);a.addEventListener("seeking",this.onvseeking);a.addEventListener("ended",this.onvended);a=this.config;this.levels&&a.autoStartLoad&&"STOPPED"===this.state&&this.startLoad(a.startPosition)}onMediaDetaching(){let a=
this.media;null!=a&&a.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);a&&this.onvseeking&&this.onvended&&(a.removeEventListener("seeking",this.onvseeking),a.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null);this.keyLoader&&this.keyLoader.detach();this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.fragmentTracker.removeAllFragments();this.stopLoad()}onMediaSeeking(){let {config:a,fragCurrent:b,
media:c,mediaBuffer:d,state:e}=this,f=c?c.currentTime:0,g=va.bufferInfo(d?d:c,f,a.maxBufferHole);this.log(`media seeking to ${Y(f)?f.toFixed(3):f}, state: ${e}`);if("ENDED"===this.state)this.resetLoadingState();else if(b){var h=a.maxFragLookUpTolerance;let k=b.start-h;h=b.start+b.duration+h;if(!g.len||h<g.start||k>g.end)if(h=f>h,f<k||h)h&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.abortRequests(),this.resetLoadingState()),this.fragPrevious=
null}c&&(this.fragmentTracker.removeFragmentsInRange(f,Infinity,this.playlistType,!0),this.lastCurrentTime=f);this.loadedmetadata||g.len||(this.nextLoadPosition=this.startPosition=f);this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(a,b){this.startTimeOffset=b.startTimeOffset;this.initPTS=[]}onHandlerDestroying(){this.stopLoad();super.onHandlerDestroying()}onHandlerDestroyed(){this.state="STOPPED";this.fragmentLoader&&this.fragmentLoader.destroy();this.keyLoader&&
this.keyLoader.destroy();this.decrypter&&this.decrypter.destroy();this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null;super.onHandlerDestroyed()}loadFragment(a,b,c){this._loadFragForPlayback(a,b,c)}_loadFragForPlayback(a,b,c){this._doFragLoad(a,b,c,d=>{this.fragContextChanged(a)?(this.warn(`Fragment ${a.sn}${d.part?" p: "+d.part.index:""} of level ${a.level} was dropped during download.`),this.fragmentTracker.removeFragment(a)):(a.stats.chunkCount++,
this._handleFragmentLoadProgress(d))}).then(d=>{if(d){var e=this.state;if(this.fragContextChanged(a)){if("FRAG_LOADING"===e||!this.fragCurrent&&"PARSING"===e)this.fragmentTracker.removeFragment(a),this.state="IDLE"}else"payload"in d&&(this.log(`Loaded fragment ${a.sn} of level ${a.level}`),this.hls.trigger(u.FRAG_LOADED,d)),this._handleFragmentLoadComplete(d)}}).catch(d=>{"STOPPED"!==this.state&&"ERROR"!==this.state&&(this.warn(d),this.resetFragmentLoading(a))})}clearTrackerIfNeeded(a){let {fragmentTracker:b}=
this;if("APPENDING"===b.getState(a)){var c=this.getFwdBufferInfo(this.mediaBuffer,a.type);this.reduceMaxBufferLength(Math.max(a.duration,c?c.len:this.config.maxBufferLength))&&b.removeFragment(a)}else 0===(null==(c=this.mediaBuffer)?void 0:c.buffered.length)?b.removeAllFragments():b.hasParts(a.type)&&(b.detectPartialFragments({frag:a,part:null,stats:a.stats,id:a.type}),"PARTIAL"===b.getState(a)&&b.removeFragment(a))}checkLiveUpdate(a){if(a.updated&&!a.live){let b=a.fragments[a.fragments.length-1];
this.fragmentTracker.detectPartialFragments({frag:b,part:null,stats:b.stats,id:b.type})}a.fragments[0]||(a.deltaUpdateFailed=!0)}flushMainBuffer(a,b,c=null){a-b&&this.hls.trigger(u.BUFFER_FLUSHING,{startOffset:a,endOffset:b,type:c})}_loadInitSegment(a,b){this._doFragLoad(a,b).then(c=>{if(!c||this.fragContextChanged(a)||!this.levels)throw Error("init load aborted");return c}).then(c=>{let {hls:d}=this,{payload:e}=c,f=a.decryptdata;if(e&&0<e.byteLength&&f&&f.key&&f.iv&&"AES-128"===f.method){let g=self.performance.now();
return this.decrypter.decrypt(new Uint8Array(e),f.key.buffer,f.iv.buffer).catch(h=>{d.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:h,reason:h.message,frag:a});throw h;}).then(h=>{let k=self.performance.now();d.trigger(u.FRAG_DECRYPTED,{frag:a,payload:h,stats:{tstart:g,tdecrypt:k}});c.payload=h;return c})}return c}).then(c=>{let {fragCurrent:d,hls:e,levels:f}=this;if(!f)throw Error("init load aborted, missing levels");let g=a.stats;this.state="IDLE";b.fragmentError=
0;a.data=new Uint8Array(c.payload);g.parsing.start=g.buffering.start=self.performance.now();g.parsing.end=g.buffering.end=self.performance.now();c.frag===d&&e.trigger(u.FRAG_BUFFERED,{stats:g,frag:d,part:null,id:a.type});this.tick()}).catch(c=>{"STOPPED"!==this.state&&"ERROR"!==this.state&&(this.warn(c),this.resetFragmentLoading(a))})}fragContextChanged(a){let {fragCurrent:b}=this;return!a||!b||a.level!==b.level||a.sn!==b.sn||a.urlId!==b.urlId}fragBufferedComplete(a,b){var c,d,e,f;let g=this.mediaBuffer?
this.mediaBuffer:this.media;this.log(`Buffered ${a.type} sn: ${a.sn}${b?" part: "+b.index:""} of ${this.playlistType===ba.MAIN?"level":"track"} ${a.level} (frag:[${(null!=(c=a.startPTS)?c:NaN).toFixed(3)}-${(null!=(d=a.endPTS)?d:NaN).toFixed(3)}] > buffer:${g?$u.toString(va.getBuffered(g)):"(detached)"})`);this.state="IDLE";g&&(!this.loadedmetadata&&a.type==ba.MAIN&&g.buffered.length&&(null==(e=this.fragCurrent)?void 0:e.sn)===(null==(f=this.fragPrevious)?void 0:f.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),
this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(a){let {transmuxer:b}=this;if(b){var {frag:c,part:d,partsLoaded:e}=a;a=!e||0===e.length||e.some(f=>!f);a=new pm(c.level,c.sn,c.stats.chunkCount+1,0,d?d.index:-1,!a);b.flush(a)}}_handleFragmentLoadProgress(a){}_doFragLoad(a,b,c=null,d){var e,f=null==b?void 0:b.details;if(!this.levels||!f)throw Error(`frag load aborted, missing level${f?"":" detail"}s`);let g=null;!a.encrypted||null!=(e=a.decryptdata)&&e.key?!a.encrypted&&f.encryptedFragments.length&&
this.keyLoader.loadClear(a,f.encryptedFragments):(this.log(`Loading key for ${a.sn} of [${f.startSN}-${f.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${a.level}`),this.state="KEY_LOADING",this.fragCurrent=a,g=this.keyLoader.load(a).then(k=>{if(!this.fragContextChanged(k.frag))return this.hls.trigger(u.KEY_LOADED,k),"KEY_LOADING"===this.state&&(this.state="IDLE"),k}),this.hls.trigger(u.KEY_LOADING,{frag:a}),null===this.fragCurrent&&(g=Promise.reject(Error("frag load aborted, context changed in KEY_LOADING"))));
c=Math.max(a.start,c||0);if(this.config.lowLatencyMode&&"initSegment"!==a.sn&&(e=f.partList)&&d){c>a.end&&f.fragmentHint&&(a=f.fragmentHint);let k=this.getNextPart(e,a,c);if(-1<k){let m=e[k];this.log(`Loading part sn: ${a.sn} p: ${m.index} cc: ${a.cc} of playlist [${f.startSN}-${f.endSN}] parts [0-${k}-${e.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${a.level}, target: ${parseFloat(c.toFixed(3))}`);this.nextLoadPosition=m.start+m.duration;this.state="FRAG_LOADING";f=g?g.then(n=>
!n||this.fragContextChanged(n.frag)?null:this.doFragPartsLoad(a,m,b,d)).catch(n=>this.handleFragLoadError(n)):this.doFragPartsLoad(a,m,b,d).catch(n=>this.handleFragLoadError(n));this.hls.trigger(u.FRAG_LOADING,{frag:a,part:m,targetBufferTime:c});return null===this.fragCurrent?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING parts")):f}if(!a.url||this.loadedEndOfParts(e,c))return Promise.resolve(null)}this.log(`Loading fragment ${a.sn} cc: ${a.cc} ${f?"of ["+f.startSN+"-"+f.endSN+
"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${a.level}, target: ${parseFloat(c.toFixed(3))}`);Y(a.sn)&&!this.bitrateTest&&(this.nextLoadPosition=a.start+a.duration);this.state="FRAG_LOADING";let h=this.config.progressive;f=h&&g?g.then(k=>!k||this.fragContextChanged(null==k?void 0:k.frag)?null:this.fragmentLoader.load(a,d)).catch(k=>this.handleFragLoadError(k)):Promise.all([this.fragmentLoader.load(a,h?d:void 0),g]).then(([k])=>{!h&&k&&d&&d(k);return k}).catch(k=>this.handleFragLoadError(k));
this.hls.trigger(u.FRAG_LOADING,{frag:a,targetBufferTime:c});return null===this.fragCurrent?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING")):f}doFragPartsLoad(a,b,c,d){return new Promise((e,f)=>{var g;let h=[],k=null==(g=c.details)?void 0:g.partList,m=n=>{this.fragmentLoader.loadPart(a,n,d).then(p=>{h[n.index]=p;const r=p.part;this.hls.trigger(u.FRAG_LOADED,p);if(p=vo(c,a.sn,n.index+1)||wo(k,a.sn,n.index+1))m(p);else return e({frag:a,part:r,partsLoaded:h})}).catch(f)};m(b)})}handleFragLoadError(a){if("data"in
a){let b=a.data;a.data&&b.details===K.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(u.ERROR,b)}else this.hls.trigger(u.ERROR,{type:Z.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,err:a,error:a,fatal:!0});return null}_handleTransmuxerFlush(a){var b=this.getCurrentContext(a);if(b&&"PARSING"===this.state){var {frag:c,part:d,level:e}=b;b=self.performance.now();c.stats.parsing.end=b;d&&(d.stats.parsing.end=b);this.updateLevelTiming(c,d,e,a.partial)}else this.fragCurrent||"STOPPED"===
this.state||"ERROR"===this.state||(this.state="IDLE")}getCurrentContext(a){let {levels:b,fragCurrent:c}=this,{level:d,sn:e,part:f}=a;if(null==b||!b[d])return this.warn(`Levels object was unset while buffering fragment ${e} of level ${d}. The current chunk will not be buffered.`),null;a=b[d];let g=-1<f?vo(a,e,f):null;if(g)var h=g.fragment;else if(null!=a&&a.details){h=a.details;var k=h.fragments[e-h.startSN];h=k?k:(k=h.fragmentHint)&&k.sn===e?k:e<h.startSN&&c&&c.sn===e?c:null}else h=null;if(!h)return null;
c&&c!==h&&(h.stats=c.stats);return{frag:h,part:g,level:a}}bufferFragmentData(a,b,c,d,e){var f;if(a&&"PARSING"===this.state){var {data1:g,data2:h}=a,k=g;g&&h&&(k=ec(g,h));null!=(f=k)&&f.length&&(this.hls.trigger(u.BUFFER_APPENDING,{type:a.type,frag:b,part:c,chunkMeta:d,parent:b.type,data:k}),a.dropped&&a.independent&&!c&&!e&&this.flushBufferGap(b))}}flushBufferGap(a){var b=this.media;if(b)if(va.isBuffered(b,b.currentTime)){var c=b.currentTime,d=va.bufferInfo(b,c,0);b=Math.min(2*this.config.maxFragLookUpTolerance,
.25*a.duration);c=Math.max(Math.min(a.start-b,d.end-b),c+b);a.start-c>b&&this.flushMainBuffer(c,a.start)}else this.flushMainBuffer(0,a.start)}getFwdBufferInfo(a,b){let c=this.getLoadPosition();return Y(c)?this.getFwdBufferInfoAtPos(a,c,b):null}getFwdBufferInfoAtPos(a,b,c){let {config:{maxBufferHole:d}}=this,e=va.bufferInfo(a,b,d);return 0===e.len&&void 0!==e.nextStart&&(c=this.fragmentTracker.getBufferedFrag(b,c))&&e.nextStart<c.end?va.bufferInfo(a,b,Math.max(e.nextStart,d)):e}getMaxBufferLength(a){let {config:b}=
this;return Math.min(a?Math.max(8*b.maxBufferSize/a,b.maxBufferLength):b.maxBufferLength,b.maxMaxBufferLength)}reduceMaxBufferLength(a){let b=this.config;return b.maxMaxBufferLength>=(a||b.maxBufferLength)?(b.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${b.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(a,b){return(a=this.fragmentTracker.getAppendedFrag(a,ba.MAIN))&&"fragment"in a?a.fragment:a}getNextFragment(a,b){let c=b.fragments,d=c.length;if(!d)return null;let {config:e}=this;var f=
c[0].start;let g;if(b.live){f=e.initialLiveManifestSize;if(d<f)return this.warn(`Not enough fragments to start playback (have: ${d}, need: ${f})`),null;b.PTSKnown||this.startFragRequested||-1!==this.startPosition||(this.startPosition=(g=this.getInitialLiveFragment(b,c))?this.hls.liveSyncPosition||g.start:a)}else a<=f&&(g=c[0]);g||(g=this.getFragmentAtPosition(a,e.lowLatencyMode?b.partEnd:b.fragmentEnd,b));return this.mapToInitFragWhenRequired(g)}isLoopLoading(a,b){let c=this.fragmentTracker.getState(a);
return("OK"===c||"PARTIAL"===c&&!!a.gap)&&this.nextLoadPosition>b}getNextFragmentLoopLoading(a,b,c,d,e){var f=a.gap;a=this.getNextFragment(this.nextLoadPosition,b);return null===a?a:f&&a&&!a.gap&&c.nextStart&&(f=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,c.nextStart,d),null!==f&&c.len+f.len>=e)?(this.log(`buffer full after gaps in "${d}" playlist starting at sn: ${a.sn}`),null):a}mapToInitFragWhenRequired(a){return null==a||!a.initSegment||null!=a&&a.initSegment.data||
this.bitrateTest?a:a.initSegment}getNextPart(a,b,c){let d=-1,e=!1,f=!0;for(let g=0,h=a.length;g<h;g++){let k=a[g];f=f&&!k.independent;if(-1<d&&c<k.start)break;let m=k.loaded;m?d=-1:(e||k.independent||f)&&k.fragment===b&&(d=g);e=m}return d}loadedEndOfParts(a,b){return(a=a[a.length-1])&&b>a.start&&a.loaded}getInitialLiveFragment(a,b){let c=this.fragPrevious;var d=null;if(c){if(a.hasProgramDateTime)a:{this.log(`Live playlist, switching playlist, load frag with same PDT: ${c.programDateTime}`),d=c.endProgramDateTime;
var e=this.config.maxFragLookUpTolerance;if(!(null===d||!Array.isArray(b)||!b.length||!Y(d)||d<(b[0].programDateTime||0)||d>=(b[b.length-1].endProgramDateTime||0))){e=e||0;for(let f=0;f<b.length;++f){let g=b[f];if((g.endProgramDateTime||0)-1E3*Math.min(e,g.duration+(g.deltaPTS?g.deltaPTS:0))>d){d=g;break a}}}d=null}d||(e=c.sn+1,e>=a.startSN&&e<=a.endSN&&(a=b[e-a.startSN],c.cc===a.cc&&(d=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${d.sn}`))),d||(d=Bs(b,c.cc))&&this.log(`Live playlist, switching playlist, load frag with same CC: ${d.sn}`))}else b=
this.hls.liveSyncPosition,null!==b&&(d=this.getFragmentAtPosition(b,this.bitrateTest?a.fragmentEnd:a.edge,a));return d}getFragmentAtPosition(a,b,c){var {config:d}=this,{fragPrevious:e}=this;let {fragments:f,endSN:g}=c,{fragmentHint:h}=c,k=d.maxFragLookUpTolerance,m=c.partList;(d=!!(d.lowLatencyMode&&null!=m&&m.length&&h))&&h&&!this.bitrateTest&&(f=f.concat(h),g=h.sn);if(a=a<b?ad(e,f,a,a>b-k?0:k):f[f.length-1]){c=a.sn-c.startSN;b=this.fragmentTracker.getState(a);if("OK"===b||"PARTIAL"===b&&a.gap)e=
a;e&&a.sn===e.sn&&(!d||m[0].fragment.sn>a.sn)&&e&&a.level===e.level&&(e=f[c+1],a=a.sn<g&&"OK"!==this.fragmentTracker.getState(e)?e:null)}return a}synchronizeToLiveEdge(a){let {config:b,media:c}=this;if(c){var d=this.hls.liveSyncPosition,e=c.currentTime,f=a.edge,g=e>=a.fragments[0].start-b.maxFragLookUpTolerance&&e<=f;null!==d&&c.duration>d&&(e<d||!g)&&(a=void 0!==b.liveMaxLatencyDuration?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*a.targetduration,!g&&4>c.readyState||e<f-a)&&(this.loadedmetadata||
(this.nextLoadPosition=d),c.readyState&&(this.warn(`Playback: ${e.toFixed(3)} is located too far from the end of live sliding playlist: ${f}, reset currentTime to : ${d.toFixed(3)}`),c.currentTime=d))}}alignPlaylists(a,b){let {levels:c,levelLastLoaded:d,fragPrevious:e}=this;var f=null!==d?c[d]:null;let g=a.fragments.length;if(!g)return this.warn("No fragments in live playlist"),0;var h=a.fragments[0].start,k=!b,m=a.alignedSliding&&Y(h);if(k||!m&&!h){if(f){h=f.details&&(a.endCC>a.startCC||e&&e.cc<
a.startCC)?!0:!1;if(h){b:{h=f.details.fragments;k=a.fragments;if(k.length&&h.length)if(h=Do(h,k[0].cc),!h||h&&!h.startPTS)D.log("No frag in previous level to align on");else break b;else D.log("No fragments to align");h=void 0}h&&Y(h.start)&&(D.log(`Adjusting PTS using last level due to CC increase within current level ${a.url}`),Rg(h.start,a))}!a.alignedSliding&&f.details&&(m=f.details,m.fragments.length&&a.hasProgramDateTime&&m.hasProgramDateTime&&(h=m.fragments[0].programDateTime,k=a.fragments[0].programDateTime,
(m=(k-h)/1E3+m.fragments[0].start)&&Y(m)&&(D.log(`Adjusting PTS using programDateTime delta ${k-h}ms, sliding:${m.toFixed(3)} ${a.url} `),Rg(m,a))));a.alignedSliding||!f.details||a.skippedSegments||to(f.details,a)}f=a.fragments[0].start;this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${b?b.startSN:"na"}->${a.startSN} prev-sn: ${e?e.sn:"na"} fragments: ${g}`);return f}return h}waitForCdnTuneIn(a){return a.live&&a.canBlockReload&&a.partTarget&&a.tuneInGoal>Math.max(a.partHoldBack,3*a.partTarget)}setStartPosition(a,
b){let c=this.startPosition;c<b&&(c=-1);if(-1===c||-1===this.lastCurrentTime){let d=null!==this.startTimeOffset,e=d?this.startTimeOffset:a.startTimeOffset;null!==e&&Y(e)?(c=b+e,0>e&&(c+=a.totalduration),c=Math.min(Math.max(b,c),b+a.totalduration),this.log(`Start time offset ${e} found in ${d?"multivariant":"media"} playlist, adjust startPosition to ${c}`),this.startPosition=c):a.live?c=this.hls.liveSyncPosition||b:this.startPosition=c=0;this.lastCurrentTime=c}this.nextLoadPosition=c}getLoadPosition(){let {media:a}=
this,b=0;this.loadedmetadata&&a?b=a.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition);return b}handleFragLoadAborted(a,b){this.transmuxer&&"initSegment"!==a.sn&&a.stats.aborted&&(this.warn(`Fragment ${a.sn}${b?" part "+b.index:""} of level ${a.level} was aborted`),this.resetFragmentLoading(a))}resetFragmentLoading(a){if(!this.fragCurrent||!this.fragContextChanged(a)&&"FRAG_LOADING_WAITING_RETRY"!==this.state)this.state="IDLE"}onFragmentOrKeyLoadError(a,b){if(b.chunkMeta&&!b.frag){var c=
this.getCurrentContext(b.chunkMeta);c&&(b.frag=c.frag)}if((c=b.frag)&&c.type===a&&this.levels)if(this.fragContextChanged(c)){var d;this.warn(`Frag load error must match current frag to retry ${c.url} > ${null==(d=this.fragCurrent)?void 0:d.url}`)}else{var e=b.details===K.FRAG_GAP;e&&this.fragmentTracker.fragBuffered(c,!0);d=b.errorAction;var {action:f,retryCount:g=0,retryConfig:h}=d||{};if(d&&5===f&&h){var k;this.resetStartWhenNotLoaded(null!=(k=this.levelLastLoaded)?k:c.level);k=Pg(h,g);this.warn(`Fragment ${c.sn} of ${a} ${c.level} errored with ${b.details}, retrying loading ${g+
1}/${h.maxNumRetry} in ${k}ms`);d.resolved=!0;this.retryDate=self.performance.now()+k;this.state="FRAG_LOADING_WAITING_RETRY"}else h&&d?(this.resetFragmentErrors(a),g<h.maxNumRetry?e||(d.resolved=!0):D.warn(`${b.details} reached or exceeded max retry (${g})`)):this.state=2===(null==d?void 0:d.action)?"WAITING_LEVEL":"ERROR";this.tickImmediate()}}reduceLengthAndFlushBuffer(a){if("PARSING"===this.state||"PARSED"===this.state){let c=a.parent;var b=this.getFwdBufferInfo(this.mediaBuffer,c);let d=b&&.5<
b.len;d&&this.reduceMaxBufferLength(b.len);(b=!d)&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${c} buffer`);a.frag&&(this.fragmentTracker.removeFragment(a.frag),this.nextLoadPosition=a.frag.start);this.resetLoadingState();return b}return!1}resetFragmentErrors(a){a===ba.AUDIO&&(this.fragCurrent=null);this.loadedmetadata||(this.startFragRequested=!1);"STOPPED"!==this.state&&(this.state="IDLE")}afterBufferFlushed(a,b,c){a&&(a=va.getBuffered(a),this.fragmentTracker.detectEvictedFragments(b,
a,c),"ENDED"===this.state&&this.resetLoadingState())}resetLoadingState(){this.log("Reset loading state");this.fragPrevious=this.fragCurrent=null;this.state="IDLE"}resetStartWhenNotLoaded(a){this.loadedmetadata||(this.startFragRequested=!1,a=this.levels?this.levels[a].details:null,null!=a&&a.live?(this.startPosition=-1,this.setStartPosition(a,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition)}resetWhenMissingContext(a){var b;this.warn(`The loading context changed while buffering fragment ${a.sn} of level ${a.level}. This chunk will not be buffered.`);
this.removeUnbufferedFrags();this.resetStartWhenNotLoaded(null!=(b=this.levelLastLoaded)?b:a.level);this.resetLoadingState()}removeUnbufferedFrags(a=0){this.fragmentTracker.removeFragmentsInRange(a,Infinity,this.playlistType,!1,!0)}updateLevelTiming(a,b,c,d){var e;let f=c.details;if(f){if(Object.keys(a.elementaryStreams).reduce((g,h)=>{const k=a.elementaryStreams[h];if(k){const m=k.endPTS-k.startPTS;if(0>=m)return this.warn(`Could not parse fragment ${a.sn} ${h} duration reliably (${m})`),g||!1;g=
d?0:so(f,a,k.startPTS,k.endPTS,k.startDTS,k.endDTS);this.hls.trigger(u.LEVEL_PTS_UPDATED,{details:f,level:c,drift:g,type:h,frag:a,start:k.startPTS,end:k.endPTS});return!0}return g},!1))c.fragmentError=0;else if(null===(null==(e=this.transmuxer)?void 0:e.error)){e=Error(`Found no media in fragment ${a.sn} of level ${a.level} resetting transmuxer to fallback to playlist timing`);0===c.fragmentError&&(c.fragmentError++,a.gap=!0,this.fragmentTracker.removeFragment(a),this.fragmentTracker.fragBuffered(a,
!0));this.warn(e.message);this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:e,frag:a,reason:`Found no media in msn ${a.sn} of level "${c.url}"`});if(!this.hls)return;this.resetTransmuxer()}this.state="PARSED";this.hls.trigger(u.FRAG_PARSED,{frag:a,part:b})}else this.warn("level.details undefined")}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(a){if("demuxerWorker"===a.event){var b,c,d;this.fragmentTracker.removeAllFragments();
this.resetTransmuxer();this.resetStartWhenNotLoaded(null!=(b=null!=(c=this.levelLastLoaded)?c:null==(d=this.fragCurrent)?void 0:d.level)?b:0);this.resetLoadingState()}}set state(a){let b=this._state;b!==a&&(this._state=a,this.log(`${b}->${a}`))}get state(){return this._state}}class Mq{constructor(){this._id3Track=this._audioTrack=void 0;this.frameIndex=0;this.lastPTS=this.initPTS=this.basePTS=this.cachedData=null}resetInitSegment(a,b,c,d){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9E4,
sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(a){this.initPTS=a;this.resetContiguity()}resetContiguity(){this.lastPTS=this.basePTS=null;this.frameIndex=0}canParse(a,b){return!1}appendFrame(a,b,c){}demux(a,b){this.cachedData&&(a=ec(this.cachedData,a),this.cachedData=null);var c=Yf(a,0);let d=c?c.length:0,e,f=this._audioTrack,g=this._id3Track;if(c)a:{var h=Fq(c);for(var k=0;k<h.length;k++){var m=h[k];if(Eq(m)){8===m.data.byteLength?(k=new Uint8Array(m.data),h=k[3]&1,k=(k[4]<<23)+(k[5]<<15)+
(k[6]<<7)+k[7],k/=45,h&&(k+=4.772185884E7),h=Math.round(k)):h=void 0;break a}}h=void 0}else h=void 0;k=h;h=a.length;if(null===this.basePTS||0===this.frameIndex&&Y(k))m=this.initPTS,b=Y(k)?90*k:9E4*b+(m?9E4*m.baseTime/m.timescale:0),this.lastPTS=this.basePTS=b;null===this.lastPTS&&(this.lastPTS=this.basePTS);for(c&&0<c.length&&g.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:c,type:"org.id3",duration:Number.POSITIVE_INFINITY});d<h;)this.canParse(a,d)?(c=this.appendFrame(f,a,d))?(this.frameIndex++,
this.lastPTS=c.sample.pts,e=d+=c.length):d=h:(c=a,b=d,km(c,b)&&Xf(c,b+6)+10<=c.length-b?(c=Yf(a,d),g.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:c,type:"org.id3",duration:Number.POSITIVE_INFINITY}),e=d+=c.length):d++),d===h&&e!==h&&(c=dc(a,e),this.cachedData=this.cachedData?ec(this.cachedData,c):c);return{audioTrack:f,videoTrack:tb(),id3Track:g,textTrack:tb()}}demuxSampleAes(a,b,c){return Promise.reject(Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(a){if(a=
this.cachedData)this.cachedData=null,this.demux(a,0);return{audioTrack:this._audioTrack,videoTrack:tb(),id3Track:this._id3Track,textTrack:tb()}}destroy(){}}class av extends Mq{constructor(a,b){super();this.observer=a;this.config=b}resetInitSegment(a,b,c,d){super.resetInitSegment(a,b,c,d);this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:b,duration:d,inputTimeScale:9E4,dropped:0}}static probe(a){if(!a)return!1;let b=(Yf(a,
0)||[]).length;for(let c=a.length;b<c;b++)if(Gs(a,b))return D.log("ADTS sync word found !"),!0;return!1}canParse(a,b){return b+5<a.length&&bd(a,b)&&Sg(a,b)<=a.length-b}appendFrame(a,b,c){Go(a,this.observer,b,c,a.manifestCodec);if((a=Ho(a,b,c,this.basePTS,this.frameIndex))&&0===a.missing)return a}}let bv=/\/emsg[-/]ID3/i;class cv{constructor(a,b){this.remainderData=null;this.timeOffset=0;this.txtTrack=this.id3Track=this.audioTrack=this.videoTrack=this.config=void 0;this.config=b}resetTimeStamp(){}resetInitSegment(a,
b,c,d){b=this.videoTrack=tb("video",1);c=this.audioTrack=tb("audio",1);let e=this.txtTrack=tb("text",1);this.id3Track=tb("id3",1);this.timeOffset=0;if(null!=a&&a.byteLength){a=bo(a);if(a.video){let {id:f,timescale:g,codec:h}=a.video;b.id=f;b.timescale=e.timescale=g;b.codec=h}if(a.audio){let {id:f,timescale:g,codec:h}=a.audio;c.id=f;c.timescale=g;c.codec=h}e.id=Gq.text;b.sampleDuration=0;b.duration=c.duration=d}}resetContiguity(){this.remainderData=null}static probe(a){a=16384<a.length?a.subarray(0,
16384):a;return 0<ka(a,["moof"]).length}demux(a,b){this.timeOffset=b;var c=a;let d=this.videoTrack,e=this.txtTrack;if(this.config.progressive){this.remainderData&&(c=ec(this.remainderData,a));a=c;c={valid:null,remainder:null};var f=ka(a,["moof"]);f&&(2>f.length?c.remainder=a:(f=f[f.length-1],c.valid=dc(a,0,f.byteOffset-8),c.remainder=dc(a,f.byteOffset-8)));a=c;this.remainderData=a.remainder;d.samples=a.valid||new Uint8Array}else d.samples=c;a=this.extractID3Track(d,b);e.samples=eo(b,d);return{videoTrack:d,
audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){let a=this.timeOffset,b=this.videoTrack,c=this.txtTrack;b.samples=this.remainderData||new Uint8Array;this.remainderData=null;let d=this.extractID3Track(b,this.timeOffset);c.samples=eo(a,b);return{videoTrack:b,audioTrack:tb(),id3Track:d,textTrack:tb()}}extractID3Track(a,b){let c=this.id3Track;a.samples.length&&(a=ka(a.samples,["emsg"]))&&a.forEach(d=>{var e,f,g;let h=d[0];var k="";var m="";var n=f=e=0;let p=g=0;if(0===h){for(;"\x00"!==
La(d.subarray(p,p+1));)k+=La(d.subarray(p,p+1)),p+=1;k+=La(d.subarray(p,p+1));for(p+=1;"\x00"!==La(d.subarray(p,p+1));)m+=La(d.subarray(p,p+1)),p+=1;La(d.subarray(p,p+1));e=da(d,12);f=da(d,16);g=da(d,20);da(d,24);p=28}else if(1===h){p+=4;e=da(d,p);p+=4;g=da(d,p);p+=4;n=da(d,p);p+=4;n=2**32*g+n;Number.isSafeInteger(n)||(n=Number.MAX_SAFE_INTEGER,D.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box"));g=da(d,p);p+=4;da(d,p);for(p+=4;"\x00"!==La(d.subarray(p,
p+1));)k+=La(d.subarray(p,p+1)),p+=1;k+=La(d.subarray(p,p+1));for(p+=1;"\x00"!==La(d.subarray(p,p+1));)m+=La(d.subarray(p,p+1)),p+=1;La(d.subarray(p,p+1));p+=1}d=d.subarray(p,d.byteLength);m=n;bv.test(k)&&(k=Y(m)?m/e:b+f/e,f=4294967295===g?Number.POSITIVE_INFINITY:g/e,.001>=f&&(f=Number.POSITIVE_INFINITY),c.samples.push({data:d,len:d.byteLength,dts:k,pts:k,type:"https://aomedia.org/emsg/ID3",duration:f}))});return c}demuxSampleAes(a,b,c){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}
let he=null,Hs=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Is=[44100,48E3,32E3,22050,24E3,16E3,11025,12E3,8E3],Js=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ks=[0,1,1,4];class Nq{constructor(a){this.bitsAvailable=this.word=this.bytesAvailable=this.data=void 0;this.data=a;this.bytesAvailable=
a.byteLength;this.bitsAvailable=this.word=0}loadWord(){let a=this.data;var b=this.bytesAvailable;let c=a.byteLength-b,d=new Uint8Array(4);b=Math.min(4,b);if(0===b)throw Error("no bytes available");d.set(a.subarray(c,c+b));this.word=(new DataView(d.buffer)).getUint32(0);this.bitsAvailable=8*b;this.bytesAvailable-=b}skipBits(a){let b;a=Math.min(a,8*this.bytesAvailable+this.bitsAvailable);this.bitsAvailable>a||(a-=this.bitsAvailable,b=a>>3,a-=b<<3,this.bytesAvailable-=b,this.loadWord());this.word<<=
a;this.bitsAvailable-=a}readBits(a){let b=Math.min(this.bitsAvailable,a),c=this.word>>>32-b;32<a&&D.error("Cannot read more than 32 bits at a time");this.bitsAvailable-=b;if(0<this.bitsAvailable)this.word<<=b;else if(0<this.bytesAvailable)this.loadWord();else throw Error("no bits available");b=a-b;return 0<b&&this.bitsAvailable?c<<b|this.readBits(b):c}skipLZ(){let a;for(a=0;a<this.bitsAvailable;++a)if(0!==(this.word&2147483648>>>a))return this.word<<=a,this.bitsAvailable-=a,a;this.loadWord();return a+
this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let a=this.skipLZ();return this.readBits(a+1)-1}readEG(){let a=this.readUEG();return 1&a?1+a>>>1:-1*(a>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(a){let b=8;var c=8;for(let d=0;d<a;d++)0!==c&&(c=this.readEG(),c=(b+c+256)%256),b=0===c?b:c}readSPS(){let a=0,b=0,c=0,d=
0;let e;let f=this.readUByte.bind(this);var g=this.readBits.bind(this),h=this.readUEG.bind(this);let k=this.readBoolean.bind(this),m=this.skipBits.bind(this);var n=this.skipEG.bind(this),p=this.skipUEG.bind(this);var r=this.skipScalingList.bind(this);f();var w=f();g(5);m(3);f();p();if(100===w||110===w||122===w||244===w||44===w||83===w||86===w||118===w||128===w)if(w=h(),3===w&&m(1),p(),p(),m(1),k())for(e=3!==w?8:12,w=0;w<e;w++)k()&&(6>w?r(16):r(64));p();r=h();if(0===r)h();else if(1===r)for(m(1),n(),
n(),r=h(),w=0;w<r;w++)n();p();m(1);n=h();p=h();g=g(1);0===g&&m(1);m(1);k()&&(a=h(),b=h(),c=h(),d=h());h=[1,1];if(k()&&k())switch(f()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;
case 255:h=[f()<<8|f(),f()<<8|f()]}return{width:Math.ceil(16*(n+1)-2*a-2*b),height:(2-g)*(p+1)*16-(g?2:4)*(c+d),pixelRatio:h}}readSliceType(){this.readUByte();this.readUEG();return this.readUEG()}}class dv{constructor(a,b,c){this.decrypter=void 0;this.keyData=c;this.decrypter=new qm(b,{removePKCS7Padding:!1})}decryptBuffer(a){return this.decrypter.decrypt(a,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(a,b,c){let d=a[b].unit;if(!(16>=d.length)){var e=d.subarray(16,d.length-d.length%
16);e=e.buffer.slice(e.byteOffset,e.byteOffset+e.length);this.decryptBuffer(e).then(f=>{f=new Uint8Array(f);d.set(f,16);this.decrypter.isSync()||this.decryptAacSamples(a,b+1,c)})}}decryptAacSamples(a,b,c){for(;;b++){if(b>=a.length){c();break}if(!(32>a[b].unit.length||(this.decryptAacSample(a,b,c),this.decrypter.isSync())))break}}getAvcEncryptedData(a){let b=new Int8Array(16*Math.floor((a.length-48)/160)+16),c=0;for(let d=32;d<a.length-16;d+=160,c+=16)b.set(a.subarray(d,d+16),c);return b}getAvcDecryptedUnit(a,
b){b=new Uint8Array(b);let c=0;for(let d=32;d<a.length-16;d+=160,c+=16)a.set(b.subarray(c,c+16),d);return a}decryptAvcSample(a,b,c,d,e){let f=go(e.data),g=this.getAvcEncryptedData(f);this.decryptBuffer(g.buffer).then(h=>{e.data=this.getAvcDecryptedUnit(f,h);this.decrypter.isSync()||this.decryptAvcSamples(a,b,c+1,d)})}decryptAvcSamples(a,b,c,d){if(a instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");for(;;b++,c=0){if(b>=a.length){d();break}let e=a[b].units;for(;!(c>=e.length);c++){let f=
e[c];if(!(48>=f.data.length||1!==f.type&&5!==f.type||(this.decryptAvcSample(a,b,c,d,f),this.decrypter.isSync())))return}}}}class oc{constructor(a,b,c){this.typeSupported=void 0;this.sampleAes=null;this.pmtParsed=!1;this.videoCodec=this.audioCodec=void 0;this._duration=0;this._pmtId=-1;this._txtTrack=this._id3Track=this._audioTrack=this._avcTrack=void 0;this.remainderData=this.avcSample=this.aacOverFlow=null;this.observer=a;this.config=b;this.typeSupported=c}static probe(a){a=oc.syncOffset(a);0<a&&
D.warn(`MPEG2-TS detected but first sync word found @ offset ${a}`);return-1!==a}static syncOffset(a){let b=a.length,c=Math.min(940,a.length-188)+1,d=0;for(;d<c;){let e=!1,f=-1,g=0;for(let h=d;h<b;h+=188)if(71===a[h]){if(g++,-1===f&&(f=h,0!==f&&(c=Math.min(f+18612,a.length-188)+1)),e||(e=0===((a[h+1]&31)<<8)+a[h+2]),e&&1<g&&(0===f&&2<g||h+188>c))return f}else{if(g)return-1;break}d++}return-1}static createTrack(a,b){return{container:"video"===a||"audio"===a?"video/mp2t":void 0,type:a,id:Gq[a],pid:-1,
inputTimeScale:9E4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===a?b:void 0}}resetInitSegment(a,b,c,d){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=oc.createTrack("video");this._audioTrack=oc.createTrack("audio",d);this._id3Track=oc.createTrack("id3");this._txtTrack=oc.createTrack("text");this._audioTrack.segmentCodec="aac";this.remainderData=this.avcSample=this.aacOverFlow=null;this.audioCodec=b;this.videoCodec=c;this._duration=d}resetTimeStamp(){}resetContiguity(){let {_audioTrack:a,
_avcTrack:b,_id3Track:c}=this;a&&(a.pesData=null);b&&(b.pesData=null);c&&(c.pesData=null);this.remainderData=this.avcSample=this.aacOverFlow=null}demux(a,b,c=!1,d=!1){c||(this.sampleAes=null);let e;b=this._avcTrack;let f=this._audioTrack,g=this._id3Track,h=this._txtTrack;var k=b.pid;let m=b.pesData;var n=f.pid,p=g.pid;let r=f.pesData,w=g.pesData,z=null,x=this.pmtParsed,B=this._pmtId,E=a.length;this.remainderData&&(a=ec(this.remainderData,a),E=a.length,this.remainderData=null);if(188>E&&!d)return this.remainderData=
a,{audioTrack:f,videoTrack:b,id3Track:g,textTrack:h};let C=Math.max(0,oc.syncOffset(a));E-=(E-C)%188;E<a.byteLength&&!d&&(this.remainderData=new Uint8Array(a.buffer,E,a.buffer.byteLength-E));let I=0;for(let J=C;J<E;J+=188)if(71===a[J]){var F=!!(a[J+1]&64),O=((a[J+1]&31)<<8)+a[J+2],R=void 0;if(1<(a[J+3]&48)>>4){if(R=J+5+a[J+4],R===J+188)continue}else R=J+4;switch(O){case k:F&&(m&&(e=yc(m))&&this.parseAVCPES(b,h,e,!1),m={data:[],size:0});m&&(m.data.push(a.subarray(R,J+188)),m.size+=J+188-R);break;case n:if(F){if(r&&
(e=yc(r)))switch(f.segmentCodec){case "aac":this.parseAACPES(f,e);break;case "mp3":this.parseMPEGPES(f,e)}r={data:[],size:0}}r&&(r.data.push(a.subarray(R,J+188)),r.size+=J+188-R);break;case p:F&&(w&&(e=yc(w))&&this.parseID3PES(g,e),w={data:[],size:0});w&&(w.data.push(a.subarray(R,J+188)),w.size+=J+188-R);break;case 0:F&&(R+=a[R]+1);B=this._pmtId=(a[R+10]&31)<<8|a[R+11];break;case B:F&&(R+=a[R]+1);k=a;n=R;R=this.typeSupported;p=c;F={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"};O=n+3+((k[n+1]&15)<<8|
k[n+2])-4;for(n+=12+((k[n+10]&15)<<8|k[n+11]);n<O;){let aa=((k[n+1]&31)<<8)+k[n+2];switch(k[n]){case 207:if(!p){D.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===F.audio&&(F.audio=aa);break;case 21:-1===F.id3&&(F.id3=aa);break;case 219:if(!p){D.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===F.avc&&(F.avc=aa);break;case 3:case 4:!0!==R.mpeg&&!0!==R.mp3?D.log("MPEG audio found, not supported in this browser"):
-1===F.audio&&(F.audio=aa,F.segmentCodec="mp3");break;case 36:D.warn("Unsupported HEVC stream type found")}n+=((k[n+3]&15)<<8|k[n+4])+5}R=F;k=R.avc;0<k&&(b.pid=k);n=R.audio;0<n&&(f.pid=n,f.segmentCodec=R.segmentCodec);p=R.id3;0<p&&(g.pid=p);null===z||x||(D.warn(`MPEG-TS PMT found at ${J} after unknown PID '${z}'. Backtracking to sync byte @${C} to parse all TS packets.`),z=null,J=C-188);x=this.pmtParsed=!0;break;case 17:case 8191:break;default:z=O}}else I++;0<I&&(a=Error(`Found ${I} TS packet/s that do not start with 0x47`),
this.observer.emit(u.ERROR,u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:a,reason:a.message}));b.pesData=m;f.pesData=r;g.pesData=w;a={audioTrack:f,videoTrack:b,id3Track:g,textTrack:h};d&&this.extractRemainingSamples(a);return a}flush(){var {remainderData:a}=this;this.remainderData=null;a=a?this.demux(a,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack};this.extractRemainingSamples(a);return this.sampleAes?this.decrypt(a,
this.sampleAes):a}extractRemainingSamples(a){let {audioTrack:b,videoTrack:c,id3Track:d,textTrack:e}=a;a=c.pesData;let f=b.pesData,g=d.pesData,h;a&&(h=yc(a))?(this.parseAVCPES(c,e,h,!0),c.pesData=null):c.pesData=a;if(f&&(h=yc(f))){switch(b.segmentCodec){case "aac":this.parseAACPES(b,h);break;case "mp3":this.parseMPEGPES(b,h)}b.pesData=null}else null!=f&&f.size&&D.log("last AAC PES packet truncated,might overlap between fragments"),b.pesData=f;g&&(h=yc(g))?(this.parseID3PES(d,h),d.pesData=null):d.pesData=
g}demuxSampleAes(a,b,c){a=this.demux(a,c,!0,!this.config.progressive);b=this.sampleAes=new dv(this.observer,this.config,b);return this.decrypt(a,b)}decrypt(a,b){return new Promise(c=>{let {audioTrack:d,videoTrack:e}=a;d.samples&&"aac"===d.segmentCodec?b.decryptAacSamples(d.samples,0,()=>{e.samples?b.decryptAvcSamples(e.samples,0,0,()=>{c(a)}):c(a)}):e.samples&&b.decryptAvcSamples(e.samples,0,0,()=>{c(a)})})}destroy(){this._duration=0}parseAVCPES(a,b,c,d){let e=this.parseAVCNALu(a,c.data),f=this.avcSample,
g,h=!1;c.data=null;f&&e.length&&!a.audFound&&(cd(f,a),f=this.avcSample=je(!1,c.pts,c.dts,""));e.forEach(k=>{switch(k.type){case 1:var m=!1;g=!0;var n=k.data;h&&4<n.length&&(n=(new Nq(n)).readSliceType(),2===n||4===n||7===n||9===n)&&(m=!0);if(m){var p;null!=(p=f)&&p.frame&&!f.key&&(cd(f,a),f=this.avcSample=null)}f||(f=this.avcSample=je(!0,c.pts,c.dts,""));f.frame=!0;f.key=m;break;case 5:g=!0;null!=(m=f)&&m.frame&&!f.key&&(cd(f,a),f=this.avcSample=null);f||(f=this.avcSample=je(!0,c.pts,c.dts,""));f.key=
!0;f.frame=!0;break;case 6:g=!0;fo(k.data,1,c.pts,b.samples);break;case 7:h=g=!0;if(!a.sps){p=k.data;m=(new Nq(p)).readSPS();a.width=m.width;a.height=m.height;a.pixelRatio=m.pixelRatio;a.sps=[p];a.duration=this._duration;p=p.subarray(1,4);m="avc1.";for(n=0;3>n;n++){let r=p[n].toString(16);2>r.length&&(r="0"+r);m+=r}a.codec=m}break;case 8:g=!0;a.pps||(a.pps=[k.data]);break;case 9:g=!1;a.audFound=!0;f&&cd(f,a);f=this.avcSample=je(!1,c.pts,c.dts,"");break;case 12:g=!0;break;default:g=!1,f&&(f.debug+=
"unknown NAL "+k.type+" ")}f&&g&&f.units.push(k)});d&&f&&(cd(f,a),this.avcSample=null)}getLastNalUnit(a){var b;let c=this.avcSample,d;c&&0!==c.units.length||(c=a[a.length-1]);null!=(b=c)&&b.units&&(a=c.units,d=a[a.length-1]);return d}parseAVCNALu(a,b){var c=b.byteLength,d=a.naluState||0,e=d;let f=[],g=0;let h=-1,k=0;-1===d&&(h=0,k=b[0]&31,d=0,g=1);for(;g<c;){var m=b[g++];if(d)if(1===d)d=m?0:2;else if(m)if(1===m){if(0<=h)d={data:b.subarray(h,g-d-1),type:k},f.push(d);else if(m=this.getLastNalUnit(a.samples))if(e&&
g<=4-e&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-e)),d=g-d-1,0<d){let n=new Uint8Array(m.data.byteLength+d);n.set(m.data,0);n.set(b.subarray(0,d),m.data.byteLength);m.data=n;m.state=0}g<c?(d=b[g]&31,h=g,k=d,d=0):d=-1}else d=0;else d=3;else d=m?0:1}0<=h&&0<=d&&(c={data:b.subarray(h,c),type:k,state:d},f.push(c));0===f.length&&(c=this.getLastNalUnit(a.samples))&&(e=new Uint8Array(c.data.byteLength+b.byteLength),e.set(c.data,0),e.set(b,c.data.byteLength),c.data=e);a.naluState=d;return f}parseAACPES(a,
b){var c=0,d=this.aacOverFlow;let e=b.data;if(d){this.aacOverFlow=null;var f=d.missing,g=d.sample.unit.byteLength;-1===f?(f=new Uint8Array(g+e.byteLength),f.set(d.sample.unit,0),f.set(e,g),e=f):(g-=f,d.sample.unit.set(e.subarray(0,f),g),a.samples.push(d.sample),c=d.missing)}f=c;for(g=e.length;f<g-1&&!(f+1<e.length&&bd(e,f));f++);if(f!==c){let h=f<g-1;c=h?`AAC PES did not start with ADTS header,offset:${f}`:"No ADTS header found in AAC PES";let k=Error(c);D.warn(`parsing error: ${c}`);this.observer.emit(u.ERROR,
u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,levelRetry:h,error:k,reason:c});if(!h)return}Go(a,this.observer,e,f,this.audioCodec);if(void 0!==b.pts)b=b.pts;else if(d)b=d.sample.pts+9216E4/a.samplerate;else{D.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(d=0;f<g;)if(c=Ho(a,e,f,b,d),f+=c.length,c.missing){this.aacOverFlow=c;break}else for(d++;f<g-1&&!(f+1<e.length&&bd(e,f));f++);}parseMPEGPES(a,b){let c=b.data,d=c.length,e=0,f=0;b=b.pts;if(void 0===b)D.warn("[tsdemuxer]: MPEG PES unknown PTS");
else for(;f<d;)if(f+1<c.length&&ie(c,f)){let g=Io(a,c,f,b,e);if(g)f+=g.length,e++;else break}else f++}parseID3PES(a,b){void 0===b.pts?D.warn("[tsdemuxer]: ID3 PES unknown PTS"):(b=Ga({},b,{type:this._avcTrack?"https://aomedia.org/emsg/ID3":"org.id3",duration:Number.POSITIVE_INFINITY}),a.samples.push(b))}}class ev extends Mq{resetInitSegment(a,b,c,d){super.resetInitSegment(a,b,c,d);this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:b,
duration:d,inputTimeScale:9E4,dropped:0}}static probe(a){if(!a)return!1;let b=(Yf(a,0)||[]).length;for(let e=a.length;b<e;b++){var c=a;var d=b;if(d+1<c.length&&ie(c,d)){let f=Jo(c,d),g=4;null!=f&&f.frameLength&&(g=f.frameLength);d+=g;c=d===c.length||d+1<c.length&&ie(c,d)}else c=!1;if(c)return D.log("MPEG Audio sync word found !"),!0}return!1}canParse(a,b){return ie(a,b)&&4<=a.length-b}appendFrame(a,b,c){if(null!==this.basePTS)return Io(a,b,c,this.basePTS,this.frameIndex)}}class Oq{static getSilentFrame(a,
b){switch(a){case "mp4a.40.2":if(1===b)return new Uint8Array([0,200,0,128,35,128]);if(2===b)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===b)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,
8,224]);break;default:if(1===b)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===b||3===b)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}let Yb=Math.pow(2,32)-1;class G{static init(){G.types=
{avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};for(var a in G.types)G.types.hasOwnProperty(a)&&(G.types[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);a=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,
101,111,72,97,110,100,108,101,114,0]);var b=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);G.HDLR_TYPES={video:a,audio:b};a=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);b=new Uint8Array([0,0,0,0,0,0,0,0]);G.STTS=G.STSC=G.STCO=b;G.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);G.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);G.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);G.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);
b=new Uint8Array([105,115,111,109]);let c=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);G.FTYP=G.box(G.types.ftyp,b,d,b,c);G.DINF=G.box(G.types.dinf,G.box(G.types.dref,a))}static box(a,...b){let c=8,d=b.length,e=d;for(;d--;)c+=b[d].byteLength;let f=new Uint8Array(c);f[0]=c>>24&255;f[1]=c>>16&255;f[2]=c>>8&255;f[3]=c&255;f.set(a,4);d=0;for(c=8;d<e;d++)f.set(b[d],c),c+=b[d].byteLength;return f}static hdlr(a){return G.box(G.types.hdlr,G.HDLR_TYPES[a])}static mdat(a){return G.box(G.types.mdat,
a)}static mdhd(a,b){b*=a;let c=Math.floor(b/(Yb+1));b=Math.floor(b%(Yb+1));return G.box(G.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,a&255,c>>24,c>>16&255,c>>8&255,c&255,b>>24,b>>16&255,b>>8&255,b&255,85,196,0,0]))}static mdia(a){return G.box(G.types.mdia,G.mdhd(a.timescale,a.duration),G.hdlr(a.type),G.minf(a))}static mfhd(a){return G.box(G.types.mfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255]))}static minf(a){return"audio"===a.type?
G.box(G.types.minf,G.box(G.types.smhd,G.SMHD),G.DINF,G.stbl(a)):G.box(G.types.minf,G.box(G.types.vmhd,G.VMHD),G.DINF,G.stbl(a))}static moof(a,b,c){return G.box(G.types.moof,G.mfhd(a),G.traf(c,b))}static moov(a){let b=a.length,c=[];for(;b--;)c[b]=G.trak(a[b]);return G.box.apply(null,[G.types.moov,G.mvhd(a[0].timescale,a[0].duration)].concat(c).concat(G.mvex(a)))}static mvex(a){let b=a.length,c=[];for(;b--;)c[b]=G.trex(a[b]);return G.box.apply(null,[G.types.mvex,...c])}static mvhd(a,b){b*=a;let c=Math.floor(b/
(Yb+1));b=Math.floor(b%(Yb+1));a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,a>>24&255,a>>16&255,a>>8&255,a&255,c>>24,c>>16&255,c>>8&255,c&255,b>>24,b>>16&255,b>>8&255,b&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return G.box(G.types.mvhd,a)}static sdtp(a){a=a.samples||[];let b=new Uint8Array(4+a.length),c,d;for(c=0;c<a.length;c++)d=a[c].flags,b[c+4]=d.dependsOn<<
4|d.isDependedOn<<2|d.hasRedundancy;return G.box(G.types.sdtp,b)}static stbl(a){return G.box(G.types.stbl,G.stsd(a),G.box(G.types.stts,G.STTS),G.box(G.types.stsc,G.STSC),G.box(G.types.stsz,G.STSZ),G.box(G.types.stco,G.STCO))}static avc1(a){var b=[],c=[],d;let e;for(d=0;d<a.sps.length;d++){var f=a.sps[d];e=f.byteLength;b.push(e>>>8&255);b.push(e&255);b=b.concat(Array.prototype.slice.call(f))}for(d=0;d<a.pps.length;d++)f=a.pps[d],e=f.byteLength,c.push(e>>>8&255),c.push(e&255),c=c.concat(Array.prototype.slice.call(f));
b=G.box(G.types.avcC,new Uint8Array([1,b[3],b[4],b[5],255,224|a.sps.length].concat(b).concat([a.pps.length]).concat(c)));c=a.width;d=a.height;f=a.pixelRatio[0];a=a.pixelRatio[1];return G.box(G.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),b,G.box(G.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,
0,45,198,192])),G.box(G.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,a>>24,a>>16&255,a>>8&255,a&255])))}static esds(a){let b=a.config.length;return new Uint8Array([0,0,0,0,3,23+b,0,1,0,4,15+b,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([b]).concat(a.config).concat([6,1,2]))}static mp4a(a){let b=a.samplerate;return G.box(G.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,b>>8&255,b&255,0,0]),G.box(G.types.esds,G.esds(a)))}static mp3(a){let b=a.samplerate;
return G.box(G.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a.channelCount,0,16,0,0,0,0,b>>8&255,b&255,0,0]))}static stsd(a){return"audio"===a.type?"mp3"===a.segmentCodec&&"mp3"===a.codec?G.box(G.types.stsd,G.STSD,G.mp3(a)):G.box(G.types.stsd,G.STSD,G.mp4a(a)):G.box(G.types.stsd,G.STSD,G.avc1(a))}static tkhd(a){let b=a.id;var c=a.duration*a.timescale;let d=a.width;a=a.height;let e=Math.floor(c/(Yb+1));c=Math.floor(c%(Yb+1));return G.box(G.types.tkhd,new Uint8Array([1,0,0,7,0,0,
0,0,0,0,0,2,0,0,0,0,0,0,0,3,b>>24&255,b>>16&255,b>>8&255,b&255,0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255,c>>24,c>>16&255,c>>8&255,c&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>8&255,d&255,0,0,a>>8&255,a&255,0,0]))}static traf(a,b){let c=G.sdtp(a),d=a.id,e=Math.floor(b/(Yb+1));b=Math.floor(b%(Yb+1));return G.box(G.types.traf,G.box(G.types.tfhd,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255])),G.box(G.types.tfdt,new Uint8Array([1,
0,0,0,e>>24,e>>16&255,e>>8&255,e&255,b>>24,b>>16&255,b>>8&255,b&255])),G.trun(a,c.length+16+20+8+16+8+8),c)}static trak(a){a.duration=a.duration||4294967295;return G.box(G.types.trak,G.tkhd(a),G.mdia(a))}static trex(a){a=a.id;return G.box(G.types.trex,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(a,b){let c=a.samples||[],d=c.length;var e=12+16*d;let f=new Uint8Array(e);let g;b+=8+e;f.set(["video"===a.type?1:0,0,15,1,d>>>24&255,d>>>16&255,d>>>
8&255,d&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255],0);for(a=0;a<d;a++){var h=c[a];b=h.duration;e=h.size;g=h.flags;h=h.cts;f.set([b>>>24&255,b>>>16&255,b>>>8&255,b&255,e>>>24&255,e>>>16&255,e>>>8&255,e&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*a)}return G.box(G.types.trun,f)}static initSegment(a){G.types||G.init();a=G.moov(a);let b=new Uint8Array(G.FTYP.byteLength+
a.byteLength);b.set(G.FTYP);b.set(a,G.FTYP.byteLength);return b}}G.types=void 0;G.HDLR_TYPES=void 0;G.STTS=void 0;G.STSC=void 0;G.STCO=void 0;G.STSZ=void 0;G.VMHD=void 0;G.SMHD=void 0;G.STSD=void 0;G.FTYP=void 0;G.DINF=void 0;let ag=null,sm=null;class tm{constructor(a,b,c,d){this.videoSampleDuration=this.nextAudioPts=this.nextAvcDts=this._initDTS=this._initPTS=null;this.isVideoContiguous=this.isAudioContiguous=!1;this.observer=a;this.config=b;this.typeSupported=c;this.ISGenerated=!1;null===ag&&(ag=
(a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i))?parseInt(a[1]):0);null===sm&&(sm=(a=navigator.userAgent.match(/Safari\/(\d+)/i))?parseInt(a[1]):0)}destroy(){}resetTimeStamp(a){D.log("[mp4-remuxer]: initPTS & initDTS reset");this._initPTS=this._initDTS=a}resetNextTimestamp(){D.log("[mp4-remuxer]: reset next timestamp");this.isAudioContiguous=this.isVideoContiguous=!1}resetInitSegment(){D.log("[mp4-remuxer]: ISGenerated flag reset");this.ISGenerated=!1}getVideoStartPts(a){let b=!1;a=a.reduce((c,
d)=>{const e=d.pts-c;return-4294967296>e?(b=!0,eb(c,d.pts)):0<e?c:d.pts},a[0].pts);b&&D.debug("PTS rollover detected");return a}remux(a,b,c,d,e,f,g,h){let k,m,n,p,r,w,z=e,x=e,B=-1<b.pid;var E=b.samples.length;let C=0<a.samples.length,I=g&&0<E||1<E;if(!(-1<a.pid&&!C||B&&!I)||this.ISGenerated||g){this.ISGenerated||(n=this.generateIS(a,b,e,f));g=this.isVideoContiguous;var F=-1;if(I){a:{F=b.samples;for(let R=0;R<F.length;R++)if(F[R].key){F=R;break a}F=-1}if(!g&&this.config.forceKeyFrameOnDiscontinuity)if(w=
!0,0<F){D.warn(`[mp4-remuxer]: Dropped ${F} out of ${E} video samples due to a missing keyframe`);var O=this.getVideoStartPts(b.samples);b.samples=b.samples.slice(F);b.dropped+=F;O=x+=(b.samples[0].pts-O)/b.inputTimeScale}else-1===F&&(D.warn(`[mp4-remuxer]: No keyframe found out of ${E} video samples`),w=!1)}this.ISGenerated&&(C&&I&&(E=this.getVideoStartPts(b.samples),E=(eb(a.samples[0].pts,E)-E)/b.inputTimeScale,z+=Math.max(0,E),x+=Math.max(0,-E)),C?(a.samplerate||(D.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),
n=this.generateIS(a,b,e,f)),m=this.remuxAudio(a,z,this.isAudioContiguous,f,B||I||h===ba.AUDIO?x:void 0),I&&(h=m?m.endPTS-m.startPTS:0,b.inputTimeScale||(D.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),n=this.generateIS(a,b,e,f)),k=this.remuxVideo(b,x,g,h))):I&&(k=this.remuxVideo(b,x,g,0)),k&&(k.firstKeyFrame=F,k.independent=-1!==F,k.firstKeyFramePTS=O))}this.ISGenerated&&this._initPTS&&this._initDTS&&(c.samples.length&&(r=Ko(c,e,this._initPTS,this._initDTS)),d.samples.length&&(p=
Lo(d,e,this._initPTS)));return{audio:m,video:k,initSegment:n,independent:w,text:p,id3:r}}generateIS(a,b,c,d){let e=a.samples,f=b.samples,g=this.typeSupported,h={},k=this._initPTS;d=!k||d;let m="audio/mp4",n,p,r;d&&(n=p=Infinity);if(a.config&&e.length){a.timescale=a.samplerate;switch(a.segmentCodec){case "mp3":g.mpeg?(m="audio/mpeg",a.codec=""):g.mp3&&(a.codec="mp3")}h.audio={id:"audio",container:m,codec:a.codec,initSegment:"mp3"===a.segmentCodec&&g.mpeg?new Uint8Array(0):G.initSegment([a]),metadata:{channelCount:a.channelCount}};
d&&(r=a.inputTimeScale,k&&r===k.timescale?d=!1:n=p=e[0].pts-Math.round(r*c))}b.sps&&b.pps&&f.length&&(b.timescale=b.inputTimeScale,h.video={id:"main",container:"video/mp4",codec:b.codec,initSegment:G.initSegment([b]),metadata:{width:b.width,height:b.height}},d&&(r=b.inputTimeScale,k&&r===k.timescale?d=!1:(a=this.getVideoStartPts(f),c=Math.round(r*c),p=Math.min(p,eb(f[0].dts,a)-c),n=Math.min(n,a-c))));if(Object.keys(h).length)return this.ISGenerated=!0,d?(this._initPTS={baseTime:n,timescale:r},this._initDTS=
{baseTime:p,timescale:r}):n=r=void 0,{tracks:h,initPTS:n,timescale:r}}remuxVideo(a,b,c,d){var e=a.inputTimeScale,f=a.samples;let g=[],h=f.length;var k=this._initPTS,m=this.nextAvcDts;let n=8;var p=this.videoSampleDuration;let r=Number.POSITIVE_INFINITY,w=Number.NEGATIVE_INFINITY;var z=!1;c&&null!==m||(b*=e,m=f[0].pts-eb(f[0].dts,f[0].pts),m=b-m);k=k.baseTime*e/k.timescale;for(b=0;b<h;b++){var x=f[b];x.pts=eb(x.pts-k,m);x.dts=eb(x.dts-k,m);x.dts<f[0<b?b-1:b].dts&&(z=!0)}z&&f.sort(function(J,aa){let qa=
J.pts-aa.pts;return J.dts-aa.dts||qa});z=f[0].dts;b=f[f.length-1].dts;k=(k=b-z)?Math.round(k/(h-1)):p||a.inputTimeScale/30;c&&(b=z-m,c=b>k,x=-1>b,c||x)&&(c?D.warn(`AVC: ${dd(b,!0)} ms (${b}dts) hole between fragments detected, filling it`):D.warn(`AVC: ${dd(-b,!0)} ms (${b}dts) overlapping between fragments detected`),!x||m>=f[0].pts)&&(z=m,m=f[0].pts-b,f[0].dts=z,f[0].pts=m,D.log(`Video: First PTS/DTS adjusted: ${dd(m,!0)}/${dd(z,!0)}, delta: ${dd(b,!0)} ms`));z=Math.max(0,z);c=m=0;for(b=0;b<h;b++){x=
f[b];var B=x.units,E=B.length,C=0;for(var I=0;I<E;I++)C+=B[I].data.length;c+=C;m+=E;x.length=C;x.dts=Math.max(x.dts,z);r=Math.min(x.pts,r);w=Math.max(x.pts,w)}b=f[h-1].dts;m=c+4*m+8;let F;try{F=new Uint8Array(m)}catch(J){this.observer.emit(u.ERROR,u.ERROR,{type:Z.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:J,bytes:m,reason:`fail allocating video mdat ${m}`});return}c=new DataView(F.buffer);c.setUint32(0,m);F.set(G.types.mdat,4);m=!1;B=x=Number.POSITIVE_INFINITY;C=E=Number.NEGATIVE_INFINITY;
for(I=0;I<h;I++){let J=f[I];p=J.units;let aa=0;for(let qa=0,za=p.length;qa<za;qa++){var O=p[qa],R=O.data;O=O.data.byteLength;c.setUint32(n,O);n+=4;F.set(R,n);n+=O;aa+=4+O}if(I<h-1)p=f[I+1].dts-J.dts,R=f[I+1].pts-J.pts;else if(p=this.config,O=0<I?J.dts-f[I-1].dts:k,R=0<I?J.pts-f[I-1].pts:k,p.stretchShortVideoTrack&&null!==this.nextAudioPts){let qa=(d?r+d*e:this.nextAudioPts)-J.pts;qa>Math.floor(p.maxBufferHole*e)?(p=qa-O,0>p?p=O:m=!0,D.log(`[mp4-remuxer]: It is approximately ${qa/90} ms to the next segment; using duration ${p/
90} ms for the last video frame.`)):p=O}else p=O;O=Math.round(J.pts-J.dts);x=Math.min(x,p);E=Math.max(E,p);B=Math.min(B,R);C=Math.max(C,R);g.push(new Pq(J.key,p,aa,O))}if(g.length)if(ag)70>ag&&(d=g[0].flags,d.dependsOn=2,d.isNonSync=0);else if(sm&&C-B<E-x&&.025>k/E&&0===g[0].cts){D.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");f=z;for(let J=0,aa=g.length;J<aa;J++)d=f+g[J].duration,f+=g[J].cts,g[J].duration=J<aa-1?d+g[J+1].cts-f:J?g[J-1].duration:
k,g[J].cts=0,f=d}p=m||!p?k:p;this.nextAvcDts=m=b+p;this.videoSampleDuration=p;this.isVideoContiguous=!0;e={data1:G.moof(a.sequenceNumber++,z,Ga({},a,{samples:g})),data2:F,startPTS:r/e,endPTS:(w+p)/e,startDTS:z/e,endDTS:m/e,type:"video",hasAudio:!1,hasVideo:!0,nb:g.length,dropped:a.dropped};a.samples=[];a.dropped=0;return e}remuxAudio(a,b,c,d,e){var f=a.inputTimeScale,g=f/(a.samplerate?a.samplerate:f);let h="aac"===a.segmentCodec?1024:1152;var k=h*g,m=this._initPTS;let n="mp3"===a.segmentCodec&&this.typeSupported.mpeg,
p=[];var r=void 0!==e;let w=a.samples,z=n?0:8,x=this.nextAudioPts||-1,B=b*f,E=m.baseTime*f/m.timescale;this.isAudioContiguous=c=c||w.length&&0<x&&(d&&9E3>Math.abs(B-x)||Math.abs(eb(w[0].pts-E,B)-x)<20*k);w.forEach(function(F){F.pts=eb(F.pts-E,B)});if(!c||0>x){w=w.filter(F=>0<=F.pts);if(!w.length)return;x=0===e?0:d&&!r?Math.max(0,B):w[0].pts}if("aac"===a.segmentCodec){b=this.config.maxAudioFramesDrift;for(let F=0,O=x;F<w.length;F++){d=w[F];m=d.pts;var C=m-O;e=Math.abs(1E3*C/f);if(C<=-b*k&&r)0===F&&
(D.warn(`Audio frame @ ${(m/f).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1E3*C/f)} ms.`),this.nextAudioPts=x=O=m);else if(C>=b*k&&1E4>e&&r)for(e=Math.round(C/k),O=m-e*k,0>O&&(e--,O+=k),0===F&&(this.nextAudioPts=x=O),D.warn(`[mp4-remuxer]: Injecting ${e} audio frame @ ${(O/f).toFixed(3)}s due to ${Math.round(1E3*C/f)} ms gap.`),m=0;m<e;m++){C=Math.max(O,0);let R=Oq.getSilentFrame(a.manifestCodec||a.codec,a.channelCount);R||(D.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),
R=d.unit.subarray());w.splice(F,0,{unit:R,pts:C});O+=k;F++}d.pts=O;O+=k}}r=k=null;b=0;for(d=w.length;d--;)b+=w[d].unit.byteLength;for(let F=0,O=w.length;F<O;F++){e=w[F];d=e.unit;e=e.pts;if(null!==r)p[F-1].duration=Math.round((e-r)/g);else if(c&&"aac"===a.segmentCodec&&(e=x),k=e,0<b){b+=z;try{var I=new Uint8Array(b)}catch(R){this.observer.emit(u.ERROR,u.ERROR,{type:Z.MUX_ERROR,details:K.REMUX_ALLOC_ERROR,fatal:!1,error:R,bytes:b,reason:`fail allocating audio mdat ${b}`});return}n||((new DataView(I.buffer)).setUint32(0,
b),I.set(G.types.mdat,4))}else return;I.set(d,z);r=d.byteLength;z+=r;p.push(new Pq(!0,h,r,0));r=e}if(c=p.length)return this.nextAudioPts=x=r+g*p[p.length-1].duration,g=n?new Uint8Array(0):G.moof(a.sequenceNumber++,k/g,Ga({},a,{samples:p})),a.samples=[],a=k/f,f=x/f,I={data1:g,data2:I,startPTS:a,endPTS:f,startDTS:a,endDTS:f,type:"audio",hasAudio:!0,hasVideo:!1,nb:c},this.isAudioContiguous=!0,I}remuxEmptyAudio(a,b,c,d){var e=a.inputTimeScale,f=this.nextAudioPts,g=this._initDTS,h=9E4*g.baseTime/g.timescale;
f=(null!==f?f:d.startDTS*e)+h;g=e/(a.samplerate?a.samplerate:e)*1024;d=Math.ceil((d.endDTS*e+h-f)/g);e=Oq.getSilentFrame(a.manifestCodec||a.codec,a.channelCount);D.warn("[mp4-remuxer]: remux empty Audio");if(e){h=[];for(let k=0;k<d;k++){let m=f+k*g;h.push({unit:e,pts:m,dts:m})}a.samples=h;return this.remuxAudio(a,b,c,!1)}D.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")}}class Pq{constructor(a,b,c,d){this.flags=this.cts=this.duration=
this.size=void 0;this.duration=b;this.size=c;this.cts=d;this.flags=new fv(a)}}class fv{constructor(a){this.degradPrio=this.hasRedundancy=this.isDependedOn=this.isLeading=0;this.isNonSync=this.dependsOn=1;this.dependsOn=a?2:1;this.isNonSync=a?0:1}}class gv{constructor(){this.emitInitSegment=!1;this.initData=this.videoCodec=this.audioCodec=void 0;this.initPTS=null;this.initTracks=void 0;this.lastEndTime=null}destroy(){}resetTimeStamp(a){this.initPTS=a;this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=
null}resetInitSegment(a,b,c,d){this.audioCodec=b;this.videoCodec=c;this.generateInitSegment(ms(a,d));this.emitInitSegment=!0}generateInitSegment(a){let {audioCodec:b,videoCodec:c}=this;if(null!=a&&a.byteLength){var d=this.initData=bo(a);b||(b=Mo(d.audio,oa.AUDIO));c||(c=Mo(d.video,oa.VIDEO));var e={};d.audio&&d.video?e.audiovideo={container:"video/mp4",codec:b+","+c,initSegment:a,id:"main"}:d.audio?e.audio={container:"audio/mp4",codec:b,initSegment:a,id:"audio"}:d.video?e.video={container:"video/mp4",
codec:c,initSegment:a,id:"main"}:D.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes.");this.initTracks=e}else this.initData=this.initTracks=void 0}remux(a,b,c,d,e,f){var g,h;let {initPTS:k,lastEndTime:m}=this,n={audio:void 0,video:void 0,text:d,id3:c,initSegment:void 0};Y(m)||(m=this.lastEndTime=e||0);var p=b.samples;if(null==p||!p.length)return n;b={initPTS:void 0,timescale:1};var r=this.initData;null!=(g=r)&&g.length||(this.generateInitSegment(p),r=this.initData);
if(null==(h=r)||!h.length)return D.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),n;this.emitInitSegment&&(b.tracks=this.initTracks,this.emitInitSegment=!1);g=os(p,r);h=ns(r,p);h=null===h?e:h;var w=null===k?!0:Math.abs(h-k.baseTime/k.timescale-e)>Math.max(g,1);if(w||b.timescale!==k.timescale&&f)b.initPTS=h-e,k&&1===k.timescale&&D.warn(`Adjusting initPTS by ${b.initPTS-k.baseTime}`),this.initPTS=k={baseTime:b.initPTS,timescale:1};a=a?h-k.baseTime/k.timescale:m;f=a+g;qs(r,p,k.baseTime/
k.timescale);0<g?this.lastEndTime=f:(D.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());g=!!r.audio;r=!!r.video;h="";g&&(h+="audio");r&&(h+="video");p={data1:p,startPTS:a,startDTS:a,endPTS:f,endDTS:f,type:h,hasAudio:g,hasVideo:r,nb:1,dropped:0};n.audio="audio"===p.type?p:void 0;n.video="audio"!==p.type?p:void 0;n.initSegment=b;n.id3=Ko(c,e,k,k);d.samples.length&&(n.text=Lo(d,e,k));return n}}let Gb;try{Gb=self.performance.now.bind(self.performance)}catch(a){D.debug("Unable to use Performance API on this environment"),
Gb="undefined"!==typeof self&&self.Date.now}let um=[{demux:cv,remux:gv},{demux:oc,remux:tm},{demux:av,remux:tm},{demux:ev,remux:tm}];class Qq{constructor(a,b,c,d,e){this.async=!1;this.probe=this.decrypter=this.remuxer=this.demuxer=this.id=this.vendor=this.config=this.typeSupported=this.observer=void 0;this.decryptionPromise=null;this.currentTransmuxState=this.transmuxConfig=void 0;this.observer=a;this.typeSupported=b;this.config=c;this.vendor=d;this.id=e}configure(a){this.transmuxConfig=a;this.decrypter&&
this.decrypter.reset()}push(a,b,c,d){let e=c.transmuxing;e.executeStart=Gb();a=new Uint8Array(a);let {currentTransmuxState:f,transmuxConfig:g}=this;d&&(this.currentTransmuxState=d);let {contiguous:h,discontinuity:k,trackSwitch:m,accurateTimeOffset:n,timeOffset:p,initSegmentChange:r}=d||f,{audioCodec:w,videoCodec:z,defaultInitPts:x,duration:B,initSegmentData:E}=g;if((d=Ns(a,b))&&"AES-128"===d.method){var C=this.getDecrypter();if(C.isSync()){a=C.softwareDecrypt(a,d.key.buffer,d.iv.buffer);-1<c.part&&
(a=C.flush());if(!a)return e.executeEnd=Gb(),{remuxResult:{},chunkMeta:c};a=new Uint8Array(a)}else return this.decryptionPromise=C.webCryptoDecrypt(a,d.key.buffer,d.iv.buffer).then(I=>{I=this.push(I,null,c);this.decryptionPromise=null;return I})}if(C=this.needsProbing(k,m)){let I=this.configureTransmuxer(a);if(I)return D.warn(`[transmuxer] ${I.message}`),this.observer.emit(u.ERROR,u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,fatal:!1,error:I,reason:I.message}),e.executeEnd=Gb(),{remuxResult:{},
chunkMeta:c}}(k||m||r||C)&&this.resetInitSegment(E,w,z,B,b);(k||r||C)&&this.resetInitialTimestamp(x);h||this.resetContiguity();b=this.transmux(a,d,p,n,c);a=this.currentTransmuxState;a.contiguous=!0;a.discontinuity=!1;a.trackSwitch=!1;e.executeEnd=Gb();return b}flush(a){var b=a.transmuxing;b.executeStart=Gb();let {decrypter:c,currentTransmuxState:d,decryptionPromise:e}=this;if(e)return e.then(()=>this.flush(a));let f=[],{timeOffset:g}=d;if(c){let m=c.flush();m&&f.push(this.push(m,null,a))}let {demuxer:h,
remuxer:k}=this;if(!h||!k)return b.executeEnd=Gb(),[{remuxResult:{},chunkMeta:a}];b=h.flush(g);if(ke(b))return b.then(m=>{this.flushRemux(f,m,a);return f});this.flushRemux(f,b,a);return f}flushRemux(a,b,c){let {audioTrack:d,videoTrack:e,id3Track:f,textTrack:g}=b,{accurateTimeOffset:h,timeOffset:k}=this.currentTransmuxState;D.log(`[transmuxer.ts]: Flushed fragment ${c.sn}${-1<c.part?" p: "+c.part:""} of level ${c.level}`);b=this.remuxer.remux(d,e,f,g,k,h,!0,this.id);a.push({remuxResult:b,chunkMeta:c});
c.transmuxing.executeEnd=Gb()}resetInitialTimestamp(a){let {demuxer:b,remuxer:c}=this;b&&c&&(b.resetTimeStamp(a),c.resetTimeStamp(a))}resetContiguity(){let {demuxer:a,remuxer:b}=this;a&&b&&(a.resetContiguity(),b.resetNextTimestamp())}resetInitSegment(a,b,c,d,e){let {demuxer:f,remuxer:g}=this;f&&g&&(f.resetInitSegment(a,b,c,d),g.resetInitSegment(a,b,c,e))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0);this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(a,b,c,d,
e){return b&&"SAMPLE-AES"===b.method?this.transmuxSampleAes(a,b,c,d,e):this.transmuxUnencrypted(a,c,d,e)}transmuxUnencrypted(a,b,c,d){let {audioTrack:e,videoTrack:f,id3Track:g,textTrack:h}=this.demuxer.demux(a,b,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(e,f,g,h,b,c,!1,this.id),chunkMeta:d}}transmuxSampleAes(a,b,c,d,e){return this.demuxer.demuxSampleAes(a,b,c).then(f=>({remuxResult:this.remuxer.remux(f.audioTrack,f.videoTrack,f.id3Track,f.textTrack,c,d,!1,this.id),chunkMeta:e}))}configureTransmuxer(a){let {config:b,
observer:c,typeSupported:d,vendor:e}=this;for(let k=0,m=um.length;k<m;k++)if(um[k].demux.probe(a)){var f=um[k];break}if(!f)return Error("Failed to find demuxer by probing fragment data");a=this.demuxer;let g=this.remuxer,h=f.remux;f=f.demux;g&&g instanceof h||(this.remuxer=new h(c,b,d,e));a&&a instanceof f||(this.demuxer=new f(c,b,d),this.probe=f.probe)}needsProbing(a,b){return!this.demuxer||!this.remuxer||a||b}getDecrypter(){let a=this.decrypter;a||(a=this.decrypter=new qm(this.config));return a}}
class hv{constructor(a,b,c,d,e){this.defaultInitPts=this.duration=this.initSegmentData=this.videoCodec=this.audioCodec=void 0;this.audioCodec=a;this.videoCodec=b;this.initSegmentData=c;this.duration=d;this.defaultInitPts=e||null}}class iv{constructor(a,b,c,d,e,f){this.discontinuity=a;this.contiguous=b;this.accurateTimeOffset=c;this.trackSwitch=d;this.timeOffset=e;this.initSegmentChange=f}}var Rq={exports:{}};(function(a){function b(){}function c(k,m,n){this.fn=k;this.context=m;this.once=n||!1}function d(k,
m,n,p,r){if("function"!==typeof n)throw new TypeError("The listener must be a function");n=new c(n,p||k,r);m=h?h+m:m;k._events[m]?k._events[m].fn?k._events[m]=[k._events[m],n]:k._events[m].push(n):(k._events[m]=n,k._eventsCount++);return k}function e(k,m){0===--k._eventsCount?k._events=new b:delete k._events[m]}function f(){this._events=new b;this._eventsCount=0}var g=Object.prototype.hasOwnProperty,h="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(h=!1));f.prototype.eventNames=
function(){var k=[],m,n;if(0===this._eventsCount)return k;for(n in m=this._events)g.call(m,n)&&k.push(h?n.slice(1):n);return Object.getOwnPropertySymbols?k.concat(Object.getOwnPropertySymbols(m)):k};f.prototype.listeners=function(k){k=this._events[h?h+k:k];if(!k)return[];if(k.fn)return[k.fn];for(var m=0,n=k.length,p=Array(n);m<n;m++)p[m]=k[m].fn;return p};f.prototype.listenerCount=function(k){return(k=this._events[h?h+k:k])?k.fn?1:k.length:0};f.prototype.emit=function(k,m,n,p,r,w){var z=h?h+k:k;if(!this._events[z])return!1;
z=this._events[z];var x=arguments.length,B;if(z.fn){z.once&&this.removeListener(k,z.fn,void 0,!0);switch(x){case 1:return z.fn.call(z.context),!0;case 2:return z.fn.call(z.context,m),!0;case 3:return z.fn.call(z.context,m,n),!0;case 4:return z.fn.call(z.context,m,n,p),!0;case 5:return z.fn.call(z.context,m,n,p,r),!0;case 6:return z.fn.call(z.context,m,n,p,r,w),!0}var E=1;for(B=Array(x-1);E<x;E++)B[E-1]=arguments[E];z.fn.apply(z.context,B)}else{var C=z.length;for(E=0;E<C;E++)switch(z[E].once&&this.removeListener(k,
z[E].fn,void 0,!0),x){case 1:z[E].fn.call(z[E].context);break;case 2:z[E].fn.call(z[E].context,m);break;case 3:z[E].fn.call(z[E].context,m,n);break;case 4:z[E].fn.call(z[E].context,m,n,p);break;default:if(!B){var I=1;for(B=Array(x-1);I<x;I++)B[I-1]=arguments[I]}z[E].fn.apply(z[E].context,B)}}return!0};f.prototype.on=function(k,m,n){return d(this,k,m,n,!1)};f.prototype.once=function(k,m,n){return d(this,k,m,n,!0)};f.prototype.removeListener=function(k,m,n,p){k=h?h+k:k;if(!this._events[k])return this;
if(!m)return e(this,k),this;var r=this._events[k];if(r.fn)r.fn!==m||p&&!r.once||n&&r.context!==n||e(this,k);else{for(var w=0,z=[],x=r.length;w<x;w++)(r[w].fn!==m||p&&!r[w].once||n&&r[w].context!==n)&&z.push(r[w]);z.length?this._events[k]=1===z.length?z[0]:z:e(this,k)}return this};f.prototype.removeAllListeners=function(k){k?(k=h?h+k:k,this._events[k]&&e(this,k)):(this._events=new b,this._eventsCount=0);return this};f.prototype.off=f.prototype.removeListener;f.prototype.addListener=f.prototype.on;
f.prefixed=h;f.EventEmitter=f;a.exports=f})(Rq);var vm=function(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a["default"]:a}(Rq.exports);let wm=ae()||{isTypeSupported:()=>!1};class Sq{constructor(a,b,c,d){this.error=null;this.observer=this.id=this.hls=void 0;this.part=this.frag=null;this.useWorker=void 0;this.workerContext=null;this.onwmsg=void 0;this.transmuxer=null;this.onFlush=this.onTransmuxComplete=void 0;let e=a.config;this.hls=a;this.id=b;this.useWorker=!!e.enableWorker;
this.onTransmuxComplete=c;this.onFlush=d;a=(f,g)=>{g=g||{};g.frag=this.frag;g.id=this.id;f===u.ERROR&&(this.error=g.error);this.hls.trigger(f,g)};this.observer=new vm;this.observer.on(u.FRAG_DECRYPTED,a);this.observer.on(u.ERROR,a);a={mp4:wm.isTypeSupported("video/mp4"),mpeg:wm.isTypeSupported("audio/mpeg"),mp3:wm.isTypeSupported('audio/mp4; codecs="mp3"')};c=navigator.vendor;if(this.useWorker&&"undefined"!==typeof Worker&&(e.workerPath||"function"===typeof __HLS_WORKER_BUNDLE__))try{e.workerPath?
(D.log(`loading Web Worker ${e.workerPath} for "${b}"`),this.workerContext=Fs(e.workerPath)):(D.log(`injecting Web Worker for "${b}"`),this.workerContext=Es());this.onwmsg=g=>this.onWorkerMessage(g);let {worker:f}=this.workerContext;f.addEventListener("message",this.onwmsg);f.onerror=g=>{g=Error(`${g.message}  (${g.filename}:${g.lineno})`);e.enableWorker=!1;D.warn(`Error in "${b}" Web Worker, fallback to inline`);this.hls.trigger(u.ERROR,{type:Z.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",
error:g})};f.postMessage({cmd:"init",typeSupported:a,vendor:c,id:b,config:JSON.stringify(e)})}catch(f){D.warn(`Error setting up "${b}" Web Worker, fallback to inline`,f),this.resetWorker(),this.error=null,this.transmuxer=new Qq(this.observer,a,e,c,b)}else this.transmuxer=new Qq(this.observer,a,e,c,b)}resetWorker(){if(this.workerContext){let {worker:a,objectURL:b}=this.workerContext;b&&self.URL.revokeObjectURL(b);a.removeEventListener("message",this.onwmsg);a.onerror=null;a.terminate();this.workerContext=
null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{var a=this.transmuxer;a&&(a.destroy(),this.transmuxer=null)}(a=this.observer)&&a.removeAllListeners();this.hls=this.observer=this.frag=null}push(a,b,c,d,e,f,g,h,k,m){var n,p;k.transmuxing.start=self.performance.now();let {transmuxer:r}=this,w=f?f.start:e.start,z=e.decryptdata;var x=this.frag;let B=!(x&&e.cc===x.cc),E=!(x&&k.level===x.level),C=x?k.sn-x.sn:-1,I=this.part?k.part-this.part.index:-1;var F=0===C&&1<k.id&&k.id===
(null==x?void 0:x.stats.chunkCount);F=!E&&(1===C||0===C&&(1===I||F&&0>=I));let O=self.performance.now();if(E||C||0===e.stats.parsing.start)e.stats.parsing.start=O;!f||!I&&F||(f.stats.parsing.start=O);x=!(x&&(null==(n=e.initSegment)?void 0:n.url)===(null==(p=x.initSegment)?void 0:p.url));n=new iv(B,F,h,E,w,x);if(!F||B||x)D.log(`[transmuxer-interface, ${e.type}]: Starting new transmux session for sn: ${k.sn} p: ${k.part} level: ${k.level} id: ${k.id}
        discontinuity: ${B}
        trackSwitch: ${E}
        contiguous: ${F}
        accurateTimeOffset: ${h}
        timeOffset: ${w}
        initSegmentChange: ${x}`),b=new hv(c,d,b,g,m),this.configureTransmuxer(b);this.frag=e;this.part=f;this.workerContext?this.workerContext.worker.postMessage({cmd:"demux",data:a,decryptdata:z,chunkMeta:k,state:n},a instanceof ArrayBuffer?[a]:[]):r&&(a=r.push(a,z,k,n),ke(a)?(r.async=!0,a.then(R=>{this.handleTransmuxComplete(R)}).catch(R=>{this.transmuxerError(R,k,"transmuxer-interface push error")})):(r.async=!1,this.handleTransmuxComplete(a)))}flush(a){a.transmuxing.start=self.performance.now();
let {transmuxer:b}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:a});else if(b){let c=b.flush(a);ke(c)||b.async?(ke(c)||(c=Promise.resolve(c)),c.then(d=>{this.handleFlushResult(d,a)}).catch(d=>{this.transmuxerError(d,a,"transmuxer-interface flush error")})):this.handleFlushResult(c,a)}}transmuxerError(a,b,c){this.hls&&(this.error=a,this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_PARSING_ERROR,chunkMeta:b,fatal:!1,error:a,err:a,reason:c}))}handleFlushResult(a,
b){a.forEach(c=>{this.handleTransmuxComplete(c)});this.onFlush(b)}onWorkerMessage(a){a=a.data;let b=this.hls;switch(a.event){case "init":var c;(a=null==(c=this.workerContext)?void 0:c.objectURL)&&self.URL.revokeObjectURL(a);break;case "transmuxComplete":this.handleTransmuxComplete(a.data);break;case "flush":this.onFlush(a.data);break;case "workerLog":if(D[a.data.logType])D[a.data.logType](a.data.message);break;default:a.data=a.data||{},a.data.frag=this.frag,a.data.id=this.id,b.trigger(a.event,a.data)}}configureTransmuxer(a){let {transmuxer:b}=
this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:a}):b&&b.configure(a)}handleTransmuxComplete(a){a.chunkMeta.transmuxing.end=self.performance.now();this.onTransmuxComplete(a)}}class jv{constructor(a,b,c,d){this.config=void 0;this.media=null;this.hls=this.fragmentTracker=void 0;this.nudgeRetry=0;this.stallReported=!1;this.stalled=null;this.seeking=this.moved=!1;this.config=a;this.media=b;this.fragmentTracker=c;this.hls=d}destroy(){this.hls=this.fragmentTracker=
this.media=null}poll(a,b){let {config:c,media:d,stalled:e}=this;if(null!==d){var {currentTime:f,seeking:g}=d,h=this.seeking&&!g,k=!this.seeking&&g;this.seeking=g;if(f!==a)this.moved=!0,null!==e&&(this.stallReported&&(a=self.performance.now()-e,D.warn(`playback not stuck anymore @${f}, after ${Math.round(a)}ms`),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0);else if(k||h)this.stalled=null;else if(!(d.paused&&!g||d.ended||0===d.playbackRate)&&va.getBuffered(d).length&&(a=va.bufferInfo(d,
f,0),h=a.nextStart||0,0<a.len||h)){if(g){k=2<a.len;b=!h||b&&b.start<=f||2<h-f&&!this.fragmentTracker.getPartialFragment(f);if(k||b)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var m;b=Math.max(h,a.start||0)-f;h=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null;h=(null==h?0:null==(m=h.details)?0:m.live)?2*h.details.targetduration:2;m=this.fragmentTracker.getPartialFragment(f);if(0<b&&(b<=h||m)){this._trySkipBufferHole(m);return}}m=self.performance.now();if(null===e)this.stalled=
m;else{m-=e;if(!g&&250<=m&&(this._reportStall(a),!this.media))return;a=va.bufferInfo(d,f,c.maxBufferHole);this._tryFixBufferStall(a,m)}}}}_tryFixBufferStall(a,b){let {config:c,fragmentTracker:d,media:e}=this;if(null!==e){var f=e.currentTime,g=d.getPartialFragment(f);(!g||!this._trySkipBufferHole(g)&&this.media)&&(a.len>c.maxBufferHole||a.nextStart&&a.nextStart-f<c.maxBufferHole)&&b>1E3*c.highBufferWatchdogPeriod&&(D.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}}_reportStall(a){let {hls:b,
media:c,stallReported:d}=this;if(!d&&c){this.stallReported=!0;let e=Error(`Playback stalling at @${c.currentTime} due to low buffer (${JSON.stringify(a)})`);D.warn(e.message);b.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,fatal:!1,error:e,buffer:a.len})}}_trySkipBufferHole(a){let {config:b,hls:c,media:d}=this;if(null===d)return 0;var e=d.currentTime,f=va.bufferInfo(d,e,0),g=e<f.start?f.start:f.nextStart;if(g){var h=f.len<=b.maxBufferHole;f=0<f.len&&1>f.len&&3>d.readyState;var k=
g-e;if(0<k&&(h||f)){if(k>b.maxBufferHole&&({fragmentTracker:h}=this,f=!1,0===e&&(k=h.getAppendedFrag(0,ba.MAIN))&&g<k.end&&(f=!0),!f&&(k=a||h.getAppendedFrag(e,ba.MAIN)))){f=!1;for(k=k.end;k<g;){let m=h.getPartialFragment(k);if(m)k+=m.duration;else{f=!0;break}}if(f)return 0}g=Math.max(g+.05,e+.1);D.warn(`skipping hole, adjusting currentTime from ${e} to ${g}`);this.moved=!0;this.stalled=null;d.currentTime=g;a&&!a.gap&&(e=Error(`fragment loaded with buffer holes, seeking from ${e} to ${g}`),c.trigger(u.ERROR,
{type:Z.MEDIA_ERROR,details:K.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:e,reason:e.message,frag:a}));return g}}return 0}_tryNudgeBuffer(){let {config:a,hls:b,media:c,nudgeRetry:d}=this;if(null!==c){var e=c.currentTime;this.nudgeRetry++;if(d<a.nudgeMaxRetry){var f=e+(d+1)*a.nudgeOffset;e=Error(`Nudging 'currentTime' from ${e} to ${f}`);D.warn(e.message);c.currentTime=f;b.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.BUFFER_NUDGE_ON_STALL,error:e,fatal:!1})}else f=Error(`Playhead still not moving while enough data buffered @${e} after ${a.nudgeMaxRetry} nudges`),
D.error(f.message),b.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.BUFFER_STALLED_ERROR,error:f,fatal:!0})}}}class kv extends rm{constructor(a,b,c){super(a,b,c,"[stream-controller]",ba.MAIN);this.audioCodecSwap=!1;this.gapController=null;this.level=-1;this.audioOnly=this.altAudio=this._forceStartLoad=!1;this.onvseeked=this.onvplaying=this.fragPlaying=null;this.fragLastKbps=0;this.couldBacktrack=!1;this.backtrackFragment=null;this.audioCodecSwitch=!1;this.videoBuffer=null;this._registerListeners()}_registerListeners(){let {hls:a}=
this;a.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.LEVEL_LOADING,this.onLevelLoading,this);a.on(u.LEVEL_LOADED,this.onLevelLoaded,this);a.on(u.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this);a.on(u.ERROR,this.onError,this);a.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.on(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,
this);a.on(u.BUFFER_CREATED,this.onBufferCreated,this);a.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this);a.on(u.LEVELS_UPDATED,this.onLevelsUpdated,this);a.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let {hls:a}=this;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_PARSED,this.onManifestParsed,this);a.off(u.LEVEL_LOADED,this.onLevelLoaded,this);a.off(u.FRAG_LOAD_EMERGENCY_ABORTED,
this.onFragLoadEmergencyAborted,this);a.off(u.ERROR,this.onError,this);a.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.off(u.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this);a.off(u.BUFFER_CREATED,this.onBufferCreated,this);a.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this);a.off(u.LEVELS_UPDATED,this.onLevelsUpdated,this);a.off(u.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners();this.onMediaDetaching()}startLoad(a){if(this.levels){let {lastCurrentTime:b,
hls:c}=this;this.stopLoad();this.setInterval(100);this.level=-1;if(!this.startFragRequested){let d=c.startLevel;-1===d&&(c.config.testBandwidth&&1<this.levels.length?(d=0,this.bitrateTest=!0):d=c.nextAutoLevel);this.level=c.nextLoadLevel=d;this.loadedmetadata=!1}0<b&&-1===a&&(this.log(`Override startPosition with lastCurrentTime @${b.toFixed(3)}`),a=b);this.state="IDLE";this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a;this.tick()}else this._forceStartLoad=!0,this.state="STOPPED"}stopLoad(){this._forceStartLoad=
!1;super.stopLoad()}doTick(){switch(this.state){case "WAITING_LEVEL":var a;let {levels:c,level:d}=this;var b=null==c?void 0:null==(a=c[d])?void 0:a.details;!b||b.live&&this.levelLastLoaded!==this.level?this.hls.nextLoadLevel!==this.level&&(this.state="IDLE"):this.waitForCdnTuneIn(b)||(this.state="IDLE");break;case "FRAG_LOADING_WAITING_RETRY":a=self.performance.now();let e=this.retryDate;if(!e||a>=e||null!=(b=this.media)&&b.seeking)this.resetStartWhenNotLoaded(this.level),this.state="IDLE"}"IDLE"===
this.state&&this.doTickIdle();this.onTickEnd()}onTickEnd(){super.onTickEnd();this.checkBuffer();this.checkFragmentChanged()}doTickIdle(){let {hls:a,levelLastLoaded:b,levels:c,media:d}=this,{config:e,nextLoadLevel:f}=a;if(null!==b&&(d||!this.startFragRequested&&e.startFragPrefetch)&&!(this.altAudio&&this.audioOnly||null==c)&&c[f]){var g=c[f],h=this.getMainFwdBufferInfo();if(null!==h){var k=this.getLevelDetails();if(k&&this._streamEnded(h,k))g={},this.altAudio&&(g.type="video"),this.hls.trigger(u.BUFFER_EOS,
g),this.state="ENDED";else if(a.loadLevel!==f&&-1===a.manualLevel&&this.log(`Adapting to level ${f} from level ${this.level}`),this.level=a.nextLoadLevel=f,k=g.details,!k||"WAITING_LEVEL"===this.state||k.live&&this.levelLastLoaded!==f)this.level=f,this.state="WAITING_LEVEL";else{var m=h.len,n=this.getMaxBufferLength(g.maxBitrate);if(!(m>=n)){this.backtrackFragment&&this.backtrackFragment.start>h.end&&(this.backtrackFragment=null);m=this.backtrackFragment?this.backtrackFragment.start:h.end;var p=this.getNextFragment(m,
k);if(this.couldBacktrack&&!this.fragPrevious&&p&&"initSegment"!==p.sn&&"OK"!==this.fragmentTracker.getState(p)){var r,w=(null!=(r=this.backtrackFragment)?r:p).sn-k.startSN;(r=k.fragments[w-1])&&p.cc===r.cc&&(p=r,this.fragmentTracker.removeFragment(r))}else this.backtrackFragment&&h.len&&(this.backtrackFragment=null);p&&this.isLoopLoading(p,m)&&(p.gap||(r=this.audioOnly&&!this.altAudio?oa.AUDIO:oa.VIDEO,(w=(r===oa.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media)&&this.afterBufferFlushed(w,r,
ba.MAIN)),p=this.getNextFragmentLoopLoading(p,k,h,ba.MAIN,n));p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,g,m))}}}}}loadFragment(a,b,c){let d=this.fragmentTracker.getState(a);this.fragCurrent=a;"NOT_LOADED"===d||"PARTIAL"===d?"initSegment"===a.sn?this._loadInitSegment(a,b):this.bitrateTest?(this.log(`Fragment ${a.sn} of level ${a.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(a,b)):(this.startFragRequested=
!0,super.loadFragment(a,b,c)):this.clearTrackerIfNeeded(a)}getBufferedFrag(a){return this.fragmentTracker.getBufferedFrag(a,ba.MAIN)}followingBufferedFrag(a){return a?this.getBufferedFrag(a.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag();this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let {levels:a,media:b}=this;if(null!=b&&b.readyState){var c;(c=this.getAppendedFrag(b.currentTime))&&1<c.start&&this.flushMainBuffer(0,c.start-1);c=this.getLevelDetails();if(null!=c&&c.live){var d=
this.getMainFwdBufferInfo();if(!d||d.len<2*c.targetduration)return}!b.paused&&a?(c=a[this.hls.nextLoadLevel],c=(d=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*c.maxBitrate/(1E3*d)+1:0):c=0;if(c=this.getBufferedFrag(b.currentTime+c))if(d=this.followingBufferedFrag(c)){this.abortCurrentFrag();let e=d.duration;this.flushMainBuffer(Math.max(c.end,(d.maxStartPTS?d.maxStartPTS:d.start)+Math.min(Math.max(e-this.config.maxFragLookUpTolerance,.5*e),.75*e)),Number.POSITIVE_INFINITY)}}}abortCurrentFrag(){let a=
this.fragCurrent;this.backtrackFragment=this.fragCurrent=null;a&&(a.abortRequests(),this.fragmentTracker.removeFragment(a));switch(this.state){case "KEY_LOADING":case "FRAG_LOADING":case "FRAG_LOADING_WAITING_RETRY":case "PARSING":case "PARSED":this.state="IDLE"}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(a,b){super.flushMainBuffer(a,b,this.altAudio?"video":null)}onMediaAttached(a,b){super.onMediaAttached(a,b);a=b.media;this.onvplaying=this.onMediaPlaying.bind(this);this.onvseeked=
this.onMediaSeeked.bind(this);a.addEventListener("playing",this.onvplaying);a.addEventListener("seeked",this.onvseeked);this.gapController=new jv(this.config,a,this.fragmentTracker,this.hls)}onMediaDetaching(){let {media:a}=this;a&&this.onvplaying&&this.onvseeked&&(a.removeEventListener("playing",this.onvplaying),a.removeEventListener("seeked",this.onvseeked),this.videoBuffer=this.onvplaying=this.onvseeked=null);this.fragPlaying=null;this.gapController&&(this.gapController.destroy(),this.gapController=
null);super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){var a=this.media;a=a?a.currentTime:null;Y(a)&&this.log(`Media seeked to ${a.toFixed(3)}`);a=this.getMainFwdBufferInfo();null===a||0===a.len?this.warn(`Main forward buffer length on "seeked" event ${a?a.len:"empty"})`):this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET");this.hls.trigger(u.BUFFER_RESET,void 0);this.fragmentTracker.removeAllFragments();this.couldBacktrack=!1;this.startPosition=this.lastCurrentTime=
0;this.levels=this.fragPlaying=this.backtrackFragment=null;this.altAudio=this.audioOnly=!1}onManifestParsed(a,b){let c=!1,d=!1,e;b.levels.forEach(f=>{if(e=f.audioCodec)-1!==e.indexOf("mp4a.40.2")&&(c=!0),-1!==e.indexOf("mp4a.40.5")&&(d=!0)});(this.audioCodecSwitch=c&&d&&!Ds())&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=b.levels;this.startFragRequested=!1}onLevelLoading(a,b){({levels:a}=this);a&&"IDLE"===this.state&&(a=a[b.level],!a.details||a.details.live&&
this.levelLastLoaded!==b.level||this.waitForCdnTuneIn(a.details))&&(this.state="WAITING_LEVEL")}onLevelLoaded(a,b){var c,{levels:d}=this;a=b.level;let e=b.details;var f=e.totalduration;if(d){this.log(`Level ${a} loaded [${e.startSN},${e.endSN}]${e.lastPartSn?`[part-${e.lastPartSn}-${e.lastPartIndex}]`:""}, cc [${e.startCC}, ${e.endCC}] duration:${f}`);d=d[a];f=this.fragCurrent;!f||"FRAG_LOADING"!==this.state&&"FRAG_LOADING_WAITING_RETRY"!==this.state||f.level===b.level&&f.urlId===d.urlId||!f.loader||
this.abortCurrentFrag();b=0;if(e.live||null!=(c=d.details)&&c.live){this.checkLiveUpdate(e);if(e.deltaUpdateFailed)return;b=this.alignPlaylists(e,d.details)}d.details=e;this.levelLastLoaded=a;this.hls.trigger(u.LEVEL_UPDATED,{details:e,level:a});if("WAITING_LEVEL"===this.state){if(this.waitForCdnTuneIn(e))return;this.state="IDLE"}this.startFragRequested?e.live&&this.synchronizeToLiveEdge(e):this.setStartPosition(e,b);this.tick()}else this.warn(`Levels were reset while loading level ${a}`)}_handleFragmentLoadProgress(a){var b;
let {frag:c,part:d,payload:e}=a;({levels:a}=this);if(a){var f=a[c.level];if(a=f.details){var g=f.videoCodec,h=a.PTSKnown||!a.live,k=null==(b=c.initSegment)?void 0:b.data;b=this._getAudioCodec(f);f=this.transmuxer=this.transmuxer||new Sq(this.hls,ba.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this));var m=d?d.index:-1;m=new pm(c.level,c.sn,c.stats.chunkCount,e.byteLength,m,-1!==m);f.push(e,k,b,g,c,d,a.totalduration,h,m,this.initPTS[c.cc])}else this.warn(`Dropping fragment ${c.sn} of level ${c.level} after level details were reset`),
this.fragmentTracker.removeFragment(c)}else this.warn(`Levels were reset while fragment load was in progress. Fragment ${c.sn} of level ${c.level} will not be buffered`)}onAudioTrackSwitching(a,b){a=this.altAudio;if(!b.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading");this.mediaBuffer=this.media;var c=this.fragCurrent;c&&(this.log("Switching to main audio track, cancel main fragment load"),c.abortRequests(),this.fragmentTracker.removeFragment(c));
this.resetTransmuxer();this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();c=this.hls;a&&(c.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments());c.trigger(u.AUDIO_TRACK_SWITCHED,b)}}onAudioTrackSwitched(a,b){(a=!!this.hls.audioTracks[b.id].url)&&(b=this.videoBuffer)&&this.mediaBuffer!==b&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=b);
this.altAudio=a;this.tick()}onBufferCreated(a,b){a=b.tracks;let c,d;b=!1;for(let f in a){var e=a[f];if("main"===e.id){if(d=f,c=e,"video"===f&&(e=a[f]))this.videoBuffer=e.buffer}else b=!0}b&&c?(this.log(`Alternate track found, use ${d}.buffered to schedule main fragment loading`),this.mediaBuffer=c.buffer):this.mediaBuffer=this.media}onFragBuffered(a,b){let {frag:c,part:d}=b;c&&c.type!==ba.MAIN||(this.fragContextChanged(c)?(this.warn(`Fragment ${c.sn}${d?" p: "+d.index:""} of level ${c.level} finished buffering, but was aborted. state: ${this.state}`),
"PARSED"===this.state&&(this.state="IDLE")):(a=d?d.stats:c.stats,this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),"initSegment"!==c.sn&&(this.fragPrevious=c),this.fragBufferedComplete(c,d)))}onError(a,b){var c;if(b.fatal)this.state="ERROR";else switch(b.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ba.MAIN,b);break;case K.LEVEL_LOAD_ERROR:case K.LEVEL_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:b.levelRetry||
"WAITING_LEVEL"!==this.state||(null==(c=b.context)?void 0:c.type)!==la.LEVEL||(this.state="IDLE");break;case K.BUFFER_FULL_ERROR:if(!b.parent||"main"!==b.parent)break;this.reduceLengthAndFlushBuffer(b)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(b)}}checkBuffer(){let {media:a,gapController:b}=this;a&&b&&a.readyState&&(!this.loadedmetadata&&va.getBuffered(a).length||b.poll(this.lastCurrentTime,"IDLE"!==this.state?this.fragCurrent:null),
this.lastCurrentTime=a.currentTime)}onFragLoadEmergencyAborted(){this.state="IDLE";this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tickImmediate()}onBufferFlushed(a,{type:b}){(b!==oa.AUDIO||this.audioOnly&&!this.altAudio)&&this.afterBufferFlushed((b===oa.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media,b,ba.MAIN)}onLevelsUpdated(a,b){this.levels=b.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let {media:a}=this;
if(a){var b=a.currentTime,c=this.startPosition;if(0<=c&&b<c)if(a.seeking)this.log(`could not seek to ${c}, already seeking at ${b}`);else{var d=va.getBuffered(a);d=(d.length?d.start(0):0)-c;0<d&&(d<this.config.maxBufferHole||d<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${d} to match buffer start`),this.startPosition=c+=d);this.log(`seek to target start position ${c} from current time ${b}`);a.currentTime=c}}}_getAudioCodec(a){a=this.config.defaultAudioCodec||a.audioCodec;
this.audioCodecSwap&&a&&(this.log("Swapping audio codec"),a=-1!==a.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");return a}_loadBitrateTestFrag(a,b){a.bitrateTest=!0;this._doFragLoad(a,b).then(c=>{let {hls:d}=this;if(c&&!this.fragContextChanged(a)){b.fragmentError=0;this.state="IDLE";this.bitrateTest=this.startFragRequested=!1;var e=a.stats;e.parsing.start=e.parsing.end=e.buffering.start=e.buffering.end=self.performance.now();d.trigger(u.FRAG_LOADED,c);a.bitrateTest=!1}})}_handleTransmuxComplete(a){var b;
let {hls:c}=this,{remuxResult:d,chunkMeta:e}=a;if(a=this.getCurrentContext(e)){var {frag:f,part:g,level:h}=a,{video:k,text:m,id3:n,initSegment:p}=d;({details:a}=h);var r=this.altAudio?void 0:d.audio;if(this.fragContextChanged(f))this.fragmentTracker.removeFragment(f);else{this.state="PARSING";if(p){if(null!=p&&p.tracks){var w=f.initSegment||f;this._bufferInitSegment(h,p.tracks,w,e);c.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:"main",tracks:p.tracks})}w=p.initPTS;var z=p.timescale;Y(w)&&(this.initPTS[f.cc]=
{baseTime:w,timescale:z},c.trigger(u.INIT_PTS_FOUND,{frag:f,id:"main",initPTS:w,timescale:z}))}if(k&&a&&"initSegment"!==f.sn)if(z=a.fragments[f.sn-1-a.startSN],w=f.sn===a.startSN,z=!z||f.cc>z.cc,!1!==d.independent){let {startPTS:B,endPTS:E,startDTS:C,endDTS:I}=k;if(g)g.elementaryStreams[k.type]={startPTS:B,endPTS:E,startDTS:C,endDTS:I};else if(k.firstKeyFrame&&k.independent&&1===e.id&&!z&&(this.couldBacktrack=!0),k.dropped&&k.independent){var x=this.getMainFwdBufferInfo();x=(x?x.end:this.getLoadPosition())+
this.config.maxBufferHole;let F=k.firstKeyFramePTS?k.firstKeyFramePTS:B;if(!w&&x<F-this.config.maxBufferHole&&!z){this.backtrack(f);return}z&&(f.gap=!0);f.setElementaryStreamInfo(k.type,f.start,E,f.start,I,!0)}f.setElementaryStreamInfo(k.type,B,E,C,I);this.backtrackFragment&&(this.backtrackFragment=f);this.bufferFragmentData(k,f,g,e,w||z)}else if(w||z)f.gap=!0;else{this.backtrack(f);return}if(r){let {startPTS:B,endPTS:E,startDTS:C,endDTS:I}=r;g&&(g.elementaryStreams[oa.AUDIO]={startPTS:B,endPTS:E,
startDTS:C,endDTS:I});f.setElementaryStreamInfo(oa.AUDIO,B,E,C,I);this.bufferFragmentData(r,f,g,e)}a&&null!=n&&null!=(b=n.samples)&&b.length&&c.trigger(u.FRAG_PARSING_METADATA,{id:"main",frag:f,details:a,samples:n.samples});a&&m&&c.trigger(u.FRAG_PARSING_USERDATA,{id:"main",frag:f,details:a,samples:m.samples})}}else this.resetWhenMissingContext(e)}_bufferInitSegment(a,b,c,d){if("PARSING"===this.state){this.audioOnly=!!b.audio&&!b.video;this.altAudio&&!this.audioOnly&&delete b.audio;var {audio:e,video:f,
audiovideo:g}=b;if(e){let h=a.audioCodec,k=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(h&&(h=-1!==h.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==e.metadata.channelCount&&-1===k.indexOf("firefox")&&(h="mp4a.40.5"));-1!==k.indexOf("android")&&"audio/mpeg"!==e.container&&(h="mp4a.40.2",this.log(`Android: force audio codec to ${h}`));a.audioCodec&&a.audioCodec!==h&&this.log(`Swapping manifest audio codec "${a.audioCodec}" for "${h}"`);e.levelCodec=h;e.id="main";this.log(`Init audio buffer, container:${e.container}, codecs[selected/level/parsed]=[${h||
""}/${a.audioCodec||""}/${e.codec}]`)}f&&(f.levelCodec=a.videoCodec,f.id="main",this.log(`Init video buffer, container:${f.container}, codecs[level/parsed]=[${a.videoCodec||""}/${f.codec}]`));g&&this.log(`Init audiovideo buffer, container:${g.container}, codecs[level/parsed]=[${a.attrs.CODECS||""}/${g.codec}]`);this.hls.trigger(u.BUFFER_CODECS,b);Object.keys(b).forEach(h=>{let k=b[h].initSegment;null!=k&&k.byteLength&&this.hls.trigger(u.BUFFER_APPENDING,{type:h,data:k,frag:c,part:null,chunkMeta:d,
parent:c.type})});this.tick()}}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ba.MAIN)}backtrack(a){this.couldBacktrack=!0;this.backtrackFragment=a;this.resetTransmuxer();this.flushBufferGap(a);this.fragmentTracker.removeFragment(a);this.fragPrevious=null;this.nextLoadPosition=a.start;this.state="IDLE"}checkFragmentChanged(){var a=this.media;let b=null;if(a&&1<a.readyState&&!1===a.seeking){var c=a.currentTime;va.isBuffered(a,c)?b=this.getAppendedFrag(c):
va.isBuffered(a,c+.1)&&(b=this.getAppendedFrag(c+.1));b&&(this.backtrackFragment=null,a=this.fragPlaying,c=b.level,a&&b.sn===a.sn&&a.level===c&&b.urlId===a.urlId||(this.fragPlaying=b,this.hls.trigger(u.FRAG_CHANGED,{frag:b}),a&&a.level===c||this.hls.trigger(u.LEVEL_SWITCHED,{level:c})))}}get nextLevel(){let a=this.nextBufferedFrag;return a?a.level:-1}get currentFrag(){let a=this.media;return a?this.fragPlaying||this.getAppendedFrag(a.currentTime):null}get currentProgramDateTime(){var a=this.media;
if(a){a=a.currentTime;let b=this.currentFrag;if(b&&Y(a)&&Y(b.programDateTime))return new Date(b.programDateTime+1E3*(a-b.start))}return null}get currentLevel(){let a=this.currentFrag;return a?a.level:-1}get nextBufferedFrag(){let a=this.currentFrag;return a?this.followingBufferedFrag(a):null}get forceStartLoad(){return this._forceStartLoad}}class Uc{constructor(a,b=0,c=0){this.totalWeight_=this.estimate_=this.alpha_=this.halfLife=void 0;this.alpha_=(this.halfLife=a)?Math.exp(Math.log(.5)/a):0;this.estimate_=
b;this.totalWeight_=c}sample(a,b){let c=Math.pow(this.alpha_,a);this.estimate_=b*(1-c)+c*this.estimate_;this.totalWeight_+=a}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let a=1-Math.pow(this.alpha_,this.totalWeight_);if(a)return this.estimate_/a}return this.estimate_}}class lv{constructor(a,b,c,d=100){this.ttfb_=this.defaultTTFB_=this.fast_=this.slow_=void 0;this.defaultEstimate_=c;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new Uc(a);this.fast_=new Uc(b);this.defaultTTFB_=
d;this.ttfb_=new Uc(a)}update(a,b){let {slow_:c,fast_:d,ttfb_:e}=this;c.halfLife!==a&&(this.slow_=new Uc(a,c.getEstimate(),c.getTotalWeight()));d.halfLife!==b&&(this.fast_=new Uc(b,d.getEstimate(),d.getTotalWeight()));e.halfLife!==a&&(this.ttfb_=new Uc(a,e.getEstimate(),e.getTotalWeight()))}sample(a,b){a=Math.max(a,this.minDelayMs_);a/=1E3;b=8*b/a;this.fast_.sample(a,b);this.slow_.sample(a,b)}sampleTTFB(a){this.ttfb_.sample(Math.sqrt(2)*Math.exp(-Math.pow(a/1E3,2)/2),Math.max(a,5))}canEstimate(){return this.fast_.getTotalWeight()>=
this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class mv{constructor(a){this.hls=void 0;this.lastLoadedFragLevel=this.lastLevelLoadSec=0;this.timer=this._nextAutoLevel=-1;this.onCheck=this._abandonRulesCheck.bind(this);this.partCurrent=this.fragCurrent=null;this.bitrateTestDelay=0;this.bwEstimator=
void 0;this.hls=a;a=a.config;this.bwEstimator=new lv(a.abrEwmaSlowVoD,a.abrEwmaFastVoD,a.abrEwmaDefaultEstimate);this.registerListeners()}registerListeners(){let {hls:a}=this;a.on(u.FRAG_LOADING,this.onFragLoading,this);a.on(u.FRAG_LOADED,this.onFragLoaded,this);a.on(u.FRAG_BUFFERED,this.onFragBuffered,this);a.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this);a.on(u.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){let {hls:a}=this;a.off(u.FRAG_LOADING,this.onFragLoading,this);a.off(u.FRAG_LOADED,
this.onFragLoaded,this);a.off(u.FRAG_BUFFERED,this.onFragBuffered,this);a.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this);a.off(u.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners();this.clearTimer();this.fragCurrent=this.partCurrent=this.hls=this.onCheck=null}onFragLoading(a,b){var c;a=b.frag;this.ignoreFragment(a)||(this.fragCurrent=a,this.partCurrent=null!=(c=b.part)?c:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(a,b){this.clearTimer()}getTimeToLoadFrag(a,
b,c,d){return a+c/b+(d?this.lastLevelLoadSec:0)}onLevelLoaded(a,b){a=this.hls.config;let {total:c,bwEstimate:d}=b.stats;Y(c)&&Y(d)&&(this.lastLevelLoadSec=8*c/d);b.details.live?this.bwEstimator.update(a.abrEwmaSlowLive,a.abrEwmaFastLive):this.bwEstimator.update(a.abrEwmaSlowVoD,a.abrEwmaFastVoD)}_abandonRulesCheck(){let {fragCurrent:a,partCurrent:b,hls:c}=this,{autoLevelEnabled:d,media:e}=c;if(a&&e){var f=performance.now(),g=b?b.stats:a.stats,h=b?b.duration:a.duration;f-=g.loading.start;if(g.aborted||
g.loaded&&g.loaded===g.total||0===a.level)this.clearTimer(),this._nextAutoLevel=-1;else if(d&&!e.paused&&e.playbackRate&&e.readyState){var k=c.mainForwardBufferInfo;if(null!==k){var m=this.bwEstimator.getEstimateTTFB(),n=Math.abs(e.playbackRate);if(!(f<=Math.max(m,h/(2*n)*1E3)||(k=k.len/n,k>=2*h/n))){n=g.loading.first?g.loading.first-g.loading.start:-1;var p=g.loaded&&-1<n,r=this.bwEstimator.getEstimate(),{levels:w,minAutoLevel:z}=c,x=w[a.level];x=g.total||Math.max(g.loaded,Math.round(h*x.maxBitrate/
8));var B=f-n;1>B&&p&&(B=Math.min(f,8*g.loaded/r));x=(B=p?1E3*g.loaded/B:0)?(x-g.loaded)/B:8*x/r+m/1E3;if(!(x<=k)){B=B?8*B:r;var E=Number.POSITIVE_INFINITY,C;for(C=a.level-1;C>z&&!(E=this.getTimeToLoadFrag(m/1E3,B,h*w[C].maxBitrate,!w[C].details),E<k);C--);E>=x||E>10*h||(c.nextLoadLevel=C,p?this.bwEstimator.sample(f-Math.min(m,n),g.loaded):this.bwEstimator.sampleTTFB(f),this.clearTimer(),D.warn(`[abr] Fragment ${a.sn}${b?" part "+b.index:""} of level ${a.level} is loading too slowly;
      Time to underbuffer: ${k.toFixed(3)} s
      Estimated load time for current fragment: ${x.toFixed(3)} s
      Estimated load time for down switch fragment: ${E.toFixed(3)} s
      TTFB estimate: ${n}
      Current BW estimate: ${Y(r)?(r/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${C}`),a.loader&&(this.fragCurrent=this.partCurrent=null,a.abortRequests()),c.trigger(u.FRAG_LOAD_EMERGENCY_ABORTED,{frag:a,part:b,stats:g}))}}}}}}onFragLoaded(a,{frag:b,part:c}){a=c?c.stats:b.stats;b.type===ba.MAIN&&this.bwEstimator.sampleTTFB(a.loading.first-a.loading.start);if(!this.ignoreFragment(b)){this.clearTimer();this.lastLoadedFragLevel=b.level;this._nextAutoLevel=-1;if(this.hls.config.abrMaxWithRealBitrate){let d=this.hls.levels[b.level],e=(d.loaded?
d.loaded.bytes:0)+a.loaded,f=(d.loaded?d.loaded.duration:0)+(c?c.duration:b.duration);d.loaded={bytes:e,duration:f};d.realBitrate=Math.round(8*e/f)}b.bitrateTest&&(this.onFragBuffered(u.FRAG_BUFFERED,{stats:a,frag:b,part:c,id:b.type}),b.bitrateTest=!1)}}onFragBuffered(a,b){let {frag:c,part:d}=b;a=null!=d&&d.stats.loaded?d.stats:c.stats;a.aborted||this.ignoreFragment(c)||(b=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB()),this.bwEstimator.sample(b,
a.loaded),a.bwEstimate=this.bwEstimator.getEstimate(),this.bitrateTestDelay=c.bitrateTest?b/1E3:0)}ignoreFragment(a){return a.type!==ba.MAIN||"initSegment"===a.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){let a=this._nextAutoLevel;var b=this.bwEstimator;if(-1!==a&&!b.canEstimate())return a;b=this.getNextABRAutoLevel();if(-1!==a){let c=this.hls.levels;if(c.length>Math.max(a,b)&&c[a].loadError<=c[b].loadError)return a}-1!==a&&(b=Math.min(a,b));return b}getNextABRAutoLevel(){let {fragCurrent:a,
partCurrent:b,hls:c}=this,{maxAutoLevel:d,config:e,minAutoLevel:f,media:g}=c,h=b?b.duration:a?a.duration:0;var k=g&&0!==g.playbackRate?Math.abs(g.playbackRate):1;let m=this.bwEstimator?this.bwEstimator.getEstimate():e.abrEwmaDefaultEstimate;var n=c.mainForwardBufferInfo;k=(n?n.len:0)/k;n=this.findBestLevel(m,f,d,k,e.abrBandWidthFactor,e.abrBandWidthUpFactor);if(0<=n)return n;D.trace(`[abr] ${k?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);n=h?Math.min(h,e.maxStarvationDelay):
e.maxStarvationDelay;let p=e.abrBandWidthFactor,r=e.abrBandWidthUpFactor;if(!k){let w=this.bitrateTestDelay;w&&(n=(h?Math.min(h,e.maxLoadingDelay):e.maxLoadingDelay)-w,D.trace(`[abr] bitrate test took ${Math.round(1E3*w)}ms, set first fragment max fetchDuration to ${Math.round(1E3*n)} ms`),p=r=1)}n=this.findBestLevel(m,f,d,k+n,p,r);return Math.max(n,0)}findBestLevel(a,b,c,d,e,f){var g;let {fragCurrent:h,partCurrent:k,lastLoadedFragLevel:m}=this,{levels:n}=this.hls,p=n[m],r=!(null==p||null==(g=p.details)||
!g.live);g=null==p?void 0:p.codecSet;let w=k?k.duration:h?h.duration:0,z=this.bwEstimator.getEstimateTTFB()/1E3,x=b,B=-1;for(;c>=b;c--){var E=n[c];if(!E||g&&E.codecSet!==g){E&&(x=Math.min(c,x),B=Math.max(c,B));continue}-1!==B&&D.trace(`[abr] Skipped level(s) ${x}-${B} with CODECS:"${n[B].attrs.CODECS}"; not compatible with "${p.attrs.CODECS}"`);var C=E.details;E=(k?null==C?void 0:C.partTarget:null==C?void 0:C.averagetargetduration)||w;let I;I=c<=m?e*a:f*a;let F=n[c].maxBitrate;C=this.getTimeToLoadFrag(z,
I,F*E,void 0===C);D.trace(`[abr] level:${c} adjustedbw-bitrate:${Math.round(I-F)} avgDuration:${E.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${C.toFixed(1)}`);if(I>F&&(0===C||!Y(C)||r&&!this.bitrateTestDelay||C<d))return c}return-1}set nextAutoLevel(a){this._nextAutoLevel=a}}class Tq{constructor(){this.chunks=[];this.dataLength=0}push(a){this.chunks.push(a);this.dataLength+=a.length}flush(){let {chunks:a,dataLength:b}=this;if(a.length)if(1===a.length)var c=a[0];else{c=new Uint8Array(b);
let d=0;for(let e=0;e<a.length;e++){let f=a[e];c.set(f,d);d+=f.length}}else return new Uint8Array(0);this.reset();return c}reset(){this.dataLength=this.chunks.length=0}}class nv extends rm{constructor(a,b,c){super(a,b,c,"[audio-stream-controller]",ba.AUDIO);this.videoBuffer=null;this.waitingVideoCC=this.videoTrackCC=-1;this.switchingTrack=this.bufferedTrack=null;this.trackId=-1;this.mainDetails=this.waitingData=null;this.bufferFlushed=!1;this.cachedTrackLoadedData=null;this._registerListeners()}onHandlerDestroying(){this._unregisterListeners();
this.switchingTrack=this.bufferedTrack=this.mainDetails=null}_registerListeners(){let {hls:a}=this;a.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.LEVEL_LOADED,this.onLevelLoaded,this);a.on(u.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this);a.on(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);a.on(u.ERROR,this.onError,
this);a.on(u.BUFFER_RESET,this.onBufferReset,this);a.on(u.BUFFER_CREATED,this.onBufferCreated,this);a.on(u.BUFFER_FLUSHED,this.onBufferFlushed,this);a.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this);a.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let {hls:a}=this;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.LEVEL_LOADED,this.onLevelLoaded,this);a.off(u.AUDIO_TRACKS_UPDATED,
this.onAudioTracksUpdated,this);a.off(u.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this);a.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);a.off(u.ERROR,this.onError,this);a.off(u.BUFFER_RESET,this.onBufferReset,this);a.off(u.BUFFER_CREATED,this.onBufferCreated,this);a.off(u.BUFFER_FLUSHED,this.onBufferFlushed,this);a.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this);a.off(u.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(a,{frag:b,id:c,initPTS:d,timescale:e}){"main"===c&&(a=b.cc,
this.initPTS[b.cc]={baseTime:d,timescale:e},this.log(`InitPTS for cc: ${a} found from main: ${d}`),this.videoTrackCC=a,"WAITING_INIT_PTS"===this.state&&this.tick())}startLoad(a){if(this.levels){var b=this.lastCurrentTime;this.stopLoad();this.setInterval(100);0<b&&-1===a?(this.log(`Override startPosition with lastCurrentTime @${b.toFixed(3)}`),a=b,this.state="IDLE"):(this.loadedmetadata=!1,this.state="WAITING_TRACK");this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a;this.tick()}else this.startPosition=
a,this.state="STOPPED"}doTick(){switch(this.state){case "IDLE":this.doTickIdle();break;case "WAITING_TRACK":var a;let {levels:c,trackId:d}=this;var b=null==c?void 0:null==(a=c[d])?void 0:a.details;b&&!this.waitForCdnTuneIn(b)&&(this.state="WAITING_INIT_PTS");break;case "FRAG_LOADING_WAITING_RETRY":a=performance.now();let e=this.retryDate;if(!e||a>=e||null!=(b=this.media)&&b.seeking)this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state="IDLE";
break;case "WAITING_INIT_PTS":if(b=this.waitingData){let {frag:f,part:g,cache:h,complete:k}=b;void 0!==this.initPTS[f.cc]?(this.waitingData=null,this.waitingVideoCC=-1,this.state="FRAG_LOADING",b=h.flush(),b={frag:f,part:g,payload:b,networkDetails:null},this._handleFragmentLoadProgress(b),k&&super._handleFragmentLoadComplete(b)):this.videoTrackCC!==this.waitingVideoCC?(this.log(`Waiting fragment cc (${f.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment()):(b=this.getLoadPosition(),
b=va.bufferInfo(this.mediaBuffer,b,this.config.maxBufferHole),0>Qg(b.end,this.config.maxFragLookUpTolerance,f)&&(this.log(`Waiting fragment cc (${f.cc}) @ ${f.start} cancelled because another fragment at ${b.end} is needed`),this.clearWaitingFragment()))}else this.state="IDLE"}this.onTickEnd()}clearWaitingFragment(){let a=this.waitingData;a&&(this.fragmentTracker.removeFragment(a.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state="IDLE")}resetLoadingState(){this.clearWaitingFragment();
super.resetLoadingState()}onTickEnd(){let {media:a}=this;null!=a&&a.readyState&&(this.lastCurrentTime=a.currentTime)}doTickIdle(){let {hls:a,levels:b,media:c,trackId:d}=this;var e=a.config;if(null!=b&&b[d]&&(c||!this.startFragRequested&&e.startFragPrefetch)){e=b[d];var f=e.details;if(!f||f.live&&this.levelLastLoaded!==d||this.waitForCdnTuneIn(f))this.state="WAITING_TRACK";else{var g=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&g&&(this.bufferFlushed=!1,this.afterBufferFlushed(g,
oa.AUDIO,ba.AUDIO));g=this.getFwdBufferInfo(g,ba.AUDIO);if(null!==g){var {bufferedTrack:h,switchingTrack:k}=this;if(!k&&this._streamEnded(g,f))a.trigger(u.BUFFER_EOS,{type:"audio"}),this.state="ENDED";else{var m=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ba.MAIN),n=g.len,p=this.getMaxBufferLength(null==m?void 0:m.len);if(!(n>=p)||k){var r=f.fragments[0].start;n=g.end;if(k&&c){var w=this.getLoadPosition();h&&k.attrs!==h.attrs&&(n=w);f.PTSKnown&&w<r&&(g.end>r||g.nextStart)&&
(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),c.currentTime=r+.05)}r=this.getNextFragment(n,f);w=!1;r&&this.isLoopLoading(r,n)&&(w=!!r.gap,r=this.getNextFragmentLoopLoading(r,f,g,ba.MAIN,p));if(r){if((f=m&&r.start>m.end+f.targetduration)||(null==m||!m.len)&&g.len){p=this.getAppendedFrag(r.start,ba.MAIN);if(null===p)return;w||(w=!!p.gap||!!f&&0===m.len);if(f&&!w||w&&g.nextStart&&g.nextStart<p.end)return}this.loadFragment(r,e,n)}else this.bufferFlushed=!0}}}}}}getMaxBufferLength(a){let b=
super.getMaxBufferLength();return a?Math.min(Math.max(b,a),this.config.maxMaxBufferLength):b}onMediaDetaching(){this.videoBuffer=null;super.onMediaDetaching()}onAudioTracksUpdated(a,{audioTracks:b}){this.resetTransmuxer();this.levels=b.map(c=>new Kd(c))}onAudioTrackSwitching(a,b){a=!!b.url;this.trackId=b.id;let {fragCurrent:c}=this;c&&(c.abortRequests(),this.removeUnbufferedFrags(c.start));this.resetLoadingState();a?this.setInterval(100):this.resetTransmuxer();a?(this.switchingTrack=b,this.state=
"IDLE"):(this.switchingTrack=null,this.bufferedTrack=b,this.state="STOPPED");this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments();this.startPosition=this.lastCurrentTime=0;this.bufferFlushed=!1;this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null;this.startFragRequested=!1;this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(a,b){this.mainDetails=b.details;null!==this.cachedTrackLoadedData&&(this.hls.trigger(u.AUDIO_TRACK_LOADED,
this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(a,b){var c;if(null==this.mainDetails)this.cachedTrackLoadedData=b;else{({levels:a}=this);var {details:d,id:e}=b;if(a){this.log(`Track ${e} loaded [${d.startSN},${d.endSN}]${d.lastPartSn?`[part-${d.lastPartSn}-${d.lastPartIndex}]`:""},duration:${d.totalduration}`);b=a[e];a=0;if(d.live||null!=(c=b.details)&&c.live){this.checkLiveUpdate(d);c=this.mainDetails;if(d.deltaUpdateFailed||!c)return;!b.details&&d.hasProgramDateTime&&
c.hasProgramDateTime?(Fo(d,c),a=d.fragments[0].start):a=this.alignPlaylists(d,b.details)}b.details=d;this.levelLastLoaded=e;this.startFragRequested||!this.mainDetails&&d.live||this.setStartPosition(b.details,a);"WAITING_TRACK"!==this.state||this.waitForCdnTuneIn(d)||(this.state="IDLE");this.tick()}else this.warn(`Audio tracks were reset while loading level ${e}`)}}_handleFragmentLoadProgress(a){var b;let {frag:c,part:d,payload:e}=a,{config:f,trackId:g,levels:h}=this;if(h){var k=h[g];if(k)if(a=k.details){k=
f.defaultAudioCodec||k.audioCodec||"mp4a.40.2";var m=this.transmuxer;m||(m=this.transmuxer=new Sq(this.hls,ba.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var n=this.initPTS[c.cc],p=null==(b=c.initSegment)?void 0:b.data;void 0!==n?(b=d?d.index:-1,b=new pm(c.level,c.sn,c.stats.chunkCount,e.byteLength,b,-1!==b),m.push(e,p,k,"",c,d,a.totalduration,!1,b,n)):(this.log(`Unknown video PTS for cc ${c.cc}, waiting for video PTS before demuxing audio frag ${c.sn} of [${a.startSN} ,${a.endSN}],track ${g}`),
{cache:a}=this.waitingData=this.waitingData||{frag:c,part:d,cache:new Tq,complete:!1},a.push(new Uint8Array(e)),this.waitingVideoCC=this.videoTrackCC,this.state="WAITING_INIT_PTS")}else this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(c.start);else this.warn("Audio track is undefined on fragment load progress")}else this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${c.sn} of level ${c.level} will not be buffered`)}_handleFragmentLoadComplete(a){this.waitingData?
this.waitingData.complete=!0:super._handleFragmentLoadComplete(a)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1}onBufferCreated(a,b){if(a=b.tracks.audio)this.mediaBuffer=a.buffer||null;b.tracks.video&&(this.videoBuffer=b.tracks.video.buffer||null)}onFragBuffered(a,b){let {frag:c,part:d}=b;c.type!==ba.AUDIO?this.loadedmetadata||c.type!==ba.MAIN||(a=this.videoBuffer||this.media)&&va.getBuffered(a).length&&(this.loadedmetadata=!0):this.fragContextChanged(c)?this.warn(`Fragment ${c.sn}${d?
" p: "+d.index:""} of level ${c.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`):("initSegment"!==c.sn&&(this.fragPrevious=c,a=this.switchingTrack)&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(u.AUDIO_TRACK_SWITCHED,Xa({},a))),this.fragBufferedComplete(c,d))}onError(a,b){var c;if(b.fatal)this.state="ERROR";else switch(b.details){case K.FRAG_GAP:case K.FRAG_PARSING_ERROR:case K.FRAG_DECRYPT_ERROR:case K.FRAG_LOAD_ERROR:case K.FRAG_LOAD_TIMEOUT:case K.KEY_LOAD_ERROR:case K.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ba.AUDIO,
b);break;case K.AUDIO_TRACK_LOAD_ERROR:case K.AUDIO_TRACK_LOAD_TIMEOUT:case K.LEVEL_PARSING_ERROR:b.levelRetry||"WAITING_TRACK"!==this.state||(null==(c=b.context)?void 0:c.type)!==la.AUDIO_TRACK||(this.state="IDLE");break;case K.BUFFER_FULL_ERROR:if(!b.parent||"audio"!==b.parent)break;this.reduceLengthAndFlushBuffer(b)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case K.INTERNAL_EXCEPTION:this.recoverWorkerError(b)}}onBufferFlushed(a,{type:b}){b===oa.AUDIO&&
(this.bufferFlushed=!0,"ENDED"===this.state&&(this.state="IDLE"))}_handleTransmuxComplete(a){var b;let {hls:c}=this,{remuxResult:d,chunkMeta:e}=a;if(a=this.getCurrentContext(e)){var {frag:f,part:g,level:h}=a;({details:a}=h);var {audio:k,text:m,id3:n,initSegment:p}=d;if(this.fragContextChanged(f)||!a)this.fragmentTracker.removeFragment(f);else{this.state="PARSING";this.switchingTrack&&k&&this.completeAudioSwitch(this.switchingTrack);if(null!=p&&p.tracks){let r=f.initSegment||f;this._bufferInitSegment(p.tracks,
r,e);c.trigger(u.FRAG_PARSING_INIT_SEGMENT,{frag:r,id:"audio",tracks:p.tracks})}if(k){let {startPTS:r,endPTS:w,startDTS:z,endDTS:x}=k;g&&(g.elementaryStreams[oa.AUDIO]={startPTS:r,endPTS:w,startDTS:z,endDTS:x});f.setElementaryStreamInfo(oa.AUDIO,r,w,z,x);this.bufferFragmentData(k,f,g,e)}null!=n&&null!=(b=n.samples)&&b.length&&(b=Ga({id:"audio",frag:f,details:a},n),c.trigger(u.FRAG_PARSING_METADATA,b));m&&(b=Ga({id:"audio",frag:f,details:a},m),c.trigger(u.FRAG_PARSING_USERDATA,b))}}else this.resetWhenMissingContext(e)}_bufferInitSegment(a,
b,c){if("PARSING"===this.state){a.video&&delete a.video;var d=a.audio;d&&(d.levelCodec=d.codec,d.id="audio",this.log(`Init audio buffer, container:${d.container}, codecs[parsed]=[${d.codec}]`),this.hls.trigger(u.BUFFER_CODECS,a),a=d.initSegment,null!=a&&a.byteLength&&this.hls.trigger(u.BUFFER_APPENDING,{type:"audio",frag:b,part:null,chunkMeta:c,parent:b.type,data:a}),this.tick())}}loadFragment(a,b,c){let d=this.fragmentTracker.getState(a);this.fragCurrent=a;if(this.switchingTrack||"NOT_LOADED"===
d||"PARTIAL"===d){var e;"initSegment"===a.sn?this._loadInitSegment(a,b):null!=(e=b.details)&&e.live&&!this.initPTS[a.cc]?(this.log(`Waiting for video PTS in continuity counter ${a.cc} of live stream before loading audio fragment ${a.sn} of level ${this.trackId}`),this.state="WAITING_INIT_PTS"):(this.startFragRequested=!0,super.loadFragment(a,b,c))}else this.clearTrackerIfNeeded(a)}completeAudioSwitch(a){let {hls:b,media:c,bufferedTrack:d}=this,e=null==d?void 0:d.attrs,f=a.attrs;c&&e&&(e.CHANNELS!==
f.CHANNELS||e.NAME!==f.NAME||e.LANGUAGE!==f.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));this.bufferedTrack=a;this.switchingTrack=null;b.trigger(u.AUDIO_TRACK_SWITCHED,Xa({},a))}}class ov extends nm{constructor(a){super(a,"[audio-track-controller]");this.tracks=[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.currentTrack=null;this.selectDefaultTrack=!0;this.registerListeners()}registerListeners(){let {hls:a}=
this;a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.LEVEL_LOADING,this.onLevelLoading,this);a.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this);a.on(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);a.on(u.ERROR,this.onError,this)}unregisterListeners(){let {hls:a}=this;a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_PARSED,this.onManifestParsed,this);a.off(u.LEVEL_LOADING,this.onLevelLoading,this);a.off(u.LEVEL_SWITCHING,
this.onLevelSwitching,this);a.off(u.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this);a.off(u.ERROR,this.onError,this)}destroy(){this.unregisterListeners();this.tracks.length=0;this.tracksInGroup.length=0;this.currentTrack=null;super.destroy()}onManifestLoading(){this.tracks=[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.currentTrack=null;this.selectDefaultTrack=!0}onManifestParsed(a,b){this.tracks=b.audioTracks||[]}onAudioTrackLoaded(a,b){let {id:c,groupId:d,details:e}=b;if((a=this.tracksInGroup[c])&&
a.groupId===d){var f=a.details;a.details=b.details;this.log(`audio-track ${c} "${a.name}" lang:${a.lang} group:${d} loaded [${e.startSN}-${e.endSN}]`);c===this.trackId&&this.playlistLoaded(c,b,f)}else this.warn(`Track with id:${c} and group:${d} not found in active group ${a.groupId}`)}onLevelLoading(a,b){this.switchLevel(b.level)}onLevelSwitching(a,b){this.switchLevel(b.level)}switchLevel(a){a=this.hls.levels[a];if(null!=a&&a.audioGroupIds){var b=a.audioGroupIds[a.urlId];if(this.groupId!==b){this.groupId=
b||null;a=this.tracks.filter(d=>!b||d.groupId===b);this.selectDefaultTrack&&!a.some(d=>d.default)&&(this.selectDefaultTrack=!1);this.tracksInGroup=a;let c={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group:${b}`);this.hls.trigger(u.AUDIO_TRACKS_UPDATED,c);this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}}onError(a,b){!b.fatal&&b.context&&b.context.type===la.AUDIO_TRACK&&b.context.id===this.trackId&&b.context.groupId===
this.groupId&&(this.requestScheduled=-1,this.checkRetry(b))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(a){this.selectDefaultTrack=!1;this.setAudioTrack(a)}setAudioTrack(a){var b=this.tracksInGroup;if(0>a||a>=b.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var c=this.currentTrack;b[this.trackId];b=b[a];var {groupId:d,name:e}=b;this.log(`Switching to audio-track ${a} "${e}" lang:${b.lang} group:${d}`);this.trackId=
a;this.currentTrack=b;this.selectDefaultTrack=!1;this.hls.trigger(u.AUDIO_TRACK_SWITCHING,Xa({},b));if(!b.details||b.details.live)a=this.switchParams(b.url,null==c?void 0:c.details),this.loadPlaylist(a)}}selectInitialTrack(){var a=this.tracksInGroup;let b=this.findTrackId(this.currentTrack)|this.findTrackId(null);-1!==b?this.setAudioTrack(b):(a=Error(`No track found for running audio group-ID: ${this.groupId} track count: ${a.length}`),this.warn(a.message),this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,
details:K.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:a}))}findTrackId(a){let b=this.tracksInGroup;for(let c=0;c<b.length;c++){let d=b[c];if(!this.selectDefaultTrack||d.default)if(!a||void 0!==a.attrs["STABLE-RENDITION-ID"]&&a.attrs["STABLE-RENDITION-ID"]===d.attrs["STABLE-RENDITION-ID"]||a.name===d.name&&a.lang===d.lang)return d.id}return-1}loadPlaylist(a){super.loadPlaylist();let b=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(b)){let c=b.id,d=b.groupId,e=b.url;if(a)try{e=a.addDirectives(e)}catch(f){this.warn(`Could not construct new URL with HLS Delivery Directives: ${f}`)}this.log(`loading audio-track playlist ${c} "${b.name}" lang:${b.lang} group:${d}`);
this.clearTimer();this.hls.trigger(u.AUDIO_TRACK_LOADING,{url:e,id:c,groupId:d,deliveryDirectives:a||null})}}}class pv extends rm{constructor(a,b,c){super(a,b,c,"[subtitle-stream-controller]",ba.SUBTITLE);this.levels=[];this.currentTrackId=-1;this.tracksBuffered=[];this.mainDetails=null;this._registerListeners()}onHandlerDestroying(){this._unregisterListeners();this.mainDetails=null}_registerListeners(){let {hls:a}=this;a.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,
this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.LEVEL_LOADED,this.onLevelLoaded,this);a.on(u.ERROR,this.onError,this);a.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);a.on(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this);a.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);a.on(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this);a.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this);a.on(u.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let {hls:a}=
this;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.LEVEL_LOADED,this.onLevelLoaded,this);a.off(u.ERROR,this.onError,this);a.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);a.off(u.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this);a.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);a.off(u.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this);a.off(u.BUFFER_FLUSHING,
this.onBufferFlushing,this);a.off(u.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(a){this.stopLoad();this.state="IDLE";this.setInterval(500);this.nextLoadPosition=this.startPosition=this.lastCurrentTime=a;this.tick()}onManifestLoading(){this.mainDetails=null;this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[];super.onMediaDetaching()}onLevelLoaded(a,b){this.mainDetails=b.details}onSubtitleFragProcessed(a,b){let {frag:c,success:d}=b;this.fragPrevious=c;this.state=
"IDLE";if(d&&(a=this.tracksBuffered[this.currentTrackId])){b=c.start;for(var e=0;e<a.length;e++)if(b>=a[e].start&&b<=a[e].end){var f=a[e];break}e=c.start+c.duration;f?f.end=e:(f={start:b,end:e},a.push(f));this.fragmentTracker.fragBuffered(c)}}onBufferFlushing(a,b){let {startOffset:c,endOffset:d}=b;if(0===c&&d!==Number.POSITIVE_INFINITY){let e=d-1;0>=e||(b.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(f=>{for(let g=0;g<f.length;)if(f[g].end<=e)f.shift();else{if(f[g].start<e)f[g].start=
e;else break;g++}}),this.fragmentTracker.removeFragmentsInRange(c,e,ba.SUBTITLE))}}onFragBuffered(a,b){if(!this.loadedmetadata&&b.frag.type===ba.MAIN){var c;null!=(c=this.media)&&c.buffered.length&&(this.loadedmetadata=!0)}}onError(a,b){a=b.frag;(null==a?void 0:a.type)===ba.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),"STOPPED"!==this.state&&(this.state="IDLE"))}onSubtitleTracksUpdated(a,{subtitleTracks:b}){No(this.levels,b)?this.levels=b.map(c=>new Kd(c)):(this.tracksBuffered=[],
this.levels=b.map(c=>{c=new Kd(c);this.tracksBuffered[c.id]=[];return c}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ba.SUBTITLE),this.mediaBuffer=this.fragPrevious=null)}onSubtitleTrackSwitch(a,b){this.currentTrackId=b.id;this.levels.length&&-1!==this.currentTrackId?(a=this.levels[this.currentTrackId],this.mediaBuffer=null!=a&&a.details?this.mediaBufferTimeRanges:null,a&&this.setInterval(500)):this.clearInterval()}onSubtitleTrackLoaded(a,b){var c;let {details:d,id:e}=
b,{currentTrackId:f,levels:g}=this;if(g.length&&(a=g[f],!(e>=g.length||e!==f)&&a)){this.mediaBuffer=this.mediaBufferTimeRanges;b=0;if(d.live||null!=(c=a.details)&&c.live){c=this.mainDetails;if(d.deltaUpdateFailed||!c)return;let h=c.fragments[0];a.details?(b=this.alignPlaylists(d,a.details),0===b&&h&&(b=h.start,Og(d,b))):d.hasProgramDateTime&&c.hasProgramDateTime?(Fo(d,c),b=d.fragments[0].start):h&&(b=h.start,Og(d,b))}a.details=d;this.levelLastLoaded=e;this.startFragRequested||!this.mainDetails&&d.live||
this.setStartPosition(a.details,b);this.tick();d.live&&!this.fragCurrent&&this.media&&"IDLE"===this.state&&!ad(null,d.fragments,this.media.currentTime,0)&&(this.warn("Subtitle playlist not aligned with playback"),a.details=void 0)}}_handleFragmentLoadComplete(a){let {frag:b,payload:c}=a;a=b.decryptdata;let d=this.hls;if(!this.fragContextChanged(b)&&c&&0<c.byteLength&&a&&a.key&&a.iv&&"AES-128"===a.method){let e=performance.now();this.decrypter.decrypt(new Uint8Array(c),a.key.buffer,a.iv.buffer).catch(f=>
{d.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.FRAG_DECRYPT_ERROR,fatal:!1,error:f,reason:f.message,frag:b});throw f;}).then(f=>{let g=performance.now();d.trigger(u.FRAG_DECRYPTED,{frag:b,payload:f,stats:{tstart:e,tdecrypt:g}})}).catch(f=>{this.warn(`${f.name}: ${f.message}`);this.state="IDLE"})}}doTick(){if(!this.media)this.state="IDLE";else if("IDLE"===this.state){let {currentTrackId:k,levels:m}=this,n=m[k];if(m.length&&n&&n.details){var {config:a}=this,b=this.getLoadPosition();b=va.bufferedInfo(this.tracksBuffered[this.currentTrackId]||
[],b,a.maxBufferHole);var {end:c,len:d}=b,e=this.getFwdBufferInfo(this.media,ba.MAIN);b=n.details;e=this.getMaxBufferLength(null==e?void 0:e.len)+b.levelTargetDuration;if(!(d>e)){e=b.fragments;var f=e.length,g=b.edge,h=this.fragPrevious;c<g?(a=a.maxFragLookUpTolerance,a=ad(h,e,Math.max(e[0].start,c),c>g-a?0:a),!a&&h&&h.start<e[0].start&&(a=e[0])):a=e[f-1];a&&(a=this.mapToInitFragWhenRequired(a),"initSegment"!==a.sn&&(b=e[a.sn-b.startSN-1])&&b.cc===a.cc&&"NOT_LOADED"===this.fragmentTracker.getState(b)&&
(a=b),"NOT_LOADED"===this.fragmentTracker.getState(a)&&this.loadFragment(a,n,c))}}}}getMaxBufferLength(a){let b=super.getMaxBufferLength();return a?Math.max(b,a):b}loadFragment(a,b,c){this.fragCurrent=a;"initSegment"===a.sn?this._loadInitSegment(a,b):(this.startFragRequested=!0,super.loadFragment(a,b,c))}get mediaBufferTimeRanges(){return new qv(this.tracksBuffered[this.currentTrackId]||[])}}class qv{constructor(a){this.buffered=void 0;let b=(c,d,e)=>{d>>>=0;if(d>e-1)throw new DOMException(`Failed to execute '${c}' on 'TimeRanges': The index provided (${d}) is greater than the maximum bound (${e})`);
return a[d][c]};this.buffered={get length(){return a.length},end(c){return b("end",c,a.length)},start(c){return b("start",c,a.length)}}}}class rv extends nm{constructor(a){super(a,"[subtitle-track-controller]");this.media=null;this.tracks=[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.selectDefaultTrack=!0;this.queuedDefaultTrack=-1;this.trackChangeListener=()=>this.onTextTracksChanged();this.asyncPollTrackChange=()=>this.pollTrackChange(0);this.useTextTrackPolling=!1;this.subtitlePollingInterval=
-1;this._subtitleDisplay=!0;this.registerListeners()}destroy(){this.unregisterListeners();this.tracks.length=0;this.tracksInGroup.length=0;this.trackChangeListener=this.asyncPollTrackChange=null;super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(a){this._subtitleDisplay=a;-1<this.trackId&&this.toggleTrackModes(this.trackId)}registerListeners(){let {hls:a}=this;a.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,
this.onManifestLoading,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.LEVEL_LOADING,this.onLevelLoading,this);a.on(u.LEVEL_SWITCHING,this.onLevelSwitching,this);a.on(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);a.on(u.ERROR,this.onError,this)}unregisterListeners(){let {hls:a}=this;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_PARSED,this.onManifestParsed,
this);a.off(u.LEVEL_LOADING,this.onLevelLoading,this);a.off(u.LEVEL_SWITCHING,this.onLevelSwitching,this);a.off(u.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this);a.off(u.ERROR,this.onError,this)}onMediaAttached(a,b){if(this.media=b.media)-1<this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),(this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks))?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",
this.asyncPollTrackChange)}pollTrackChange(a){self.clearInterval(this.subtitlePollingInterval);this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,a)}onMediaDetaching(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),-1<this.trackId&&(this.queuedDefaultTrack=this.trackId),Ug(this.media.textTracks).forEach(a=>{wc(a)}),this.subtitleTrack=-1,this.media=null)}onManifestLoading(){this.tracks=
[];this.groupId=null;this.tracksInGroup=[];this.trackId=-1;this.selectDefaultTrack=!0}onManifestParsed(a,b){this.tracks=b.subtitleTracks}onSubtitleTrackLoaded(a,b){let {id:c,details:d}=b;({trackId:a}=this);if(a=this.tracksInGroup[a]){var e=a.details;a.details=b.details;this.log(`subtitle track ${c} loaded [${d.startSN}-${d.endSN}]`);c===this.trackId&&this.playlistLoaded(c,b,e)}else this.warn(`Invalid subtitle track id ${c}`)}onLevelLoading(a,b){this.switchLevel(b.level)}onLevelSwitching(a,b){this.switchLevel(b.level)}switchLevel(a){a=
this.hls.levels[a];if(null!=a&&a.textGroupIds){var b=a.textGroupIds[a.urlId];a=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==b){let c=this.tracks.filter(f=>!b||f.groupId===b);this.tracksInGroup=c;let d=this.findTrackId(null==a?void 0:a.name)||this.findTrackId();this.groupId=b||null;let e={subtitleTracks:c};this.log(`Updating subtitle tracks, ${c.length} track(s) found in "${b}" group-id`);this.hls.trigger(u.SUBTITLE_TRACKS_UPDATED,e);-1!==d&&this.setSubtitleTrack(d,
a)}else this.shouldReloadPlaylist(a)&&this.setSubtitleTrack(this.trackId,a)}}findTrackId(a){let b=this.tracksInGroup;for(let c=0;c<b.length;c++){let d=b[c];if(!this.selectDefaultTrack||d.default)if(!a||a===d.name)return d.id}return-1}onError(a,b){!b.fatal&&b.context&&b.context.type===la.SUBTITLE_TRACK&&b.context.id===this.trackId&&b.context.groupId===this.groupId&&this.checkRetry(b)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(a){this.selectDefaultTrack=
!1;this.setSubtitleTrack(a,this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0)}loadPlaylist(a){super.loadPlaylist();var b=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(b)){let c=b.id,d=b.groupId;b=b.url;if(a)try{b=a.addDirectives(b)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${c}`);this.hls.trigger(u.SUBTITLE_TRACK_LOADING,{url:b,id:c,groupId:d,deliveryDirectives:a||null})}}toggleTrackModes(a){let {media:b,
trackId:c}=this;if(b){var d=Ug(b.textTracks),e=d.filter(f=>f.groupId===this.groupId);if(-1===a)[].slice.call(d).forEach(f=>{f.mode="disabled"});else if(d=e[c])d.mode="disabled";if(a=e[a])a.mode=this.subtitleDisplay?"showing":"hidden"}}setSubtitleTrack(a,b){var c;let d=this.tracksInGroup;if(this.media){if(this.trackId!==a&&this.toggleTrackModes(a),!(this.trackId===a&&(-1===a||null!=(c=d[a])&&c.details)||-1>a||a>=d.length))if(this.clearTimer(),c=d[a],this.log(`Switching to subtitle-track ${a}`+(c?` "${c.name}" lang:${c.lang} group:${c.groupId}`:
"")),this.trackId=a,c){let {id:e,groupId:f="",name:g,type:h,url:k}=c;this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:e,groupId:f,name:g,type:h,url:k});a=this.switchParams(c.url,null==b?void 0:b.details);this.loadPlaylist(a)}else this.hls.trigger(u.SUBTITLE_TRACK_SWITCH,{id:a})}else this.queuedDefaultTrack=a}onTextTracksChanged(){this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval);if(this.media&&this.hls.config.renderTextTracksNatively){var a=-1,b=Ug(this.media.textTracks);for(let c=
0;c<b.length;c++)if("hidden"===b[c].mode)a=c;else if("showing"===b[c].mode){a=c;break}this.subtitleTrack!==a&&(this.subtitleTrack=a)}}}class sv{constructor(a){this.queues={video:[],audio:[],audiovideo:[]};this.buffers=a}append(a,b){let c=this.queues[b];c.push(a);1===c.length&&this.buffers[b]&&this.executeNext(b)}insertAbort(a,b){this.queues[b].unshift(a);this.executeNext(b)}appendBlocker(a){let b,c=new Promise(d=>{b=d});this.append({execute:b,onStart:()=>{},onComplete:()=>{},onError:()=>{}},a);return c}executeNext(a){let {buffers:b,
queues:c}=this,d=b[a],e=c[a];if(e.length){let f=e[0];try{f.execute()}catch(g){D.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),f.onError(g),null!=d&&d.updating||(e.shift(),this.executeNext(a))}}}shiftAndExecuteNext(a){this.queues[a].shift();this.executeNext(a)}current(a){return this.queues[a][0]}}let Uq=ae(),Vq=/([ha]vc.)(?:\.[^.,]+)+/;class tv{constructor(a){this._objectUrl=this.details=null;this.hls=this.listeners=this.operationQueue=void 0;this._bufferCodecEventsTotal=
this.bufferCodecEventsExpected=0;this.lastMpegAudioChunk=this.mediaSource=this.media=null;this.appendError=0;this.tracks={};this.pendingTracks={};this.sourceBuffer=void 0;this._onMediaSourceOpen=()=>{let {media:b,mediaSource:c}=this;D.log("[buffer-controller]: Media source opened");b&&(b.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(u.MEDIA_ATTACHED,{media:b}));c&&c.removeEventListener("sourceopen",this._onMediaSourceOpen);this.checkPendingTracks()};
this._onMediaSourceClose=()=>{D.log("[buffer-controller]: Media source closed")};this._onMediaSourceEnded=()=>{D.log("[buffer-controller]: Media source ended")};this._onMediaEmptied=()=>{let {media:b,_objectUrl:c}=this;b&&b.src!==c&&D.error(`Media element src was set while attaching MediaSource (${c} > ${b.src})`)};this.hls=a;this._initSourceBuffer();this.registerListeners()}hasSourceTypes(){return 0<this.getSourceBufferTypes().length||0<Object.keys(this.pendingTracks).length}destroy(){this.unregisterListeners();
this.lastMpegAudioChunk=this.details=null}registerListeners(){let {hls:a}=this;a.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.BUFFER_RESET,this.onBufferReset,this);a.on(u.BUFFER_APPENDING,this.onBufferAppending,this);a.on(u.BUFFER_CODECS,this.onBufferCodecs,this);a.on(u.BUFFER_EOS,this.onBufferEos,this);a.on(u.BUFFER_FLUSHING,this.onBufferFlushing,
this);a.on(u.LEVEL_UPDATED,this.onLevelUpdated,this);a.on(u.FRAG_PARSED,this.onFragParsed,this);a.on(u.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){let {hls:a}=this;a.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_PARSED,this.onManifestParsed,this);a.off(u.BUFFER_RESET,this.onBufferReset,this);a.off(u.BUFFER_APPENDING,this.onBufferAppending,this);a.off(u.BUFFER_CODECS,
this.onBufferCodecs,this);a.off(u.BUFFER_EOS,this.onBufferEos,this);a.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this);a.off(u.LEVEL_UPDATED,this.onLevelUpdated,this);a.off(u.FRAG_PARSED,this.onFragParsed,this);a.off(u.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={};this.operationQueue=new sv(this.sourceBuffer);this.listeners={audio:[],video:[],audiovideo:[]};this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=
0;this.details=null}onManifestParsed(a,b){a=2;if(b.audio&&!b.video||!b.altAudio)a=1;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=a;D.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(a,b){(a=this.media=b.media)&&Uq&&(b=this.mediaSource=new Uq,b.addEventListener("sourceopen",this._onMediaSourceOpen),b.addEventListener("sourceended",this._onMediaSourceEnded),b.addEventListener("sourceclose",this._onMediaSourceClose),a.src=self.URL.createObjectURL(b),
this._objectUrl=a.src,a.addEventListener("emptied",this._onMediaEmptied))}onMediaDetaching(){let {media:a,mediaSource:b,_objectUrl:c}=this;if(b){D.log("[buffer-controller]: media source detaching");if("open"===b.readyState)try{b.endOfStream()}catch(d){D.warn(`[buffer-controller]: onMediaDetaching: ${d.message} while calling endOfStream`)}this.onBufferReset();b.removeEventListener("sourceopen",this._onMediaSourceOpen);b.removeEventListener("sourceended",this._onMediaSourceEnded);b.removeEventListener("sourceclose",
this._onMediaSourceClose);a&&(a.removeEventListener("emptied",this._onMediaEmptied),c&&self.URL.revokeObjectURL(c),a.src===c?(a.removeAttribute("src"),a.load()):D.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup"));this._objectUrl=this.media=this.mediaSource=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={}}this.hls.trigger(u.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(a=>{let b=this.sourceBuffer[a];
try{b&&(this.removeBufferListeners(a),this.mediaSource&&this.mediaSource.removeSourceBuffer(b),this.sourceBuffer[a]=void 0)}catch(c){D.warn(`[buffer-controller]: Failed to reset the ${a} buffer`,c)}});this._initSourceBuffer()}onBufferCodecs(a,b){let c=this.getSourceBufferTypes().length;Object.keys(b).forEach(d=>{if(c){let e=this.tracks[d];if(e&&"function"===typeof e.buffer.changeType){let {id:f,codec:g,levelCodec:h,container:k,metadata:m}=b[d],n=(e.levelCodec||e.codec).replace(Vq,"$1"),p=(h||g).replace(Vq,
"$1");n!==p&&(this.appendChangeType(d,`${k};codecs=${h||g}`),D.log(`[buffer-controller]: switching codec ${n} to ${p}`),this.tracks[d]={buffer:e.buffer,codec:g,container:k,levelCodec:h,metadata:m,id:f})}}else this.pendingTracks[d]=b[d]});c||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(a,b){let {operationQueue:c}=this;c.append({execute:()=>{const d=this.sourceBuffer[a];
d&&(D.log(`[buffer-controller]: changing ${a} sourceBuffer type to ${b}`),d.changeType(b));c.shiftAndExecuteNext(a)},onStart:()=>{},onComplete:()=>{},onError:d=>{D.warn(`[buffer-controller]: Failed to change ${a} SourceBuffer type`,d)}},a)}onBufferAppending(a,b){let {hls:c,operationQueue:d,tracks:e}=this,{data:f,type:g,frag:h,part:k,chunkMeta:m}=b,n=m.buffering[g];a=self.performance.now();n.start=a;let p=h.stats.buffering,r=k?k.stats.buffering:null;0===p.start&&(p.start=a);r&&0===r.start&&(r.start=
a);a=e.audio;let w=!1;"audio"===g&&"audio/mpeg"===(null==a?void 0:a.container)&&(w=!this.lastMpegAudioChunk||1===m.id||this.lastMpegAudioChunk.sn!==m.sn,this.lastMpegAudioChunk=m);let z=h.start;d.append({execute:()=>{n.executeStart=self.performance.now();if(w){const x=this.sourceBuffer[g];if(x){const B=z-x.timestampOffset;.1<=Math.abs(B)&&(D.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${z} (delta: ${B}) sn: ${h.sn})`),x.timestampOffset=z)}}this.appendExecutor(f,g)},onStart:()=>
{},onComplete:()=>{var x=self.performance.now();n.executeEnd=n.end=x;0===p.first&&(p.first=x);r&&0===r.first&&(r.first=x);({sourceBuffer:x}=this);const B={};for(const E in x)B[E]=va.getBuffered(x[E]);this.appendError=0;this.hls.trigger(u.BUFFER_APPENDED,{type:g,frag:h,part:k,chunkMeta:m,parent:h.type,timeRanges:B})},onError:x=>{D.error(`[buffer-controller]: Error encountered while trying to append to the ${g} SourceBuffer`,x);const B={type:Z.MEDIA_ERROR,parent:h.type,details:K.BUFFER_APPEND_ERROR,
frag:h,part:k,chunkMeta:m,error:x,err:x,fatal:!1};x.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=K.BUFFER_FULL_ERROR:(this.appendError++,B.details=K.BUFFER_APPEND_ERROR,this.appendError>c.config.appendErrorMaxRetry&&(D.error(`[buffer-controller]: Failed ${c.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),B.fatal=!0));c.trigger(u.ERROR,B)}},g)}onBufferFlushing(a,b){let {operationQueue:c}=this,d=e=>({execute:this.removeExecutor.bind(this,e,b.startOffset,b.endOffset),onStart:()=>
{},onComplete:()=>{this.hls.trigger(u.BUFFER_FLUSHED,{type:e})},onError:f=>{D.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,f)}});b.type?c.append(d(b.type),b.type):this.getSourceBufferTypes().forEach(e=>{c.append(d(e),e)})}onFragParsed(a,b){let {frag:c,part:d}=b;a=[];b=d?d.elementaryStreams:c.elementaryStreams;b[oa.AUDIOVIDEO]?a.push("audiovideo"):(b[oa.AUDIO]&&a.push("audio"),b[oa.VIDEO]&&a.push("video"));0===a.length&&D.warn(`Fragments must have at least one ElementaryStreamType set. type: ${c.type} level: ${c.level} sn: ${c.sn}`);
this.blockBuffers(()=>{const e=self.performance.now();c.stats.buffering.end=e;d&&(d.stats.buffering.end=e);this.hls.trigger(u.FRAG_BUFFERED,{frag:c,part:d,stats:d?d.stats:c.stats,id:c.type})},a)}onFragChanged(a,b){this.flushBackBuffer()}onBufferEos(a,b){this.getSourceBufferTypes().reduce((c,d)=>{const e=this.sourceBuffer[d];!e||b.type&&b.type!==d||(e.ending=!0,e.ended||(e.ended=!0,D.log(`[buffer-controller]: ${d} sourceBuffer now EOS`)));return c&&!(e&&!e.ended)},!0)&&(D.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),
this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(d=>{if(d=this.sourceBuffer[d])d.ending=!1});let {mediaSource:c}=this;c&&"open"===c.readyState?(D.log("[buffer-controller]: Calling mediaSource.endOfStream()"),c.endOfStream()):c&&D.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${c.readyState}`)}))}onLevelUpdated(a,{details:b}){b.fragments.length&&(this.details=b,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):
this.updateMediaElementDuration())}flushBackBuffer(){let {hls:a,details:b,media:c,sourceBuffer:d}=this;if(c&&null!==b){var e=this.getSourceBufferTypes();if(e.length){var f=b.live&&null!==a.config.liveBackBufferLength?a.config.liveBackBufferLength:a.config.backBufferLength;if(Y(f)&&!(0>f)){var g=c.currentTime,h=b.levelTargetDuration,k=Math.floor(g/h)*h-Math.max(f,h);e.forEach(m=>{let n=d[m];if(n){let p=va.getBuffered(n);if(0<p.length&&k>p.start(0)){a.trigger(u.BACK_BUFFER_REACHED,{bufferEnd:k});if(b.live)a.trigger(u.LIVE_BACK_BUFFER_REACHED,
{bufferEnd:k});else if(n.ended&&p.end(p.length-1)-g<2*h){D.info(`[buffer-controller]: Cannot flush ${m} back buffer while SourceBuffer is in ended state`);return}a.trigger(u.BUFFER_FLUSHING,{startOffset:0,endOffset:k,type:m})}}})}}}}updateMediaElementDuration(){if(this.details&&this.media&&this.mediaSource&&"open"===this.mediaSource.readyState){var {details:a,hls:b,media:c,mediaSource:d}=this,e=a.fragments[0].start+a.totalduration,f=c.duration,g=Y(d.duration)?d.duration:0;if(a.live&&b.config.liveDurationInfinity)D.log("[buffer-controller]: Media Source duration is set to Infinity"),
d.duration=Infinity,this.updateSeekableRange(a);else if(e>g&&e>f||!Y(f))D.log(`[buffer-controller]: Updating Media Source duration to ${e.toFixed(3)}`),d.duration=e}}updateSeekableRange(a){let b=this.mediaSource;var c=a.fragments;c.length&&a.live&&null!=b&&b.setLiveSeekableRange&&(c=Math.max(0,c[0].start),b.setLiveSeekableRange(c,Math.max(c,c+a.totalduration)))}checkPendingTracks(){let {bufferCodecEventsExpected:a,operationQueue:b,pendingTracks:c}=this;var d=Object.keys(c).length;if(d&&!a||2===d)this.createSourceBuffers(c),
this.pendingTracks={},d=this.getSourceBufferTypes(),d.length?(this.hls.trigger(u.BUFFER_CREATED,{tracks:this.tracks}),d.forEach(e=>{b.executeNext(e)})):(d=Error("could not create source buffer for media codec(s)"),this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:d,reason:d.message}))}createSourceBuffers(a){let {sourceBuffer:b,mediaSource:c}=this;if(!c)throw Error("createSourceBuffers called when mediaSource was null");for(let d in a)if(!b[d]){let e=
a[d];if(!e)throw Error(`source buffer exists for track ${d}, however track does not`);let f=e.levelCodec||e.codec,g=`${e.container};codecs=${f}`;D.log(`[buffer-controller]: creating sourceBuffer(${g})`);try{let h=b[d]=c.addSourceBuffer(g),k=d;this.addBufferListener(k,"updatestart",this._onSBUpdateStart);this.addBufferListener(k,"updateend",this._onSBUpdateEnd);this.addBufferListener(k,"error",this._onSBUpdateError);this.tracks[d]={buffer:h,codec:f,container:e.container,levelCodec:e.levelCodec,metadata:e.metadata,
id:e.id}}catch(h){D.error(`[buffer-controller]: error while trying to add sourceBuffer: ${h.message}`),this.hls.trigger(u.ERROR,{type:Z.MEDIA_ERROR,details:K.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,mimeType:g})}}}_onSBUpdateStart(a){let {operationQueue:b}=this;b.current(a).onStart()}_onSBUpdateEnd(a){let {operationQueue:b}=this;b.current(a).onComplete();b.shiftAndExecuteNext(a)}_onSBUpdateError(a,b){let c=Error(`${a} SourceBuffer error`);D.error(`[buffer-controller]: ${c}`,b);this.hls.trigger(u.ERROR,
{type:Z.MEDIA_ERROR,details:K.BUFFER_APPENDING_ERROR,error:c,fatal:!1});if(a=this.operationQueue.current(a))a.onError(b)}removeExecutor(a,b,c){let {media:d,mediaSource:e,operationQueue:f,sourceBuffer:g}=this,h=g[a];if(d&&e&&h){var k=Y(d.duration)?d.duration:Infinity,m=Y(e.duration)?e.duration:Infinity;b=Math.max(0,b);c=Math.min(c,k,m);c>b&&!h.ending?(h.ended=!1,D.log(`[buffer-controller]: Removing [${b},${c}] from the ${a} SourceBuffer`),h.remove(b,c)):f.shiftAndExecuteNext(a)}else D.warn(`[buffer-controller]: Attempting to remove from the ${a} SourceBuffer, but it does not exist`),
f.shiftAndExecuteNext(a)}appendExecutor(a,b){let {operationQueue:c,sourceBuffer:d}=this,e=d[b];e?(e.ended=!1,e.appendBuffer(a)):(D.warn(`[buffer-controller]: Attempting to append to the ${b} SourceBuffer, but it does not exist`),c.shiftAndExecuteNext(b))}blockBuffers(a,b=this.getSourceBufferTypes()){if(b.length){var {operationQueue:c}=this,d=b.map(e=>c.appendBlocker(e));Promise.all(d).then(()=>{a();b.forEach(e=>{let f=this.sourceBuffer[e];null!=f&&f.updating||c.shiftAndExecuteNext(e)})})}else D.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),
Promise.resolve().then(a)}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(a,b,c){let d=this.sourceBuffer[a];d&&(c=c.bind(this,a),this.listeners[a].push({event:b,listener:c}),d.addEventListener(b,c))}removeBufferListeners(a){let b=this.sourceBuffer[a];b&&this.listeners[a].forEach(c=>{b.removeEventListener(c.event,c.listener)})}}let Wq={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,
135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,
198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Xq=function(a){let b=a;Wq.hasOwnProperty(a)&&(b=Wq[a]);return String.fromCharCode(b)},uv={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},vv={17:2,18:4,21:6,22:8,23:10,19:13,20:15},wv={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},xv={25:2,26:4,29:6,30:8,31:10,27:13,28:15},yv="white green blue cyan red yellow magenta black transparent".split(" ");class zv{constructor(){this.time=null;this.verboseLevel=0}log(a,b){this.verboseLevel>=
a&&(b="function"===typeof b?b():b,D.log(`${this.time} [${a}] ${b}`))}}let pc=function(a){const b=[];for(let c=0;c<a.length;c++)b.push(a[c].toString(16));return b};class Yq{constructor(a,b,c,d,e){this.flash=this.background=this.italics=this.underline=this.foreground=void 0;this.foreground=a||"white";this.underline=b||!1;this.italics=c||!1;this.background=d||"black";this.flash=e||!1}reset(){this.foreground="white";this.italics=this.underline=!1;this.background="black";this.flash=!1}setStyles(a){let b=
["foreground","underline","italics","background","flash"];for(let c=0;c<b.length;c++){let d=b[c];a.hasOwnProperty(d)&&(this[d]=a[d])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(a){return this.foreground===a.foreground&&this.underline===a.underline&&this.italics===a.italics&&this.background===a.background&&this.flash===a.flash}copy(a){this.foreground=a.foreground;this.underline=a.underline;this.italics=a.italics;this.background=
a.background;this.flash=a.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Av{constructor(a,b,c,d,e,f){this.penState=this.uchar=void 0;this.uchar=a||" ";this.penState=new Yq(b,c,d,e,f)}reset(){this.uchar=" ";this.penState.reset()}setChar(a,b){this.uchar=a;this.penState.copy(b)}setPenState(a){this.penState.copy(a)}equals(a){return this.uchar===a.uchar&&this.penState.equals(a.penState)}copy(a){this.uchar=
a.uchar;this.penState.copy(a.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class Bv{constructor(a){this.logger=this.cueStartTime=this.currPenState=this.pos=void 0;this.chars=[];for(let b=0;100>b;b++)this.chars.push(new Av);this.logger=a;this.pos=0;this.currPenState=new Yq}equals(a){let b=!0;for(let c=0;100>c;c++)if(!this.chars[c].equals(a.chars[c])){b=!1;break}return b}copy(a){for(let b=0;100>b;b++)this.chars[b].copy(a.chars[b])}isEmpty(){let a=!0;for(let b=0;100>b;b++)if(!this.chars[b].isEmpty()){a=
!1;break}return a}setCursor(a){this.pos!==a&&(this.pos=a);0>this.pos?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):100<this.pos&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=100)}moveCursor(a){let b=this.pos+a;if(1<a)for(a=this.pos+1;a<b+1;a++)this.chars[a].setPenState(this.currPenState);this.setCursor(b)}backSpace(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(a){144<=a&&this.backSpace();let b=Xq(a);100<=this.pos?
this.logger.log(0,()=>"Cannot insert "+a.toString(16)+" ("+b+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(b,this.currPenState),this.moveCursor(1))}clearFromPos(a){for(;100>a;a++)this.chars[a].reset()}clear(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let a=[],b=!0;for(let c=0;100>c;c++){let d=this.chars[c].uchar;" "!==d&&(b=!1);a.push(d)}return b?"":a.join("")}setPenStyles(a){this.currPenState.setStyles(a);
this.chars[this.pos].setPenState(this.currPenState)}}class xm{constructor(a){this.logger=this.lastOutputScreen=this.nrRollUpRows=this.currRow=this.rows=void 0;this.rows=[];for(let b=0;15>b;b++)this.rows.push(new Bv(a));this.logger=a;this.currRow=14;this.lastOutputScreen=this.nrRollUpRows=null;this.reset()}reset(){for(let a=0;15>a;a++)this.rows[a].clear();this.currRow=14}equals(a){let b=!0;for(let c=0;15>c;c++)if(!this.rows[c].equals(a.rows[c])){b=!1;break}return b}copy(a){for(let b=0;15>b;b++)this.rows[b].copy(a.rows[b])}isEmpty(){let a=
!0;for(let b=0;15>b;b++)if(!this.rows[b].isEmpty()){a=!1;break}return a}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(a){this.rows[this.currRow].insertChar(a)}setPen(a){this.rows[this.currRow].setPenStyles(a)}moveCursor(a){this.rows[this.currRow].moveCursor(a)}setCursor(a){this.logger.log(2,"setCursor: "+a);this.rows[this.currRow].setCursor(a)}setPAC(a){this.logger.log(2,()=>"pacData = "+JSON.stringify(a));var b=a.row-1;this.nrRollUpRows&&
b<this.nrRollUpRows-1&&(b=this.nrRollUpRows-1);if(this.nrRollUpRows&&this.currRow!==b){for(var c=0;15>c;c++)this.rows[c].clear();c=this.currRow+1-this.nrRollUpRows;let e=this.lastOutputScreen;if(e){var d=e.rows[c].cueStartTime;let f=this.logger.time;if(d&&null!==f&&d<f)for(d=0;d<this.nrRollUpRows;d++)this.rows[b-this.nrRollUpRows+d+1].copy(e.rows[c+d])}}this.currRow=b;b=this.rows[this.currRow];null!==a.indent&&(c=Math.max(a.indent-1,0),b.setCursor(a.indent),a.color=b.chars[c].penState.foreground);
this.setPen({foreground:a.color,underline:a.underline,italics:a.italics,background:"black",flash:!1})}setBkgData(a){this.logger.log(2,()=>"bkgData = "+JSON.stringify(a));this.backSpace();this.setPen(a);this.insertChar(32)}setRollUpRows(a){this.nrRollUpRows=a}rollUp(){if(null===this.nrRollUpRows)this.logger.log(3,"roll_up but nrRollUpRows not set yet");else{this.logger.log(1,()=>this.getDisplayText());var a=this.rows.splice(this.currRow+1-this.nrRollUpRows,1)[0];a.clear();this.rows.splice(this.currRow,
0,a);this.logger.log(2,"Rolling up")}}getDisplayText(a){a=a||!1;let b=[],c="",d;for(let e=0;15>e;e++){let f=this.rows[e].getTextString();f&&(d=e+1,a?b.push("Row "+d+": '"+f+"'"):b.push(f.trim()))}0<b.length&&(c=a?"["+b.join(" | ")+"]":b.join("\n"));return c}getTextAndFormat(){return this.rows}}class Zq{constructor(a,b,c){this.logger=this.cueStartTime=this.writeScreen=this.currRollUpRow=this.lastOutputScreen=this.nonDisplayedMemory=this.displayedMemory=this.verbose=this.mode=this.outputFilter=this.chNr=
void 0;this.chNr=a;this.outputFilter=b;this.mode=null;this.verbose=0;this.displayedMemory=new xm(c);this.nonDisplayedMemory=new xm(c);this.lastOutputScreen=new xm(c);this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.cueStartTime=this.mode=null;this.logger=c}reset(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.outputFilter.reset();this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=
this.displayedMemory;this.cueStartTime=this.mode=null}getHandler(){return this.outputFilter}setHandler(a){this.outputFilter=a}setPAC(a){this.writeScreen.setPAC(a)}setBkgData(a){this.writeScreen.setBkgData(a)}setMode(a){a!==this.mode&&(this.mode=a,this.logger.log(2,()=>"MODE="+a),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=
null),this.mode=a)}insertChars(a){for(let c=0;c<a.length;c++)this.writeScreen.insertChar(a[c]);let b=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>b+": "+this.writeScreen.getDisplayText(!0));if("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate()}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace");
"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()}ccRU(a){this.logger.log(2,"RU("+a+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(a)}ccFON(){this.logger.log(2,"FON - Flash On");this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,
"RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR");this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD");this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()}ccEOC(){this.logger.log(2,
"EOC - End Of Caption");if("MODE_POP-ON"===this.mode){let a=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.writeScreen=this.nonDisplayedMemory=a;this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(a){this.logger.log(2,"TO("+a+") - Tab Offset");this.writeScreen.moveCursor(a)}ccMIDROW(a){let b={flash:!1};b.underline=1===a%2;b.italics=46<=a;b.foreground=b.italics?"white":"white green blue cyan red yellow magenta".split(" ")[Math.floor(a/
2)-16];this.logger.log(2,"MIDROW: "+JSON.stringify(b));this.writeScreen.setPen(b)}outputDataUpdate(a=!1){let b=this.logger.time;null!==b&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,b,this.lastOutputScreen),a&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:b):this.cueStartTime=b,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(a){this.outputFilter&&
!this.displayedMemory.isEmpty()&&(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,a,this.displayedMemory),this.cueStartTime=a)}}class $q{constructor(a,b,c){this.channels=void 0;this.currentChannel=0;this.logger=this.cmdHistory=void 0;let d=new zv;this.channels=[null,new Zq(a,b,d),new Zq(a+1,c,d)];this.cmdHistory={a:null,b:null};this.logger=d}getHandler(a){return this.channels[a].getHandler()}setHandler(a,b){this.channels[a].setHandler(b)}addData(a,b){let c,d,e=!1;this.logger.time=
a;for(let f=0;f<b.length;f+=2)if(c=b[f]&127,d=b[f+1]&127,0!==c||0!==d){this.logger.log(3,"["+pc([b[f],b[f+1]])+"] -> ("+pc([c,d])+")");(a=this.parseCmd(c,d))||(a=this.parseMidrow(c,d));a||(a=this.parsePAC(c,d));a||(a=this.parseBackgroundAttributes(c,d));if(!a&&(e=this.parseChars(c,d))){let g=this.currentChannel;g&&0<g?this.channels[g].insertChars(e):this.logger.log(2,"No channel found yet. TEXT-MODE?")}a||e||this.logger.log(2,"Couldn't parse cleaned data "+pc([c,d])+" orig: "+pc([b[f],b[f+1]]))}}parseCmd(a,
b){let {cmdHistory:c}=this;if(!((20===a||28===a||21===a||29===a)&&32<=b&&47>=b||(23===a||31===a)&&33<=b&&35>=b))return!1;if(c.a===a&&c.b===b)return c.a=null,c.b=null,this.logger.log(3,"Repeated command ("+pc([a,b])+") is dropped"),!0;let d=20===a||21===a||23===a?1:2,e=this.channels[d];20===a||21===a||28===a||29===a?32===b?e.ccRCL():33===b?e.ccBS():34===b?e.ccAOF():35===b?e.ccAON():36===b?e.ccDER():37===b?e.ccRU(2):38===b?e.ccRU(3):39===b?e.ccRU(4):40===b?e.ccFON():41===b?e.ccRDC():42===b?e.ccTR():
43===b?e.ccRTD():44===b?e.ccEDM():45===b?e.ccCR():46===b?e.ccENM():47===b&&e.ccEOC():e.ccTO(b-32);c.a=a;c.b=b;this.currentChannel=d;return!0}parseMidrow(a,b){if((17===a||25===a)&&32<=b&&47>=b){var c=17===a?1:2;if(c!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;c=this.channels[c];if(!c)return!1;c.ccMIDROW(b);this.logger.log(3,"MIDROW ("+pc([a,b])+")");return!0}return!1}parsePAC(a,b){let c=this.cmdHistory;if(!((17<=a&&23>=a||25<=a&&31>=a)&&64<=b&&127>=b||(16===
a||24===a)&&64<=b&&95>=b))return!1;if(c.a===a&&c.b===b)return c.a=null,c.b=null,!0;let d=23>=a?1:2,e=this.channels[d];if(!e)return!1;e.setPAC(this.interpretPAC(64<=b&&95>=b?1===d?uv[a]:wv[a]:1===d?vv[a]:xv[a],b));c.a=a;c.b=b;this.currentChannel=d;return!0}interpretPAC(a,b){a={color:null,italics:!1,indent:null,underline:!1,row:a};b=95<b?b-96:b-64;a.underline=1===(b&1);13>=b?a.color="white green blue cyan red yellow magenta white".split(" ")[Math.floor(b/2)]:15>=b?(a.italics=!0,a.color="white"):a.indent=
4*Math.floor((b-16)/2);return a}parseChars(a,b){var c=null;let d;if(25<=a){var e=2;d=a-8}else e=1,d=a;17<=d&&19>=d?(c=17===d?b+80:18===d?b+112:b+144,this.logger.log(2,"Special char '"+Xq(c)+"' in channel "+e),c=[c]):32<=a&&127>=a&&(c=0===b?[a]:[a,b]);c&&(e=pc(c),this.logger.log(3,"Char codes =  "+e.join(",")),e=this.cmdHistory,e.a=a,e.b=b);return c}parseBackgroundAttributes(a,b){if(!((16===a||24===a)&&32<=b&&47>=b||(23===a||31===a)&&45<=b&&47>=b))return!1;let c={};if(16===a||24===a){var d=Math.floor((b-
32)/2);c.background=yv[d];1===b%2&&(c.background+="_semi")}else 45===b?c.background="transparent":(c.foreground="black",47===b&&(c.underline=!0));this.channels[23>=a?1:2].setBkgData(c);d=this.cmdHistory;d.a=a;d.b=b;return!0}reset(){for(let a=0;a<Object.keys(this.channels).length;a++){let b=this.channels[a];b&&b.reset()}this.cmdHistory={a:null,b:null}}cueSplitAtTime(a){for(let b=0;b<this.channels.length;b++){let c=this.channels[b];c&&c.cueSplitAtTime(a)}}}class bg{constructor(a,b){this.timelineController=
void 0;this.cueRanges=[];this.trackName=void 0;this.screen=this.endTime=this.startTime=null;this.timelineController=a;this.trackName=b}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(a,b,c){if(null===this.startTime||this.startTime>a)this.startTime=a;this.endTime=b;this.screen=c;this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[];this.startTime=
null}}var ah=function(){function a(f,g){if("string"!==typeof g||!Array.isArray(f))return!1;g=g.toLowerCase();return~f.indexOf(g)?g:!1}function b(f,...g){for(g=1;g<arguments.length;g++){let h=arguments[g];for(let k in h)f[k]=h[k]}return f}function c(f,g,h){let k={enumerable:!0};this.hasBeenReset=!1;let m="",n=!1,p=f,r=g,w=h,z=null,x="",B=!0,E="auto",C="start",I=50,F="middle",O=50,R="middle";Object.defineProperty(this,"id",b({},k,{get:function(){return m},set:function(J){m=""+J}}));Object.defineProperty(this,
"pauseOnExit",b({},k,{get:function(){return n},set:function(J){n=!!J}}));Object.defineProperty(this,"startTime",b({},k,{get:function(){return p},set:function(J){if("number"!==typeof J)throw new TypeError("Start time must be set to a number.");p=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"endTime",b({},k,{get:function(){return r},set:function(J){if("number"!==typeof J)throw new TypeError("End time must be set to a number.");r=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"text",
b({},k,{get:function(){return w},set:function(J){w=""+J;this.hasBeenReset=!0}}));Object.defineProperty(this,"region",b({},k,{get:function(){return z},set:function(J){z=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"vertical",b({},k,{get:function(){return x},set:function(J){J=a(d,J);if(!1===J)throw new SyntaxError("An invalid or illegal string was specified.");x=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"snapToLines",b({},k,{get:function(){return B},set:function(J){B=!!J;this.hasBeenReset=
!0}}));Object.defineProperty(this,"line",b({},k,{get:function(){return E},set:function(J){if("number"!==typeof J&&"auto"!==J)throw new SyntaxError("An invalid number or illegal string was specified.");E=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"lineAlign",b({},k,{get:function(){return C},set:function(J){J=a(e,J);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");C=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"position",b({},k,{get:function(){return I},
set:function(J){if(0>J||100<J)throw Error("Position must be between 0 and 100.");I=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"positionAlign",b({},k,{get:function(){return F},set:function(J){J=a(e,J);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");F=J;this.hasBeenReset=!0}}));Object.defineProperty(this,"size",b({},k,{get:function(){return O},set:function(J){if(0>J||100<J)throw Error("Size must be between 0 and 100.");O=J;this.hasBeenReset=!0}}));Object.defineProperty(this,
"align",b({},k,{get:function(){return R},set:function(J){J=a(e,J);if(!J)throw new SyntaxError("An invalid or illegal string was specified.");R=J;this.hasBeenReset=!0}}));this.displayState=void 0}if("undefined"!==typeof self&&self.VTTCue)return self.VTTCue;let d=["","lr","rl"],e=["start","middle","end","left","right"];c.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)};return c}();class Cv{decode(a,b){if(!a)return"";if("string"!==typeof a)throw Error("Error - expected string data.");
return decodeURIComponent(encodeURIComponent(a))}}class Qs{constructor(){this.values=Object.create(null)}set(a,b){this.get(a)||""===b||(this.values[a]=b)}get(a,b,c){return c?this.has(a)?this.values[a]:b[c]:this.has(a)?this.values[a]:b}has(a){return a in this.values}alt(a,b,c){for(let d=0;d<c.length;++d)if(b===c[d]){this.set(a,b);break}}integer(a,b){/^-?\d+$/.test(b)&&this.set(a,parseInt(b,10))}percent(a,b){return/^([\d]{1,3})(\.[\d]*)?%$/.test(b)&&(b=parseFloat(b),0<=b&&100>=b)?(this.set(a,b),!0):
!1}}let Vg=new ah(0,0,""),le="middle"===Vg.align?"middle":"center";class Ss{constructor(){this.state="INITIAL";this.buffer="";this.decoder=new Cv;this.regionList=[];this.cue=null;this.onflush=this.onparsingerror=this.oncue=void 0}parse(a){function b(){let f=d.buffer,g=0;for(f=f.replace(/<br(?: \/)?>/gi,"\n");g<f.length&&"\r"!==f[g]&&"\n"!==f[g];)++g;let h=f.slice(0,g);"\r"===f[g]&&++g;"\n"===f[g]&&++g;d.buffer=f.slice(g);return h}function c(f){Po(f,function(g,h){},/:/)}let d=this;a&&(d.buffer+=d.decoder.decode(a,
{stream:!0}));try{a="";if("INITIAL"===d.state){if(!/\r\n|\n/.test(d.buffer))return this;a=b();var e=a.match(/^(\u00ef\u00bb\u00bf)?WEBVTT([ \t].*)?$/);if(null==e||!e[0])throw Error("Malformed WebVTT signature.");d.state="HEADER"}for(e=!1;d.buffer;){if(!/\r\n|\n/.test(d.buffer))return this;e?e=!1:a=b();switch(d.state){case "HEADER":/:/.test(a)?c(a):a||(d.state="ID");continue;case "NOTE":a||(d.state="ID");continue;case "ID":if(/^NOTE($|[ \t])/.test(a)){d.state="NOTE";break}if(!a)continue;d.cue=new ah(0,
0,"");d.state="CUE";if(-1===a.indexOf("--\x3e")){d.cue.id=a;continue}case "CUE":if(!d.cue){d.state="BADCUE";continue}try{Ps(a,d.cue,d.regionList)}catch(g){d.cue=null;d.state="BADCUE";continue}d.state="CUETEXT";continue;case "CUETEXT":let f=-1!==a.indexOf("--\x3e");if(!a||f&&(e=!0)){if(d.oncue&&d.cue)d.oncue(d.cue);d.cue=null;d.state="ID";continue}if(null===d.cue)continue;d.cue.text&&(d.cue.text+="\n");d.cue.text+=a;continue;case "BADCUE":a||(d.state="ID")}}}catch(f){if("CUETEXT"===d.state&&d.cue&&
d.oncue)d.oncue(d.cue);d.cue=null;d.state="INITIAL"===d.state?"BADWEBVTT":"BADCUE"}return this}flush(){try{if(this.cue||"HEADER"===this.state)this.buffer+="\n\n",this.parse();if("INITIAL"===this.state||"BADWEBVTT"===this.state)throw Error("Malformed WebVTT signature.");}catch(a){if(this.onparsingerror)this.onparsingerror(a)}if(this.onflush)this.onflush();return this}}let Ts=/\r\n|\n\r|\n|\r/g,Yg=function(a,b,c=0){return a.slice(c,c+b.length)===b},Us=function(a){let b=parseInt(a.slice(-3));const c=
parseInt(a.slice(-6,-4)),d=parseInt(a.slice(-9,-7)),e=9<a.length?parseInt(a.substring(0,a.indexOf(":"))):0;if(!(Y(b)&&Y(c)&&Y(d)&&Y(e)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${a}`);return b=b+1E3*c+6E4*d+36E5*e},Xg=function(a){let b=5381,c=a.length;for(;c;)b=33*b^a.charCodeAt(--c);return(b>>>0).toString()},Uo=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Vo=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Xs={left:"start",center:"center",right:"end",start:"start",end:"end"};class Dv{constructor(a){this.hls=
void 0;this.media=null;this.config=void 0;this.enabled=!0;this.Cues=void 0;this.textTracks=[];this.tracks=[];this.initPTS=[];this.unparsedVttFrags=[];this.captionsTracks={};this.nonNativeCaptionsTracks={};this.cea608Parser2=this.cea608Parser1=void 0;this.prevCC=this.lastPartIndex=this.lastSn=-1;this.vttCCs=Wo();this.hls=a;this.config=a.config;this.Cues=a.config.cueHandler;this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},
textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}};if(this.config.enableCEA708Captions){let b=new bg(this,"textTrack1"),c=new bg(this,"textTrack2"),d=new bg(this,"textTrack3"),e=new bg(this,"textTrack4");this.cea608Parser1=
new $q(1,b,c);this.cea608Parser2=new $q(3,d,e)}a.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.on(u.MANIFEST_LOADING,this.onManifestLoading,this);a.on(u.MANIFEST_LOADED,this.onManifestLoaded,this);a.on(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);a.on(u.FRAG_LOADING,this.onFragLoading,this);a.on(u.FRAG_LOADED,this.onFragLoaded,this);a.on(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this);a.on(u.FRAG_DECRYPTED,this.onFragDecrypted,
this);a.on(u.INIT_PTS_FOUND,this.onInitPtsFound,this);a.on(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this);a.on(u.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let {hls:a}=this;a.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this);a.off(u.MANIFEST_LOADING,this.onManifestLoading,this);a.off(u.MANIFEST_LOADED,this.onManifestLoaded,this);a.off(u.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this);a.off(u.FRAG_LOADING,this.onFragLoading,
this);a.off(u.FRAG_LOADED,this.onFragLoaded,this);a.off(u.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this);a.off(u.FRAG_DECRYPTED,this.onFragDecrypted,this);a.off(u.INIT_PTS_FOUND,this.onInitPtsFound,this);a.off(u.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this);a.off(u.BUFFER_FLUSHING,this.onBufferFlushing,this);this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(a,b,c,d,e){let f=!1;for(let g=e.length;g--;){let h=e[g],k=Math.min(h[1],c)-Math.max(h[0],b);if(0<=
k&&(h[0]=Math.min(h[0],b),h[1]=Math.max(h[1],c),f=!0,.5<k/(c-b)))return}f||e.push([b,c]);this.config.renderTextTracksNatively?this.Cues.newCue(this.captionsTracks[a],b,c,d):(b=this.Cues.newCue(null,b,c,d),this.hls.trigger(u.CUES_PARSED,{type:"captions",cues:b,track:a}))}onInitPtsFound(a,{frag:b,id:c,initPTS:d,timescale:e}){({unparsedVttFrags:a}=this);"main"===c&&(this.initPTS[b.cc]={baseTime:d,timescale:e});a.length&&(this.unparsedVttFrags=[],a.forEach(f=>{this.onFragLoaded(u.FRAG_LOADED,f)}))}getExistingTrack(a){let {media:b}=
this;if(b)for(let c=0;c<b.textTracks.length;c++){let d=b.textTracks[c];if(d[a])return d}return null}createCaptionsTrack(a){this.config.renderTextTracksNatively?this.createNativeTrack(a):this.createNonNativeTrack(a)}createNativeTrack(a){if(!this.captionsTracks[a]){var {captionsProperties:b,captionsTracks:c,media:d}=this,{label:e,languageCode:f}=b[a],g=this.getExistingTrack(a);if(g)c[a]=g,wc(c[a]),qo(c[a],d);else if(g=this.createTextTrack("captions",e,f))g[a]=!0,c[a]=g}}createNonNativeTrack(a){if(!this.nonNativeCaptionsTracks[a]){var b=
this.captionsProperties[a];b&&(b={_id:a,label:b.label,kind:"captions",default:b.media?!!b.media.default:!1,closedCaptions:b.media},this.nonNativeCaptionsTracks[a]=b,this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[b]}))}}createTextTrack(a,b,c){let d=this.media;if(d)return d.addTextTrack(a,b,c)}onMediaAttaching(a,b){this.media=b.media;this._cleanTracks()}onMediaDetaching(){let {captionsTracks:a}=this;Object.keys(a).forEach(b=>{wc(a[b]);delete a[b]});this.nonNativeCaptionsTracks={}}onManifestLoading(){this.prevCC=
this.lastPartIndex=this.lastSn=-1;this.vttCCs=Wo();this._cleanTracks();this.tracks=[];this.captionsTracks={};this.nonNativeCaptionsTracks={};this.textTracks=[];this.unparsedVttFrags=[];this.initPTS=[];this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){var {media:a}=this;if(a&&(a=a.textTracks))for(let b=0;b<a.length;b++)wc(a[b])}onSubtitleTracksUpdated(a,b){a=b.subtitleTracks||[];b=a.some(c=>"stpp.ttml.im1t"===c.textCodec);if(this.config.enableWebVTT||
b&&this.config.enableIMSC1)if(No(this.tracks,a))this.tracks=a;else if(this.textTracks=[],this.tracks=a,this.config.renderTextTracksNatively){let c=this.media?this.media.textTracks:null;this.tracks.forEach((d,e)=>{var f;if(c&&e<c.length){let g=null;for(let h=0;h<c.length;h++)if((e=c[h])&&e.label===d.name&&!e.textTrack1&&!e.textTrack2){g=c[h];break}g&&(f=g)}if(f)wc(f);else if(f=this._captionsOrSubtitlesFromCharacteristics(d),f=this.createTextTrack(f,d.name,d.lang))f.mode="disabled";f&&(f.groupId=d.groupId,
this.textTracks.push(f))})}else this.tracks.length&&(a=this.tracks.map(c=>({label:c.name,kind:c.type.toLowerCase(),default:c.default,subtitleTrack:c})),this.hls.trigger(u.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a}))}_captionsOrSubtitlesFromCharacteristics(a){if(a.attrs.CHARACTERISTICS){let b=/transcribes-spoken-dialog/gi.test(a.attrs.CHARACTERISTICS);a=/describes-music-and-sound/gi.test(a.attrs.CHARACTERISTICS);if(b&&a)return"captions"}return"subtitles"}onManifestLoaded(a,b){this.config.enableCEA708Captions&&
b.captions&&b.captions.forEach(c=>{var d=/(?:CC|SERVICE)([1-4])/.exec(c.instreamId);d&&(d=this.captionsProperties[`textTrack${d[1]}`])&&(d.label=c.name,c.lang&&(d.languageCode=c.lang),d.media=c)})}closedCaptionsForLevel(a){a=this.hls.levels[a.level];return null==a?void 0:a.attrs["CLOSED-CAPTIONS"]}onFragLoading(a,b){let {cea608Parser1:c,cea608Parser2:d,lastSn:e,lastPartIndex:f}=this;if(this.enabled&&c&&d&&b.frag.type===ba.MAIN){var g,h;a=b.frag.sn;b=null!=(g=null==b?void 0:null==(h=b.part)?void 0:
h.index)?g:-1;a===e+1||a===e&&b===f+1||(c.reset(),d.reset());this.lastSn=a;this.lastPartIndex=b}}onFragLoaded(a,b){let {frag:c,payload:d}=b;if(c.type===ba.SUBTITLE)if(d.byteLength){if(a=c.decryptdata,null==a||!a.encrypted||"stats"in b){a=this.tracks[c.level];let e=this.vttCCs;e[c.cc]||(e[c.cc]={start:c.start,prevCC:this.prevCC,new:!0},this.prevCC=c.cc);a&&"stpp.ttml.im1t"===a.textCodec?this._parseIMSC1(c,d):this._parseVTTs(b)}}else this.hls.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:c,error:Error("Empty subtitle payload")})}_parseIMSC1(a,
b){let c=this.hls;Qo(b,this.initPTS[a.cc],d=>{this._appendCues(d,a.level);c.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:a})},d=>{D.log(`Failed to parse IMSC1: ${d}`);c.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:a,error:d})})}_parseVTTs(a){var b;let {frag:c,payload:d}=a,{initPTS:e,unparsedVttFrags:f}=this,g=e.length-1;if(e[c.cc]||-1!==g){var h=this.hls,k=null!=(b=c.initSegment)&&b.data?ec(c.initSegment.data,new Uint8Array(d)):d;Rs(k,this.initPTS[c.cc],this.vttCCs,c.cc,c.start,m=>{this._appendCues(m,
c.level);h.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:c})},m=>{let n="Missing initPTS for VTT MPEGTS"===m.message;n?f.push(a):this._fallbackToIMSC1(c,d);D.log(`Failed to parse VTT cue: ${m}`);n&&g>c.cc||h.trigger(u.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:c,error:m})})}else f.push(a)}_fallbackToIMSC1(a,b){let c=this.tracks[a.level];c.textCodec||Qo(b,this.initPTS[a.cc],()=>{c.textCodec="stpp.ttml.im1t";this._parseIMSC1(a,b)},()=>{c.textCodec="wvtt"})}_appendCues(a,b){let c=this.hls;if(this.config.renderTextTracksNatively){let d=
this.textTracks[b];d&&"disabled"!==d.mode&&a.forEach(e=>ro(d,e))}else{let d=this.tracks[b];d&&c.trigger(u.CUES_PARSED,{type:"subtitles",cues:a,track:d.default?"default":"subtitles"+b})}}onFragDecrypted(a,b){({frag:a}=b);if(a.type===ba.SUBTITLE)this.onFragLoaded(u.FRAG_LOADED,b)}onSubtitleTracksCleared(){this.tracks=[];this.captionsTracks={}}onFragParsingUserdata(a,b){let {cea608Parser1:c,cea608Parser2:d}=this;if(this.enabled&&c&&d){var {frag:e,samples:f}=b;if(e.type!==ba.MAIN||"NONE"!==this.closedCaptionsForLevel(e))for(a=
0;a<f.length;a++)if(b=f[a].bytes)b=this.extractCea608Data(b),c.addData(f[a].pts,b[0]),d.addData(f[a].pts,b[1])}}onBufferFlushing(a,{startOffset:b,endOffset:c,endOffsetSubtitles:d,type:e}){({media:a}=this);if(a&&!(a.currentTime<c)){if(!e||"video"===e){let {captionsTracks:f}=this;Object.keys(f).forEach(g=>Kg(f[g],b,c))}if(this.config.renderTextTracksNatively&&0===b&&void 0!==d){let {textTracks:f}=this;Object.keys(f).forEach(g=>Kg(f[g],b,d))}}}extractCea608Data(a){let b=[[],[]],c=a[0]&31,d=2;for(let f=
0;f<c;f++){var e=a[d++];let g=127&a[d++],h=127&a[d++];0===g&&0===h||0===(4&e)||(e&=3,0!==e&&1!==e)||(b[e].push(g),b[e].push(h))}return b}}class ar{constructor(a){this.streamController=this.clientRect=this.timer=this.restrictedLevels=this.media=this.firstLevel=this.autoLevelCapping=this.hls=void 0;this.hls=a;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.firstLevel=-1;this.media=null;this.restrictedLevels=[];this.timer=void 0;this.clientRect=null;this.registerListeners()}setStreamController(a){this.streamController=
a}destroy(){this.unregisterListener();this.hls.config.capLevelToPlayerSize&&this.stopCapping();this.hls=this.streamController=this.clientRect=this.media=null}registerListeners(){let {hls:a}=this;a.on(u.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this);a.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.BUFFER_CODECS,this.onBufferCodecs,this);a.on(u.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let {hls:a}=this;a.off(u.FPS_DROP_LEVEL_CAPPING,
this.onFpsDropLevelCapping,this);a.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this);a.off(u.MANIFEST_PARSED,this.onManifestParsed,this);a.off(u.BUFFER_CODECS,this.onBufferCodecs,this);a.off(u.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(a,b){a=this.hls.levels[b.droppedLevel];this.isLevelAllowed(a)&&this.restrictedLevels.push({bitrate:a.bitrate,height:a.height,width:a.width})}onMediaAttaching(a,b){this.media=b.media instanceof HTMLVideoElement?b.media:null;this.clientRect=null}onManifestParsed(a,
b){a=this.hls;this.restrictedLevels=[];this.firstLevel=b.firstLevel;a.config.capLevelToPlayerSize&&b.video&&this.startCapping()}onBufferCodecs(a,b){this.hls.config.capLevelToPlayerSize&&b.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&0<this.mediaHeight&&0<this.mediaWidth){let a=this.hls.levels;if(a.length){let b=this.hls;b.autoLevelCapping=this.getMaxLevel(a.length-1);b.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch();
this.autoLevelCapping=b.autoLevelCapping}}}getMaxLevel(a){var b=this.hls.levels;if(!b.length)return-1;b=b.filter((c,d)=>this.isLevelAllowed(c)&&d<=a);this.clientRect=null;return ar.getMaxLevelByMediaSize(b,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1E3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=
[];this.firstLevel=-1;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let a=this.media,b={width:0,height:0};if(a){let c=a.getBoundingClientRect();b.width=c.width;b.height=c.height;b.width||b.height||(b.width=c.right-c.left||a.width||0,b.height=c.bottom-c.top||a.height||0)}return this.clientRect=b}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*
this.contentScaleFactor}get contentScaleFactor(){let a=1;if(!this.hls.config.ignoreDevicePixelRatio)try{a=self.devicePixelRatio}catch(b){}return a}isLevelAllowed(a){return!this.restrictedLevels.some(b=>a.bitrate===b.bitrate&&a.width===b.width&&a.height===b.height)}static getMaxLevelByMediaSize(a,b,c){if(null==a||!a.length)return-1;let d=a.length-1;for(let f=0;f<a.length;f+=1){let g=a[f];var e;if(e=g.width>=b||g.height>=c)e=(e=a[f+1])?g.width!==e.width||g.height!==e.height:!0;if(e){d=f;break}}return d}}
class Ev{constructor(a){this.hls=void 0;this.isVideoPlaybackQualityAvailable=!1;this.timer=void 0;this.media=null;this.lastTime=void 0;this.lastDecodedFrames=this.lastDroppedFrames=0;this.streamController=void 0;this.hls=a;this.registerListeners()}setStreamController(a){this.streamController=a}registerListeners(){this.hls.on(u.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer);
this.unregisterListeners();this.isVideoPlaybackQualityAvailable=!1;this.media=null}onMediaAttaching(a,b){a=this.hls.config;a.capLevelOnFPSDrop&&((this.media=b=b.media instanceof self.HTMLVideoElement?b.media:null)&&"function"===typeof b.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),a.fpsDroppedMonitoringPeriod))}checkFPS(a,b,c){a=performance.now();if(b){if(this.lastTime){var d=c-this.lastDroppedFrames;
let e=b-this.lastDecodedFrames,f=1E3*d/(a-this.lastTime),g=this.hls;g.trigger(u.FPS_DROP,{currentDropped:d,currentDecoded:e,totalDroppedFrames:c});0<f&&d>g.config.fpsDroppedMonitoringThreshold*e&&(d=g.currentLevel,D.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),0<d&&(-1===g.autoLevelCapping||g.autoLevelCapping>=d)&&(--d,g.trigger(u.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:g.currentLevel}),g.autoLevelCapping=d,this.streamController.nextLevelSwitch()))}this.lastTime=
a;this.lastDroppedFrames=c;this.lastDecodedFrames=b}}checkFPSInterval(){let a=this.media;if(a)if(this.isVideoPlaybackQualityAvailable){let b=a.getVideoPlaybackQuality();this.checkFPS(a,b.totalVideoFrames,b.droppedVideoFrames)}else this.checkFPS(a,a.webkitDecodedFrameCount,a.webkitDroppedFrameCount)}}class Ld{constructor(a){this.config=this.hls=void 0;this.keyFormatPromise=this.media=null;this.keySystemAccessPromises={};this._requestLicenseFailureCount=0;this.mediaKeySessions=[];this.keyIdToKeySessionPromise=
{};this.setMediaKeysQueue=Ld.CDMCleanupPromise?[Ld.CDMCleanupPromise]:[];this.onMediaEncrypted=this._onMediaEncrypted.bind(this);this.onWaitingForKey=this._onWaitingForKey.bind(this);this.debug=D.debug.bind(D,"[eme]");this.log=D.log.bind(D,"[eme]");this.warn=D.warn.bind(D,"[eme]");this.error=D.error.bind(D,"[eme]");this.hls=a;this.config=a.config;this.registerListeners()}destroy(){this.unregisterListeners();this.onMediaDetached();let a=this.config;a.requestMediaKeySystemAccessFunc=null;a.licenseXhrSetup=
a.licenseResponseCallback=void 0;a.drmSystems=a.drmSystemOptions={};this.config=this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null}registerListeners(){this.hls.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.on(u.MEDIA_DETACHED,this.onMediaDetached,this);this.hls.on(u.MANIFEST_LOADING,this.onManifestLoading,this);this.hls.on(u.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);this.hls.off(u.MEDIA_DETACHED,
this.onMediaDetached,this);this.hls.off(u.MANIFEST_LOADING,this.onManifestLoading,this);this.hls.off(u.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(a){let {drmSystems:b,widevineLicenseUrl:c}=this.config,d=b[a];if(d)return d.licenseUrl;if(a===wa.WIDEVINE&&c)return c;throw Error(`no license server URL configured for key-system "${a}"`);}getServerCertificateUrl(a){var {drmSystems:b}=this.config;if(b=b[a])return b.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${a}"]`)}attemptKeySystemAccess(a){let b=
this.hls.levels,c=(f,g,h)=>!!f&&h.indexOf(f)===g,d=b.map(f=>f.audioCodec).filter(c),e=b.map(f=>f.videoCodec).filter(c);0===d.length+e.length&&e.push("avc1.42e01e");return new Promise((f,g)=>{let h=k=>{const m=k.shift();this.getMediaKeysPromise(m,d,e).then(n=>f({keySystem:m,mediaKeys:n})).catch(n=>{k.length?h(k):n instanceof ib?g(n):g(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_ACCESS,error:n,fatal:!0},n.message))})};h(a)})}requestMediaKeySystemAccess(a,b){let {requestMediaKeySystemAccessFunc:c}=
this.config;return"function"!==typeof c?(a=`Configured requestMediaKeySystemAccess is not a function ${c}`,null===Cq&&"http:"===self.location.protocol&&(a=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(Error(a))):c(a,b)}getMediaKeysPromise(a,b,c){b=is(a,b,c,this.config.drmSystemOptions);let d=this.keySystemAccessPromises[a];c=null==d?void 0:d.keySystemAccess;if(!c){this.log(`Requesting encrypted media "${a}" key-system access with config: ${JSON.stringify(b)}`);
c=this.requestMediaKeySystemAccess(a,b);let e=this.keySystemAccessPromises[a]={keySystemAccess:c};c.catch(f=>{this.log(`Failed to obtain access to key-system "${a}": ${f}`)});return c.then(f=>{this.log(`Access for key-system "${f.keySystem}" obtained`);let g=this.fetchServerCertificate(a);this.log(`Create media-keys for "${a}"`);e.mediaKeys=f.createMediaKeys().then(h=>{this.log(`Media-keys created for "${a}"`);return g.then(k=>k?this.setMediaKeysServerCertificate(h,a,k):h)});e.mediaKeys.catch(h=>
{this.error(`Failed to create media-keys for "${a}"}: ${h}`)});return e.mediaKeys})}return c.then(()=>d.mediaKeys)}createMediaKeySessionContext({decryptdata:a,keySystem:b,mediaKeys:c}){this.log(`Creating key-system session "${b}" keyId: ${qb.hexDump(a.keyId||[])}`);let d=c.createSession();a={decryptdata:a,keySystem:b,mediaKeys:c,mediaKeysSession:d,keyStatus:"status-pending"};this.mediaKeySessions.push(a);return a}renewKeySession(a){let b=a.decryptdata;if(b.pssh){let c=this.createMediaKeySessionContext(a),
d=this.getKeyIdString(b);this.keyIdToKeySessionPromise[d]=this.generateRequestWithPreferredKeySession(c,"cenc",b.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(a)}getKeyIdString(a){if(!a)throw Error("Could not read keyId of undefined decryptdata");if(null===a.keyId)throw Error("keyId is null");return qb.hexDump(a.keyId)}updateKeySession(a,b){var c;let d=a.mediaKeysSession;this.log(`Updating key-session "${d.sessionId}" for keyID ${qb.hexDump((null==
(c=a.decryptdata)?void 0:c.keyId)||[])}
      } (data length: ${b?b.byteLength:b})`);return d.update(b)}selectKeySystemFormat(a){let b=Object.keys(a.levelkeys||{});this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${a.sn} ${a.type}: ${a.level}) key formats ${b.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(b));return this.keyFormatPromise}getKeyFormatPromise(a){return new Promise((b,c)=>{let d=Eg(this.config),e=a.map(Zn).filter(f=>!!f&&-1!==d.indexOf(f));return this.getKeySystemSelectionPromise(e).then(({keySystem:f})=>
{let g=$n(f);g?b(g):c(Error(`Unable to find format for key-system "${f}"`))}).catch(c)})}loadKey(a){let b=a.keyInfo.decryptdata,c=this.getKeyIdString(b),d=`(keyId: ${c} format: "${b.keyFormat}" method: ${b.method} uri: ${b.uri})`;this.log(`Starting session for key ${d}`);let e=this.keyIdToKeySessionPromise[c];e||(e=this.keyIdToKeySessionPromise[c]=this.getKeySystemForKeyPromise(b).then(({keySystem:f,mediaKeys:g})=>{this.throwIfDestroyed();this.log(`Handle encrypted media sn: ${a.frag.sn} ${a.frag.type}: ${a.frag.level} using key ${d}`);
return this.attemptSetMediaKeys(f,g).then(()=>{this.throwIfDestroyed();let h=this.createMediaKeySessionContext({keySystem:f,mediaKeys:g,decryptdata:b});return this.generateRequestWithPreferredKeySession(h,"cenc",b.pssh,"playlist-key")})}),e.catch(f=>this.handleError(f)));return e}throwIfDestroyed(a){if(!this.hls)throw Error("invalid state");}handleError(a){this.hls&&(this.error(a.message),a instanceof ib?this.hls.trigger(u.ERROR,a.data):this.hls.trigger(u.ERROR,{type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_KEYS,
error:a,fatal:!0}))}getKeySystemForKeyPromise(a){var b=this.getKeyIdString(a);b=this.keyIdToKeySessionPromise[b];return b?b:(a=(a=Zn(a.keyFormat))?[a]:Eg(this.config),this.attemptKeySystemAccess(a))}getKeySystemSelectionPromise(a){a.length||(a=Eg(this.config));if(0===a.length)throw new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(a)}_onMediaEncrypted(a){let {initDataType:b,
initData:c}=a;this.debug(`"${a.type}" event: init data type: "${b}"`);if(null!==c){if("sinf"===b&&this.config.drmSystems[wa.FAIRPLAY]){a=La(new Uint8Array(c));try{var d=Dg(JSON.parse(a).sinf),e=co(new Uint8Array(d));if(!e)return;var f=e.subarray(8,24);var g=wa.FAIRPLAY}catch(n){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{g=ss(c);if(null===g)return;0===g.version&&"edef8ba979d64acea3c827dcd51d21ed"===g.systemId&&g.data&&(f=g.data.subarray(8,24));g="edef8ba979d64acea3c827dcd51d21ed"===
g.systemId?wa.WIDEVINE:void 0}if(g&&f){var h=qb.hexDump(f),{keyIdToKeySessionPromise:k,mediaKeySessions:m}=this;d=k[h];for(e=0;e<m.length;e++){let n=m[e];a=n.decryptdata;if(a.pssh||!a.keyId)continue;let p=qb.hexDump(a.keyId);if(h===p||-1!==a.uri.replace(/-/g,"").indexOf(h)){d=k[p];delete k[p];a.pssh=new Uint8Array(c);a.keyId=f;d=k[h]=d.then(()=>this.generateRequestWithPreferredKeySession(n,b,c,"encrypted-event-key-match"));break}}d||(d=k[h]=this.getKeySystemSelectionPromise([g]).then(({keySystem:n,
mediaKeys:p})=>{var r;this.throwIfDestroyed();let w=new be("ISO-23001-7",h,null!=(r=$n(n))?r:"");w.pssh=new Uint8Array(c);w.keyId=f;return this.attemptSetMediaKeys(n,p).then(()=>{this.throwIfDestroyed();let z=this.createMediaKeySessionContext({decryptdata:w,keySystem:n,mediaKeys:p});return this.generateRequestWithPreferredKeySession(z,b,c,"encrypted-event-no-match")})}));d.catch(n=>this.handleError(n))}}}_onWaitingForKey(a){this.log(`"${a.type}" event`)}attemptSetMediaKeys(a,b){let c=this.setMediaKeysQueue.slice();
this.log(`Setting media-keys for "${a}"`);let d=Promise.all(c).then(()=>{if(!this.media)throw Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(b)});this.setMediaKeysQueue.push(d);return d.then(()=>{this.log(`Media-keys set for "${a}"`);c.push(d);this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===c.indexOf(e))})}generateRequestWithPreferredKeySession(a,b,c,d){var e,f;let g=null==(e=this.config.drmSystems)?void 0:null==(f=e[a.keySystem])?void 0:
f.generateRequest;if(g)try{let p=g.call(this.hls,b,c,a);if(!p)throw Error("Invalid response from configured generateRequest filter");b=p.initDataType;c=a.decryptdata.pssh=p.initData?new Uint8Array(p.initData):null}catch(p){var h;this.warn(p.message);if(null!=(h=this.hls)&&h.config.debug)throw p;}if(null===c)return this.log(`Skipping key-session request for "${d}" (no initData)`),Promise.resolve(a);let k=this.getKeyIdString(a.decryptdata);this.log(`Generating key-session request for "${d}": ${k} (init data type: ${b} length: ${c?
c.byteLength:null})`);let m=new vm;a.mediaKeysSession.onmessage=p=>{let r=a.mediaKeysSession;if(r){var {messageType:w,message:z}=p;this.log(`"${w}" message event for session "${r.sessionId}" message size: ${z.byteLength}`);"license-request"===w||"license-renewal"===w?this.renewLicense(a,z).catch(x=>{this.handleError(x);m.emit("error",x)}):"license-release"===w?a.keySystem===wa.FAIRPLAY&&(this.updateKeySession(a,Yn("acknowledged")),this.removeSession(a)):this.warn(`unhandled media key message type "${w}"`)}else m.emit("error",
Error("invalid state"))};a.mediaKeysSession.onkeystatuseschange=p=>{a.mediaKeysSession?(this.onKeyStatusChange(a),p=a.keyStatus,m.emit("keyStatus",p),"expired"===p&&(this.warn(`${a.keySystem} expired for key ${k}`),this.renewKeySession(a))):m.emit("error",Error("invalid state"))};let n=new Promise((p,r)=>{m.on("error",r);m.on("keyStatus",w=>{w.startsWith("usable")?p():"output-restricted"===w?r(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):
"internal-error"===w?r(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${w}"`)):"expired"===w?r(Error("key expired while generating request")):this.warn(`unhandled key status change "${w}"`)})});return a.mediaKeysSession.generateRequest(b,c).then(()=>{var p;this.log(`Request generated for key-session "${null==(p=a.mediaKeysSession)?void 0:p.sessionId}" keyId: ${k}`)}).catch(p=>{throw new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_NO_SESSION,
error:p,fatal:!1},`Error generating key-session request: ${p}`);}).then(()=>n).catch(p=>{m.removeAllListeners();this.removeSession(a);throw p;}).then(()=>{m.removeAllListeners();return a})}onKeyStatusChange(a){a.mediaKeysSession.keyStatuses.forEach((b,c)=>{this.log(`key status change "${b}" for keyStatuses keyId: ${qb.hexDump("buffer"in c?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):new Uint8Array(c))} session keyId: ${qb.hexDump(new Uint8Array(a.decryptdata.keyId||[]))} uri: ${a.decryptdata.uri}`);
a.keyStatus=b})}fetchServerCertificate(a){let b=this.config,c=new b.loader(b),d=this.getServerCertificateUrl(a);if(!d)return Promise.resolve();this.log(`Fetching serverCertificate for "${a}"`);return new Promise((e,f)=>{let g={responseType:"arraybuffer",url:d},h=b.certLoadPolicy.default;c.load(g,{loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},{onSuccess:(k,m,n,p)=>{e(k.data)},onError:(k,m,n,p)=>{f(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,
fatal:!0,networkDetails:n,response:Xa({url:g.url,data:void 0},k)},`"${a}" certificate request failed (${d}). Status: ${k.code} (${k.text})`))},onTimeout:(k,m,n)=>{f(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:g.url,data:void 0}},`"${a}" certificate request timed out (${d})`))},onAbort:(k,m,n)=>{f(Error("aborted"))}})})}setMediaKeysServerCertificate(a,b,c){return new Promise((d,e)=>{a.setServerCertificate(c).then(f=>
{this.log(`setServerCertificate ${f?"success":"not supported by CDM"} (${null==c?void 0:c.byteLength}) on "${b}"`);d(a)}).catch(f=>{e(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:f,fatal:!0},f.message))})})}renewLicense(a,b){return this.requestLicense(a,new Uint8Array(b)).then(c=>this.updateKeySession(a,new Uint8Array(c)).catch(d=>{throw new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:d,fatal:!0},d.message);}))}setupLicenseXHR(a,
b,c,d){let e=this.config.licenseXhrSetup;return e?Promise.resolve().then(()=>{if(!c.decryptdata)throw Error("Key removed");return e.call(this.hls,a,b,c,d)}).catch(f=>{if(!c.decryptdata)throw f;a.open("POST",b,!0);return e.call(this.hls,a,b,c,d)}).then(f=>{a.readyState||a.open("POST",b,!0);return{xhr:a,licenseChallenge:f?f:d}}):(a.open("POST",b,!0),Promise.resolve({xhr:a,licenseChallenge:d}))}requestLicense(a,b){let c=this.config.keyLoadPolicy.default;return new Promise((d,e)=>{let f=this.getLicenseServerUrl(a.keySystem);
this.log(`Sending license request to URL: ${f}`);let g=new XMLHttpRequest;g.responseType="arraybuffer";g.onreadystatechange=()=>{if(!this.hls||!a.mediaKeysSession)return e(Error("invalid state"));if(4===g.readyState)if(200===g.status){this._requestLicenseFailureCount=0;var h=g.response;this.log(`License received ${h instanceof ArrayBuffer?h.byteLength:h}`);let k=this.config.licenseResponseCallback;if(k)try{h=k.call(this.hls,g,f,a)}catch(m){this.error(m)}d(h)}else h=(h=c.errorRetry)?h.maxNumRetry:
0,this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h||400<=g.status&&500>g.status?e(new ib({type:Z.KEY_SYSTEM_ERROR,details:K.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:f,data:void 0,code:g.status,text:g.statusText}},`License Request XHR failed (${f}). Status: ${g.status} (${g.statusText})`)):(this.warn(`Retrying license request, ${h-this._requestLicenseFailureCount+1} attempts left`),this.requestLicense(a,b).then(d,e))};a.licenseXhr&&a.licenseXhr.readyState!==
XMLHttpRequest.DONE&&a.licenseXhr.abort();a.licenseXhr=g;this.setupLicenseXHR(g,f,a,b).then(({xhr:h,licenseChallenge:k})=>{h.send(k)})})}onMediaAttached(a,b){this.config.emeEnabled&&(this.media=a=b.media,a.addEventListener("encrypted",this.onMediaEncrypted),a.addEventListener("waitingforkey",this.onWaitingForKey))}onMediaDetached(){let a=this.media,b=this.mediaKeySessions;a&&(a.removeEventListener("encrypted",this.onMediaEncrypted),a.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=
null);this._requestLicenseFailureCount=0;this.setMediaKeysQueue=[];this.mediaKeySessions=[];this.keyIdToKeySessionPromise={};be.clearKeyUriToKeyIdMap();let c=b.length;Ld.CDMCleanupPromise=Promise.all(b.map(d=>this.removeSession(d)).concat(null==a?void 0:a.setMediaKeys(null).catch(d=>{this.log(`Could not clear media keys: ${d}. media.src: ${null==a?void 0:a.src}`)}))).then(()=>{c&&(this.log("finished closing key sessions and clearing media keys"),b.length=0)}).catch(d=>{this.log(`Could not close sessions and clear media keys: ${d}. media.src: ${null==
a?void 0:a.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(a,{sessionKeys:b}){b&&this.config.emeEnabled&&!this.keyFormatPromise&&(a=b.reduce((c,d)=>{-1===c.indexOf(d.keyFormat)&&c.push(d.keyFormat);return c},[]),this.log(`Selecting key-system from session-keys ${a.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(a))}removeSession(a){let {mediaKeysSession:b,licenseXhr:c}=a;if(b)return this.log(`Remove licenses and keys and close session ${b.sessionId}`),b.onmessage=
null,b.onkeystatuseschange=null,c&&c.readyState!==XMLHttpRequest.DONE&&c.abort(),a.mediaKeysSession=a.decryptdata=a.licenseXhr=void 0,a=this.mediaKeySessions.indexOf(a),-1<a&&this.mediaKeySessions.splice(a,1),b.remove().catch(d=>{this.log(`Could not remove session: ${d}`)}).then(()=>b.close()).catch(d=>{this.log(`Could not close session: ${d}`)})}}Ld.CDMCleanupPromise=void 0;class ib extends Error{constructor(a,b){super(b);this.data=void 0;a.error||(a.error=Error(b));this.data=a;a.err=a.error}}class qc{constructor(a){this.cid=
this.sid=this.media=this.config=this.hls=void 0;this.starved=this.initialized=this.useHeaders=!1;this.buffering=!0;this.videoBuffer=this.audioBuffer=void 0;this.onWaiting=()=>{this.initialized&&(this.starved=!0);this.buffering=!0};this.onPlaying=()=>{this.initialized||(this.initialized=!0);this.buffering=!1};this.applyPlaylistData=c=>{try{this.apply(c,{ot:"m",su:!this.initialized})}catch(d){D.warn("Could not generate manifest CMCD data.",d)}};this.applyFragmentData=c=>{try{let d=c.frag,e=this.hls.levels[d.level],
f=this.getObjectType(d),g={d:1E3*d.duration,ot:f};if("v"===f||"a"===f||"av"==f)g.br=e.bitrate/1E3,g.tb=this.getTopBandwidth(f)/1E3,g.bl=this.getBufferLength(f);this.apply(c,g)}catch(d){D.warn("Could not generate segment CMCD data.",d)}};this.hls=a;a=this.config=a.config;let {cmcd:b}=a;null!=b&&(a.pLoader=this.createPlaylistLoader(),a.fLoader=this.createFragmentLoader(),this.sid=b.sessionId||qc.uuid(),this.cid=b.contentId,this.useHeaders=!0===b.useHeaders,this.registerListeners())}registerListeners(){let a=
this.hls;a.on(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.on(u.MEDIA_DETACHED,this.onMediaDetached,this);a.on(u.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let a=this.hls;a.off(u.MEDIA_ATTACHED,this.onMediaAttached,this);a.off(u.MEDIA_DETACHED,this.onMediaDetached,this);a.off(u.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners();this.onMediaDetached();this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(a,b){this.media=b.media;
this.media.addEventListener("waiting",this.onWaiting);this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(a,b){var c,d;this.audioBuffer=null==(c=b.tracks.audio)?void 0:c.buffer;this.videoBuffer=null==(d=b.tracks.video)?void 0:d.buffer}createData(){var a;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(a=this.media)?
void 0:a.playbackRate,mtp:this.hls.bandwidthEstimate/1E3}}apply(a,b={}){Ga(b,this.createData());let c="i"===b.ot||"v"===b.ot||"av"===b.ot;this.starved&&c&&(b.bs=!0,b.su=!0,this.starved=!1);null==b.su&&(b.su=this.buffering);if(this.useHeaders)b=qc.toHeaders(b),Object.keys(b).length&&(a.headers||(a.headers={}),Ga(a.headers,b));else if(b=qc.toQuery(b))a.url=qc.appendQueryToUri(a.url,b)}getObjectType(a){let {type:b}=a;if("subtitle"===b)return"tt";if("initSegment"===a.sn)return"i";if("audio"===b)return"a";
if("main"===b)return this.hls.audioTracks.length?"v":"av"}getTopBandwidth(a){let b=0;var c=this.hls;"a"===a?c=c.audioTracks:(a=c.maxAutoLevel,c=c.levels.slice(0,-1<a?a+1:c.levels.length));for(let d of c)d.bitrate>b&&(b=d.bitrate);return 0<b?b:NaN}getBufferLength(a){let b=this.hls.media;return(a="a"===a?this.audioBuffer:this.videoBuffer)&&b?1E3*va.bufferInfo(a,b.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){let {pLoader:a}=this.config,b=this.applyPlaylistData,c=a||this.config.loader;
return class{constructor(d){this.loader=void 0;this.loader=new c(d)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(d,e,f){b(d);this.loader.load(d,e,f)}}}createFragmentLoader(){let {fLoader:a}=this.config,b=this.applyFragmentData,c=a||this.config.loader;return class{constructor(d){this.loader=void 0;this.loader=new c(d)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(d,
e,f){b(d);this.loader.load(d,e,f)}}}static uuid(){let a=URL.createObjectURL(new Blob),b=a.toString();URL.revokeObjectURL(a);return b.slice(b.lastIndexOf("/")+1)}static serialize(a){let b=[],c=g=>!Number.isNaN(g)&&null!=g&&""!==g&&!1!==g;var d=g=>Math.round(g),e=g=>100*Math.round(g/100);d={br:d,d,bl:e,dl:e,mtp:e,nor:g=>encodeURIComponent(g),rtp:e,tb:d};e=Object.keys(a||{}).sort();for(let g of e)if(e=a[g],c(e)&&("v"!==g||1!==e)&&("pr"!=g||1!==e)){var f=d[g];f&&(e=f(e));f=typeof e;e="ot"===g||"sf"===
g||"st"===g?`${g}=${e}`:"boolean"===f?g:"number"===f?`${g}=${e}`:`${g}=${JSON.stringify(e)}`;b.push(e)}return b.join(",")}static toHeaders(a){var b=Object.keys(a);let c={},d=["Object","Request","Session","Status"],e=[{},{},{},{}],f={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(let g of b)e[null!=f[g]?f[g]:1][g]=a[g];for(a=0;a<e.length;a++)(b=qc.serialize(e[a]))&&(c[`CMCD-${d[a]}`]=b);return c}static toQuery(a){return`CMCD=${encodeURIComponent(qc.serialize(a))}`}static appendQueryToUri(a,
b){if(!b)return a;let c=a.includes("?")?"&":"?";return`${a}${c}${b}`}}class Fv{constructor(a){this.log=this.hls=void 0;this.uri=this.loader=null;this.pathwayId=".";this.pathwayPriority=null;this.timeToLoad=300;this.reloadTimer=-1;this.updated=0;this.started=!1;this.enabled=!0;this.subtitleTracks=this.audioTracks=this.levels=null;this.penalizedPathways={};this.hls=a;this.log=D.log.bind(D,"[content-steering]:");this.registerListeners()}registerListeners(){let a=this.hls;a.on(u.MANIFEST_LOADING,this.onManifestLoading,
this);a.on(u.MANIFEST_LOADED,this.onManifestLoaded,this);a.on(u.MANIFEST_PARSED,this.onManifestParsed,this);a.on(u.ERROR,this.onError,this)}unregisterListeners(){let a=this.hls;a&&(a.off(u.MANIFEST_LOADING,this.onManifestLoading,this),a.off(u.MANIFEST_LOADED,this.onManifestLoaded,this),a.off(u.MANIFEST_PARSED,this.onManifestParsed,this),a.off(u.ERROR,this.onError,this))}startLoad(){this.started=!0;self.clearTimeout(this.reloadTimer);if(this.enabled&&this.uri)if(this.updated){let a=Math.max(1E3*this.timeToLoad-
(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,a)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1;this.loader&&(this.loader.destroy(),this.loader=null);self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners();this.stopLoad();this.levels=this.audioTracks=this.subtitleTracks=this.hls=null}removeLevel(a){let b=this.levels;b&&(this.levels=b.filter(c=>c!==a))}onManifestLoading(){this.stopLoad();this.enabled=!0;this.timeToLoad=300;this.updated=0;this.uri=
null;this.pathwayId=".";this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(a,b){({contentSteering:a}=b);null!==a&&(this.pathwayId=a.pathwayId,this.uri=a.uri,this.started&&this.startLoad())}onManifestParsed(a,b){this.audioTracks=b.audioTracks;this.subtitleTracks=b.subtitleTracks}onError(a,b){({errorAction:a}=b);if(2===(null==a?void 0:a.action)&&1===a.flags){b=this.pathwayPriority;let c=this.pathwayId;this.penalizedPathways[c]||(this.penalizedPathways[c]=performance.now());!b&&this.levels&&
(b=this.levels.reduce((d,e)=>{-1===d.indexOf(e.pathwayId)&&d.push(e.pathwayId);return d},[]));b&&1<b.length&&(this.updatePathwayPriority(b),a.resolved=this.pathwayId!==c)}}filterParsedLevels(a){this.levels=a;let b=this.getLevelsForPathway(this.pathwayId);if(0===b.length){let c=a[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${c}"`);b=this.getLevelsForPathway(c);this.pathwayId=c}return b.length!==a.length?(this.log(`Found ${b.length}/${a.length} levels in Pathway "${this.pathwayId}"`),
b):a}getLevelsForPathway(a){return null===this.levels?[]:this.levels.filter(b=>a===b.pathwayId)}updatePathwayPriority(a){this.pathwayPriority=a;let b,c=this.penalizedPathways,d=performance.now();Object.keys(c).forEach(e=>{3E5<d-c[e]&&delete c[e]});for(let e=0;e<a.length;e++){let f=a[e];if(c[f])continue;if(f===this.pathwayId)break;let g=this.hls.nextLoadLevel,h=this.hls.levels[g];b=this.getLevelsForPathway(f);if(0<b.length){this.log(`Setting Pathway to "${f}"`);this.pathwayId=f;this.hls.trigger(u.LEVELS_UPDATED,
{levels:b});a=this.hls.levels[g];h&&a&&this.levels&&(a.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&a.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${a.bitrate}`),this.hls.nextLoadLevel=g);break}}}clonePathways(a){let b=this.levels;if(b){var c={},d={};a.forEach(e=>{let {ID:f,"BASE-ID":g,"URI-REPLACEMENT":h}=e;b.some(k=>k.pathwayId===f)||(e=this.getLevelsForPathway(g).map(k=>{var m=Ga({},k);m.details=void 0;m.url=Yo(k.uri,k.attrs["STABLE-VARIANT-ID"],
"PER-VARIANT-URIS",h);const n=new Aa(k.attrs);n["PATHWAY-ID"]=f;k=n.AUDIO&&`${n.AUDIO}_clone_${f}`;const p=n.SUBTITLES&&`${n.SUBTITLES}_clone_${f}`;k&&(c[n.AUDIO]=k,n.AUDIO=k);p&&(d[n.SUBTITLES]=p,n.SUBTITLES=p);m.attrs=n;m=new Kd(m);ee(m,"audio",k);ee(m,"text",p);return m}),b.push(...e),Xo(this.audioTracks,c,h,f),Xo(this.subtitleTracks,d,h,f))})}}loadSteeringManifest(a){var b=this.hls.config,c=b.loader;this.loader&&this.loader.destroy();this.loader=new c(b);let d;try{d=new self.URL(a)}catch(e){this.enabled=
!1;this.log(`Failed to parse Steering Manifest URI: ${a}`);return}"data:"!==d.protocol&&(a=(this.hls.bandwidthEstimate||b.abrEwmaDefaultEstimate)|0,d.searchParams.set("_HLS_pathway",this.pathwayId),d.searchParams.set("_HLS_throughput",""+a));a={responseType:"json",url:d.href};b=b.steeringManifestLoadPolicy.default;c=b.errorRetry||b.timeoutRetry||{};b={loadPolicy:b,timeout:b.maxLoadTimeMs,maxRetry:c.maxNumRetry||0,retryDelay:c.retryDelayMs||0,maxRetryDelay:c.maxRetryDelayMs||0};this.log(`Requesting steering manifest: ${d}`);
this.loader.load(a,b,{onSuccess:(e,f,g,h)=>{this.log(`Loaded steering manifest: "${d}"`);e=e.data;if(1!==e.VERSION)this.log(`Steering VERSION ${e.VERSION} not supported!`);else{this.updated=performance.now();this.timeToLoad=e.TTL;var {"RELOAD-URI":k,"PATHWAY-CLONES":m,"PATHWAY-PRIORITY":n}=e;if(k)try{this.uri=(new self.URL(k,d)).href}catch(p){this.enabled=!1;this.log(`Failed to parse Steering Manifest RELOAD-URI: ${k}`);return}this.scheduleRefresh(this.uri||g.url);m&&this.clonePathways(m);n&&this.updatePathwayPriority(n)}},
onError:(e,f,g,h)=>{this.log(`Error loading steering manifest: ${e.code} ${e.text} (${f.url})`);this.stopLoad();410===e.code?(this.enabled=!1,this.log(`Steering manifest ${f.url} no longer available`)):(g=1E3*this.timeToLoad,429===e.code?(e=this.loader,"function"===typeof(null==e?void 0:e.getResponseHeader)&&(e=e.getResponseHeader("Retry-After"))&&parseFloat(e),this.log(`Steering manifest ${f.url} rate limited`)):this.scheduleRefresh(this.uri||f.url,g))},onTimeout:(e,f,g)=>{this.log(`Timeout loading steering manifest (${f.url})`);
this.scheduleRefresh(this.uri||f.url)}})}scheduleRefresh(a,b=1E3*this.timeToLoad){self.clearTimeout(this.reloadTimer);this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(a)},b)}}let Gv=/^age:\s*[\d.]+\s*$/im;class br{constructor(a){this.retryDelay=this.retryTimeout=this.requestTimeout=this.xhrSetup=void 0;this.callbacks=this.config=null;this.context=void 0;this.loader=null;this.stats=void 0;this.xhrSetup=a?a.xhrSetup||null:null;this.stats=new Wf;this.retryDelay=0}destroy(){this.callbacks=
null;this.abortInternal();this.config=this.loader=null}abortInternal(){let a=this.loader;self.clearTimeout(this.requestTimeout);self.clearTimeout(this.retryTimeout);a&&(a.onreadystatechange=null,a.onprogress=null,4!==a.readyState&&(this.stats.aborted=!0,a.abort()))}abort(){var a;this.abortInternal();if(null!=(a=this.callbacks)&&a.onAbort)this.callbacks.onAbort(this.stats,this.context,this.loader)}load(a,b,c){if(this.stats.loading.start)throw Error("Loader can only be used once.");this.stats.loading.start=
self.performance.now();this.context=a;this.config=b;this.callbacks=c;this.loadInternal()}loadInternal(){let {config:a,context:b}=this;if(a){var c=this.loader=new self.XMLHttpRequest,d=this.stats;d.loading.first=0;d.loaded=0;d.aborted=!1;var e=this.xhrSetup;e?Promise.resolve().then(()=>{if(!this.stats.aborted)return e(c,b.url)}).catch(f=>{c.open("GET",b.url,!0);return e(c,b.url)}).then(()=>{this.stats.aborted||this.openAndSendXhr(c,b,a)}).catch(f=>{this.callbacks.onError({code:c.status,text:f.message},
b,c,d)}):this.openAndSendXhr(c,b,a)}}openAndSendXhr(a,b,c){a.readyState||a.open("GET",b.url,!0);let d=this.context.headers,{maxTimeToFirstByteMs:e,maxLoadTimeMs:f}=c.loadPolicy;if(d)for(let g in d)a.setRequestHeader(g,d[g]);b.rangeEnd&&a.setRequestHeader("Range","bytes="+b.rangeStart+"-"+(b.rangeEnd-1));a.onreadystatechange=this.readystatechange.bind(this);a.onprogress=this.loadprogress.bind(this);a.responseType=b.responseType;self.clearTimeout(this.requestTimeout);c.timeout=e&&Y(e)?e:f;this.requestTimeout=
self.setTimeout(this.loadtimeout.bind(this),c.timeout);a.send()}readystatechange(){let {context:a,loader:b,stats:c}=this;if(a&&b){var d=b.readyState,e=this.config;if(!c.aborted&&2<=d&&(0===c.loading.first&&(c.loading.first=Math.max(self.performance.now(),c.loading.start),e.timeout!==e.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),e.timeout=e.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),e.loadPolicy.maxLoadTimeMs-(c.loading.first-c.loading.start)))),
4===d)){self.clearTimeout(this.requestTimeout);b.onreadystatechange=null;b.onprogress=null;d=b.status;var f="text"!==b.responseType;if(200<=d&&300>d&&(f&&b.response||null!==b.responseText)){if(c.loading.end=Math.max(self.performance.now(),c.loading.first),f=f?b.response:b.responseText,c.loaded=c.total="arraybuffer"===b.responseType?f.byteLength:f.length,c.bwEstimate=8E3*c.total/(c.loading.end-c.loading.first),this.callbacks&&((e=this.callbacks.onProgress)&&e(c,a,f,b),this.callbacks))this.callbacks.onSuccess({url:b.responseURL,
data:f,code:d},c,a,b)}else e=e.loadPolicy.errorRetry,de(e,c.retry,!1,d)?this.retry(e):(D.error(`${d} while loading ${a.url}`),this.callbacks.onError({code:d,text:b.statusText},a,b,c))}}}loadtimeout(){var a;let b=null==(a=this.config)?void 0:a.loadPolicy.timeoutRetry;if(de(b,this.stats.retry,!0))this.retry(b);else if(D.warn(`timeout while loading ${this.context.url}`),a=this.callbacks)this.abortInternal(),a.onTimeout(this.stats,this.context,this.loader)}retry(a){let {context:b,stats:c}=this;this.retryDelay=
Pg(a,c.retry);c.retry++;D.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${b.url}, retrying ${c.retry}/${a.maxNumRetry} in ${this.retryDelay}ms`);this.abortInternal();this.loader=null;self.clearTimeout(this.retryTimeout);this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(a){let b=this.stats;b.loaded=a.loaded;a.lengthComputable&&(b.total=a.total)}getCacheAge(){var a=null;this.loader&&Gv.test(this.loader.getAllResponseHeaders())&&(a=(a=this.loader.getResponseHeader("age"))?
parseFloat(a):null);return a}getResponseHeader(a){return this.loader&&(new RegExp(`^${a}:\\s*[\\d.]+\\s*$`,"im")).test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(a):null}}let at=/(\d+)-(\d+)\/(\d+)/;class cr{constructor(a){this.context=this.controller=this.response=this.request=this.requestTimeout=this.fetchSetup=void 0;this.callbacks=this.config=null;this.stats=void 0;this.loader=null;this.fetchSetup=a.fetchSetup||bt;this.controller=new self.AbortController;this.stats=new Wf}destroy(){this.loader=
this.callbacks=null;this.abortInternal()}abortInternal(){let a=this.response;null!=a&&a.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var a;this.abortInternal();if(null!=(a=this.callbacks)&&a.onAbort)this.callbacks.onAbort(this.stats,this.context,this.response)}load(a,b,c){let d=this.stats;if(d.loading.start)throw Error("Loader can only be used once.");d.loading.start=self.performance.now();let e=Zs(a,this.controller.signal),f=c.onProgress,g="arraybuffer"===a.responseType,h=g?"byteLength":
"length",{maxTimeToFirstByteMs:k,maxLoadTimeMs:m}=b.loadPolicy;this.context=a;this.config=b;this.callbacks=c;this.request=this.fetchSetup(a,e);self.clearTimeout(this.requestTimeout);b.timeout=k&&Y(k)?k:m;this.requestTimeout=self.setTimeout(()=>{this.abortInternal();c.onTimeout(d,a,this.response)},b.timeout);self.fetch(this.request).then(n=>{this.response=this.loader=n;let p=Math.max(self.performance.now(),d.loading.start);self.clearTimeout(this.requestTimeout);b.timeout=m;this.requestTimeout=self.setTimeout(()=>
{this.abortInternal();c.onTimeout(d,a,this.response)},m-(p-d.loading.start));if(!n.ok){let {status:r,statusText:w}=n;throw new Hv(w||"fetch, bad network response",r,n);}d.loading.first=p;d.total=$s(n.headers)||d.total;return f&&Y(b.highWaterMark)?this.loadProgressively(n,d,a,b.highWaterMark,f):g?n.arrayBuffer():"json"===a.responseType?n.json():n.text()}).then(n=>{let {response:p}=this;self.clearTimeout(this.requestTimeout);d.loading.end=Math.max(self.performance.now(),d.loading.first);var r=n[h];
r&&(d.loaded=d.total=r);r={url:p.url,data:n,code:p.status};f&&!Y(b.highWaterMark)&&f(d,a,n,p);c.onSuccess(r,d,a,p)}).catch(n=>{self.clearTimeout(this.requestTimeout);if(!d.aborted)c.onError({code:n?n.code||0:0,text:n?n.message:null},a,n?n.details:null,d)})}getCacheAge(){var a=null;this.response&&(a=(a=this.response.headers.get("age"))?parseFloat(a):null);return a}getResponseHeader(a){return this.response?this.response.headers.get(a):null}loadProgressively(a,b,c,d=0,e){let f=new Tq,g=a.body.getReader(),
h=()=>g.read().then(k=>{if(k.done)return f.dataLength&&e(b,c,f.flush(),a),Promise.resolve(new ArrayBuffer(0));k=k.value;const m=k.length;b.loaded+=m;m<d||f.dataLength?(f.push(k),f.dataLength>=d&&e(b,c,f.flush(),a)):e(b,c,k,a);return h()}).catch(()=>Promise.reject());return h()}}class Hv extends Error{constructor(a,b,c){super(a);this.details=this.code=void 0;this.code=b;this.details=c}}let Iv=/\s/,Jv=Xa(Xa({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,
ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,maxBufferSize:6E7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,
startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5E3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:br,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:mv,bufferController:tv,capLevelController:ar,errorController:Qu,fpsController:Ev,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5E5,abrBandWidthFactor:.95,
abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Cq,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8E3,maxLoadTimeMs:2E4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8E3,
maxLoadTimeMs:2E4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1E3,maxRetryDelayMs:2E4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1E3,maxRetryDelayMs:2E4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:Infinity,maxLoadTimeMs:2E4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1E3,maxRetryDelayMs:8E3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1E4,maxLoadTimeMs:2E4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,
maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1E3,maxRetryDelayMs:8E3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1E4,maxLoadTimeMs:12E4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1E3,maxRetryDelayMs:8E3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1E4,maxLoadTimeMs:2E4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1E3,maxRetryDelayMs:8E3}}},manifestLoadingTimeOut:1E4,
manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1E3,manifestLoadingMaxRetryTimeout:64E3,levelLoadingTimeOut:1E4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1E3,levelLoadingMaxRetryTimeout:64E3,fragLoadingTimeOut:2E4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1E3,fragLoadingMaxRetryTimeout:64E3},{cueHandler:{newCue(a,b,c,d){const e=[];let f,g;const h=self.VTTCue||self.TextTrackCue;for(let p=0;p<d.rows.length;p++){var k=d.rows[p];var m=!0;f=0;g="";if(!k.isEmpty()){var n;for(let r=0;r<k.chars.length;r++)Iv.test(k.chars[r].uchar)&&
m?f++:(g+=k.chars[r].uchar,m=!1);k.cueStartTime=b;b===c&&(c+=1E-4);16<=f?f--:f++;m=g.trim().replace(/<br(?: \/)?>/gi,"\n");k=Wg(b,c,m);null!=a&&null!=(n=a.cues)&&n.getCueById(k)||(m=new h(b,c,m),m.id=k,m.line=p+1,m.align="left",m.position=10+Math.min(80,10*Math.floor(8*f/32)),e.push(m))}}a&&e.length&&(e.sort((p,r)=>"auto"===p.line||"auto"===r.line?0:8<p.line&&8<r.line?r.line-p.line:p.line-r.line),e.forEach(p=>ro(a,p)));return e}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",
captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:pv,subtitleTrackController:rv,timelineController:Dv,audioStreamController:nv,audioTrackController:ov,emeController:Ld,cmcdController:qc,contentSteeringController:Fv});class Zb{static get version(){return"1.4.12"}static isSupported(){var a=
ae();if(a){var b=self.SourceBuffer||self.WebKitSourceBuffer;a=a&&"function"===typeof a.isTypeSupported&&a.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');b=!b||b.prototype&&"function"===typeof b.prototype.appendBuffer&&"function"===typeof b.prototype.remove;b=!!a&&!!b}else b=!1;return b}static get Events(){return u}static get ErrorTypes(){return Z}static get ErrorDetails(){return K}static get DefaultConfig(){return Zb.defaultConfig?Zb.defaultConfig:Jv}static set DefaultConfig(a){Zb.defaultConfig=
a}constructor(a={}){this.networkControllers=this.coreComponents=this.userConfig=this.config=void 0;this._emitter=new vm;this._autoLevelCapping=void 0;this._maxHdcpLevel=null;this.cmcdController=this.emeController=this.subtitleTrackController=this.audioTrackController=this.streamController=this.levelController=this.latencyController=this.capLevelController=this.bufferController=this.abrController=void 0;this.url=this._media=null;var b=a.debug||!1;if(self.console&&!0===b||"object"===typeof b){gs(b,
"debug","log","info","warn","error");try{$c.log('Debug logs enabled for "Hls instance" in hls.js version 1.4.12')}catch(C){$c=im}}else $c=im;b=this.config=ct(Zb.DefaultConfig,a);this.userConfig=a;this._autoLevelCapping=-1;if(b.progressive)if(a=b.loader,a!==cr&&a!==br)D.log("[config]: Custom loader detected, cannot enable progressive streaming"),b.progressive=!1;else{a:{if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{new self.ReadableStream({});var c=!0;break a}catch(C){}c=
!1}c&&(b.loader=cr,b.progressive=!0,b.enableSoftwareAES=!0,D.log("[config]: Progressive streaming enabled, using FetchLoader"))}let {abrController:d,bufferController:e,capLevelController:f,errorController:g,fpsController:h}=b;c=new g(this);var k=this.abrController=new d(this),m=this.bufferController=new e(this);let n=this.capLevelController=new f(this),p=new h(this);var r=new Nu(this);let w=new Ou(this),z=(a=b.contentSteeringController)?new a(this):null,x=this.levelController=new Ru(this,z);a=new Su(this);
let B=new Uu(this.config),E=this.streamController=new kv(this,a,B);n.setStreamController(E);p.setStreamController(E);r=[r,x,E];z&&r.splice(1,0,z);this.networkControllers=r;k=[k,m,n,p,w,a];this.audioTrackController=this.createController(b.audioTrackController,r);(m=b.audioStreamController)&&r.push(new m(this,a,B));this.subtitleTrackController=this.createController(b.subtitleTrackController,r);(m=b.subtitleStreamController)&&r.push(new m(this,a,B));this.createController(b.timelineController,k);B.emeController=
this.emeController=this.createController(b.emeController,k);this.cmcdController=this.createController(b.cmcdController,k);this.latencyController=this.createController(Pu,k);this.coreComponents=k;r.push(c);b=c.onErrorOut;if("function"===typeof b)this.on(u.ERROR,b,c)}createController(a,b){return a?(a=new a(this),b&&b.push(a),a):null}on(a,b,c=this){this._emitter.on(a,b,c)}once(a,b,c=this){this._emitter.once(a,b,c)}removeAllListeners(a){this._emitter.removeAllListeners(a)}off(a,b,c=this,d){this._emitter.off(a,
b,c,d)}listeners(a){return this._emitter.listeners(a)}emit(a,b,c){return this._emitter.emit(a,b,c)}trigger(a,b){if(this.config.debug)return this.emit(a,a,b);try{return this.emit(a,a,b)}catch(c){D.error("An internal error happened while handling event "+a+'. Error message: "'+c.message+'". Here is a stacktrace:',c),this.trigger(u.ERROR,{type:Z.OTHER_ERROR,details:K.INTERNAL_EXCEPTION,fatal:!1,event:a,error:c})}return!1}listenerCount(a){return this._emitter.listenerCount(a)}destroy(){D.log("destroy");
this.trigger(u.DESTROYING,void 0);this.detachMedia();this.removeAllListeners();this._autoLevelCapping=-1;this.url=null;this.networkControllers.forEach(b=>b.destroy());this.networkControllers.length=0;this.coreComponents.forEach(b=>b.destroy());this.coreComponents.length=0;let a=this.config;a.xhrSetup=a.fetchSetup=void 0;this.userConfig=null}attachMedia(a){D.log("attachMedia");this._media=a;this.trigger(u.MEDIA_ATTACHING,{media:a})}detachMedia(){D.log("detachMedia");this.trigger(u.MEDIA_DETACHING,
void 0);this._media=null}loadSource(a){this.stopLoad();let b=this.media,c=this.url,d=this.url=hm.buildAbsoluteURL(self.location.href,a,{alwaysNormalize:!0});D.log(`loadSource:${d}`);b&&c&&(c!==d||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(b));this.trigger(u.MANIFEST_LOADING,{url:a})}startLoad(a=-1){D.log(`startLoad(${a})`);this.networkControllers.forEach(b=>{b.startLoad(a)})}stopLoad(){D.log("stopLoad");this.networkControllers.forEach(a=>{a.stopLoad()})}swapAudioCodec(){D.log("swapAudioCodec");
this.streamController.swapAudioCodec()}recoverMediaError(){D.log("recoverMediaError");let a=this._media;this.detachMedia();a&&this.attachMedia(a)}removeLevel(a,b=0){this.levelController.removeLevel(a,b)}get levels(){let a=this.levelController.levels;return a?a:[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(a){D.log(`set currentLevel:${a}`);this.loadLevel=a;this.abrController.clearTimer();this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(a){D.log(`set nextLevel:${a}`);
this.levelController.manualLevel=a;this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(a){D.log(`set loadLevel:${a}`);this.levelController.manualLevel=a}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(a){this.levelController.nextLoadLevel=a}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(a){D.log(`set firstLevel:${a}`);this.levelController.firstLevel=a}get startLevel(){return this.levelController.startLevel}set startLevel(a){D.log(`set startLevel:${a}`);
-1!==a&&(a=Math.max(a,this.minAutoLevel));this.levelController.startLevel=a}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(a){a=!!a;a!==this.config.capLevelToPlayerSize&&(a?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=a)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let {bwEstimator:a}=this.abrController;
return a?a.getEstimate():NaN}get ttfbEstimate(){let {bwEstimator:a}=this.abrController;return a?a.getEstimateTTFB():NaN}set autoLevelCapping(a){this._autoLevelCapping!==a&&(D.log(`set autoLevelCapping:${a}`),this._autoLevelCapping=a)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(a){-1<mm.indexOf(a)&&(this._maxHdcpLevel=a)}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let {levels:a,config:{minAutoBitrate:b}}=
this;if(!a)return 0;let c=a.length;for(let d=0;d<c;d++)if(a[d].maxBitrate>=b)return d;return 0}get maxAutoLevel(){let {levels:a,autoLevelCapping:b,maxHdcpLevel:c}=this,d;d=-1===b&&a&&a.length?a.length-1:b;if(c)for(let e=d;e--;){let f=a[e].attrs["HDCP-LEVEL"];if(f&&f<=c)return e}return d}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(a){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,a)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){let a=
this.audioTrackController;return a?a.audioTracks:[]}get audioTrack(){let a=this.audioTrackController;return a?a.audioTrack:-1}set audioTrack(a){let b=this.audioTrackController;b&&(b.audioTrack=a)}get subtitleTracks(){let a=this.subtitleTrackController;return a?a.subtitleTracks:[]}get subtitleTrack(){let a=this.subtitleTrackController;return a?a.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(a){let b=this.subtitleTrackController;b&&(b.subtitleTrack=a)}get subtitleDisplay(){let a=
this.subtitleTrackController;return a?a.subtitleDisplay:!1}set subtitleDisplay(a){let b=this.subtitleTrackController;b&&(b.subtitleDisplay=a)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(a){this.config.lowLatencyMode=a}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}
Zb.defaultConfig=void 0;let ym=class extends W{init(){this._key="DelayGamCall";this._default=!1}run(){return super.run()}};ym=q([v("DelayGamCallExperiment"),y()],ym);class dr extends lq{constructor(a,b=1,c,d,e,f,g,h,k,m,n,p,r,w,z){super(a,c,d,e,f,g,h,k);this._mediaIdCount=b;this._mediaOrPlaylistId=c;this.name=m;this._isCollapsible=n;this._prebidMethods=p;this._auctionManagers=r;this._slotManager=w;this._collapseSettings=z;this.prerollNum=0;this._additionalAdFields=this.collapseCollection=null;this._adFetched=
this._adDurationLogged=!1;this._adPlayErrorWithoutPlayAttempt=new L;this._adPlayMap=new Map;this._adTimingBuffer=10;this._adDetails=null;this._calledNextVideo=this._bidMarkedOnCurrentAd=this._adPlaying=!1;this._canSkip="auto-injected"===this._playerType?!0:!1;this._createdSkipContainer=this._canTearDown=!1;this._currentAdTime=this._currentAdDurationWithBuffer=0;this._defaultAdDuration=30;this._hls=new Zb;this._isAdvanedPlaylistEnabled=!1;this._isProgrammaticPlay=this._isProgrammaticPause=!0;this._isVideoEnded=
this._isProgrammaticVolumeChange=!1;this._pendingBidRequests=[];this._playerState=0;this._playerWasClicked=!1;this._playlistIndex=0;this._prerollAdUrl="";this._reInitAttempts=0;this._spaListeners=[];this._state=0;this._stalePlayerTimer=null;this._tearDownAfterNextAd=!1;this._tearDownPlayerTimeout=0;this._topBackgroundElement=this._tearDownTimer=null;this._transactionId="";this._userIdTargetingData=[];this._wasSeeking=this._videoStarted=!1;this._onBeforeRequestBids();this._reducedVideoPlayerSizeExperiment=
S.resolve(Sf);this._userIdComponent=S.resolve(Pc);this._videoCloseButtonComponent=S.resolve(Id);this._mobileStickyPlayerPositionSiteExperiment=S.resolve(Jd);a=(a=this._config.video.contentSpecificPlaylists)&&gf(a);this._hasContentSpecificPlaylist=!!a;a&&(this._mediaOrPlaylistId=a);this._delayGamCallExperiment=S.resolve(ym);this._topCenterMobileBackgroundCoreExperiment=S.resolve(Tc);this._prebidAuctionManager=this._auctionManagers.getPrebidAuctionManager();this._collapseSettings&&(this.createPlayerWrapper(),
a=this._collapseSettings.title)&&(b=document.createElement("h3"),b.innerText=a,b.className="adthrive-player-title",b.id="adthrive-collapse-title",this._container.appendChild(b));a=this._config.video.advancePlaylist;this._isAdvanedPlaylistEnabled="auto-injected"===this._playerType?a.playlistPlayer.enabled:a.relatedPlayer.enabled;this.ready.on(()=>{this._setPlayerVolume();this._initiateListeners();void this.getPlayerContent();"auto-injected"!==this._playerType&&this._setupAllowSkip();let x=async()=>
{const B=this._config.gdpr;!B.consentCaptured&&B.enabled&&await this.waitForConsent();await this._fetchLinearAd();this.triggerPlayInView()};if(this._slotManager.requestedBids.emitted)x().catch(B=>{A.error("Html5InstreamPlayer","ready","handleAdFetching error",B)});else this._slotManager.requestedBids.once(x);this._checkVideoClose()&&(this._state=7)});this._isAdvanedPlaylistEnabled&&"auto-injected"===this._playerType&&this._initSkipContainer()}_setupAllowSkip(){this._config.video.advancePlaylist.relatedPlayer.applyToFirst&&
(this._canSkip=!0)}_removeSkipContainer(){var a,b;null===(b=null===(a=this._skipContainer)||void 0===a?void 0:a.parentNode)||void 0===b?void 0:b.removeChild(this._skipContainer);this._skipContainer=void 0}_handleNextButton(){this._calledNextVideo=!0;this._removeSkipContainer();this._programmaticPauseVideo();this._adLoadedOrErrored().then(a=>{"adLoaded"===a&&(this._toggleAdContainer(!0),this.playAdInStream());"adError"!==a&&"vpaidAdPlayError"!==a||this._continuePlayingFirstOrNextVideo()}).catch(()=>
{})}_checkVideoClose(){return this._collapseSettings&&this._collapseSettings.saveVideoCloseState&&this._config.video.videoWasClosed}_createSkipContainer(){let a=document.createElement("div");a.id="next-stay-container";let b=this._createNavButton("next");b.onclick=this._handleNextButton.bind(this);a.appendChild(b);a.appendChild(this._createNavButton("stay")).onclick=()=>{this._playerWasClicked=!0;this._removeSkipContainer()};return a}_createNavButton(a){let b=document.createElement("div");b.id=`${a}-video`;
b.textContent=a.charAt(0).toUpperCase()+a.slice(1);we(15)||we(16)||qp()||b.classList.add("video-box-shadow");return b}_initSkipContainer(){this.timeupdate.on(()=>{var a=this._videoElement;let b=a.currentTime;a=a.duration;if(!(!this._canSkip||this._playerWasClicked||5>a)){var c=30>a,d=c?b>=a-5&&b<=a-5+.5:25<=b&&25.5>=b,e=c?b>=a&&b<=a+.5:30<=b&&30.5>=b;!this._createdSkipContainer&&(c?b>=a&&b<=a+.5:20<=b&&20.5>=b)&&!this._adFetched&&(this.prerollNum++,this._reInitAttempts=0,void this._fetchLinearAd(),
this._toggleSpinner(!0));!this._createdSkipContainer&&d?(this._createdSkipContainer=!0,this._skipContainer=this._createSkipContainer(),this._skipContainer.style.zIndex="1",this._playerPosition.appendChild(this._skipContainer),getComputedStyle(this._skipContainer).backgroundColor&&this._skipContainer.classList.add("loaded")):this._createdSkipContainer&&!this._calledNextVideo&&e&&this._handleNextButton()}})}_setPlayerVolume(){this._videoElement.volume!==this.volumeLevel&&(this._isProgrammaticVolumeChange=
!0,this._videoElement.volume=this.volumeLevel);0!==this._videoElement.volume&&this.muted&&(this._isProgrammaticVolumeChange=!0,this._videoElement.volume=0)}_handleVideoPlayingEvent({playerId:a,mediaIdCount:b}){if(a!==this._playlistId||b!==this._mediaIdCount)this.collapseCollection?pa.handleOtherVideoPlaying(this.collapseCollection):this._programmaticPauseVideo()}_adLoadedOrErrored(){return new Promise(a=>{this._adPlayErrorWithoutPlayAttempt.once(()=>{this._resetAndClearAdEmitters();a("vpaidAdPlayError")});
this._adPlayErrorWithoutPlayAttempt.emitted&&(this._resetAndClearAdEmitters(),a("vpaidAdPlayError"));this.adLoaded.emitted&&(this._resetAndClearAdEmitters(),a("adLoaded"));this.adError.emitted&&(this._resetAndClearAdEmitters(),a("adError"));this.adLoaded.once(()=>{this._resetAndClearAdEmitters();a("adLoaded")});this.adError.once(()=>{this._resetAndClearAdEmitters();a("adError")})})}_resetAndClearAdEmitters(){this.adError.resetEmitted();this.adLoaded.resetEmitted();this._adPlayErrorWithoutPlayAttempt.resetEmitted();
this.adLoaded.clear()}triggerPlayInView(){this.loadedMetaData.once(()=>{this.collapseCollection&&void pa.handleScroll(this.collapseCollection)});this.loadedMetaData.emitted&&this.collapseCollection&&void pa.handleScroll(this.collapseCollection)}createPlayerWrapper(){this.loadedMetaData.once(()=>{this._config.video.removeVideoTitleWrapper?this._addCloseWithoutWrapper():this._isTopCenterCollapse()?this._addTopCenterWrapper():this._addCloseWithoutWrapper();this._collapseSettings&&this._createCollapsibleCollection()});
this.loadedMetaData.emitted&&(this._config.video.removeVideoTitleWrapper?this._addCloseWithoutWrapper():this._isTopCenterCollapse()?this._addTopCenterWrapper():this._addCloseWithoutWrapper(),this._collapseSettings&&this._createCollapsibleCollection());this.collapsible&&(this._isTopCenterCollapse()&&this._createTopCenterBackground(this._container),this._stickyElement=null)}async getPlayerContent(){this._playlist=await this._getVideoContent();this._setVideoElementAttributesAndSource()}_initializeHls(a){Zb.isSupported()?
(this._hls.loadSource(a),this._hls.attachMedia(this._videoElement),this.isFirstPlay&&(this._hls.config.maxMaxBufferLength=1),this._hls.on(Zb.Events.ERROR,(b,c)=>{A.error("Html5InstreamPlayer","_initializeHls",{event:b,data:c})})):this._videoElement.canPlayType("application/vnd.apple.mpegurl")?this._videoElement.src=a:A.event("Html5InstreamPlayer","_initializeHls",{message:"Hls is not supported"})}setNextVideo(){this._playlist&&("auto-injected"===this._playerType||this._canSkip||this._setupAllowSkip(),
this._isProgrammaticVolumeChange=this._playerWasClicked=!1,this._playlistIndex=this._playlist.playlist.length-1===this._playlistIndex?0:++this._playlistIndex,void this._setVideoElementAttributesAndSource())}_setVideoElementAttributesAndSource(){if(this._playlist){var a=this._playlist.playlist[this._playlistIndex],b=a.sources;this._videoTitleDiv.innerHTML=a.title;this._videoDescriptionDiv.innerHTML=a.description;this._videoElement.poster=this.isFirstPlay?a.image:"";this._videoElement.controls=!0;this._videoElement.preload=
"metadata";for(a=0;a<b.length;a++){let c=b[a];"application/vnd.apple.mpegurl"===c.type&&this._initializeHls(c.file)}}}_onBeforeRequestBids(){this._prebidMethods.onEvent("beforeRequestBids",a=>{a.forEach(b=>{var c;let d=b.code===this.name,e=this._userIdComponent.getUserIdTargeting();d&&e&&(this.userIdTargetingData=e);b=null!==(c=b.ortb2Imp&&b.ortb2Imp.ext&&b.ortb2Imp.ext.tid)&&void 0!==c?c:"";d&&b&&(this.transactionId=b)})})}_initiateListeners(){if(this.collapsible&&"adthrive-collapse-mobile"===this._collapseSettings.collapseType)this._eventProxy.footerRefreshed.on(this._handleFooterRefreshedEvent.bind(this));
this._collapseSettings&&(pa.classesToggled.on(()=>{this._handleResizeAd()}),pa.uncollapseEvent.on(()=>{this._handleResizeAd()}));this.ready.on(this._handleReady.bind(this));this.adLoaded.on(this._handleAdLoaded.bind(this));this.adStarted.on(this._handleAdStart.bind(this));this.adProgress.on(this._handleAdProgress.bind(this));this.adPause.on(this._handleAdPause.bind(this));this.adPlay.on(this._handleAdPlay.bind(this));this.adError.on(this._handleAdError.bind(this));this.adSkipped.on(this._handleCompleteAndSkip.bind(this));
this.adCompleted.on(this._handleCompleteAndSkip.bind(this));this.play.on(this._handleVideoElementPlay.bind(this));this.seeked.on(this._handlePlayerInteraction.bind(this));this.seeking.on(this._handlePlayerInteraction.bind(this));this.click.on(this._handlePlayerInteraction.bind(this));this._isAdvanedPlaylistEnabled&&(this.pause.on(this._handlePlayerInteraction.bind(this)),this.playerVolumeChange.on(this._handlePlayerInteraction.bind(this)),this.seeking.on(this._handlePlayerInteraction.bind(this)),
this.seeked.on(this._handlePlayerInteraction.bind(this)));this.pause.on(this._handleVideoElementPause.bind(this));this.timeupdate.on(this._handleVideoElementTimeUpdate.bind(this));this.ended.on(this._handleVideoElementEnded.bind(this));this._spaListeners.push(this._eventProxy.resize.on(this._handleResizeAd.bind(this)));this._collapseSettings&&this._spaListeners.push(this._eventProxy.scroll.on(this._handleScroll.bind(this)))}get collapsible(){return this._isCollapsible}get isPlayerType(){return this._playerType}get transactionId(){return this._transactionId}set transactionId(a){this._transactionId=
a}get vp(){return 1>=this.prerollNum?this.prerollNum:9>=this.prerollNum?2:3}set userIdTargetingData(a){this._userIdTargetingData=a}get userIdTargetingData(){return this._userIdTargetingData}set videoAdUnit(a){this._videoAdUnit=a}get videoAdUnit(){return this._videoAdUnit}get mediaOrPlaylistId(){return this._mediaOrPlaylistId}fetchVideoContent(a){return rh(ua.addMaxResolutionQueryParam(`https://cdn.jwplayer.com/v2/${a}/${this.mediaOrPlaylistId}`))}async _getVideoContent(){try{let a="";"embedded-stationary"===
this._playerType?a="media":"auto-injected"===this._playerType&&(a="playlists");return await this.fetchVideoContent(a)}catch(a){}}_handleReady(){this._startTearDownTimer()}_handleAdLoaded(a){this.collapseCollection&&a.ad&&(this.collapseCollection.adIsLinear=a.ad.linear);A.event(this._playerType,"adLoaded",this._getEventInfo(a));if(a=this._getAdDetailsFromAd(a))this._addAdDetailFields(),this._adDetails={...this._additionalAdFields,wrapperIds:a.adWrapperIds,gamCreativeId:a.adWrapperCreativeIds[a.adWrapperCreativeIds.length-
1],gamLineItemId:a.adWrapperIds[a.adWrapperIds.length-1],wrapperCreativeIds:a.adWrapperCreativeIds,vastCreativeId:a.creativeId,mediaFileURL:a.mediaUrl,adUnitName:this.name,tag:this._prerollAdUrl,isEmpty:!1,wrapperSystems:a.adWrapperSystems}}_handleAdStart(a){this._programmaticPauseVideo();this._resetAdVars();this._handleResizeAd();this._toggleSpinner(!1);let b=this._getAdDetailsFromAd(a);this._currentAdDurationWithBuffer=(b&&b.duration||a.duration||this._defaultAdDuration)+this._adTimingBuffer;this._setStaleAdDetection();
0!==this._currentAdTime&&this._setStaleAdDetection();this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails||{});this._eventProxy.emitVideoPlayingEvent(this._playlistId,this._mediaIdCount);this._checkRenderedAdDetails();this._adPlaying=!0}_handleAdProgress(a){let {duration:b,position:c}=a;this._currentAdTime=c;this._config.video.logAdDuration&&!this._adDurationLogged&&(A.event("VideoManager","VideoAdDuration",{adDuration:b,roundedAdDuration:Math.round(b)}),this._adDurationLogged=!0)}_handleAdPause(){var a;
this._clearStaleTimers();this.adPlay.once(()=>{0!==this._currentAdTime&&this._setStaleAdDetection()});this.collapseCollection&&(this._isProgrammaticPause?this._isProgrammaticPause=!1:this.collapseCollection&&7!==(null===(a=this.collapseCollection)||void 0===a?void 0:a.playerState)&&(this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?4:3))}_handleAdPlay(){var a;this._isProgrammaticPlay?this._isProgrammaticPlay=!1:this.collapseCollection&&7!==(null===(a=this.collapseCollection)||
void 0===a?void 0:a.playerState)&&(this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?2:1)}_handleAdError(a){"adLoadError"===a.type?A.error("Html5InstreamPlayer","_handleAdError","adLoadError",a):("adPlayError"===a.type&&this._playAdInStreamAttempted&&(this._playAdInStreamAttempted?(this._clearStaleTimers(),this._continuePlayingFirstOrNextVideo()):this._adPlayErrorWithoutPlayAttempt.emit()),A.error("Html5InstreamPlayer","_handleAdError",a.type,a));var b=this._prerollAdUrl;
this._bidMarkedOnCurrentAd=!1;this._adDetails||(this._addAdDetailFields(),this._adDetails={...this._additionalAdFields,adUnitName:this.name,tag:b,isEmpty:!0});this._checkRenderedAdDetails();b={...a,...this._getPlayerVersions(),...this._getErrorLogAdDetails()};900===a.code&&this._eventProxy.emitVideoSlotRenderedEvent(this._adDetails);A.error(this._playerType,"vastError",b)}_skipContainerReset(){this._playerWasClicked=this._createdSkipContainer=this._calledNextVideo=!1}_handleCompleteAndSkip(a){this._setPlayerVolume();
1===this._hls.config.maxMaxBufferLength&&(this._hls.config.maxMaxBufferLength=600);this._continuePlayingFirstOrNextVideo();"adSkipped"===a.type&&this._clearStaleTimers()}_programmaticPlayVideo(){return new Promise((a,b)=>{if(this._adPlaying)try{this._playAd(),a()}catch(c){b(c)}else this._isProgrammaticPlay=!0,this._videoElement.play().then(a).catch(b)})}_handlePlayerInteraction(a){"click"===a.type&&(this._removeSkipContainer(),this._playerWasClicked=!0);"pause"!==a.type||this._isProgrammaticPause||
(this._removeSkipContainer(),this._playerWasClicked=!0);"play"===a.type&&this.isFirstPlay&&!this._isProgrammaticPlay&&(this._removeSkipContainer(),this._playerWasClicked=!0);"seeking"===a.type&&(this._wasSeeking=!0,this._isAdvanedPlaylistEnabled&&(this._removeSkipContainer(),this._playerWasClicked=!0));"seeked"===a.type&&(this._wasSeeking=!1,this._isAdvanedPlaylistEnabled&&(this._removeSkipContainer(),this._playerWasClicked=!0));"volumechange"===a.type&&(this._isProgrammaticVolumeChange?this._isProgrammaticVolumeChange=
!1:(this._playerWasClicked=!0,this._removeSkipContainer()))}_handleVideoElementPlay(){var a;this._wasSeeking&&(this._isVideoEnded||0===this._videoElement.currentTime)?(this._toggleAdContainer(!0),this._programmaticPauseVideo()):(this._eventProxy.emitVideoPlayingEvent(this.mediaOrPlaylistId,this._mediaIdCount),this._clearStaleTimers(),this.collapseCollection&&(this.collapseCollection.mediaStarted=!0),this.isFirstPlay&&(this._programmaticPauseVideo(),this._toggleAdContainer(!0),this._adLoadedOrErrored().then(b=>
{"adLoaded"===b&&this.playAdInStream();if("adError"===b||"vpaidAdPlayError"===b)this._continuePlayingFirstOrNextVideo(),1===this._hls.config.maxMaxBufferLength&&(this._hls.config.maxMaxBufferLength=600)}).catch(()=>{})),this._isProgrammaticPlay?this._isProgrammaticPlay=!1:this.collapseCollection&&7!==(null===(a=this.collapseCollection)||void 0===a?void 0:a.playerState)&&(this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?2:1))}_programmaticPauseVideo(){this._isProgrammaticPause=
!0;this.isFirstPlay||!this._adPlaying?this._videoElement.pause():this._adPlaying&&this._pauseAd();this._adPlaying&&this._pauseAd()}_handleVideoElementPause(){var a;this._clearStaleTimers();!this.collapseCollection||this._videoElement.seeking||this._videoElement.ended||(this._isProgrammaticPause?this._isProgrammaticPause=!1:this.collapseCollection&&7!==(null===(a=this.collapseCollection)||void 0===a?void 0:a.playerState)&&(this.collapseCollection.playerState=this.collapseCollection.playerCollapsed?
4:3))}_handleVideoElementTimeUpdate(){var a=this._videoElement;let b=a.currentTime;a=a.duration-b;1<b&&!this._videoStarted&&(this._videoStarted=!0,this._playAdInStreamAttempted=this._isVideoEnded=!1,this.isFirstPlay||this._skipContainerReset(),this._eventProxy.emitVideoPlayingEvent(this._playlistId,this._mediaIdCount));3<b&&this._videoTitleOverlayContainer.classList.contains("active")&&this._toggleTitle(!1);10>a&&!this._adFetched&&(this.prerollNum++,this._reInitAttempts=0,void this._fetchLinearAd(),
this._toggleSpinner(!0))}async _fetchLinearAd(){this._adFetched=!0;let a=()=>{this._prerollAdUrl=this.buildVideoUrl(this);this.requestAd({adTagUrl:this._prerollAdUrl});this._adPlayMap.set(this.prerollNum,!0)};await this._fetchBids();if(0<this._pendingBidRequests.length){let b=this._pendingBidRequests.pop();b&&b.then(()=>{this._delayGamCallExperiment.result?setTimeout(a,1E3):a()}).catch(()=>{})}}_handleVideoElementEnded(){this._isVideoEnded=!0;this._videoStarted=!1;this._calledNextVideo=!0;this._skipContainerReset();
this.volumeLevel=this._videoElement.volume;this.muted=this._videoElement.muted;this._toggleAdContainer(!0);this._adLoadedOrErrored().then(a=>{"adLoaded"===a&&this.playAdInStream();"adError"!==a&&"vpaidAdPlayError"!==a||this._continuePlayingFirstOrNextVideo()}).catch(()=>{})}_handleResizeAd(){this._adsManager&&this._adsManager.resize(this._adContainer.clientWidth,this._adContainer.clientHeight,this._ima.ViewMode.NORMAL)}_addAdDetailFields(){var a=this._prerollAdUrl;a=a&&this._getCustParamsFromQueryString(a);
let {hb_adid:b,hb_adomain:c,hb_bidder:d,amznp:e,hb_pb:f,amznbid:g,hb_deal:h}=a||{};this._additionalAdFields={adId:`${b}`,adomain:`${c}`,hb_bidder:`${d}`,amznp:`${e}`,hb_pb:`${f}`,amznbid:`${g}`,hb_deal:`${h}`}}_checkRenderedAdDetails(){let a=this._prebidAuctionManager,b=this._adDetails;a&&b&&!this._bidMarkedOnCurrentAd&&this._markPrebidBidAsUsed(b.gamCreativeId,a,b.wrapperSystems)}_clearStaleTimers(){this._stalePlayerTimer&&(clearTimeout(this._stalePlayerTimer),this._stalePlayerTimer=null)}_continuePlayingFirstOrNextVideo(){this._adPlaying=
!1;1===this._hls.config.maxMaxBufferLength&&(this._hls.config.maxMaxBufferLength=600);this.isFirstPlay||this.setNextVideo();this.isFirstPlay=!1;1>this._reInitAttempts&&(this._remove(),this.reInitIMA(),this._reInitAttempts++);this._resetAdVars();this._programmaticPlayVideo().then(()=>{this._skipContainerReset();this._toggleTitle(!0);this._toggleAdContainer(!1);Ce(1);this._adsLoader.contentComplete()}).catch(()=>{})}_enableRemoveIMAPLayer(){this._tearDownAfterNextAd=!0}_getAdDetailsFromAd(a){return a&&
0<Object.keys(a).length?a[Object.keys(a)[0]]:null}_getCustParamsFromQueryString(a){return(a=(a=a&&jc(a.split("?")[1]))&&a.get("cust_params"))&&ph(this._getDecodedURI(a))}_getDecodedURI(a){try{return decodeURIComponent(a)}catch(b){return""}}_getErrorLogAdDetails(){return(({wrapperIds:a,wrapperCreativeIds:b,wrapperSystems:c,vastCreativeId:d,mediaFileURL:e,adId:f,adUnitName:g,adomain:h,hb_bidder:k,amznp:m,hb_pb:n,amznbid:p,hb_deal:r})=>({wrapperIds:a,wrapperCreativeIds:b,wrapperSystems:c,vastCreativeId:d,
mediaFileURL:e,adId:f,adUnitName:g,adomain:h&&encodeURIComponent(h),hb_bidder:k,amznp:m,hb_pb:n,amznbid:p,hb_deal:r}))(this._adDetails||{})}_getEventInfo(a){return{playerName:this.name,...a}}_getPlayerVersions(){return{imaSDKVersion:this._ima&&this._ima.VERSION}}async _fetchBids(){if(2>this._pendingBidRequests.length){let a=this.requestVideoBids([this]);a&&(this._pendingBidRequests.push(a),await a)}}_markPrebidBidAsUsed(a="",b,c=[]){b=a&&b.videoCreativeIdMapping.get(a);let d=!1,e=!1,f=!1;c.forEach(g=>
{g=g.toLowerCase();"gdfp"===g&&(e=!0);"prebid.org wrapper"===g?d=!0:"amazon"===g&&(f=!0)});if(b){if(a=this._adDetails,a=(a&&a.tag&&this._getCustParamsFromQueryString(a.tag)||{})[`hb_adid_${b}`.substring(0,20)])this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name,adId:a}),this._bidMarkedOnCurrentAd=!0}else if(a)A.event("IMAPlayer","MarkBidsAsUsed",{message:"Creative Id Not Found",gamCreativeId:a});else{if(d||e&&!f||!c.length)this._bidMarkedOnCurrentAd=!0,this._prebidMethods.markWinningBidAsUsed({adUnitCode:this.name});
A.event("IMAPlayer","MarkBidsAsUsed",{message:"Missing Creative Id"})}}_resetAdVars(){this._bidMarkedOnCurrentAd=!1;this._adDetails=null;this._adDurationLogged=this._adFetched=!1;this._currentAdDurationWithBuffer=this._currentAdTime=0;this._pendingBidRequests.length=0;this._clearStaleTimers();this.adLoaded.clear();this.adLoaded.resetEmitted()}_setStaleAdDetection(){let a=this._currentAdDurationWithBuffer-this._currentAdTime;this._stalePlayerTimer||(this._stalePlayerTimer=window.setTimeout(()=>{A.error("IMAPlayer",
"stalePlayer",{message:"IMAPlayer encountered an unknown error during ad play",...this._getPlayerVersions(),...this._getErrorLogAdDetails()});-1!==this._tearDownPlayerTimeout&&this._continuePlayingFirstOrNextVideo()},1E3*a))}_startTearDownTimer(){let a=this._tearDownPlayerTimeout;this._canTearDown&&(this._tearDownTimer=window.setTimeout(this._enableRemoveIMAPLayer.bind(this),a))}_toggleAdContainer(a){let b=document.getElementById(`adthrive-${this._playerType}-ad-container`);b&&(a?(b.classList.add("adthrive-player-ad-container-loading"),
b.classList.remove("adthrive-player-ad-container-idle")):(b.classList.remove("adthrive-player-ad-container-loading"),b.classList.add("adthrive-player-ad-container-idle")))}_toggleSpinner(a){let b=document.getElementById(`adthrive-${this._playerType}-loading-spinner`);b&&(a?b.classList.add("active"):b.classList.remove("active"))}_toggleTitle(a){a?this._videoTitleOverlayContainer.classList.add("active"):this._videoTitleOverlayContainer.classList.remove("active")}_preventCollapse(){pa.disableCollapse=
!0;this.collapseCollection&&pa.uncollapse(this.collapseCollection)}_createCollapsibleCollection(){this.collapseCollection={adContainer:this._adContainer,adIsLinear:!1,closeButton:this._closeButton,collapseMobileSizeType:this._collapseSettings.collapseMobileSizeType,collapseMobileSubType:this._getCollapseMobileSubType(),collapseSubType:"adthrive-collapse-bottom-right",collapseTimer:{timeCollapsed:0,isRunning:!1},collapseType:this._collapseSettings.collapseType,desktopCollapseOnScrollUp:this._collapseSettings.desktopCollapseOnScrollUp,
footerElement:this._config.video.footerSelector?document.querySelector(this._config.video.footerSelector):null,forceMobile:"desktop"!==this._config.context.device,hasPreviouslyCollapsed:!1,isAdPlaying:this._adPlaying,mediaStarted:!1,mobileCollapseOnScrollUp:this._collapseSettings.mobileCollapseOnScrollUp,mobileHeaderSelector:this._collapseSettings.mobileHeaderSelector,playerCollapsed:!1,playerContainer:this._container,playerElement:this._videoElement,playerPosition:this._playerPosition,playerSizeExperiment:this._reducedVideoPlayerSizeExperiment.result,
playerState:this._playerState,playerType:this._playerType,programmaticPause:this._programmaticPauseVideo.bind(this),programmaticPlay:this._programmaticPlayVideo.bind(this),saveVideoCloseState:this._collapseSettings.saveVideoCloseState,stickyElement:this._stickyElement,title:this._collapseSettings.title,topBackgroundElement:this._topBackgroundElement}}_getCollapseMobileSubType(){return this._mobileStickyPlayerPositionSiteExperiment.enabled&&"control"!==this._mobileStickyPlayerPositionSiteExperiment.result?
ua.setMobileLocation(this._mobileStickyPlayerPositionSiteExperiment.result):this._collapseSettings.mobileLocation}async _handleScroll(){let a=this._config.gdpr;!a.consentCaptured&&a.enabled&&await this.waitForConsent();this.collapseCollection&&(this._handleResize(),pa.handleScroll(this.collapseCollection))}_handleResize(){this.collapseCollection&&pa.handleResize(this.collapseCollection)}_handlePageVisibilityChange(a){this.collapseCollection&&pa.handlePageVisibilityChange(a,this.collapseCollection)}_displayCloseButton(){this.collapseCollection&&
pa.displayCloseButton(this.collapseCollection)}_handleClose(){this.collapseCollection&&(this._collapseSettings.saveVideoCloseState&&U.setLocalStorageValue("video_closed",!0),this._isAdvanedPlaylistEnabled&&(this._playerWasClicked=!0,this._removeSkipContainer()),pa.handleClose(this.collapseCollection))}_handleUserClick(){this.collapseCollection&&pa.handleUserClick(this.collapseCollection)}_handleWidthBreak(a){this.collapseCollection&&pa.handleWidthBreak(a,this.collapseCollection)}_handleTitleClick(a){this.collapseCollection.collapseTimer.firstInView&&
A.event("html5-insteam-player","handleTitleClick",{timeElapsed:Date.now()-this.collapseCollection.collapseTimer.firstInView.valueOf(),link:a.currentTarget.getAttribute("href")})}_handleFooterRefreshedEvent(){this.collapseCollection&&this.collapseCollection.playerCollapsed&&pa.repositionCollapseMobileBottom(this.collapseCollection)}get _isTopCollapse(){return"adthrive-collapse-top-center"===this._getCollapseMobileSubType()}_createTopCenterBackground(a){this._topBackgroundElement=this._createPlayerCollapseBackgroundElement();
let b=this._topCenterMobileBackgroundCoreExperiment.backgroundColor;b&&(this._topBackgroundElement.style.backgroundColor=b);a.appendChild(this._topBackgroundElement)}_createLinkIcon(a){let b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("width","24");b.setAttribute("height","24");b.setAttribute("style","vertical-align: top;");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d","M 16 1 H 23 V 8 Z M 19.5 12.5 V 23 H 1 V 4.5 H 12 l 1 1 H 2 V 22 H 18.5 V 11.5 l 1 1 v 1 M 19 4 L 11.5 11.5 l 1 1 L 20 5");
c.setAttribute("stroke","white");c.setAttribute("stroke-width","2");c.setAttribute("stroke-linejoin","round");b.appendChild(c);b.id=`${a}-svg-link`;return b}_addCloseWithoutWrapper(){this._playerPosition.appendChild(this._createPlayerCloseButton());this._playerPosition.classList.add("adthrive-player-without-wrapper-text")}_addTopCenterWrapper(){this._playerPosition.appendChild(this._createPlayerWrapper(!1));this._playerPosition.appendChild(this._createTopCollapseWrapper(!1));this._playerPosition.classList.add("adthrive-player-with-wrapper-text")}_addPlayerWithoutWrapper(){this._playerPosition.appendChild(this._createPlayerWrapper(!1));
this._playerPosition.classList.add("adthrive-player-without-wrapper-text")}_createPlayerWrapper(a){a?(this._wrapperTitleWrapperElement=document.createElement("a"),a=this._createLinkIcon(this._playlistId),this._wrapperTitleWrapperElement.appendChild(a)):this._wrapperTitleWrapperElement=document.createElement("div");this._videoTitleElement=document.createElement("span");a=document.createElement("div");let b=document.createElement("div");b.className="adthrive-wrapper-title-wrapper";this._videoTitleElement.classList.add("adthrive-video-text-cutoff");
this._videoTitleElement.classList.add("adthrive-video-title");this._wrapperTitleWrapperElement.className="adthrive-video-text-cutoff";this._wrapperTitleWrapperElement.appendChild(this._videoTitleElement);this._wrapperTitleWrapperElement.target="_blank";this._wrapperTitleWrapperElement.onclick=this._handleTitleClick.bind(this);this._closeButton=this._createPlayerCloseButton();b.appendChild(this._wrapperTitleWrapperElement);a.className="adthrive-wrapper-bar";a.appendChild(b);a.appendChild(this._closeButton);
return a}_createLearnMoreLink(a){let b=document.createElement("a");b.classList.add("adthrive-learn-more-link");b.innerText="Tap here to learn more.";b.id=`${a}-learn-more-link`;return b}_createTopCollapseWrapper(a=!0){let b=document.createElement("div");b.className="adthrive-top-collapse-wrapper-bar";this._closeButton=this._createPlayerCloseButton();var c=document.createElement("div");c.style.minHeight="33px";c.appendChild(this._closeButton);b.appendChild(c);c=document.createElement("a");this._topCollapseVideoTitleElement=
document.createElement("span");this._topCollapseVideoTitleElement.classList.add("adthrive-top-collapse-wrapper-video-title");let d=this._topCenterMobileBackgroundCoreExperiment.buttonTitleColor;d&&(this._topCollapseVideoTitleElement.style.color=d);c.appendChild(this._topCollapseVideoTitleElement);a&&(a=this._createLearnMoreLink(this._playlistId),c.appendChild(a),c.onclick=this._handleTitleClick.bind(this));b.appendChild(c);this._wrapperText=c;return b}_isTopCenterCollapse(){return"adthrive-collapse-mobile"===
this._collapseSettings.collapseType&&this._isTopCollapse}_createPlayerCloseButton(){this._closeButton=this._videoCloseButtonComponent.createPlayerCloseButton(this._handleClose.bind(this),"instream","adthrive-collapse-close",!1,this._isTopCollapse);this._closeButton.style.margin="0";return this._closeButton}_createPlayerCollapseBackgroundElement(){let a=document.createElement("div");a.classList.add("adthrive-collapse-mobile-background");a.style.width=`${window.innerWidth}px`;a.style.display="inline";
a.style.height="0";return a}}let zm=class extends W{init(){this._key="RaptivePlayerDesktop";this._default=!1}};zm=q([v("RaptiveDesktopPlayerExperiment"),y()],zm);let Am=class extends W{init(){this._key="RaptivePlayerMobile";this._default=!1}};Am=q([v("RaptivMobilePlayerExperiment"),y()],Am);let Bm=class extends W{init(){this._key="PlaylistFix";this._default=!1}run(){return super.run()}};Bm=q([v("PlaylistFixExperiment"),y()],Bm);let Cm=class extends yq{constructor(a,b,c,d,e,f,g,h,k="adthrive-collapse-float",
m,n,p,r,w,z,x,B,E,C){super(a,1,b,c,d,f,g,h,k,m,n,p,"playlist",!0,r,w,B,z);this._sharedVideoSettings=e;this._title=E;this._shuffle=C;this._topBackgroundElement=null;this._isCollapsible=!0;this._playerData=null;this._playerConfig={repeat:!0,playlist:`https://cdn.jwplayer.com/v2/playlists/${this._playlistId}`,related:{autoplaytimer:0}};this._playerContainer=(this._clsPlayerContainer=document.querySelector(`#cls-video-container-${this.playerContainerId} > div`)||document.querySelector(`#cls-video-container-${this.playerContainerId.split("_")[0]} > div`))?
this._clsPlayerContainer:document.createElement("div");this._playerElement=document.createElement("div");a=(a=this._config.video.contentSpecificPlaylists)&&gf(a);this._hasContentSpecificPlaylist=!!a;a&&(this._playlistId=a,this._playerConfig.playlist=`https://cdn.jwplayer.com/v2/playlists/${a}`);this._playerConfig={...this._playerConfig,...this._autoplayBehaviorConfig};this.initialAuctionPlayer=!0;this._stickyElement=null;this._checkVideoClose()&&(this._state=7);this._footerElement=this._config.video.footerSelector?
document.querySelector(this._config.video.footerSelector):null;this._playerData={playerElement:this._playerElement,playerContainer:this._playerContainer,footerElement:this._footerElement,stickyElement:this._stickyElement,mobileHeaderSelector:x||null};(this._playlistFixExperiment=S.resolve(Bm).result)||this._createCollapsibleCollection(this._playerData)}setup(){this._isCollapsible&&(this._playerConfig.playlist=ua.addMaxResolutionQueryParam(this._playerConfig.playlist),this._playlistFixExperiment&&
this._createCollapsibleCollection(this._playerData),this.collapseCollection.closeButton=this._closeButton);this._isFirstPlay&&this._appendPlayer();this.playerInstance=window.jwplayer(this._playlistId);this.collapseCollection&&(this.collapseCollection.playerInstance=this.playerInstance,this.collapseCollection.playerContainer=this._playerContainer,this.collapseCollection.playerElement=this._playerElement,this.collapseCollection.topBackgroundElement=this._topBackgroundElement);this._jwSetup(this._playerConfig);
this._config.video.playlistPlayerAdded=!0}_appendPlayer(){let a=document.createElement("div");this._playerContainer.classList.add("adthrive-player-container");this._playerContainer.classList.add("adthrive-collapse-player");this._playerContainer.id="adthrive-collapse-container";this._playerElement.className="adthrive-player-position";this._playerElement.id="adthrive-collapse-position";a.id=this._playlistId;let b=this._getTitle();if(b){let c=document.createElement("h3");c.innerText=b;c.className="adthrive-player-title";
c.id="adthrive-collapse-title";this._playerElement.appendChild(c)}this._config.video.removeVideoTitleWrapper?(this._playerElement.appendChild(this._createPlayerCloseButton()),this._playerElement.classList.add("adthrive-player-without-wrapper-text")):"adthrive-collapse-mobile"===this._collapseType&&this._isTopCollapse?(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.appendChild(this._createTopCollapseWrapper()),this._playerElement.classList.add("adthrive-player-with-wrapper-text")):
(this._playerElement.appendChild(this._createPlayerWrapper(!0)),this._playerElement.classList.add("adthrive-player-without-wrapper-text"));this.collapseCollection.closeButton=this._closeButton;this._playerElement.appendChild(a);this.isTopCenterCollapse()&&this._createTopCenterBackground(this._playerContainer);this._playerContainer.appendChild(this._playerElement);this._clsPlayerContainer||this._pageElement.insertAdjacentElement(this._sharedVideoSettings.position,this._playerContainer)}_linkProvidedByPublisher(a){return!a.startsWith("https://cdn.jwplayer.com")}_playerReady(a){var b;
super._playerReady(a);null===(b=this._playerElement.querySelector(".adthrive-wrapper-bar"))||void 0===b?void 0:b.style.setProperty("display","flex");this._getShuffle()&&!this._hasContentSpecificPlaylist&&(b=this.playerInstance.getPlaylist(),this.playerInstance.load(ua.shufflePlaylist(b)));this._config.video.advancePlaylist.playlistPlayer.enabled&&(this.playerInstance.on("firstFrame",()=>this._handleFirstFrame()),this.playerInstance.getContainer().addEventListener("click",()=>this._handleVideoPlayerClicked()),
this._initSkipContainer());this.playerInstance.on("playlistItem",c=>{c=c.item;let d=this._playlistId,e=document.getElementById(`${d}-learn-more-link`),f=document.getElementById(`${d}-svg-link`);this._videoTitleElement&&Cb(c,"title")&&"string"===typeof c.title&&(this._videoTitleElement.innerText=c.title);this._topCollapseVideoTitleElement&&Cb(c,"title")&&"string"===typeof c.title&&(this._topCollapseVideoTitleElement.innerText=c.title);this._wrapperTitleWrapperElement&&Cb(c,"link")&&"string"===typeof c.link&&
this._linkProvidedByPublisher(c.link)&&(this._wrapperTitleWrapperElement.href=c.link,f||this._wrapperTitleWrapperElement.prepend(this._createLinkIcon(d)));this._wrapperText&&Cb(c,"link")&&"string"===typeof c.link&&this._linkProvidedByPublisher(c.link)&&(this._wrapperText.href=c.link,e||this._wrapperText.append(this._createLearnMoreLink(d)));c&&Cb(c,"link")&&"string"===typeof c.link&&!this._linkProvidedByPublisher(c.link)&&(null===f||void 0===f?void 0:f.remove(),null===e||void 0===e?void 0:e.remove())});
this._handleResize();this._playlistFixExperiment&&this._handleScroll().catch(()=>!1);a.viewable&&void this._inViewPlay()}_getShuffle(){return this._shuffle?this._shuffle:!1}_getTitle(){return this._title?this._title:""}_checkVideoClose(){return this._saveVideoCloseState&&this._config.video.videoWasClosed}};Cm=q([v("PlaylistPlayer"),t("design:paramtypes",[String,String,String,Array,Object,HTMLElement,Ub,N,String,String,ia,Rc,Boolean,String,String,Object,Boolean,String,Boolean])],Cm);let Dm=class extends Gu{async init(){var a,
b;(((null!==(b=null===(a=document.querySelector("meta[name=generator]"))||void 0===a?void 0:a.content)&&void 0!==b?b:null)||"").includes("Wix")||window.wixPerformanceMeasurements||window["wix-perf-measure"]||window.wixDevelopersAnalytics)&&await Hu();this._setupSpaListeners();this._handleCollapsibleVideoLogging();this._initializePlayers();this._mediaType.runOneStreamExperiment()}constructor(a,b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B,E,C,I){super(d.video,"VideoManagerComponent");this._auctionManagers=a;this._bootstrapConfig=
b;this._collapsibleVideoLoggingStore=c;this._config=d;this._eventProxy=e;this._events=f;this._irisTv=g;this._jwBoostExperiment=h;this._mediaType=k;this._ortb2=m;this._prebidMethods=n;this._spaEventBus=p;this._slotManager=r;this._raptiveDesktopPlayerExperiment=w;this._raptiveMobilePlayerExperiment=z;this._userPageDataLoggingEvent=x;this._videoCollapseScrollUpExperiment=B;this._videoCollapseScrollUpTopCenterExperiment=E;this._videoRequestManager=C;this._videoUrlBuilder=I;this._jwPlayers=[];this._html5Players=
[];this._spaListeners=[];this._IN_POST_SELECTOR=".adthrive-video-player";this._desktopCollapseOnScrollUp=!1;this._mobileCollapseOnScrollUp="off";this._mobileRaptivePlayerEnabled=this._desktopRaptivePlayerEnabled=!1;this._desktopCollapseOnScrollUp=this._videoCollapseScrollUpExperiment.result;this._mobileCollapseOnScrollUp=this._videoCollapseScrollUpTopCenterExperiment.result||"off";this._desktopRaptivePlayerEnabled="mobile"!==this._device&&this._raptiveDesktopPlayerExperiment.result;this._mobileRaptivePlayerEnabled=
"mobile"===this._device&&this._raptiveMobilePlayerExperiment.result}_setupSpaListeners(){this._spaEventBus.routeChanged.on(()=>{this._removeExistingSpaListeners();this._removePlayers();this._stickyRelatedOnPage=!1;this._relatedMediaIds=[];this.setPotentialPlayersMap()});this._spaEventBus.resetCompleted.on(()=>{this._handleCollapsibleVideoLogging();this._initializePlayers()})}_removeExistingSpaListeners(){this._spaListeners.forEach(a=>a());this._spaListeners.length=0}_removePlayers(){this._jwPlayers.forEach(a=>
a.playerInstance.remove());this._jwPlayers.length=0}_initializePlayers(){let a=document.querySelectorAll(this._IN_POST_SELECTOR);a.length&&this._initializeRelatedPlayers(a);if(this._shouldRunAutoplayPlayers()){this._determineAutoplayPlayers();try{this._importScripts(),void this._initHtml5Players()}catch(b){A.error("VideoManagerComponent","initializePlayers",b)}}else try{this._importScripts()}catch(b){A.error("VideoManagerComponent","initializePlayers",b)}}_createStationaryRelatedPlayer(a,b,c){let d=
"mobile"===this._device?[400,225]:[640,360],e=M.Video_In_Post_ClicktoPlay_SoundOn,f=this._config,g=this._prebidMethods;this._desktopRaptivePlayerEnabled||this._mobileRaptivePlayerEnabled?(a=new dr(a.playerId,c||1,a.mediaOrPlaylistId,"embedded-stationary",b,d,f,this._eventProxy,!1,e,!1,g,this._auctionManagers,this._slotManager),this._html5Players.push(a)):(a=new Tf(a.playerId,c||1,a.mediaOrPlaylistId,e,d,b,this._eventProxy,this._config,!1,"adthrive-collapse-mobile","adthrive-collapse-medium",this._prebidMethods,
this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp),this._jwPlayers.push(a))}_createStickyRelatedPlayer(a,b){let c="mobile"===this._device?[400,225]:[640,360],d=M.Video_Individual_Autoplay_SOff,e=this._getCollapseType();this._collapsibleVideoLoggingStore.playerName=d;this._stickyRelatedOnPage=!0;this._config.video.mobileStickyPlayerOnPage="mobile"===this._device?!0:!1;a=new Tf(a.playerId,1,a.mediaId,d,c,b,this._eventProxy,this._config,!0,e,"adthrive-collapse-medium",
this._prebidMethods,this._auctionManagers,this._desktopCollapseOnScrollUp,this._mobileCollapseOnScrollUp,a.mobileLocation,a.mobileHeaderSelector);this._jwPlayers.push(a)}_createPlaylistPlayer(a,b){let c=a.playerId,d=a.playlistId,e=this._getCollapseType(),f="adthrive-collapse-mobile"===e?[400,225]:[640,360],g=this._config,h="mobile"===this._device?M.Video_Coll_SOff_Smartphone:M.Video_Collapse_Autoplay_SoundOff,k=this._prebidMethods;if(this._desktopRaptivePlayerEnabled||this._mobileRaptivePlayerEnabled){let m=
document.querySelector(`#cls-video-container-${d} > div`);b=m?m:b;a={classNames:[],collapseMobileSizeType:"adthrive-collapse-medium",collapseType:e,desktopCollapseOnScrollUp:this._desktopCollapseOnScrollUp,elementSelector:a.elementSelector,enabled:!0,mobileCollapseOnScrollUp:this._mobileCollapseOnScrollUp,mobileHeaderSelector:a.mobileHeaderSelector,mobileLocation:a.mobileLocation,pageSelector:a.pageSelector,position:a.position,saveVideoCloseState:a.saveVideoCloseState,shuffle:a.shuffle,skip:a.skip,
title:a.title};this._config.video.mobileStickyPlayerOnPage=!0;b=new dr(c,1,d,"auto-injected",b,f,g,this._eventProxy,!0,h,!0,k,this._auctionManagers,this._slotManager,a);this._collapsibleVideoLoggingStore.playerName=h;this._html5Players.push(b)}else b=new Cm(c,d,h,f,{classNames:[],enabled:!0,pageSelector:a.pageSelector,elementSelector:a.elementSelector,position:a.position,skip:a.skip},b,this._eventProxy,this._config,e,"adthrive-collapse-medium",this._prebidMethods,this._auctionManagers,this._desktopCollapseOnScrollUp,
this._mobileCollapseOnScrollUp,a.mobileLocation,a.mobileHeaderSelector,a.saveVideoCloseState,a.title,a.shuffle),this._collapsibleVideoLoggingStore.playerName=h,this._jwPlayers.push(b)}_initJwBoost(){this._prebidMethods.setConfig({...(this._jwBoostExperiment.result&&this._jwPlayers.length&&{realTimeData:{dataProviders:[{name:"jwplayer",params:{mediaIDs:this._relatedMediaIds}}]}})})}_setPlayerInstance(a){void this._resetPlayer(a)}_resetPlayer(a){a.init()}async _initializePlayer(a,b){let c=this._videoRequestManager;
a.setDefaults(window.jwplayer.defaults);window.jwplayer.defaults={};await this._bootstrapConfig.bootstrapLoaders[Oa.Prebid].then(()=>{this._videoUrlBuilder.shouldPrebidRun=!0}).catch(()=>{});b&&this._relatedMediaIds[0]&&(await this._irisTv.setContextualData(this._relatedMediaIds[0]),this._ortb2.updateOrtb2WithIris(this._irisTv));c.addVideoSlots([a]);a.setPlayerInstance=this._setPlayerInstance.bind(this);a.requestVideoBids=async d=>await c.requestVideoBids(d);a.waitForConsent=this.gdprConsentWait.bind(this);
V.pushToQueue(()=>{a.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder);a.init()})}async gdprConsentWait(){return new Promise(a=>{this._events.consentCaptured.on(b=>{b&&a(!0)})})}async _initHtml5Players(){let a=this._videoRequestManager;for(let b of this._html5Players){let c="embedded-stationary"===b.isPlayerType;await this._bootstrapConfig.bootstrapLoaders[Oa.Prebid].then(()=>{this._videoUrlBuilder.shouldPrebidRun=!0}).catch(()=>{});c&&this._relatedMediaIds[0]&&await this._irisTv.setContextualData(this._relatedMediaIds[0]);
a.addVideoSlots([b]);b.requestVideoBids=async d=>await a.requestVideoBids(d);b.waitForConsent=this.gdprConsentWait.bind(this);V.pushToQueue(()=>{b.buildVideoUrl=this._videoUrlBuilder.buildVideoUrl.bind(this._videoUrlBuilder);void b.init()})}}_importScripts(){this._config.video.preventStickyOutstream=this._disableStickyOutstreamInPresenceOfCollapsiblePlayer();this._jwPlayers.length&&(this._config.ccpa.userOptedOut||this._initJwBoost(),this._config.video.hasJwPlayer=!0,this._jwPlayers.forEach(a=>{let b=
"related"===a.isPlayerType;b&&this._config.video.setupAdvanceRelatedExperiment(a.collapsible);nb(`https://content.jwplatform.com/libraries/${a._playerId}.js${this._config.video.jwpVersion?`?version_override=${this._config.video.jwpVersion}`:""}`).then(async()=>this._initializePlayer(a,b)).catch(c=>A.error("VideoManagerComponent","importScripts",c))}))}_hasCollapsiblePlayer(a){return a.length?a.some(b=>b.collapsible):!1}_disableStickyOutstreamInPresenceOfCollapsiblePlayer(){return this._hasCollapsiblePlayer([...this._jwPlayers,
...this._html5Players])?!this._config.video.stickyOutstreamSettings.allowForPageWithStickyPlayer.enabled:!1}_isVideoAllowedOnPage(){return this._config.disableAds.video?(this._config.disableAds.reasons.has("video_tag")?A.error("VideoManagerComponent","isVideoAllowedOnPage",Error("DBP: Disabled by publisher via video tag")):this._config.disableAds.reasons.has("video_plugin")?A.error("VideoManagerComponent","isVideoAllowedOnPage",Error("DBP: Disabled by publisher via video plugin")):this._config.disableAds.reasons.has("video_page")?
A.error("VideoManagerComponent","isVideoAllowedOnPage",Error("DBP: Disabled by publisher via command queue")):A.error("VideoManagerComponent","isVideoAllowedOnPage",Error("DBP: Disabled by publisher via other")),!1):!0}_getCollapseType(){return"mobile"===this._device?"adthrive-collapse-mobile":"adthrive-collapse-float"}_handleCollapsibleVideoLogging(){this._spaListeners.push(pa.collapseEvent.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=ra()}),xa.collapseEvent.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime=
ra()}));this._spaListeners.push(pa.uncollapseEvent.on(()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?ra()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0;this._collapsibleVideoLoggingStore.startedCollapsedTime=void 0}),xa.uncollapseEvent.on(()=>{this._collapsibleVideoLoggingStore.totalTimeCollapsed+=this._collapsibleVideoLoggingStore.startedCollapsedTime?ra()-this._collapsibleVideoLoggingStore.startedCollapsedTime:0;this._collapsibleVideoLoggingStore.startedCollapsedTime=
void 0}));this._spaListeners.push(pa.closeEvent.on(()=>{this._collapsibleVideoLoggingStore.wasClosed=!0}),xa.closeEvent.on(()=>{this._collapsibleVideoLoggingStore.wasClosed=!0}));pa.startEvent.once(()=>{this._collapsibleVideoLoggingStore.wasStarted=!0});xa.startEvent.once(()=>{this._collapsibleVideoLoggingStore.wasStarted=!0});this._spaListeners.push(this._userPageDataLoggingEvent.loggingData.on(()=>{this._collapsibleVideoLoggingStore.startedCollapsedTime&&(this._collapsibleVideoLoggingStore.totalTimeCollapsed+=
ra()-this._collapsibleVideoLoggingStore.startedCollapsedTime)}))}};Dm=q([v("VideoManagerComponent"),H(),t("design:paramtypes",[Rc,Fa,Af,N,Ub,Tb,Oc,Gd,gb,Sb,ia,Pa,ja,zm,Am,Lc,Uf,Vf,lc,gm])],Dm);var $b,Md,er,cg,Nd,fr=-1,rc=function(a){addEventListener("pageshow",function(b){b.persisted&&(fr=b.timeStamp,a(b))},!0)},Em=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},dg=function(){var a=Em();return a&&a.activationStart||0},jb=function(a,
b){var c=Em(),d="navigate";0<=fr?d="back-forward-cache":c&&(document.prerendering||0<dg()?d="prerender":document.wasDiscarded?d="restore":c.type&&(d=c.type.replace(/_/g,"-")));return{name:a,value:void 0===b?-1:b,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1E12),navigationType:d}},Vc=function(a,b,c){try{if(PerformanceObserver.supportedEntryTypes.includes(a)){var d=new PerformanceObserver(function(e){Promise.resolve().then(function(){b(e.getEntries())})});
return d.observe(Object.assign({type:a,buffered:!0},c||{})),d}}catch(e){}},kb=function(a,b,c,d){var e,f;return function(g){0<=b.value&&(g||d)&&((f=b.value-(e||0))||void 0===e)&&(e=b.value,b.delta=f,g=b.value,b.rating=g>c[1]?"poor":g>c[0]?"needs-improvement":"good",a(b))}},Fm=function(a){requestAnimationFrame(function(){return requestAnimationFrame(function(){return a()})})},eg=function(a){var b=function(c){"pagehide"!==c.type&&"hidden"!==document.visibilityState||a(c)};addEventListener("visibilitychange",
b,!0);addEventListener("pagehide",b,!0)},Gm=function(a){var b=!1;return function(c){b||(a(c),b=!0)}},Wc=-1,fg=function(a){"hidden"===document.visibilityState&&-1<Wc&&(Wc="visibilitychange"===a.type?a.timeStamp:0,removeEventListener("visibilitychange",fg,!0),removeEventListener("prerenderingchange",fg,!0))},gr=function(){addEventListener("visibilitychange",fg,!0);addEventListener("prerenderingchange",fg,!0)},Hm=function(){return 0>Wc&&(Wc="hidden"!==document.visibilityState||document.prerendering?
1/0:0,gr(),rc(function(){setTimeout(function(){Wc="hidden"!==document.visibilityState||document.prerendering?1/0:0;gr()},0)})),{get firstHiddenTime(){return Wc}}},Od=function(a){document.prerendering?addEventListener("prerenderingchange",function(){return a()},!0):a()},hr=[1800,3E3],ir=function(a,b){b=b||{};Od(function(){var c,d=Hm(),e=jb("FCP"),f=Vc("paint",function(g){g.forEach(function(h){"first-contentful-paint"===h.name&&(f.disconnect(),h.startTime<d.firstHiddenTime&&(e.value=Math.max(h.startTime-
dg(),0),e.entries.push(h),c(!0)))})});f&&(c=kb(a,e,hr,b.reportAllChanges),rc(function(g){e=jb("FCP");c=kb(a,e,hr,b.reportAllChanges);Fm(function(){e.value=performance.now()-g.timeStamp;c(!0)})}))})},jr=[.1,.25],Kv=function(a,b){b=b||{};ir(Gm(function(){var c,d=jb("CLS",0),e=0,f=[],g=function(k){k.forEach(function(m){if(!m.hadRecentInput){var n=f[0],p=f[f.length-1];e&&1E3>m.startTime-p.startTime&&5E3>m.startTime-n.startTime?(e+=m.value,f.push(m)):(e=m.value,f=[m])}});e>d.value&&(d.value=e,d.entries=
f,c())},h=Vc("layout-shift",g);h&&(c=kb(a,d,jr,b.reportAllChanges),eg(function(){g(h.takeRecords());c(!0)}),rc(function(){e=0;d=jb("CLS",0);c=kb(a,d,jr,b.reportAllChanges);Fm(function(){return c()})}),setTimeout(c,0))}))},Pd={passive:!0,capture:!0},Lv=new Date,mr=function(a,b){$b||($b=b,Md=a,er=new Date,kr(removeEventListener),lr())},lr=function(){if(0<=Md&&Md<er-Lv){var a={entryType:"first-input",name:$b.type,target:$b.target,cancelable:$b.cancelable,startTime:$b.timeStamp,processingStart:$b.timeStamp+
Md};cg.forEach(function(b){b(a)});cg=[]}},Mv=function(a){if(a.cancelable){var b=(1E12<a.timeStamp?new Date:performance.now())-a.timeStamp;"pointerdown"==a.type?function(c,d){var e=function(){mr(c,d);g()},f=function(){g()},g=function(){removeEventListener("pointerup",e,Pd);removeEventListener("pointercancel",f,Pd)};addEventListener("pointerup",e,Pd);addEventListener("pointercancel",f,Pd)}(b,a):mr(b,a)}},kr=function(a){["mousedown","keydown","touchstart","pointerdown"].forEach(function(b){return a(b,
Mv,Pd)})},nr=[100,300],Nv=function(a,b){b=b||{};Od(function(){var c=Hm(),d=jb("FID"),e=function(k){k.startTime<c.firstHiddenTime&&(d.value=k.processingStart-k.startTime,d.entries.push(k),h(!0))},f=function(k){k.forEach(e)},g=Vc("first-input",f);var h=kb(a,d,nr,b.reportAllChanges);g&&eg(Gm(function(){f(g.takeRecords());g.disconnect()}));g&&rc(function(){d=jb("FID");h=kb(a,d,nr,b.reportAllChanges);cg=[];Md=-1;$b=null;kr(addEventListener);cg.push(e);lr()})})},gg=0,Im=1/0,hg=0,Ov=function(a){a.forEach(function(b){b.interactionId&&
(Im=Math.min(Im,b.interactionId),hg=Math.max(hg,b.interactionId),gg=hg?(hg-Im)/7+1:0)})},or=[200,500],Jm=0,yb=[],Km={},pr=function(a){var b=yb[yb.length-1],c=Km[a.interactionId];if(c||10>yb.length||a.duration>b.latency)c?(c.entries.push(a),c.latency=Math.max(c.latency,a.duration)):(a={id:a.interactionId,latency:a.duration,entries:[a]},Km[a.id]=a,yb.push(a)),yb.sort(function(d,e){return e.latency-d.latency}),yb.splice(10).forEach(function(d){delete Km[d.id]})},Pv=function(a,b){b=b||{};Od(function(){"interactionCount"in
performance||Nd||(Nd=Vc("event",Ov,{type:"event",buffered:!0,durationThreshold:0}));var c=jb("INP"),d=function(g){g.forEach(function(k){(k.interactionId&&pr(k),"first-input"===k.entryType)&&!yb.some(function(m){return m.entries.some(function(n){return k.duration===n.duration&&k.startTime===n.startTime})})&&pr(k)});var h;(g=(h=Math.min(yb.length-1,Math.floor(((Nd?gg:performance.interactionCount||0)-Jm)/50)),yb[h]))&&g.latency!==c.value&&(c.value=g.latency,c.entries=g.entries,f())},e=Vc("event",d,{durationThreshold:b.durationThreshold||
40});var f=kb(a,c,or,b.reportAllChanges);e&&(e.observe({type:"first-input",buffered:!0}),eg(function(){d(e.takeRecords());0>c.value&&0<(Nd?gg:performance.interactionCount||0)-Jm&&(c.value=0,c.entries=[]);f(!0)}),rc(function(){yb=[];Jm=Nd?gg:performance.interactionCount||0;c=jb("INP");f=kb(a,c,or,b.reportAllChanges)}))})},qr=[2500,4E3],Lm={},Qv=function(a,b){b=b||{};Od(function(){var c=Hm(),d=jb("LCP"),e=function(k){(k=k[k.length-1])&&k.startTime<c.firstHiddenTime&&(d.value=Math.max(k.startTime-dg(),
0),d.entries=[k],g())},f=Vc("largest-contentful-paint",e);if(f){var g=kb(a,d,qr,b.reportAllChanges);var h=Gm(function(){Lm[d.id]||(e(f.takeRecords()),f.disconnect(),Lm[d.id]=!0,g(!0))});["keydown","click"].forEach(function(k){addEventListener(k,h,!0)});eg(h);rc(function(k){d=jb("LCP");g=kb(a,d,qr,b.reportAllChanges);Fm(function(){d.value=performance.now()-k.timeStamp;Lm[d.id]=!0;g(!0)})})}})},rr=[800,1800],Rv=function c(b){document.prerendering?Od(function(){return c(b)}):"complete"!==document.readyState?
addEventListener("load",function(){return c(b)},!0):setTimeout(b,0)},Sv=function(b,c){c=c||{};var d=jb("TTFB"),e=kb(b,d,rr,c.reportAllChanges);Rv(function(){var f=Em();if(f){var g=f.responseStart;0>=g||g>performance.now()||(d.value=Math.max(g-dg(),0),d.entries=[f],e(!0),rc(function(){d=jb("TTFB",0);(e=kb(b,d,rr,c.reportAllChanges))(!0)}))}})};let ig=class extends T{constructor(b,c,d){super();this._bootstrapConfig=b;this._pageManager=c;this._googleAdManager=d;this._maxTimeOnPage=36E5;this._webVitals=
[];this._webVitalsSent=!1}init(){this._visibilityChangeOff=this._pageManager.visibilityChange.on(()=>this.logWebVitals());oh().then(()=>{let b=this.addWebVital.bind(this);Nv(b);Kv(b);Qv(b);ir(b);Pv(b);Sv(b)}).catch(()=>!1);setTimeout(()=>{this.logWebVitals()},this._maxTimeOnPage)}addWebVital({name:b,delta:c,value:d,id:e}){this._webVitals.push({name:b,delta:c,value:d,id:e})}_getFlagTargeting(){try{return this._googleAdManager.getTargetingValuesForKey("flag")}catch(b){return[]}}logWebVitals(){var b;
if(!this._webVitalsSent){var c=this._getFlagTargeting();c={webVitals:this._webVitals,DOMSize:document.querySelectorAll("*").length,gptLoad:!0,gptv:googletag&&googletag.getVersion&&googletag.getVersion(),flagTargeting:c};this._webVitalsSent=!0;null===(b=this._visibilityChangeOff)||void 0===b?void 0:b.call(this);this._bootstrapConfig.gptLibFailed&&(c.gptLoad=!1);A.fetchEvent("WebVitalsComponent","logWebVital",c)}}get enabled(){return this._bootstrapConfig.webVitalsEnabled}};ig=q([v("WebVitalsComponent"),
H(),t("design:paramtypes",[Fa,Ra,V])],ig);let Mm=class extends W{init(){this._key="LayoutShift";this._default=!1}isEnabled(){return super.isEnabled()&&ic()}};Mm=q([v("LayoutShiftExperiment"),y()],Mm);let jg=class extends T{constructor(b,c,d,e,f,g){super();this._gam=b;this._slotManager=c;this._slots=d;this._videoRequestManager=e;this._layoutShiftExperiment=f;this._pageManager=g;this._events=[];this._maxTimeOnPage=36E5;this._screenHeightsWithin=5;this._previousSiblings=3;this._layoutShiftData=[];this._slotResize=
{};this._loggedInitialLoadShift=!1;this._maxPayloadSize=3062}init(){this.watchSlotShift()}get enabled(){return this._layoutShiftExperiment.result&&"ResizeObserver"in window&&"PerformanceObserver"in window&&PerformanceObserver.supportedEntryTypes.includes("layout-shift")}watchSlotShift(){this.setPerformanceObserver();this.setResizeEvents();this.setEventListeners()}setPerformanceObserver(){if(!this._layoutObserver)try{this._layoutObserver=new PerformanceObserver(b=>{this.analyzeEntries(b.getEntries())}),
this._layoutObserver.observe({type:"layout-shift",buffered:!1})}catch(b){A.error("LayoutShiftComponent","SetPerformanceObserver",b)}}setResizeEvents(){this._events.push(this._videoRequestManager.requestingVideoBids.on(b=>{b.forEach(c=>{this.setResizeObservers(c._playlistId,c._pageElement)})}));this._events.push(this._gam.slotRequested.on(({slot:b})=>{this.setResizeObservers(b.element.id,b.element)}));this._slotManager.refreshing.once(()=>{this.logLayoutShift()})}setEventListeners(){this._events.push(this._pageManager.beforeUnload.on(()=>
this.logLayoutShift()));this._events.push(this._pageManager.visibilityChange.on(()=>this.logLayoutShift()));setTimeout(()=>{this.logLayoutShift()},this._maxTimeOnPage)}setResizeObservers(b,c){this._slotResize[b]||(this._slotResize[b]={hasResized:!1,resizeObserver:new ResizeObserver(d=>{d.forEach(()=>{this._slotResize[b].hasResized=!0;this._slotResize[b].ro_ts=Date.now();this._slotResize[b].resizeObserver.disconnect()})})},this._slotResize[b].resizeObserver.observe(c))}analyzeEntries(b){let c=Date.now();
for(let d of b){let {value:e,sources:f,hadRecentInput:g}=d;if(!g){b={value:e,po_ts:c,nodes:[]};for(let h of f)if(h.node){let k=Ac(h.node),m=k.split(":")[1];b.nodes.push({identifier:k,posDiff:h.currentRect.top-h.previousRect.top,absPos:window.pageYOffset+Number(h.currentRect.top),prevEls:this.getPreviousSibling(h.node,this._previousSiblings),parent:Ac(h.node.parentNode),hasResized:this.checkResizes(h.node),...(this._slotResize[m]&&this._slotResize[m].ro_ts&&{ro_ts:this._slotResize[m].ro_ts})})}this._layoutShiftData.push(b)}}}getPreviousSibling(b,
c=3){b=b.previousElementSibling;let d=0,e=[];for(;b&&d<c;)++d,e.push(Ac(b)),b=b.previousElementSibling;return e}checkResizes(b){let c=Ac(b).split(":")[1];return this._slotResize[c]&&this._slotResize[c].hasResized?this.checkIsSticky(c)||this.checkElementPlacement(b):!1}checkIsSticky(b){return(b=this._slots.get(b))&&b.isSticky}checkElementPlacement(b){var c=b.getBoundingClientRect();if(c=0<=c.top&&0<=c.left&&c.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&c.right<=(window.innerWidth||
document.documentElement.clientWidth)||window.pageYOffset>b.getBoundingClientRect().top+window.pageYOffset)c=this._screenHeightsWithin,c=window.pageYOffset-(b.getBoundingClientRect().top+window.pageYOffset)<window.innerHeight+window.innerHeight*c;return c}logLayoutShift(){this._loggedInitialLoadShift||(this._loggedInitialLoadShift=!0,this.checkAndTrim(this._layoutShiftData).forEach(b=>{A.event("LayoutShiftComponent","logLayoutShift",b)}),this.cleanUp())}checkAndTrim(b=[]){if(!b.length)return[];b=
[...b].sort((d,e)=>e.value-d.value);var c=JSON.stringify(b);if(c.length>this._maxPayloadSize){if(2>=Math.ceil(c.length/this._maxPayloadSize))return[b.slice(0,Math.ceil(b.length/2)),b.slice(Math.ceil(b.length/2))];c=this._maxPayloadSize/c.length*(Math.ceil(c.length/this._maxPayloadSize)/2);let d=b.slice();d.length=Math.floor(b.length*c);return this.checkAndTrim(d)}return[b]}cleanUp(){this.disconnectObservers();this.removeEventListeners()}removeEventListeners(){this._events.forEach(b=>{b()})}disconnectObservers(){this._layoutObserver.disconnect();
let b=Object.keys(this._slotResize);for(let c of b)this._slotResize[c].resizeObserver.disconnect()}};jg=q([v("LayoutShiftComponent"),H(),t("design:paramtypes",[V,ja,Qa,lc,Mm,Ra])],jg);let kg=class extends Ma{constructor(){super(...arguments);this.stickyContainerContentAdStylingApplied=new ab}};kg=q([y()],kg);let Nm=class extends W{init(){this._key="ParallaxAdLogError";this._default=!1}};Nm=q([v("ParallaxAdLogErrorExperiment"),y()],Nm);let Om=class extends T{constructor(b,c,d,e,f,g,h,k){super();this._gam=
b;this.parallaxAdsExperiment=c;this._pageManager=d;this._slotManager=e;this._stickyContainerAdsEventBus=f;this._videoEventBus=g;this._config=h;this._parallaxAdLogErrorExperiment=k;this._parallaxSlotMap=new Map;this._parallaxScrollEventOffMap=new Map;this._slotRebuildComplete=new Map;this._stickyContainerAdsApplied=!1;this._scrollStartPosition=300;this._slotScrollStartPosition=new Map}get enabled(){return this.parallaxAdsExperiment.result}start(){this._setupListeners()}_setupListeners(){this._stickyContainerAdsEventBus.stickyContainerContentAdStylingApplied.on(()=>
{this._stickyContainerAdsApplied=!0},{handleEventsAlreadyEmitted:!0});this._videoEventBus.topCenterVideoCollapsed.on(()=>{this._scrollStartPosition=500});this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{this._scrollStartPosition=300});this._gam.slotOnload.on(({slot:b})=>{if("Content"===b.location){let c=b.element;this._stickyContainerAdsApplied&&this._removeParallaxCSS(c);this._removeParallaxScrollEvent(c);this._isParallaxAd(c)&&(A.event("ParallaxComponent","_setupListeners","parallax_rendered",
b.element.id,b.refreshCount),b=c.firstChild?c.firstChild:null,this._parallaxSlotMap.set(c.id,!0),this._setParallaxSlotCSS(c,b),this._parallaxAdOnScroll(c),this._parallaxAdLogErrorExperiment.result&&this._checkParallaxAdVisibilityPercent(c,b))}});this._slotManager.refreshing.on(b=>{b.forEach(c=>{let d=c.element.id;"Content"!==c.location||this._slotRebuildComplete.get(d)||this._parallaxSlotMap.get(d)||this._stickyContainerAdsApplied||this._rebuildSlot(c)})})}_setParallaxSlotCSS(b,c){b.classList.add("adthrive-parallax-slot");
c&&c.classList.add("adthrive-parallax-ad")}_removeParallaxCSS(b){b.classList.remove("adthrive-parallax-slot");(b=b.firstChild)&&b.classList.remove("adthrive-parallax-ad")}_removeParallaxScrollEvent(b){(b=this._parallaxScrollEventOffMap.get(b.id))&&b()}_parallaxAdOnScroll(b){let c=Number(b.getBoundingClientRect().top)+window.pageYOffset,d=()=>{const e=b.firstChild?b.firstChild:void 0,f=this._isParallaxAd(b);var g=this._getScrollStartPosition(c<window.pageYOffset+window.innerHeight,b);g=.5*(window.pageYOffset-
c+g);e&&f&&(e.style.transform=`translateY(-${205<g?205:g}px)`)};this._parallaxScrollEventOffMap.set(b.id,this._pageManager.scroll.on(()=>d()))}_getScrollStartPosition(b,c){if(b)return this._slotScrollStartPosition.get(c.id)||this._scrollStartPosition;this._slotScrollStartPosition.get(c.id)!==this._scrollStartPosition&&this._slotScrollStartPosition.set(c.id,this._scrollStartPosition);return this._scrollStartPosition}_isParallaxAd(b){b=Pk(b);return 600<=b&&750>=b}_rebuildSlot(b){b.sizes=b.sizes.filter(c=>
600>c[1]);this._slotManager.rebuild(b);this._slotRebuildComplete.set(b.element.id,!0)}_checkParallaxAdVisibilityPercent(b,c){let d=new IntersectionObserver(e=>{e.forEach(f=>{const g=100*f.intersectionRatio,h=400/Pk(b)*100;2<h-g&&this._logParallaxAdError(b,c,"adVisibility",Math.floor(h-g));d.unobserve(f.target)})},{root:b});c&&d.observe(c)}_logParallaxAdError(b,c,d,e){A.error("ParallaxComponent","_logParallaxAdError",`parallax ad error: ${d}, visibility percent lost:`,e,`siteId: ${this._config.site.id}`,
`pageUrl: ${window.location.href}`,`containerId: ${b.id}`,`creativeId: ${null===c||void 0===c?void 0:c.id}`)}};Om=q([H(),v("ParallaxAdsComponent"),t("design:paramtypes",[V,Bd,Ra,ja,kg,Ua,N,Nm])],Om);let lg=class extends W{init(){this._key="Uid2TokenCleanup";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],lg.prototype,"run",null);lg=q([v("Uid2TokenCleanupExperiment"),y()],lg);let Pm=class extends T{constructor(b,
c){var d;super();this._config=b;this._uid2TokenCleanupExperiment=c;this._validExistingToken=!1;this._uid2TokenKeys=["__uid2_advertising_token","__uid2_server_token"];this._config.user.hash&&this._config.user.source&&(b=this._config.user.source.includes("td")&&this._config.user.source.endsWith("_s"),c=this._config.user.source.match(/^(?:l_i-l_i|l_i)$/),c=null!==c&&0<c.length,this._validExistingToken=null!==(d=b||c)&&void 0!==d?d:!1)}init(){this._config.uid2TokenCleanup.active=!0;try{this._uid2TokenKeys.forEach(b=>
{window.localStorage.getItem(b)&&this._cleanUpToken(b)})}catch(b){}}_cleanUpToken(b){window.localStorage.removeItem(b)}get enabled(){return this._validExistingToken&&this._uid2TokenCleanupExperiment.result}};Pm=q([v("Uid2TokenCleanupComponent"),H(),t("design:paramtypes",[N,lg])],Pm);let Qd=class{constructor(){this.contentAdded=new L}};Qd=q([v("InfiniteScrollEvents"),y()],Qd);let Qm=class extends T{constructor(b,c){super();this._config=b;this._events=c;this._ajaxSelector="#ajax-load-more";this._heightThreshold=
1E3;this._infiniteScrollElement=null}start(){this.detectInfiniteScroll()}detectInfiniteScroll(){this.checkForCustomConfig();let b=new MutationObserver((c,d)=>{c.filter(({type:e,addedNodes:f})=>"childList"===e&&0<f.length).reduce((e,{addedNodes:f})=>[...e,...Array.prototype.slice.call(f)],[]).filter(e=>e instanceof HTMLElement&&e.clientHeight>this._heightThreshold).forEach(e=>{e.parentElement&&(d.disconnect(),d.observe(e.parentElement,{childList:!0}),this._infiniteScrollElement&&d.observe(this._infiniteScrollElement,
{childList:!0,subtree:!0}));try{this._events.contentAdded.emit(e)}catch(f){A.error("InfiniteScrollDetectionComponent","addMutationObserver","added",f)}})});this._infiniteScrollElement?b.observe(this._infiniteScrollElement,{childList:!0,subtree:!0}):Array.prototype.slice.call(document.querySelectorAll("body *")).filter(c=>c instanceof HTMLElement&&c.offsetHeight>this._heightThreshold).forEach(c=>{b.observe(c,{childList:!0})})}checkForCustomConfig(){let {heightThreshold:b,selector:c}=this._config.adOptions.infiniteScrollOptions;
var d=c?document.querySelector(c):null;if(d)this._infiniteScrollElement=d;else if(d=document.querySelector(this._ajaxSelector))this._config.infiniteScroll.ajaxType=!0,this._infiniteScrollElement=d;b&&0<b&&(this._heightThreshold=b)}get enabled(){return this._config.adOptions.infiniteScroll&&"MutationObserver"in window}};Qm=q([v("InfiniteScrollDetectionComponent"),H(),t("design:paramtypes",[N,Qd])],Qm);let Rm=class extends bl{constructor(b,c){super(c);this._config=b;this._adInjectionMap=c;this._count=
1}getDynamicElementId(){return`${this._config.gam.prefix}_Infinite_${this._count++}`}};Rm=q([v("InfiniteScrollDynamicAdsInjector"),H(),t("design:paramtypes",[N,nc])],Rm);let Sm=class extends T{constructor(b,c,d,e,f){super();this._config=b;this._events=c;this._injector=d;this._slotManager=e;this._gam=f;this._page=1}init(){this._events.contentAdded.on(b=>{this._page++;this._config.context.pageviewKey=Dc();this._gam.setTargeting({key:"pvk",value:this._config.context.pageviewKey});this.slotsAlreadyInjectedInElement(b)||
this.addSlots(b)})}slotsAlreadyInjectedInElement(b){return!!b.querySelector("[id*='AdThrive_Content']")}addSlots(b){let c=this._config.dynamicAds.filter(d=>!(this._config.infiniteScroll.ajaxType&&"Sidebar"===d.location)).filter(d=>ue(this._config,d)).filter(d=>d.devices.includes(this._config.context.device)).filter(d=>0===d.pageSelector.length||null!==document.querySelector(d.pageSelector));b=this._injector.inject(c,b);this._slotManager.add(b).then(d=>{d.forEach(e=>{V.pushToQueue(()=>{e.setTargeting({key:"inf_scroll",
value:this._page.toString()})})})}).catch(d=>{A.error("InfiniteScrollDynamicAdsComponent","addSlots",d)})}get enabled(){return this._config.adOptions.infiniteScroll}};Sm=q([v("InfiniteScrollDynamicAdsComponent"),H(),t("design:paramtypes",[N,Qd,Rm,ja,V])],Sm);let Tm=class extends T{constructor(b,c,d,e){super();this._config=b;this._events=c;this._slotManager=d;this._slots=e;this._debounce=new ht(1E3)}start(){this._observer=this.getIntersectionObserver();this._events.contentAdded.on(b=>{this._observer&&
this._observer.observe(b)})}getIntersectionObserver(){return new IntersectionObserver(b=>{for(let c of b)0<c.intersectionRatio&&c.isIntersecting&&this._debounce.limit(c.target.id).then(()=>this.refresh()).catch(d=>{A.error("InfiniteScrollRefreshComponent","getIntersectionObserver","refresh",d)})},{threshold:[.08]})}refresh(){this._config.adOptions.infiniteScrollRefresh&&this._slots.get().filter(b=>this._config.infiniteScroll.refreshSlots.has(b.location)&&b.isSticky&&!b.isRefreshing).forEach(b=>{this._slotManager.updateRefreshTimeout(b,
1001)})}get enabled(){return this._config.adOptions.infiniteScroll&&"IntersectionObserver"in window}};Tm=q([v("InfiniteScrollRefreshComponent"),H(),t("design:paramtypes",[N,Qd,ja,Qa])],Tm);let Um=class extends T{constructor(b){super();this._googleAdManager=b}init(){this._googleAdManager.slotResponseReceived.on(({slot:b})=>{this.slotResponseReceived(b)})}slotResponseReceived(b){b.alwaysInView="Footer"===b.location||"Video_StickyOutstream"===b.location}};Um=q([v("AlwaysInViewComponent"),H(),t("design:paramtypes",
[V])],Um);let Vm=class extends T{constructor(b){super();this._slotManager=b;window.addEventListener("message",c=>{c&&c.data&&"set_adthrive_slot_timeout"===c.data.message&&c.data.slot_id&&0<=c.data.refresh_interval&&this._slotManager.updateRefreshTimeout(c.data.slot_id,c.data.refresh_interval)},!1)}};Vm=q([v("ChangeSlotRefreshComponent"),H(),t("design:paramtypes",[ja])],Vm);let Wm=class extends T{constructor(b,c,d){super();this._slotManager=b;this._slots=c;this._pageManager=d}init(){this._pageManager.visibilityChange.on(()=>
this.documentVisibilityChanged())}documentVisibilityChanged(){let b=document.visibilityState,c=this._slots.get();"visible"===b?this._slotManager.resumeRefresh(c):"hidden"===b&&this._slotManager.pauseRefresh(c)}};Wm=q([v("DocumentHiddenPauseRefreshComponent"),H(),t("design:paramtypes",[ja,Qa,Ra])],Wm);let Xm=class extends T{constructor(b,c){super();this._googleAdManager=b;this._slotManager=c;this._inViewPercentage=50}init(){this._googleAdManager.impressionViewable.on(({slot:b})=>{this.processImpressionViewable(b)});
this._googleAdManager.slotVisibilityChanged.on(({slot:b,event:c})=>{this.processVisibilityChanged(b,c)})}processImpressionViewable(b){b.outOfViewGPT=!1;this._slotManager.inView(b)}processVisibilityChanged(b,c){this.check(b,c.inViewPercentage)}check(b,c){c&&c>=this._inViewPercentage||"Video_StickyOutstream"===b.location?(b.outOfViewGPT=!1,this._slotManager.inView(b)):(b.outOfViewGPT=!0,this._slotManager.outOfView(b))}};Xm=q([v("ImpressionViewableRefreshComponent"),H(),t("design:paramtypes",[V,ja])],
Xm);let Ym=class extends T{constructor(b,c,d){super();this._googleAdManager=b;this._slotManager=c;this._slots=d;this._inViewPercentage=50;this._trackSlotEvents=new Map}init(){this._observer=this.getIntersectionObserver();this._googleAdManager.slotResponseReceived.on(({slot:b})=>{this.slotResponseReceived(b);this._trackSlotEvents.set(b.id,"slotResponseReceived")});this._googleAdManager.slotRenderEnded.on(({slot:b})=>{this.slotResponseReceived(b);this._trackSlotEvents.delete(b.id)});this._googleAdManager.slotRequested.on(({slot:b})=>
{this._trackSlotEvents.set(b.id,"slotRequested")});this._slotManager.refreshing.on(b=>{for(let c of b)this._trackSlotEvents.get(c.id)&&(this._slotManager.rebuild(c),this._trackSlotEvents.delete(c.id));this.refreshing(b)})}get enabled(){return"IntersectionObserver"in window}slotResponseReceived(b){this._observer&&b.element&&this._observer.observe(b.element)}refreshing(b){if(this._observer)for(let c of b)c.element&&this._observer.unobserve(c.element)}getIntersectionObserver(){return new IntersectionObserver(b=>
{for(let c of b)(b=this._slots.get(c.target.id))&&this.check(b,100*c.intersectionRatio)},{threshold:[0,this._inViewPercentage/100]})}check(b,c){c>=this._inViewPercentage||"Video_StickyOutstream"===b.location?(b.outOfViewIO=!1,this._slotManager.inView(b)):(b.outOfViewIO=!0,this._slotManager.outOfView(b))}};Ym=q([v("IntersectionObserverRefreshComponent"),H(),t("design:paramtypes",[V,ja,Qa])],Ym);let Zm=class extends W{init(){this._key="SlotResize";this._default=!1}};Zm=q([y()],Zm);let $m=class extends T{constructor(b,
c,d){super();this.slotResizeExperiment=d;this._slotSizeMap=new Map;this._gamSlotOnLoad=b.slotOnload;this._stickyContentEnabled=c.adOptions.stickyContentEnabled||!1}get enabled(){return this.slotResizeExperiment.result}start(){this._setupListeners()}_setupListeners(){this._gamSlotOnLoad.on(({slot:b})=>{"Content"===b.location&&this._compareSlot(b)})}_compareSlot(b){let c=this._slotSizeMap.get(b.id),d=getComputedStyle(b.element).height,e=Number(d.slice(0,-2));if(!c||c<e)this._resize(b.element,d),this._setSlotSizeMap(b.element.id,
e);this._stickyContentEnabled||this._align(b.element)}_resize(b,c){b.style.minHeight=c}_setSlotSizeMap(b,c){this._slotSizeMap.set(b,c)}_align(b){let {top:c,bottom:d}=b.getBoundingClientRect();b.style.alignContent=c<window.innerHeight-d?"end":"start"}};$m=q([H(),v("SlotResizeComponent"),t("design:paramtypes",[V,N,Zm])],$m);let an=b=>b.some(c=>null!==document.querySelector(c)),mg=class{constructor(b){this.stickyBlockedSelectors=[];this.stickyHeaderHeight=fl(b.adOptions.stickyHeaderSelectors);this.stickyBlockedSelectors=
b.adOptions.stickyBlockedSelectors||[]}logOverflow(b){(b=document.querySelector(b))&&se(b)}getStickyAdTopProperty(b){let {playerElement:c,topBackgroundElement:d,collapseMobileSubType:e,mobileHeaderSelector:f}=b;if("adthrive-collapse-bottom-left"===e||"adthrive-collapse-bottom-right"===e)return this.stickyHeaderHeight;b=d?Number(d.getBoundingClientRect().height):Number(c.getBoundingClientRect().height);let g=fl([f?f:""]);return g?Number(g)+b:b}};mg=q([v("StickyContainerAdsUtil"),H(),t("design:paramtypes",
[N])],mg);let ng=class extends W{init(){this._key="DetectOverlappingHeader";this._default=!1}};ng=q([v("DetectOverlappingHeaderExperiment"),y()],ng);let og=class extends W{init(){this._key="StickyContainerAdsTopCenterVideoDependency";this._default=!1}isEnabled(){return super.isEnabled()&&ca()}};og=q([H(),v("StickyContainerAdsTopCenterVideoDependencyExperiment")],og);let sr=(b,c=!1)=>{let d=Infinity,e=null;for(let h=0;h<b.length;h++){const k=b[h];if(!c||"fixed"===window.getComputedStyle(k).getPropertyValue("position")){const m=
k.getBoundingClientRect();var f=k,g=m;const n="hidden"===getComputedStyle(f).visibility;f="none"===getComputedStyle(f).display;0<g.height&&0<g.width&&!n&&!f&&m.top<d&&(d=m.top,e=k)}}return e},bn=class{constructor(b,c,d){this._googleAdManager=b;this._pageManager=c;this._topMostElement=null;this._slots={};this._scrollListener=[];this._hasFired=!1;this._slot={slot:null,element:null};d.result&&(this._topMostElement=sr(Array.from(document.body.querySelectorAll("*")),!0))&&this._addContentSlotListeners()}_addContentSlotListeners(){this._addScrollListener();
this._googleAdManager.slotVisibilityChanged.on(({slot:b})=>{if(-1<b.element.id.indexOf("AdThrive_Content")&&!b.outOfViewGPT&&(this._slots[b.id]=b,this._slot.element||(this._slot={slot:b,element:b.element.firstChild||b.element}),this._slot.element)){let c=sr([this._slot.element,b.element]);(null===c||void 0===c?void 0:c.id)!==b.element.id&&(this._slot={slot:b,element:b.element.firstChild||b.element})}})}_addScrollListener(){let b=0;this._scrollListener.push(this._pageManager.scroll.on(()=>{b++;20<
b&&(b=0,this._topMostElement&&this._slot.slot&&this._shouldFireLogger(!1===this._slot.slot.outOfViewGPT)&&(this._hasFired=!0,this._scrollListener[0](),A.event("DetectOverlappingHeader","_addScrollListener","overlapped",Ac(this._topMostElement))))}))}_shouldFireLogger(b){if(b=!this._hasFired&&b&&this._topMostElement&&this._slot.slot&&this._slot.element&&!this._adCreativeIsStuckToBottomOfContainer()){var c=this._topMostElement;b=this._slot.element.getBoundingClientRect();c=c.getBoundingClientRect();
b=!(b.right<c.left||b.left>c.right||b.bottom<c.top||b.top>c.bottom)}return!!b}_adCreativeIsStuckToBottomOfContainer(){var b;let c=this._slot.element,d=null===(b=this._slot.element)||void 0===b?void 0:b.parentElement;return c&&d?Math.round(c.getBoundingClientRect().bottom)===Math.round(d.getBoundingClientRect().bottom):!1}};bn=q([v("DetectOverlappingHeader"),H(),t("design:paramtypes",[V,Ra,ng])],bn);let cn=class extends T{constructor(b,c,d,e,f,g,h,k){super();this._videoEventBus=c;this._stickyContainerAdEventBus=
d;this._stickyContainerAdsExperiment=e;this._gam=f;this._pageManager=g;this._detectOverlappingHeaderExperiment=h;this._stickyContainerTopCenterVideoDependencyExperiment=k;this._stickyContentEnabled=this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerAdsExperimentResult=!1;this._detectOverlappingHeader={};this._stickyContainerAdsUtil=new mg(b);this._stickyContentHeight=b.adOptions.stickyContentHeight;this._stickyContainerAdsExperimentResult=this._stickyContainerAdsExperiment.result;
this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result;this._stickyContentEnabled=b.adOptions.stickyContentEnabled||!1}get enabled(){return this._stickyContentEnabled&&this._stickyContainerAdsExperimentResult&&!an(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS();this._stickyContainerAdsUtil.logOverflow(".adthrive-sticky-container");this._stickyContainerAdEventBus.stickyContainerContentAdStylingApplied.emit();
this._detectOverlappingHeader=new bn(this._gam,this._pageManager,this._detectOverlappingHeaderExperiment)}setCSS(){var b=this._stickyContentHeight;Ab(`
  .adthrive-device-phone .adthrive-sticky-content {
    height: 450px !important;
    margin-bottom: 100px !important;
  }
  .adthrive-content.adthrive-sticky {
    position: -webkit-sticky;
    position: sticky !important;
    top: 42px !important;
    margin-top: 42px !important;
  }
  .adthrive-content.adthrive-sticky:after {
    content: "\u2014 Advertisement. Scroll down to continue. \u2014";
    font-size: 10pt;
    margin-top: 5px;
    margin-bottom: 5px;
    display:block;
    color: #888;
  }
  .adthrive-sticky-container {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height:${b?b:400}px !important;
    margin: 10px 0 10px 0;
    background-color: #FAFAFA;
    padding-bottom:0px;
  }
  `);dl(this._stickyContainerAdsUtil.stickyHeaderHeight);this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on(b=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(b));dl(this._stickyAdTopProperty)});this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{dl(this._stickyContainerAdsUtil.stickyHeaderHeight)})}};cn=q([v("StickyContainerContentAdsComponent"),
H(),t("design:paramtypes",[N,Ua,kg,Df,V,Ra,ng,og])],cn);let dn=class extends T{constructor(b,c,d,e){super();this._videoEventBus=c;this._stickyContainerRecipeExperiment=d;this._stickyContainerTopCenterVideoDependencyExperiment=e;this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerRecipeExperimentResult=!1;this._stickyContainerAdsUtil=new mg(b);this._stickyRecipeHeight=b.adOptions.stickyRecipeHeight;this._stickyContainerRecipeExperimentResult=this._stickyContainerRecipeExperiment.result;
this._stickyContainerTopCenterVideoDependencyExperimentResult=this._stickyContainerTopCenterVideoDependencyExperiment.result}get enabled(){return this._stickyContainerRecipeExperimentResult&&!an(this._stickyContainerAdsUtil.stickyBlockedSelectors)}start(){this.setCSS();this._stickyContainerAdsUtil.logOverflow(".adthrive-recipe-sticky-container")}setCSS(){var b=this._stickyRecipeHeight;Ab(`
  .adthrive-recipe.adthrive-sticky {
    position: -webkit-sticky;
    position: sticky !important;
    top: 42px !important;
    margin-top: 42px !important;
  }
  .adthrive-recipe-sticky-container {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    min-height:${b?b:400}px !important;
    margin: 10px 0 10px 0;
    background-color: #FAFAFA;
    padding-bottom:0px;
  }
  `);el(this._stickyContainerAdsUtil.stickyHeaderHeight);this._stickyContainerTopCenterVideoDependencyExperimentResult&&this.addListeners()}addListeners(){this._videoEventBus.topCenterVideoCollapsed.on(b=>{this._stickyAdTopProperty||(this._stickyAdTopProperty=this._stickyContainerAdsUtil.getStickyAdTopProperty(b));el(this._stickyAdTopProperty)});this._videoEventBus.topCenterVideoUnCollapsed.on(()=>{el(this._stickyContainerAdsUtil.stickyHeaderHeight)})}};dn=q([v("StickyContainerRecipeAdsComponent"),
H(),t("design:paramtypes",[N,Ua,Nc,og])],dn);let Tv=b=>{const c=encodeURIComponent(location.href),d=`https://${"ads.adthrive.com"}/api/v1/marmalade?siteid=${b}&url=${c}&experiments=recencyFrequency`;return fetch?fetch(d).then(e=>e.json()).catch(e=>{A.error("getMarmaladeData","Unable to get marmalade data. Error:",e);return null}):new Promise(e=>{const f=new XMLHttpRequest;f.onload=()=>{200===f.status&&e(f.response)};f.open("GET",d,!0);f.responseType="json";f.send()})},en=class extends T{constructor(b,
c,d){super();this._spaEventBus=b;this._marmaladeEventBus=c;this._config=d;this._siteId=this._config.site.id}init(){this._spaEventBus.routeChanged.on(async()=>{let b=await Tv(this._siteId);b&&(this._config.marmalade=new Ye(b,this._marmaladeEventBus),this._marmaladeEventBus.marmaladeResponseLoaded.emit(b))})}get enabled(){return!0}};en=q([v("SPAMarmaladeComponent"),H(),t("design:paramtypes",[Pa,ob,N])],en);let fn=class extends T{constructor(b,c,d){super();this._gdprEnforcement=b;this.gppComponent=c;
this._config=d;this._cb=null;this._facebookVendorId=20089;this._fbEventsUrlPattern=/connect\.facebook\.net\/en_US\/fbevents.js/;this._userInteractionEvents=["mousemove","keydown","touchstart","wheel"];this._consent="revoke";this._throttleInterval=500}init(){this.checkGPPConsentForFacebook();this._config.gdpr.enabled&&this._gdprEnforcement.checkConsentOnLoad().then(b=>{b&&b.tcString?this.checkGDPRConsentForFacebook():this.listenForUserActionComplete()}).catch(()=>{})}checkGPPConsentForFacebook(){this.gppComponent.enabled&&
(this._consent=this.gppComponent.gpcEnabled?"revoke":"grant",this._config.ccpa.consentChange.on(b=>{this._consent=b!==this.gppComponent.ccpaOptOut?"grant":"revoke";this.handleFacebookPixelConsent()}),this.handleFacebookPixelConsent())}checkGDPRConsentForFacebook(){this._gdprEnforcement.checkConsentForVendor(this._facebookVendorId,[1]).then(b=>{this._consent=b?"grant":"revoke";this.handleFacebookPixelConsent()}).catch(()=>{})}listenForUserActionComplete(){window.__tcfapi("addEventListener",2,(b,c)=>
{c&&b&&"useractioncomplete"===b.eventStatus&&this.checkGDPRConsentForFacebook()})}checkFBEventsJSExists(){return Array.from(document.querySelectorAll("head > script:not([src]), body > script:not([src])")).some(b=>this._fbEventsUrlPattern.test(b.innerHTML))}removeUserInteractionListeners(){this._cb&&(this._userInteractionEvents.forEach(b=>window.removeEventListener(b,this._cb)),this._cb=null)}addUserInteractionListeners(b){this._cb=Zc(()=>{b()&&this.removeUserInteractionListeners()},this._throttleInterval,
{leading:!1});this._userInteractionEvents.forEach(c=>window.addEventListener(c,this._cb))}handleFacebookPixelConsent(){window.fbq&&"function"===typeof window.fbq?(window.fbq("consent",this._consent),this.removeUserInteractionListeners()):!this._cb&&this.checkFBEventsJSExists()&&this.addUserInteractionListeners(this.handleFacebookPixelConsent.bind(this))}get enabled(){return this._config.gdpr.enabled||this.gppComponent.enabled}};fn=q([v("FacebookPixelComponent"),H(),t("design:paramtypes",[mc,Jf,N])],
fn);let gn=class extends W{init(){this._key="SlickstreamAdUnits";this._default=!1}};gn=q([v("SlickstreamAdsExperiment"),y()],gn);let tr=(b,c,d=0)=>{const e=[];for(let f=0;f<c;f++)e.push({...b,sequence:d+f});return e},hn=class extends bl{constructor(b,c){super(c);this._config=b;this._adInjectionMap=c;this._count=0}injectSlickstreamAdSlots(b,c=document,d){let e=[];c=Gf(".slick-search-ad-slot div",c);this._count=d+1;b=tr(b,c.length,this._count).map(k=>{k.lazy=!0;return k});for(d=0;d<c.length;d++){var f=
c.item(d);let k=b[d],m=`${k.location}_${k.sequence}`;if(!e.some(n=>n.name===m)){var g=this.getDynamicElementId(),h=`adthrive-${k.location.replace("_","-").toLowerCase()}`;h=[h,`${h}-${k.sequence}`,...k.classNames,"adthrive-slicksearch"];if(f=Ff(f,g,k.position,h,k.location))g=this._filterAdUnitSizes(k,f),g.length&&(e.push(Hd(k,f,g,!1)),this._count++)}}return e}getDynamicElementId(){return`${this._config.gam.prefix}_Content_${this._count}_${this._config.context.device}`}};hn=q([v("SlickstreamAdsInjector"),
H(),t("design:paramtypes",[N,nc])],hn);let jn=class extends T{constructor(b,c,d,e){super();this._config=b;this._injector=c;this._slotManager=d;this._slickstreamAdsExperiment=e;this._slickstreamAdSlots=[];this._contentSlotsCount=0}get enabled(){return this._slickstreamAdsExperiment.result}init(){document.addEventListener("slick-search-panel-show",()=>{let b=document.querySelector("slick-search-panel");b&&!this.slotsAlreadyInjectedInElement(b)&&this._addSlots(b)});document.addEventListener("slick-search-panel-hide",
()=>{0<this._slickstreamAdSlots.length&&this._removeSlots()});this._slotManager.added.on(b=>{for(let c of b)"Content"===c.location&&this._contentSlotsCount++})}_addSlots(b){let c=this._config.dynamicAds.filter(d=>"Content"===d.location).filter(d=>ue(this._config,d)).filter(d=>d.devices.includes(this._config.context.device));0<c.length&&(b=this._injector.injectSlickstreamAdSlots(c[0],b,this._contentSlotsCount),this._slotManager.add(b).then(d=>{d.forEach(e=>{this._slickstreamAdSlots.push(e);V.pushToQueue(()=>
{e.setTargeting({key:"slicksearch",value:"true"});e.setSlotTargetingFlag("slicksearch",["true"])})})}).catch(d=>{A.error("SlickstreamAdsComponent","_addSlots",d)}))}_removeSlots(){this._slotManager.destroy(this._slickstreamAdSlots);this._slotManager.removeElement(this._slickstreamAdSlots);this._contentSlotsCount-=this._slickstreamAdSlots.length;this._slickstreamAdSlots.length=0}slotsAlreadyInjectedInElement(b){return!!b.querySelector("[id*='AdThrive_Content']")}};jn=q([v("SlickstreamAdsComponent"),
H(),t("design:paramtypes",[N,hn,ja,gn])],jn);let pg=class extends Ch{constructor(b,c,d,e){var f;super();this._siteExperiments=b;this._pubabgroup=c;this._clsOptions=d;this._choices=[];this._mappedChoices=[];this._result="";this.key=bb.AdLayout;this._resultValidator=g=>{if("string"!==typeof g)return!1;g=g.startsWith(".")?g.substring(1):g;return/^[-_a-zA-Z]+[-_a-zA-Z0-9]*$/.test(g)};(null===(f=e.siteAds)||void 0===f?0:f.siteExperiments)?this.experimentConfig=(new Dh(e.siteAds)).getSiteExperimentByKey(this.key):
this.experimentConfig=this._siteExperiments.getSiteExperimentByKey(this.key);b=this._clsOptions.getWeightedChoiceExperiment(this.key,!0);this.enabled&&this._isValidResult(b)?(this._result=b,this.setExperimentTargeting()):this.enabled&&this.experimentConfig&&(this._choices=this.experimentConfig.variants,this._mappedChoices=this._mapChoices(),this._result=this.run(),this.setExperimentTargeting())}run(){if(!this.enabled)return A.error("AdLayoutSiteExperiment","run","() => %o","No experiment config found. Defaulting to empty class name."),
"";let b=(new Ec(this._mappedChoices)).get();if(this._isValidResult(b))return b;A.error("AdLayoutSiteExperiment","run","() => %o","Invalid result from experiment choices. Defaulting to empty class name for result",b);return""}setExperimentTargeting(){if(this.enabled&&this._isValidResult(this._result)){var b=this.experimentConfig;b=`${b.key.toLowerCase()}-${b.id}`;this._pubabgroup.set(b,this._result)}else A.error("AdLayoutSiteExperiment","setExperimentTargeting","() => %o","Experiment targeting requires an experiment config and valid result")}_mapChoices(){return this._choices.map(({weight:b,
value:c})=>({weight:b,choice:c}))}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],pg.prototype,"run",null);pg=q([y(),ha(3,fa("AdthriveCLS")),t("design:paramtypes",[vb,pb,Kc,Object])],pg);let kn=class extends T{constructor(b){super();this._adLayoutSiteExperiment=b}get enabled(){return this._adLayoutSiteExperiment.enabled}init(){let b=this._adLayoutSiteExperiment.result,c=b.startsWith(".")?b.substring(1):b;if(/^[-_a-zA-Z]+[-_a-zA-Z0-9]*$/.test(c))try{document.body.classList.add(c)}catch(d){A.error("AdLayoutComponent",
"init",`Uncaught CSS Class Name error: ${d}`)}else A.error("AdLayoutComponent","init",`Invalid class name: ${b}`)}};kn=q([v("AdLayoutComponent"),H(),t("design:paramtypes",[pg])],kn);let ln=class extends T{constructor(b){super();this._footerConfigEventBus=b}init(){this._footerConfigEventBus.comscoreInitialized.on(b=>{b&&this._footerConfigEventBus.footerElementAdded.emit({order:2,element:"<span>A Raptive Partner Site</span>"})},{handleEventsAlreadyEmitted:!0})}};ln=q([H(),t("design:paramtypes",[nd])],
ln);let mn=class extends T{constructor(b){super();this._slotManager=b}init(){this._slotManager.added.on(b=>{b.forEach(c=>{c.element.classList.add("adthrive-ad-debug");c.element.addEventListener("click",()=>{console.warn(`%c Debug Info for ${c.id}`,"background: #6B65FF; color: #F0EDEB; padding: 1px; border-radius: 3px;",c)})})})}get enabled(){let b=(new URLSearchParams(window.location.search)).get("at_ui_debug");return"true"===b||"1"===b}};mn=q([v("UIDebugComponent"),y(),t("design:paramtypes",[ja])],
mn);let qg=class extends W{init(){this._key="PageRefreshMonitorExperiment";this._default=!1}run(){return super.run()}};q([ea(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],qg.prototype,"run",null);qg=q([v("PageRefreshMonitorExperiment"),y()],qg);let nn=class extends T{constructor(b,c,d){super();this._pageRefreshMonitorExperiment=b;this.pageviewKey=c;this.pageManager=d}get enabled(){return this._pageRefreshMonitorExperiment.result}start(){var b,c=sessionStorage.getItem("previousUrl");
let d=sessionStorage.getItem("previousPVK"),e=sessionStorage.getItem("previousPageHide"),f=sessionStorage.getItem("previousUnload"),g=sessionStorage.getItem("previousBeforeUnload");this.pageManager.beforeUnload.on(()=>{sessionStorage.setItem("previousBeforeUnload","true")});window.addEventListener("unload",()=>{sessionStorage.setItem("previousUnload","true")});this.pageManager.pageHide.on(()=>{sessionStorage.setItem("previousPageHide","true")});let h=(new Date).toISOString();c&&c===window.location.href&&
(c=sessionStorage.getItem("previousLoadTime"),A.event("PageRefreshMonitor","refresh",{timeSinceLastLoad:c?new Date(h)-new Date(c):void 0,navigationType:null===(b=performance.getEntriesByType("navigation")[0])||void 0===b?void 0:b.type,legacyNavigationType:window.performance.navigation.type,previousPVK:d,previousPageHide:e,previousUnload:f,previousBeforeUnload:g}));sessionStorage.setItem("previousUrl",window.location.href);sessionStorage.setItem("previousLoadTime",h);sessionStorage.setItem("previousPVK",
this.pageviewKey);sessionStorage.setItem("previousPageHide","false");sessionStorage.setItem("previousUnload","false");sessionStorage.setItem("previousBeforeUnload","false")}};nn=q([H(),ha(1,fa("PageviewKey")),t("design:paramtypes",[qg,String,Ra])],nn);class Uv{constructor(){this._clsOptions=new Kc;this.shouldUseCoreExperimentsConfig=!1}setExperimentKey(b=!1){this._clsOptions.setExperiment(this.abgroup,this.result,b)}}let ur=class extends Uv{constructor(b){super();this._result=!1;this.key="ParallaxAdsExperiment";
this.abgroup="parallax";this._choices=[{choice:!0},{choice:!1}];this.weight=.5;ca()&&b.largeFormatsMobile&&(this._result=this.run(),this.setExperimentKey())}get result(){return this._result}run(){return(new Ha(this.weight)).get()}};ur=q([v("ParallaxAdsExperiment"),t("design:paramtypes",[Object])],ur);let Vv=(b,c)=>{const d=lp(c),e=b.sticky&&"Sidebar"===b.location;return b.sizes.filter(f=>{const g=e?f[1]<=window.innerHeight-100:!0;return(b.autosize?f[0]<=d||320>=f[0]:!0)&&g})},on=class extends X{init(){this._key=
"DynamicSidebarSlotsCap"}};on=q([v("DynamicSidebarSlotsCapExperiment"),y()],on);let Wv=(b,c,d=1200,e=25)=>{if(c.hasChildNodes()){var f=c.lastChild;f instanceof HTMLElement?c=f.offsetTop+f.offsetHeight:f instanceof Text?c=(f=f.previousElementSibling)?f.offsetTop+f.offsetHeight:c.offsetTop:(A.error("util","determineSidebar9ElementTop","Could not determine the top of the sidebar9 child element"),c=c.offsetTop)}else c=c.offsetTop;return Math.min(Math.floor((b-c)/(d+10)),e)},pn=class extends T{constructor(b,
c,d,e){super();this._config=b;this._slotManager=c;this._dynamicSidebarSlotsCapExperiment=d;this._essaExperiment=e}get enabled(){return!an(this._config.adOptions.dynamicStickySidebarBlockedSelectors||[])&&!!this._config.adOptions.dynamicStickySidebarEnabled&&this._essaExperiment.result}start(){var b=this._config.dynamicAds.filter(c=>"Sidebar"===c.location).filter(c=>9===c.sequence).filter(c=>ue(this._config,c)).filter(c=>c.devices.includes(this._config.context.device)).filter(c=>0===c.pageSelector.length||
null!==document.querySelector(c.pageSelector))[0];b&&(b=this.insertDynamicStickySidebarAds(b),this._slotManager.add(b))}updateStylingForExistingStickySidebarAd(b){b=this.getDynamicElementId(b);b=document.getElementById(b);null===b||void 0===b?void 0:b.classList.add("adthrive-sticky-sidebar")}getSidebarElement(b){return Gf(b.elementSelector,document).item(b.skip)}insertDynamicStickySidebarAds(b){let c=[],d=Gf(b.elementSelector,document).item(b.skip);if(null===d)return c;let e=this.repeatDynamicStickySidebar(b).filter(h=>
null===document.querySelector(`#${this.getDynamicElementId(h)}`));if(2>e.length)return c;this.updateStylingForExistingStickySidebarAd(b);for(let h=0;h<e.length;h++){let k=e[h],m=`${k.location}_${k.sequence}`;if(c.some(p=>p.name===m))continue;var f=this.getDynamicElementId(k),g=Hf(k);let n=$k(k);g=[h!==e.length-1?"adthrive-sticky-sidebar":"",g,n,...k.classNames];if(f=Ff(d,f,k.position,g,b.location))g=Vv(k,f),g.length&&c.push(Hd(k,f,g,!1))}return c}getSidebarSlotHeight(){let b=this._config.adOptions.dynamicStickySidebarHeight;
return 0===b||void 0===b?(A.error("EnhancedStickySidebarComponent","_getSidebarSlotHeight","Dynamic sticky sidebar height is not set in config"),1800):b}calculateNumberOfDynamicStickySidebars(b){var c;let d=this.getSidebarElement(b);if(!d)return 0;let e=this.getSidebarSlotHeight();b=b.stickyOverlapSelector?(null===(c=document.querySelector(b.stickyOverlapSelector))||void 0===c?void 0:c.offsetTop)||document.body.scrollHeight:document.body.scrollHeight;return Wv(b,d,e,this._dynamicSidebarSlotsCapExperiment.result||
0)}repeatDynamicStickySidebar(b){if("Sidebar"!==b.location||9!==b.sequence||!b.sticky)return[b];let c=this.calculateNumberOfDynamicStickySidebars(b);return tr(b,c,9).map(d=>{9!==d.sequence&&(d.lazy=!0);return d})}getDynamicElementId(b){return`${this._config.gam.prefix}_${b.location}_${b.sequence}_${this._config.context.device}`}};pn=q([v("EnhancedStickySidebarComponent"),H(),t("design:paramtypes",[N,ja,on,Nf])],pn);let qn=class extends W{init(){this._key="INPExperiment";this._default=!1}};qn=q([v("INPExperiment"),
y()],qn);var Rd;(function(b){b.good="good";b.needsImprovement="needs improvement";b.poor="poor"})(Rd||(Rd={}));let rn=class extends T{constructor(b,c,d){super();this._pageManager=b;this._loggerEventBus=c;this._inpExperiment=d;this._existingInteractions=new Map;this._lengthOfCurrentLogRequest=this._currentContextualDataSize=this._maxCharsAvailableInSendEvent=this._totalInteractionEvents=0;this._logData={INPData:[]}}init(){this._observer=this._createPerformanceObserver();this._observer.observe({type:"event",
buffered:!0,durationThreshold:0});this._pageManager.pageHide.on(()=>{this._logINPEventsData();this._logINPCounts()});this._currentContextualDataSize=encodeURIComponent(JSON.stringify(A.data)).length;this._setMaxCharsAvailableToLog();this._loggerEventBus.newContextDataEncodingSize.on(b=>this._updateCharLimits(b))}_createPerformanceObserver(){return new PerformanceObserver(b=>{b.getEntries().forEach(c=>{this._isEntryPerformanceEventTimingType(c)&&this._hasNonZeroInteractionId(c)&&this._processEntry(c)})})}_processEntry(b){let c=
b.interactionId;b=this._getInteractionEventInfo(b);let d=this._existingInteractions.get(c);(!d||b.inp>d.maxINP)&&this._updateINPForInteraction(c,b);this._updateINPLog({...b,interactionId:c});this._totalInteractionEvents++}_isEntryPerformanceEventTimingType(b){return"event"===b.entryType}_hasNonZeroInteractionId(b){return!!b.interactionId&&0!==b.interactionId}_getInteractionEventInfo(b){let c=b.duration,d=b.startTime,e=b.processingStart,f=b.processingEnd;return{inp:c,startTime:d,startDelay:e-d,processingStart:e,
processingEnd:f,processingTime:f-e,...this._getTargetIdentifiers(b.target),qualitativeScore:this._getQualitativeINPScore(c),eventType:b.name}}_updateINPForInteraction(b,c){this._existingInteractions.set(b,{maxINP:c.inp,qualitativeScore:c.qualitativeScore})}_setMaxCharsAvailableToLog(){let b=A.buildRequestUrl("event","INPComponent","_logINPEventsData",[]).length,c=this._calculateCharsOfEncodedDataObject(this._logData)+this._calculateCharsFromEncodedCommas(1);this._maxCharsAvailableInSendEvent=A.maxCloudFrontUrlSize-
b-c}_updateCharLimits(b){let c=this._maxCharsAvailableInSendEvent;this._maxCharsAvailableInSendEvent+=this._currentContextualDataSize-b;this._currentContextualDataSize=b;this._maxCharsAvailableInSendEvent<c&&this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent&&this._saveExcessEventsAndLogRemaining()}_saveExcessEventsAndLogRemaining(){let b=[];for(;this._lengthOfCurrentLogRequest>=this._maxCharsAvailableInSendEvent;){var c=this._logData.INPData.pop();c&&(b.push(c),c=this._countAdditionalEncodedChars(c),
this._lengthOfCurrentLogRequest-=c)}b.forEach(d=>this._updateINPLog(d))}_countAdditionalEncodedChars(b){let c=!!this._logData.INPData.length;return this._calculateCharsOfEncodedDataObject(b)+(c?this._calculateCharsFromEncodedCommas(1):0)}_updateINPLog(b){let c=this._countAdditionalEncodedChars(b);c+this._lengthOfCurrentLogRequest>this._maxCharsAvailableInSendEvent&&(this._logINPEventsData(),this._clearLogData(),this._lengthOfCurrentLogRequest=0);this._addINPData(b);this._lengthOfCurrentLogRequest+=
c}_addINPData(b){this._logData.INPData.push(b)}_logINPEventsData(){A.event("INPComponent","_logINPEventsData",this._logData)}_logINPCounts(){let b=-Infinity;for(let [,c]of this._existingInteractions.entries())c.maxINP>b&&(b=c.maxINP);A.event("INPComponent","_logINPCounts",{...this._getNumberOfEventsAndInteractions(),maxINP:b})}_clearLogData(){this._logData.INPData.length=0}_calculateCharsOfEncodedDataObject(b){return encodeURIComponent(JSON.stringify(b)).length}_calculateCharsFromEncodedCommas(b){return b*
encodeURIComponent(",").length}_getTargetIdentifiers(b){let c={nodeIdentifier:"",innerText:""};if(b instanceof HTMLElement)return c.nodeIdentifier=Ac(b),c.innerText=b.innerText&&300>b.innerText.length?b.innerText:"",c;b instanceof Node&&(c.nodeIdentifier=`node:${b.nodeName}`);return c}_getQualitativeINPScore(b){return 200>=b?Rd.good:500>=b?Rd.needsImprovement:Rd.poor}_getNumberOfEventsAndInteractions(){return{totalInteractions:this._existingInteractions.size,totalInteractionEvents:this._totalInteractionEvents}}get enabled(){return"PerformanceObserver"in
window&&PerformanceObserver&&PerformanceObserver.supportedEntryTypes.includes("event")&&"interactionId"in PerformanceEventTiming.prototype&&this._inpExperiment.result}};rn=q([v("INPComponent"),H(),t("design:paramtypes",[Ra,ed,qn])],rn);let sn=class{constructor(b,c,d,e,f,g,h,k,m,n,p,r,w,z,x,B,E,C,I,F,O,R,J,aa,qa,za,Ea,Ib,Jb,Ba,Sa,Kb,db,fc,Zi,$i,Mc,aj,bj,cj,Dd,kf,dj,Rb,Xv,Yv,Zv,$v,aw,bw,cw,dw,ew,fw,gw,hw,iw,jw,vr,kw,lw,mw,wr,nw,ow,pw,qw,rw,sw,tw,uw,vw,ww){this._config=b;this._components=[c,d,e,f,g,
h,k,m,n,p,r,w,z,x,B,E,uw,C,I,F,O,R,J,aa,qa,za,Ea,Jb,Ba,Ib,Sa,Kb,db,fc,Zi,$i,aj,Mc,bj,cj,Dd,kf,dj,Rb,Xv,Yv,Zv,$v,aw,cw,dw,ew,fw,bw,gw,hw,iw,jw,vr,kw,lw,wr,mw,nw,ow,pw,qw,rw,sw,tw,vw,ww];this._nonCCPAComponents=[C,Dd,kf,vr,wr]}init(){let b=this._config.ccpa;this._components.filter(c=>!b.enabled||b.enabled&&!this._nonCCPAComponents.includes(c)).forEach(c=>void 0!==c.init&&c.enabled&&c.init())}start(){this._components.forEach(b=>void 0!==b.start&&b.enabled&&b.start())}};sn=q([v("Components"),H(),t("design:paramtypes",
[N,Qk,Rk,Um,Tk,Uk,Bf,Vm,zl,ln,qj,Xk,Yk,Wk,Zk,Wm,If,xl,gl,fn,hl,of,pl,ql,Dl,Jf,rl,sl,rj,El,Xm,Qm,Sm,Tm,Ym,wl,jg,sj,Gl,Hl,sf,uj,Jl,Kl,Ul,Vl,Wl,Xl,$l,$m,nn,Yl,Zl,en,Of,cn,dn,vj,wj,am,Pm,Nk,Pc,bm,Dm,ig,jn,Om,kn,lf,pn,mn,rn])],sn);Ab(".adthrive-ad{clear:both;line-height:0;margin-bottom:10px;margin-top:10px;overflow-x:visible;text-align:center}.adthrive-ad-cls{align-items:center;display:flex;flex-wrap:wrap;justify-content:center}.adthrive-ad-cls>div,.adthrive-ad-cls>iframe{flex-basis:100%}.adthrive-interstitial{margin-bottom:0;margin-top:0}.adthrive-native-recipe{display:inline-block}.adthrive-recipe{min-width:300px;position:relative;z-index:1}.adthrive-device-desktop .adthrive-recipe,.adthrive-device-tablet .adthrive-recipe{max-width:320px}.adthrive-stuck.adthrive-sticky.adthrive-header,.adthrive-stuck.adthrive-sticky.adthrive-sidebar{position:fixed;top:0;z-index:9999}.adthrive-stuck.adthrive-header{margin-top:0}.adthrive-stuck.adthrive-sticky-outstream{display:none;overflow:hidden;position:fixed;z-index:2147483644}.adthrive-sticky.adthrive-footer{background-color:hsla(0,0%,100%,.8);border-top:2px solid hsla(0,0%,88%,.8);bottom:0;box-sizing:content-box;left:0;margin:0;max-height:100px;overflow:hidden;position:fixed;text-align:center;width:100%;z-index:1000001}.adthrive-sticky.adthrive-footer>.adthrive-close{background:#fff;border:1px solid #b2b2b2;border-radius:20px;color:#b2b2b2;cursor:pointer;display:inline-block;font-family:arial,sans-serif;font-size:20px;line-height:20px;padding:0 5px;position:absolute;right:5px;top:5px}.adthrive-device-desktop .adthrive-sticky.adthrive-footer>.adthrive-close{right:10px;top:10px}.adthrive-ccpa-link,.adthrive-footer-message,.adthrive-privacy-preferences{margin-top:5px;text-align:center}.adthrive-footer>div,.adthrive-header>div{max-width:1200px}#next-video,#stay-video{background-color:#333;color:#fff;cursor:pointer;height:40px;line-height:40px;margin:10px;opacity:.9;text-align:center;width:100px}#next-video{box-shadow:inset 0 0 0 0 #333;transition:box-shadow 5s linear}#next-stay-container.loaded #next-video{box-shadow:inset 100px 0 0 0 red}.adthrive-collapse-mobile #next-video,.adthrive-collapse-mobile #stay-video,.adthrive-player-position-mobile #next-video,.adthrive-player-position-mobile #stay-video,.jw-flag-small-player #next-video,.jw-flag-small-player #stay-video{height:30px;line-height:30px;width:75px}#next-stay-container{bottom:25%;margin:12px;position:absolute;right:0}.adthrive-collapse-mobile #next-stay-container,.adthrive-player-position-mobile #next-stay-container,.jw-flag-small-player #next-stay-container{margin:0}.video-box-shadow{box-shadow:0 0 10px rgba(0,0,0,.5)}.adthrive-wrapper-bar{background-color:#595959;border-top-left-radius:5px;border-top-right-radius:5px;display:none;font-family:Arial,Helvetica,sans-serif;height:36px}.adthrive-video-title{color:#fff;font-size:13px;font-weight:700;text-decoration:none}.adthrive-wrapper-title-wrapper{align-items:center;display:inline-flex;justify-content:center;margin-left:10px;margin-right:10px;min-width:0}.adthrive-wrapper-title-wrapper>a>svg,.adthrive-wrapper-title-wrapper>div>svg{vertical-align:middle;fill:#fff;margin-right:5px}.adthrive-wrapper-title-wrapper>a{text-decoration:none}.adthrive-video-text-cutoff{color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.adthrive-collapse-player{border-bottom:1px solid #dbdbdb;border-top:1px solid #dbdbdb;margin-left:auto;margin-right:auto;padding:8px!important;width:90%}.adthrive-outstream-container{flex-basis:unset!important;margin:0 auto;position:relative}.adthrive-player-idle{display:none;transition:all .5s ease-out;transition-delay:.5s}.adthrive-player-ad-container-idle{display:none}.adthrive-player-playing{display:block;transition:all .5s ease-in;transition-delay:.5s}.adthrive-sticky-outstream-active.adthrive-new-outstream-player{animation-duration:.5s;animation-iteration-count:1;animation-name:adthrive-fade-in;animation-timing-function:ease-in;opacity:1}.adthrive-sticky-outstream-idle.adthrive-new-outstream-player{animation-duration:.5s;animation-iteration-count:1;animation-name:adthrive-fade-out;animation-timing-function:ease-out;display:block;opacity:0}@keyframes adthrive-fade-in{0%{opacity:0}to{opacity:1}}@keyframes adthrive-fade-out{0%{opacity:1}to{opacity:0}}.adthrive-player-ad-controls-play,.adthrive-player-ad-controls-volume{display:inline-block;margin-top:-8px;padding:8px 0 0}.adthrive-player-icon{cursor:pointer;display:inline-block;margin:0 10px!important}.adthrive-player-hidden,.adthrive-player-icon-hidden{display:none}.adthrive-player-icon svg{filter:drop-shadow(3px 5px 3px rgb(0 0 0/.5));pointer-events:none}.adthrive-player-ad-container{bottom:0;margin:0;position:absolute}.adthrive-player-ad-container-loading{align-items:center;background-color:#000;display:flex;height:100%;justify-content:center}#adthrive-auto-injected-loading-spinner,#adthrive-embedded-stationary-loading-spinner{animation:spin 1s ease-in-out infinite;-webkit-animation:spin 1s ease-in-out infinite;border:3px solid hsla(0,0%,100%,.3);border-radius:50%;border-top-color:#fff;display:none;height:50px;width:50px}#adthrive-title-overlay{background:rgba(0,0,0,.4);display:none;left:0;padding-top:10px;position:absolute;right:0;top:0;z-index:1}#adthrive-title-overlay.active{display:initial}.adthrive-collapse-mobile #adthrive-title-overlay{display:none}#adthrive-video-title-text{font-size:1.2rem}.adthrive-player-position-mobile #adthrive-video-title-text{font-size:.85em}#adthrive-video-description-text{font-size:1vw;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.adthrive-video-play-button{border-bottom:30px solid transparent;border-left:60px solid #fff;border-top:30px solid transparent;cursor:pointer;height:0;width:0;z-index:1}.adthrive-video-text{color:#fff;direction:unset;overflow:hidden;padding-bottom:.5em;padding-left:20px;padding-right:20px;text-overflow:ellipsis;white-space:nowrap;width:100%}#adthrive-auto-injected-loading-spinner.active,#adthrive-embedded-stationary-loading-spinner.active{display:inline-block}@keyframes spin{to{-webkit-transform:rotate(1turn)}}@-webkit-keyframes spin{to{-webkit-transform:rotate(1turn)}}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile .adthrive-player-ad-container{margin-bottom:2px;margin-top:2px}.adthrive-player-ad-controls{bottom:6px;height:26px;left:0;line-height:18px;padding:0;position:absolute;text-align:left;width:100%;z-index:1000000}.adthrive-player-volume-control{height:30px;left:6px;margin:0!important;position:absolute;top:-66px;transform:rotate(-90deg);width:100px;z-index:10000}.adthrive-player-volume-control input[type=range]{-webkit-appearance:none;background-color:#777;border:0;border-radius:20px;height:10px;margin:6px 6px 0;outline:0;overflow:hidden;padding:0;vertical-align:bottom;width:100px}.adthrive-player-volume-control input[type=range]::-webkit-slider-runnable-track{-webkit-appearance:none;color:#777;height:10px;margin-top:-1px}.adthrive-player-volume-control input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;background:#fff;border-radius:50%;box-shadow:-325px 0 0 320px #ccc,inset 0 0 0 40px #fff;cursor:pointer;height:10px;position:relative;width:10px}.adthrive-player-volume-control input[type=range]:active::-webkit-slider-thumb{background:#fff;box-shadow:-325px 0 0 320px #ddd,inset 0 0 0 3px #fff}.adthrive-player-volume-control input[type=range]::-moz-range-progress{background-color:#ddd;box-shadow:-325px 0 0 320px #ddd,inset 0 0 0 3px #ddd}.adthrive-player-volume-control input[type=range]::-moz-range-track{background-color:#777}.adthrive-player-volume-control input[type=range]::-ms-fill-lower{background-color:#ddd;box-shadow:-325px 0 0 320px #ddd,inset 0 0 0 3px #ddd}.adthrive-player-volume-control input[type=range]::-ms-fill-upper{background-color:#777}.adthrive-player-position{position:relative;transform:translateZ(0);will-change:transform}.adthrive-player-fixed-ratio{background-color:#000;padding-top:56.25%}.adthrive-player-video{height:100%;margin-block:0!important;position:absolute;top:0;width:100%}.adthrive-player-position.adthrive-collapse-float{height:169px;padding:unset;position:fixed;width:300px!important;z-index:2147483644}.adthrive-player-position.adthrive-collapse-float #adthrive-video-description-text{display:none}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-right{right:5px;top:0}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-right{bottom:100px;right:5px}.adthrive-player-position.adthrive-collapse-float.adthrive-collapse-bottom-left{bottom:100px;left:5px}.adthrive-player-position.adthrive-collapse-float>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-float>.adthrive-video-text{font-size:.67em}.adthrive-player-position.adthrive-collapse-sticky{padding-bottom:20px;padding-top:20px;position:fixed;z-index:9999}.adthrive-player-position.adthrive-collapse-sticky>.adthrive-player-title{display:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{bottom:auto!important;top:0;transform:translate(0)!important}#adthrive-sticky-outstream-close>svg>*{stroke:#fff!important}body.adthrive-device-phone .adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{bottom:auto!important}.adthrive-collapse-mobile-background{background-color:#000;left:0;position:fixed;top:0;z-index:99990}.adthrive-collapse-mobile-background.extra-height{height:163px!important}.adthrive-top-collapse-close{left:-30px;position:fixed;top:5px;z-index:1}.adthrive-sticky-outstream-top-center>.adthrive-top-collapse-close{left:10px;position:fixed;top:48px}.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile>.adthrive-top-collapse-close{top:10px}.adthrive-top-collapse-wrapper-bar>* .adthrive-top-collapse-close{left:0;position:relative;top:0}.adthrive-top-collapse-wrapper-bar>* .adthrive-wrapper-float-close{display:none;float:none;margin-bottom:0}.adthrive-player-position.adthrive-collapse-mobile{position:fixed;width:300px;z-index:99998}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-small{height:153px;padding:unset;width:272px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-small.rvps-experiment{width:256px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-medium{height:153px;padding:unset;width:272px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-medium.rvps-experiment{width:256px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-right{right:10px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-left{left:5px;top:26px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-left{bottom:52px;left:5px}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-bottom-right{bottom:52px;right:10px}.adthrive-player-position.adthrive-collapse-mobile>.adthrive-player-title{display:none}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-wrapper-bar{display:none!important}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center>.adthrive-top-collapse-wrapper-bar{display:block}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-without-wrapper-text{left:50%;padding-bottom:1px!important;padding-top:0!important;top:0;transform:translateX(-50%)}.adthrive-player-position.adthrive-collapse-mobile.adthrive-collapse-top-center.adthrive-player-with-wrapper-text{padding-bottom:1px!important;padding-top:0!important;right:5px;top:0}.adthrive-top-collapse-wrapper-bar{color:#fff;display:none;left:5px;padding-bottom:5px;padding-top:5px;position:fixed;top:0;width:-webkit-calc(100% - 282px);width:-moz-calc(100% - 282px);width:calc(100% - 282px);z-index:99998}.adthrive-top-collapse-wrapper-bar.rvps-experiment{width:-webkit-calc(100% - 266px);width:-moz-calc(100% - 266px);width:calc(100% - 266px)}.adthrive-top-collapse-wrapper-video-title{color:#fff;display:-webkit-box;font-size:13px;font-weight:700;line-height:1.2;overflow:hidden;text-decoration:none;text-overflow:ellipsis;-webkit-line-clamp:3;line-clamp:3;-webkit-box-orient:vertical}.adthrive-top-collapse-wrapper-bar a a.adthrive-learn-more-link{color:#fff;display:inline-block;font-size:13px;line-height:1.2}h3.adthrive-player-title{margin:10px 0}.adthrive-wrapper-close{align-items:center;color:#fff;font-size:36px;height:36px;justify-content:center;margin-left:auto;margin-right:0;min-width:36px}.adthrive-wrapper-float-close{cursor:pointer;display:none;float:right;margin-bottom:5px}.adthrive-top-left-outer{height:78px;left:-30px;position:absolute;top:-55px;width:78px}.adthrive-top-left-outer>svg{bottom:30px;left:30px;position:absolute}.adthrive-top-left-inner{position:absolute;top:0}.adthrive-top-left-inner.adthrive-wrapper-float-close{background:rgba(0,0,0,.5);color:#fff;padding:2px;pointer-events:none;width:100%;z-index:99}.adthrive-new-outstream-player .adthrive-top-left-inner.adthrive-wrapper-float-close{z-index:10000}.adthrive-new-outstream-player .adthrive-ad{margin-bottom:0;margin-top:0}.adthrive-top-left-inner-wrapper.adthrive-wrapper-float-close{background:rgba(0,0,0,.5);color:#fff;padding:2px;pointer-events:none;position:absolute;top:36px;width:100%;z-index:10000}.adthrive-sticky-outstream>.adthrive-wrapper-float-close{position:absolute;right:1px;top:0}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-outside-left{left:2px}.adthrive-sticky-outstream>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{background:rgba(0,0,0,.5);color:#fff;left:0;padding:2px;pointer-events:none;top:0}.adthrive-new-outstream-player{margin-bottom:20px;padding:0!important}.adthrive-new-outstream-player>.adthrive-wrapper-float-close.adthrive-wrapper-close-bkgd-50{top:0}#adthrive-sticky-outstream-close{position:relative}.adthrive-sticky-outstream-idle>#adthrive-sticky-outstream-close{pointer-events:none}.adthrive-sticky-outstream-active>#adthrive-sticky-outstream-close{pointer-events:all}.adthrive-wrapper-close-bkgd-50>#adthrive-sticky-outstream-close{padding:2px 0 0 2px;pointer-events:all}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile{bottom:52px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-right{right:10px}.adthrive-sticky-outstream.adthrive-sticky-outstream-mobile-left{left:10px;transform:none!important}.adthrive-sticky-outstream.adthrive-sticky-outstream-active.adthrive-sticky-outstream-top-center{background:#000;bottom:auto;left:0;right:0;top:0;transform:none}.adthrive-sticky-outstream.adthrive-sticky-outstream-desktop{bottom:100px;right:5px}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-desktop,.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile{bottom:auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-top-center.adthrive-sticky-outstream-mobile .adthrive-stickyoutstream-container{background-color:#000;margin:0 auto}.adthrive-sticky-outstream.adthrive-sticky-outstream-active{display:block}.adthrive-video-stickyoutstream{margin-top:0}.adthrive-video-stickyoutstream div:first-of-type{margin:-1px}.adthrive-video-stickyoutstream-new-player div:first-of-type{margin:0}.adthrive-instream-close{pointer-events:all}.adthrive-instream-close.adthrive-float-left{float:left}.adthrive-ccpa-link,.adthrive-ccpa-link span,.adthrive-footer-message span,.adthrive-privacy-preferences a{color:#a9a9a9;font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:13px}.adthrive-ccpa-link a{cursor:pointer;text-decoration:underline}.adthrive-device-phone .adthrive-footer-message{margin-bottom:60px}.adthrive-footer-message{margin-bottom:100px}.adthrive-footer-message>span{border-top:1px solid #b2b2b2;padding-top:5px;text-transform:uppercase}.adthrive-parallax-slot{height:400px;overflow:hidden;padding-top:5px}.adthrive-parallax-ad{transform:translateY(0);transition:transform .3s ease-out}.adthrive-sticky-container.adthrive-parallax-slot{flex-direction:row;justify-content:center;padding-top:10px}#_inv_voicefive___{display:none}.adthrive-ad-debug{background-color:rgba(255,0,0,.5)!important;outline:1px solid red!important}.adthrive-ad-debug:hover{background-color:rgba(255,0,0,.8)!important;cursor:pointer;outline:1px solid red!important}");
class xw{constructor(){this.healthReport={}}addHealthReport(b,c){this.healthReport[b]=this.healthReport[b]||{details:[]};this.healthReport[b].details.push(c)}log(){gc.event("HealthReporter","log",this.healthReport)}}class yw extends xw{constructor(){super(...arguments);this._reporter="CLSReporter"}get enabled(){return!1}start(){this._clsType();this._clsSlots()}_clsType(){let b=window.adthriveCLS,c=b&&!b.injectedFromPlugin&&b.injectedFromSiteAds;this.addHealthReport(this._reporter,{metric:"clsType",
value:b&&b.injectedFromPlugin&&"plugin"||c&&"nonplugin"||"none"})}_clsSlots(){var b=window.adthriveCLS;let c=b&&b.injectedSlots;b=b&&b.injectedVideoSlots;this.addHealthReport(this._reporter,{metric:"clsSlots",value:(c&&c.length||0)+(b&&b.length||0)})}}let tn=class{constructor(b){this._healthReporters=[b].filter(c=>c.enabled)}start(){this._healthReporters.forEach(b=>{b.start();b.log()})}};tn=q([H(),t("design:paramtypes",[yw])],tn);let un=class extends Eb{init(){this._setAbGroup=!1;this._key="DialDownLogsExperiment"}};
un=q([y()],un);Ab(".adthrive-act25-modal{background-color:#000;background-color:rgba(0,0,0,.4);display:none;height:100%;left:0;overflow:auto;position:fixed;top:0;width:100%;z-index:2147483647}.adthrive-act25-modal.show{display:block}.adthrive-act25-modal-content{background-color:#fefefe;border:1px solid #888;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,.5);font-family:Verdana,Geneva,Tahoma,sans-serif;left:50%;margin:auto;max-width:592px;padding:20px 24px 24px;position:absolute;top:50%;transform:translate(-50%,-50%);width:80%}.adthrive-act25-modal-close{color:#000;font-size:28px;font-weight:700;position:fixed;right:3px;top:-10px}.adthrive-act25-modal-close:focus,.adthrive-act25-modal-close:hover{color:#000;cursor:pointer;text-decoration:none}.adthrive-act25-modal-header{padding:2px 16px}.adthrive-act25-modal-header h1{color:rgba(0,0,0,.87);font-size:20px;line-height:26px}.adthrive-act25-modal-body{margin-bottom:10px;max-height:50vh;overflow-y:auto;padding:10px 16px;position:relative}.adthrive-act25-modal-body p{font-size:14px;line-height:20px}.adthrive-act25-modal-footer{color:#fff;display:flex;flex-direction:column;justify-content:space-between;padding:2px 16px}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{border:none;border-radius:10px;color:#fff;cursor:pointer}.adthrive-act25-modal-accept{background-color:#010044}.adthrive-act25-modal-decline{background-color:#fff;color:#000}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{flex:1;margin:0 10px 10px 0;text-transform:uppercase}.adthrive-act25-modal-accept:focus,.adthrive-act25-modal-accept:hover{background-color:#010044;color:#c4c4c4}.adthrive-act25-modal-decline:focus,.adthrive-act25-modal-decline:hover{background-color:#fff;color:#000}@media (max-width:600px){.adthrive-act25-modal-content{width:90%}.adthrive-act25-modal-body{border-bottom:1px solid #c4c4c4;box-shadow:inset 0 -100px 30px -100px rgba(0,0,0,.1)}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{font-size:14px;line-height:14px}}@media (min-width:600px){.adthrive-act25-modal-footer{flex-direction:row}.adthrive-act25-modal-accept,.adthrive-act25-modal-decline{flex:0 0 auto;margin:0}}.adthrive-act25-footer{margin-bottom:30px}.adthrive-act25-footer-text{color:#a9a9a9;font-size:14px}.adthrive-act25-footer-text p{color:#a9a9a9;text-decoration:underline}.adthrive-act25-footer-link{cursor:pointer;font-size:14px;text-decoration:underline}");
let vn=class extends T{constructor(b,c){super();this._config=b;this._consentEventBus=c;this._cssPrefix="adthrive-act25";this._footerLink=this._footer=this._modal=null;this._footerLinkOptOutText="Ne vendez pas ou ne partagez pas mes informations personnelles / Do not sell or share my personal information";this._footerLinkOptInText="Personnalisez mon exp\u00e9rience publicitaire / Customize my ad experience";this._storageKey="act25-consent";this._timer=null;this._timeout=3E4;this._consented=this._config.act25.consented}get consented(){return this._consented}get modal(){return this._modal}get footer(){return this._footer}init(){var b;
this._modal=this._createConsentModal();this._footer=this._createFooterElement();null===this._consented?(null===(b=this._modal)||void 0===b?void 0:b.classList.add("show"),this._startTimer()):this._consentEventBus.act25consentCaptured.emit(this._consented);this._injectFooterElement()}checkConsent(){return new Promise(b=>{null!==this._consented&&b(this._consented);this._consentEventBus.act25consentCaptured.on(c=>{this._timer&&(clearTimeout(this._timer),this._timer=null);b(c)})})}_createConsentModal(){if(this._modal)return this._modal;
let b=document.createElement("div");b.className=`${this._cssPrefix}-modal`;let c=document.createElement("div");c.className=`${this._cssPrefix}-modal-content`;let d=document.createElement("span");d.className=`${this._cssPrefix}-modal-close`;d.innerText="\u2715";d.addEventListener("click",()=>this._handleClose());let e=document.createElement("div");e.className=`${this._cssPrefix}-modal-body`;e.innerHTML='\n    <p>\n    Soucieux d\u2019offrir une exp\u00e9rience optimale, nous et nos partenaires utilisons des technologies telles que les cookies pour enregistrer et/ou acc\u00e9der\n    aux informations des appareils. Le consentement \u00e0 ces technologies nous permettra, \u00e0 nous et \u00e0 nos partenaires, de traiter des donn\u00e9es personnelles\n    telles que le comportement de navigation ou les identifiants uniques sur ce site. Les cookies d\u00e9pos\u00e9s par nos partenaires ou fournisseurs tiers sont\n    des cookies tiers d\u00e9pos\u00e9s dans le but de placer des publicit\u00e9s sur nos produits et Services sur d\u2019autres sites web. L\u2019utilisation des cookies par\n    ces tiers est r\u00e9gie par leurs politiques de confidentialit\u00e9.\n    </p>\n    <p>\n    Cliquez sur \u00ab accepter \u00bb ou \u00ab d\u00e9clin \u00bb ci-dessous. Vous pouvez mettre \u00e0 jour vos choix \u00e0 tout moment en cliquant sur ne vendez pas en\n    bas de la page.\n    </p>\n\n    <br />\n\n    <p>\n    To provide the best experiences, we and our partners use technologies like cookies to store and/or access device information.\n    Consenting to these technologies will allow us and our partners to process personal data such as browsing behavior or unique IDs on this site.\n    Cookies placed by our partners or third-party suppliers are third-party cookies placed for the purpose of placing advertisements on our products\n    and Services on other websites. The use of cookies by these third parties is governed by their privacy policies.\n    </p>\n    <p>\n    Click "accept" or \u201cdecline" below. You can update your choices at any time by clicking on the Do not sell link in the bottom of the page.\n    </p>\n    ';
let f=document.createElement("div");f.className=`${this._cssPrefix}-modal-footer`;let g=document.createElement("button");g.className=`${this._cssPrefix}-modal-accept`;g.innerText="Accepter/Accept";g.addEventListener("click",()=>this._handleAccept());let h=document.createElement("button");h.className=`${this._cssPrefix}-modal-decline`;h.innerText="D\u00e9clin/Decline";h.addEventListener("click",()=>this._handleDecline());e.appendChild(d);f.appendChild(h);f.appendChild(g);c.appendChild(e);c.appendChild(f);
b.appendChild(c);document.body.appendChild(b);return b}_createFooterElement(){if(this._footer)return this._footer;let b=document.createElement("div");b.className=`${this._cssPrefix}-footer`;let c=document.createElement("p");c.className=`${this._cssPrefix}-footer-text`;c.innerText="\n    Les informations de votre appareil peuvent \u00eatre utilis\u00e9es pour personnaliser votre exp\u00e9rience publicitaire. /\n      Information from your device can be used to personalize your ad experience.";let d=
document.createElement("a");d.innerText=this._consented?this._footerLinkOptOutText:this._footerLinkOptInText;d.className=`${this._cssPrefix}-footer-link`;d.addEventListener("click",()=>{var e;return this._handleFooterLinkClick(null!==(e=this._consented)&&void 0!==e?e:!1)});this._footerLink=d;b.appendChild(c);b.appendChild(d);return b}_injectFooterElement(){let b=this._config.footer.elements;this._footer&&b.find(c=>c.element===this._footer)||b.push({order:1,element:this._footer})}_destroyConsentModal(){var b;
null===(b=this._modal)||void 0===b?void 0:b.classList.remove("show")}_handleAccept(){this._toggleConsent(!0);A.event("Act25EnforcementComponent","handleUserAction","qbccmp:acc")}_handleDecline(){this._toggleConsent(!1);A.event("Act25EnforcementComponent","handleUserAction","qbccmp:dec")}_handleClose(){this._toggleConsent(!1);A.event("Act25EnforcementComponent","handleUserAction","qbccmp:clo")}_handleTimeout(){this._toggleConsent(!1);A.event("Act25EnforcementComponent","handleUserAction","qbccmp:tim")}_handleFooterLinkClick(b){var c;
b?this._handleDecline():null===(c=this._modal)||void 0===c?void 0:c.classList.add("show")}_toggleConsent(b){U.setLocalStorageValue(this._storageKey,b);this._consented=b;this._destroyConsentModal();this._updateFooterLink(b);this._consentEventBus.act25consentCaptured.emit(b)}_updateFooterLink(b){this._footerLink&&(this._footerLink.innerText=b?this._footerLinkOptOutText:this._footerLinkOptInText)}_startTimer(){this._timer=window.setTimeout(()=>{this._handleTimeout()},this._timeout)}};vn=q([v("Act25EnforcementComponent"),
y(),t("design:paramtypes",[N,md])],vn);let wn=class{constructor(b,c,d){this._slotEventBus=b;this._pageManager=c;this._prebidMethods=d;this._prebidResponses=this._adSlots=this._adRequests=0;this._prebidResponseCPMs=[];this._timeToFirstAdReq=this._timeOnPage=this._domContentLoaded=-Infinity}init(){this._slotEventBus.requestingBids.once(()=>this._setTimeToFirstAdRequest());this._slotEventBus.requestingBids.on(()=>this._adRequested());this._slotEventBus.addSlots.on(b=>this._addSlots(b.length));this._trackDomContentLoaded();
this._pageManager.beforeUnload.on(()=>{this._calculateTimeOnPage();this._sendCounts()});this._prebidMethods.onEvent("bidWon",b=>{this._prebidResponses++;this._prebidResponseCPMs.push(Number(b.cpm.toFixed(2)))})}_setTimeToFirstAdRequest(){this._timeToFirstAdReq=-Infinity!==this._domContentLoaded?kd.now()-this._domContentLoaded:-Infinity}_adRequested(){this._adRequests++}_addSlots(b){this._adSlots+=b}_trackDomContentLoaded(){let b=performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation");
b&&b[0]&&b[0].domContentLoadedEventEnd&&(this._domContentLoaded=b[0].domContentLoadedEventEnd)}_calculateTimeOnPage(){this._timeOnPage=-Infinity!==this._domContentLoaded?kd.now()-this._domContentLoaded:-Infinity}_sendCounts(){gc.event("SystemPulse","counts",{adRequests:this._adRequests,prebidsWon:this._prebidResponses,prebidCPMs:this._prebidResponseCPMs,adSlots:this._adSlots,timeToFirstAdReq:this._timeToFirstAdReq,timeOnPage:this._timeOnPage})}};wn=q([y(),t("design:paramtypes",[cb,Ra,ia])],wn);let rg=
class{constructor(b,c,d,e,f,g,h,k,m,n,p){this.config=b;this.cmd=c;this.slotManager=d;this.slots=e;this._auctionManagers=f;this._coreExperimentConfig=g;this._googleAdManager=h;this._components=k;this._healthReporters=m;this._siteExperimentEventBus=n;this._realizedAdDensityEventBus=p;this.marmalade={mcmp:null};this.marmaladeFinished=r=>r;this.raptiveFloorsFinished=r=>r;this._apiReady=new Promise(r=>r(!1));this._adDensityReady=new Promise(r=>r(!1));this.bucket=this.config.context.bucket;this.branch=
this.config.context.branch;this.invalidTraffic=this.config.context.invalidTraffic;this.deployment=this.config.context.deployment;this.abgroup=this.config.abGroup.groups;this.pubab=this.config.pubAbGroup.groups;this.siteAds=window.adthrive.siteAds;this.buildDate=window.adthrive.buildDate;this.windowPerformance=window.adthrive.windowPerformance;this.marmaladeFinished=window.adthrive.marmaladeFinished||this.marmaladeFinished;this.raptiveFloorsFinished=window.adthrive.raptiveFloorsFinished||this.raptiveFloorsFinished;
this.coreExperiments=this._coreExperimentConfig.coreExperiments;this.deliveryFeatures=window.adthrive.deliveryFeatures;this.cookieDeprecationLabel=window.adthrive.cookieDeprecationLabel;this.siteAds.targeting={push:r=>this._googleAdManager.setTargeting(r)};this._siteExperimentEventBus.targetingReady.on(()=>{this.pubab=this.config.pubAbGroup.groups;this._googleAdManager.setTargeting({key:"pubab",value:this.pubab})});"off"===jc().get("at_sticky")&&this.clearSticky()}async init(){let b=0===window.adthrive.bucket.indexOf("hbs-q")||
.01>Math.random();b&&this.cmd.push(()=>gc.event("AdThrive","init","hcstart"));this._apiReady=new Promise(e=>this.config.identityApi.apiReady.on(()=>e(!0)));this._adDensityReady=new Promise(e=>this._realizedAdDensityEventBus.realizedAdDensityCompReady.on(()=>e(!0)));let c=e=>{e.data={abgroup:this.config.abGroup.groupsAsObject,pubab:this.config.pubAbGroup.groupsAsObject,sess:this.config.context.sessionKey,pvk:this.config.context.pageviewKey,hbho:this.config.hbho.bidders,vbho:this.config.vbho.bidders,
spa:this.config.adOptions.spa,...(this.config.context.deliveryVersion&&{lmdv:this.config.context.deliveryVersion}),...(this.config.clsOptions&&this.config.clsOptions.branch&&{clsBranch:this.config.clsOptions.branch}),...(this.config.clsOptions&&this.config.clsOptions.bucket&&{clsBucket:this.config.clsOptions.bucket})}};var d=S.resolve(un);S.resolve(ed).dialDownLogs.emit({result:d.result,choices:d._choices});c(A);A.sending.on(()=>c(A));gc.sending.on(()=>c(gc));this.cmd.init();this._auctionManagers.init();
this._googleAdManager.init();S.resolve(wn).init();this.config.act25.required&&(d=S.resolve(vn),d.init(),await d.checkConsent());this._components.init();this._googleAdManager.start();this._components.start();window.adthriveCLS&&window.adthriveCLS.error&&A.error("AdThrive","init","Problem with AdThriveCLS SiteAds. CLS Disabled");this._healthReporters.start();b&&gc.event("AdThrive","init","hcend")}identityApi(b,c){return this._apiReady.then(()=>{this.config.identityApi.optIn.emit({data:b,cb:c})})}disableAds(b){this.config.disableAds.disableAllAds(b)}disableContentAds(b){this.config.disableAds.disableContentAds(b)}disablePlaylistPlayers(b){this.config.disableAds.disablePlaylistPlayers(b)}showPrivacyPreferences(){window.__tcfapi&&
window.__tcfapi("showConsentManager",2)}getConsentData(){window.__tcfapi&&window.__tcfapi("getFullTCData",2,b=>{})}getAdthriveFlippData(){return this.config.marmalade.flpProdIds.filter(Lb)}setTargetingFlag(b,c,d=!1){b&&"string"===typeof b&&c&&Array.isArray(c)&&0!==c.length&&this._googleAdManager.setTargetingFlag(b,c,d)}setTargeting(b){this._googleAdManager.setTargeting(b)}getTargeting(){return this._googleAdManager.getTargeting()}getTargetingMap(){return this._googleAdManager.getTargetingMap()}logError(b,
c,d){A.error(b,c,d)}refreshSlots(b){let c=this.slots.get();b&&b.length&&(c=c.filter(d=>b.includes(d.id)));c.forEach(d=>{this.slotManager.refresh(d,!1).then(()=>{this.slotManager.clearRefreshTimeout(d,!0)}).catch(()=>{})})}nmr(){A.event("adthrive","nmr","adthrive.nmr() has been called");return this.slotManager.updateRefreshTimeout(this.slots.get(),0)}clearSticky(){A.event("adthrive","clearSticky","adthrive.clearSticky() has been called");U.removeLocalStorageValue("abgroup")}async getAdDensity(){let b=
null;await this._adDensityReady.then(()=>{this._realizedAdDensityEventBus.metricsRequested.emit(c=>b=c)}).catch(()=>{});return b}logAdDensity(){this._adDensityReady.then(()=>{this._realizedAdDensityEventBus.metricsRequested.emit(b=>{})}).catch(()=>{})}};rg=q([v("AdThrive"),y(),t("design:paramtypes",[N,Jk,ja,Qa,Rc,Ob,V,sn,tn,Fe,Ge])],rg);let zw={domain:"ads.adthrive.com",branch:"main",bucket:"prod",cmp:!0},xn=class extends fb{constructor(){super();this.classList=["EmailCaptureHandler"];this._result=
!1;this._choices=[{choice:!0},{choice:!1}];this.abgroup="logfltr";this.key="LoggerFilter";this._result=this.run()}get result(){return this._result}run(){return(new Ha(0)).get()}};xn=q([v("LoggerFilterExperiment"),y(),t("design:paramtypes",[])],xn);let yn=class{init(b){if(void 0!==window.__tcfapi&&"function"===typeof window.__tcfapi){var c=!1;window.__tcfapi("adthrive",2,d=>c=d);c&&("true"===b?window.__tcfapi("setGdprApplies",2,d=>d,!0):(this.clearQueue(),this.stubCommands()))}}processTcfCommand(b){let {command:c,
callback:d}=b;!d||d&&"function"!==typeof d||("ping"===c||"addEventListener"===c?d({apiVersion:"2",cmpLoaded:!0,cmpStatus:"loaded",cmpId:void 0,cmpVersion:void 0,displayStatus:"disabled",gdprApplies:!1,tcfPolicyVersion:void 0,gvlVersion:void 0},!0):"removeEventListener"===c&&d(!0))}clearQueue(){let b=window.__tcfapi();b&&Array.isArray(b)&&b.forEach(c=>this.processTcfCommand(c))}stubCommands(){window.__tcfapi=(b,c,d,e)=>{this.processTcfCommand({command:b,version:c,callback:d,parameter:e})}}};yn=q([v("StubCmp"),
y()],yn);let Aw=()=>{var b,c,d;return navigator.userAgent&&(-1<navigator.userAgent.search(/GTmetrix/i)||-1<navigator.userAgent.search(/pingdom/i)||-1<navigator.userAgent.search(/Google Page Speed Insights/i)||-1<navigator.userAgent.search(/Chrome-Lighthouse/i))?!0:(null===(d=null===(c=null===(b=window.navigator)||void 0===b?void 0:b.userAgentData)||void 0===c?void 0:c.brands)||void 0===d?0:d.map(e=>e.brand).includes("Lighthouse"))?!0:!1};var zn;(zn||(zn={})).SetInterestGroupsData="adthrive_SetInterestGroupsData";
let An=class{constructor(b,c,d,e,f){var g;this._bootstrapConfig=b;this._fledgeConfig=c;this._privacySandboxEventBus=d;this._browserTopicsAPIEventBus=e;this._marmaladeEventBus=f;this._host=null!==(g=window.adthriveDevelopmentHost)&&void 0!==g?g:"https://ads.adthrive.com";this._frame=document.createElement("iframe");this._frameSrc=`${this._bootstrapConfig.baseUrl.replace("/gdpr","")}/html/ps.html`;this.enabled&&this._addIframeToPage().then(()=>{this._privacySandboxEventBus.iframeReady.emit();this._setupEventListeners()}).catch(h=>
{A.error("PrivacySandboxIframeManager","constructor","Failed to initialize Privacy Sandbox iframe",h)})}get enabled(){return this._fledgeConfig.enabled}setInterestGroups(b){try{this._frame.contentWindow&&this._frame.contentWindow.postMessage({action:zn.SetInterestGroupsData,groupNames:b},this._host)}catch(c){A.error("PrivacySandboxIframeManager","setInterestGroups","Failed to set interest groups.",c)}}_addIframeToPage(){return new Promise(b=>{this._frame.src=this._frameSrc;this._frame.id="adthrive-privacy-sandbox";
this._frame.style.display="none";this._frame.onload=()=>{b()};document.body.appendChild(this._frame)})}_setupEventListeners(){this._browserTopicsAPIEventBus.topicsReceived.on(b=>{b=b.map(c=>`${c.id}`);this.setInterestGroups(b)},{handleEventsAlreadyEmitted:!0});this._marmaladeEventBus.marmaladeResponseLoaded.on(({recencyFrequency:b})=>{var c;b=null!==(c=null===b||void 0===b?void 0:b.map(({rf_code:d})=>d))&&void 0!==c?c:[];this.setInterestGroups(b)},{handleEventsAlreadyEmitted:!0})}};An=q([v("PrivacySandboxIframeManager"),
y(),t("design:paramtypes",[Fa,Ue,Ah,ld,ob])],An);let Bw=b=>b instanceof rg||b instanceof Promise,lb=S.resolve(Ze),Cw=async(b,c,d,e)=>{const f=ra();S.register("RecencyFrequencyMarmaladeResponse",{useValue:d.result});window.adthrive=S.resolve(rg);lb.loading=b;lb.bootstrapFinished=f;lb.gamStarted=c.started;lb.gamFinished=c.finished;lb.gamDuration=c.duration;lb.marmaladeStarted=d.started;lb.marmaladeFinished=d.finished;lb.marmaladeDuration=d.duration;lb.floorsStarted=e.started;lb.floorsFinished=e.finished;
lb.floorsDuration=e.duration;await kj();return window.adthrive.init()},Dw=async b=>{const c=ra(),d=window.adthrive.branch,e=U.getLocalStorageValue("branch");U.setLocalStorageValue("branch",{branch:d,enabled:d===(null===e||void 0===e?void 0:e.branch)});U.setSessionFpv();S.register("Build",{useValue:zw});S.register("AdThrive",{useValue:b});S.resolve(Re);S.resolve(An);return await S.resolve(ai).run().then(({gam:f,marmalade:g,floors:h})=>Cw(c,f,g,h)).catch(f=>{const g=f.marmalade;f=f.message||f;g&&Object.prototype.hasOwnProperty.call(g,
"result")&&(S.register("RecencyFrequencyMarmaladeResponse",{useValue:g.result}),S.resolve(jg).init());S.resolve(ig).init();return Promise.reject(f)})},Ew=({gdpr:b,baseUrl:c})=>"true"===b?`${c}/gdpr`:c,Fw=()=>{const b=window.adthrive.siteAds;var c=window.adthriveCLS;c=c&&c.siteAds;var d=window.adthrive.siteAds.videoPlayers&&window.adthrive.siteAds.videoPlayers.contentSpecificPlaylists;d=d?[...d]:[];c&&Dp(c)&&(b.adUnits=c.adUnits,b.video=c.video,b.videoPlayers=c.videoPlayers,b.breakpoints=c.breakpoints,
b.videoPlayers&&(b.videoPlayers.contentSpecificPlaylists=d.filter(e=>!e.isDraft)))},Gw=b=>{var c=S.resolve(Ra).setupOnceEventWithPromise;const d=[c("scroll"),c("mousemove"),c("keyup")];Ta()||d.push(c("touchstart"));c=[c("load").then(()=>kp(b))];return Aw()?d:c.concat(d)},Hw=b=>{Q(b.siteAds.adOptions.delayLoading,!1)?(b=Gw(50),b=Promise.race(b)):b=Promise.resolve();return b},Iw=()=>{S.register("PageviewKey",{useValue:Dc()});const b=window.adthrive;window.adthriveCLS&&!window.adthriveCLS.error?(S.register("AdthriveCLS",
{useValue:window.adthriveCLS}),Fw()):S.register("AdthriveCLS",{useValue:{}});S.register("CoreExperimentValues",{useValue:b.core.coreExperiments});const c=Ew(b),d=zp();var e=0===b.bucket.indexOf("hbs-q");e=d||e?"unsupported":b.bucket;const f=S.resolve(xn),g={...b,bucket:e,baseUrl:c,invalidTraffic:d,loggerFilters:f.result?[]:f.classList};U.init(g);gc.init(g);A.init(g);const h=ra();S.resolve(yn).init(g.gdpr);Hw(g).then(()=>{const k=ra()-h;lb.delay=k;return Dw(g)}).then(()=>{}).catch(k=>{"string"===typeof k?
A.error("index","load",Error(k)):A.error("index","load",k)})};try{Bw(window.adthrive)||Iw()}catch(b){A.error("index","pre-init",b)}return window.adthrive}()
;